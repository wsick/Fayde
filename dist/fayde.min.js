var Fayde;!function(e){e.version="0.16.56"}(Fayde||(Fayde={})),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},o=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,o.prototype=new r,o}),function(e){e.perfex||(e.perfex={}),e.perfex.timer||(e.perfex.timer={all:[],reset:function(){},start:function(e){},stop:function(){}}),e.perfex.phases||(e.perfex.phases={current:null,all:[],start:function(e){}})}(window);var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},Fayde;!function(e){function t(e,t){return"/"!==e[e.length-1]&&(e+="/"),e+("/"===t[0]?t.substr(1):t)}function n(t,n,r){r=r||nullstone.getTypeName(t),e.TypeManager.add(n,r,t)}function r(t,n,r){e.TypeManager.addEnum(n,r,t)}e.XMLNS="http://schemas.wsick.com/fayde",e.XMLNSX="http://schemas.wsick.com/fayde/x",e.XMLNSINTERNAL="http://schemas.wsick.com/fayde/internal",e.Enum=nullstone.Enum,e.Uri=nullstone.Uri;var o=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.resolveResource=function(e){if("lib"===e.scheme){var n=e.resource,r=e.toString(),o=r.replace(n,""),i=this.resolveLibrary(o);if(!i)throw new Error("Could not find library when resolving resource ["+r+"].");return t(i.basePath,n.length>1?n.substr(1):"")}return e.toString()},n}(nullstone.TypeManager);e.ResourceTypeManager=o,e.TypeManager=new o(e.XMLNS,e.XMLNSX),e.CoreLibrary=e.TypeManager.resolveLibrary(e.XMLNS),e.CoreLibrary.$$module=e,e.XLibrary=e.TypeManager.resolveLibrary(e.XMLNSX),e.XLibrary.$$module=e,e.RegisterType=n,e.RegisterEnum=r,e.IType_=new nullstone.Interface("IType"),e.IType_.is=function(e){return"function"==typeof e}}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){!function(e){e[e.Add=1]="Add",e[e.Remove=2]="Remove",e[e.Replace=3]="Replace",e[e.Reset=4]="Reset"}(t.CollectionChangedAction||(t.CollectionChangedAction={}));var n=t.CollectionChangedAction;e.CoreLibrary.addEnum(n,"NotifyCollectionChangedAction");var r=function(){function e(){}return e.Reset=function(t){var r=new e;return Object.defineProperty(r,"Action",{value:n.Reset,writable:!1}),Object.defineProperty(r,"OldStartingIndex",{value:0,writable:!1}),Object.defineProperty(r,"NewStartingIndex",{value:-1,writable:!1}),Object.defineProperty(r,"OldItems",{value:t,writable:!1}),Object.defineProperty(r,"NewItems",{value:null,writable:!1}),r},e.Replace=function(t,r,o){var i=new e;return Object.defineProperty(i,"Action",{value:n.Replace,writable:!1}),Object.defineProperty(i,"OldStartingIndex",{value:-1,writable:!1}),Object.defineProperty(i,"NewStartingIndex",{value:o,writable:!1}),Object.defineProperty(i,"OldItems",{value:[r],writable:!1}),Object.defineProperty(i,"NewItems",{value:[t],writable:!1}),i},e.Add=function(t,r){var o=new e;return Object.defineProperty(o,"Action",{value:n.Add,writable:!1}),Object.defineProperty(o,"OldStartingIndex",{value:-1,writable:!1}),Object.defineProperty(o,"NewStartingIndex",{value:r,writable:!1}),Object.defineProperty(o,"OldItems",{value:null,writable:!1}),Object.defineProperty(o,"NewItems",{value:[t],writable:!1}),o},e.AddRange=function(t,r){var o=new e;return Object.defineProperty(o,"Action",{value:n.Add,writable:!1}),Object.defineProperty(o,"OldStartingIndex",{value:-1,writable:!1}),Object.defineProperty(o,"NewStartingIndex",{value:r,writable:!1}),Object.defineProperty(o,"OldItems",{value:null,writable:!1}),Object.defineProperty(o,"NewItems",{value:t,writable:!1}),o},e.Remove=function(t,r){var o=new e;return Object.defineProperty(o,"Action",{value:n.Remove,writable:!1}),Object.defineProperty(o,"OldStartingIndex",{value:r,writable:!1}),Object.defineProperty(o,"NewStartingIndex",{value:-1,writable:!1}),Object.defineProperty(o,"OldItems",{value:[t],writable:!1}),Object.defineProperty(o,"NewItems",{value:null,writable:!1}),o},e}();t.CollectionChangedEventArgs=r}(t=e.Collections||(e.Collections={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){e.INotifyCollectionChanged_=new nullstone.Interface("INotifyCollectionChanged"),e.INotifyCollectionChanged_.is=function(e){return e&&e.CollectionChanged instanceof nullstone.Event}}(t=e.Collections||(e.Collections={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function e(e){Object.defineProperty(this,"PropertyName",{value:e,writable:!1})}return e}();e.PropertyChangedEventArgs=t,e.CoreLibrary.add(t),e.INotifyPropertyChanged_=new nullstone.Interface("INotifyPropertyChanged"),e.INotifyPropertyChanged_.is=function(e){return e&&e.PropertyChanged instanceof nullstone.Event}}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function n(){this._ht=[],this.CollectionChanged=new nullstone.Event,this.PropertyChanged=new nullstone.Event}return n.prototype.getEnumerator=function(){return nullstone.IEnumerator_.fromArray(this._ht)},Object.defineProperty(n.prototype,"Count",{get:function(){return this._ht.length},enumerable:!0,configurable:!0}),n.prototype.ToArray=function(){return this._ht.slice(0)},n.prototype.GetValueAt=function(e){var t=this._ht;if(0>e||e>=t.length)throw new IndexOutOfRangeException(e);return t[e]},n.prototype.SetValueAt=function(e,n){var r=this._ht;if(0>e||e>=r.length)throw new IndexOutOfRangeException(e);var o=r[e];r[e]=n,this.CollectionChanged.raise(this,t.CollectionChangedEventArgs.Replace(n,o,e))},n.prototype.Add=function(e){var n=this._ht.push(e)-1;this.CollectionChanged.raise(this,t.CollectionChangedEventArgs.Add(e,n)),this._RaisePropertyChanged("Count")},n.prototype.AddRange=function(e){for(var n=this._ht.length,r=e.length,o=0;r>o;o++)this._ht.push(e[o]);this.CollectionChanged.raise(this,t.CollectionChangedEventArgs.AddRange(e,n)),this._RaisePropertyChanged("Count")},n.prototype.Insert=function(e,n){var r=this._ht;if(0>e||e>r.length)throw new IndexOutOfRangeException(e);e>=r.length?r.push(n):r.splice(e,0,n),this.CollectionChanged.raise(this,t.CollectionChangedEventArgs.Add(n,e)),this._RaisePropertyChanged("Count")},n.prototype.IndexOf=function(e){return this._ht.indexOf(e)},n.prototype.Contains=function(e){return this._ht.indexOf(e)>-1},n.prototype.Remove=function(e){var n=this._ht.indexOf(e);return 0>n?!1:(this._ht.splice(n,1),this.CollectionChanged.raise(this,t.CollectionChangedEventArgs.Remove(e,n)),this._RaisePropertyChanged("Count"),!0)},n.prototype.RemoveAt=function(e){if(0>e||e>=this._ht.length)throw new IndexOutOfRangeException(e);var n=this._ht.splice(e,1)[0];this.CollectionChanged.raise(this,t.CollectionChangedEventArgs.Remove(n,e)),this._RaisePropertyChanged("Count")},n.prototype.Clear=function(){var e=this._ht;this._ht=[],this.CollectionChanged.raise(this,t.CollectionChangedEventArgs.Reset(e)),this._RaisePropertyChanged("Count")},n.prototype._RaisePropertyChanged=function(t){this.PropertyChanged.raise(this,new e.PropertyChangedEventArgs(t))},n}();t.ObservableCollection=n,e.CoreLibrary.add(n),nullstone.ICollection_.mark(n)}(t=e.Collections||(e.Collections={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this.ItemPropertyChanged=new nullstone.Event,this.CollectionChanged.on(this._OnCollectionChanged,this)}return __extends(r,n),r.prototype._OnCollectionChanged=function(t,n){if(n.NewItems)for(var r=0;r<n.NewItems.length;r++){var o=e.INotifyPropertyChanged_.as(n.NewItems[r]);o&&o.PropertyChanged.on(this._OnItemPropertyChanged,this)}if(n.OldItems)for(var r=0;r<n.OldItems.length;r++){var o=e.INotifyPropertyChanged_.as(n.OldItems[r]);o&&o.PropertyChanged.off(this._OnItemPropertyChanged,this)}},r.prototype._OnItemPropertyChanged=function(e,n){this.ItemPropertyChanged.raise(this,new t.ItemPropertyChangedEventArgs(e,n.PropertyName))},r}(t.ObservableCollection);t.DeepObservableCollection=n}(t=e.Collections||(e.Collections={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t=function(t){function n(n,r){t.call(this),this.Filter=n,this._SetSource(r||new e.DeepObservableCollection)}return __extends(n,t),Object.defineProperty(n.prototype,"Source",{get:function(){return this._Source},set:function(e){this._SetSource(e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Filter",{get:function(){return this._Filter},set:function(e){this._Filter=e,this.Update()},enumerable:!0,configurable:!0}),n.prototype._SetSource=function(e){this._Source&&(this._Source.CollectionChanged.off(this._OnSourceCollectionChanged,this),this._Source.ItemPropertyChanged.off(this._OnSourceItemPropertyChanged,this)),this._Source=e,e&&(e.CollectionChanged.on(this._OnSourceCollectionChanged,this),e.ItemPropertyChanged.on(this._OnSourceItemPropertyChanged,this)),this.Update()},n.prototype._OnSourceCollectionChanged=function(e,t){this.Update()},n.prototype._OnSourceItemPropertyChanged=function(e,t){this.Update();var n=this.Source.IndexOf(t.Item);this.Filter&&this.Filter(t.Item,n)&&this.ItemPropertyChanged.raise(this,t)},n.prototype.Update=function(){if(this._Source)for(var e=this.Filter||function(e){return!0},t=0,n=0,r=this._Source.getEnumerator();r.moveNext();t++){var o=e(r.current,t),i=n<this.Count&&this.GetValueAt(n)===r.current;o&&!i?this.Insert(n,r.current):!o&&i&&this.RemoveAt(n),o&&n++}},n}(e.DeepObservableCollection);e.FilteredCollection=t}(t=e.Collections||(e.Collections={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(t,n){e.call(this,n),Object.defineProperty(this,"Item",{value:t,writable:!1})}return __extends(t,e),t}(e.PropertyChangedEventArgs);t.ItemPropertyChangedEventArgs=n}(t=e.Collections||(e.Collections={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function e(e){this.CollectionChanged=new nullstone.Event,this.PropertyChanged=new nullstone.Event,this._Source=e,this._Source.CollectionChanged.on(this._OnCollectionChanged,this),this._Source.PropertyChanged.on(this._OnPropertyChanged,this)}return Object.defineProperty(e.prototype,"Count",{get:function(){return this._Source.Count},enumerable:!0,configurable:!0}),e.prototype.GetValueAt=function(e){return this._Source.GetValueAt(e)},e.prototype.getEnumerator=function(){return this._Source.getEnumerator()},e.prototype.ToArray=function(){return this._Source.ToArray()},e.prototype.IndexOf=function(e){return this._Source.IndexOf(e)},e.prototype.Contains=function(e){return this._Source.Contains(e)},e.prototype._OnCollectionChanged=function(e,t){this.CollectionChanged.raise(this,t)},e.prototype._OnPropertyChanged=function(e,t){this.PropertyChanged.raise(this,t)},e.prototype.SetValueAt=function(e,t){throw new Error("Collection is read only.")},e.prototype.Insert=function(e,t){throw new Error("Collection is read only.")},e.prototype.Add=function(e){throw new Error("Collection is read only.")},e.prototype.Remove=function(e){throw new Error("Collection is read only.")},e.prototype.RemoveAt=function(e){throw new Error("Collection is read only.")},e.prototype.Clear=function(){throw new Error("Collection is read only.")},e}();t.ReadOnlyObservableCollection=n,e.CoreLibrary.add(t.ObservableCollection),nullstone.addTypeInterfaces(n,nullstone.ICollection_,t.INotifyCollectionChanged_,e.INotifyPropertyChanged_)}(t=e.Collections||(e.Collections={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function e(e){this.ParentNode=null,this.Name="",this.NameScope=null,this.DocNameScope=null,this.IsShareable=!1,this._OwnerNameScope=null,this._LogicalChildren=[],this._IAMonitors=null,this._DataContext=void 0,this._IsEnabled=!0,this.IsAttached=!1,this.XObject=e}return Object.defineProperty(e.prototype,"DataContext",{get:function(){return this._DataContext},set:function(e){var t=this._DataContext;t!==e&&(this._DataContext=e,this.OnDataContextChanged(t,e))},enumerable:!0,configurable:!0}),e.prototype.OnDataContextChanged=function(e,t){for(var n=this._LogicalChildren,r=n.length,o=null,i=0;r>i;i++)o=n[i],o.DataContext=t},Object.defineProperty(e.prototype,"IsEnabled",{get:function(){return this._IsEnabled},set:function(e){e=e!==!1;var t=this._IsEnabled;t!==e&&(this._IsEnabled=e,this.OnIsEnabledChanged(t,e))},enumerable:!0,configurable:!0}),e.prototype.OnIsEnabledChanged=function(e,t){for(var n=this._LogicalChildren,r=n.length,o=null,i=0;r>i;i++)o=n[i],o.IsEnabled=t},e.prototype.FindName=function(e,t){var n,r=this.FindNameScope();r&&(n=r.FindName(e));var o;return!n&&t&&(o=this.DocNameScope)&&(n=o.FindName(e)),n},e.prototype.SetName=function(e){this.Name=e;var t=this.FindNameScope();t&&t.RegisterName(e,this)},e.prototype.FindNameScope=function(){if(this._OwnerNameScope)return this._OwnerNameScope;for(var e,t=this;t;){if(e=t.NameScope)return this._OwnerNameScope=e,e;t=t.ParentNode}return void 0},e.prototype.SetIsAttached=function(e){this.IsAttached!==e&&(this.IsAttached=e,this.OnIsAttachedChanged(e))},e.prototype.OnIsAttachedChanged=function(e){var t=this.XObject;e&&this.ParentNode&&!t.App&&(t.App=this.ParentNode.XObject.App);for(var n=this._LogicalChildren,r=n.length,o=null,i=0;r>i;i++)o=n[i],o.SetIsAttached(e);for(var i=0,a=(this._IAMonitors||[]).slice(0),r=a.length;r>i;i++)a[i].Callback(e);e||(this._OwnerNameScope=void 0)},e.prototype.MonitorIsAttached=function(e){var t=this._IAMonitors;t||(this._IAMonitors=t=[]);var n={Callback:e,Detach:null};return n.Detach=function(){var e=t.indexOf(n);e>-1&&t.splice(e,1)},this._IAMonitors.push(n),n},e.prototype.AttachTo=function(e,t){if(this.ParentNode&&this.IsShareable)return!0;for(var n={ParentNode:e,ChildNode:this,Name:""},r=e;r;){if(r===this)return t.Message="Cycle found.",t.Data=n,t.Number=BError.Attach,!1;r=r.ParentNode}if(this.ParentNode)return this.ParentNode===e?!0:(t.Message="Element is already a child of another element.",t.Data=n,t.Number=BError.Attach,!1);var o=e.FindNameScope(),i=this.NameScope;if(i)i.IsRoot||(o.Absorb(i),this.NameScope=null,this._OwnerNameScope=o);else if(o){var a=this.Name;if(a){var s=o.FindName(a);if(s&&s!==this)return t.Message="Name is already registered in parent namescope.",n.Name=a,t.Data=n,t.Number=BError.Attach,!1;o.RegisterName(a,this)}this._OwnerNameScope=o}var u=this.ParentNode;return this.ParentNode=e,this.OnParentChanged(u,e),e._LogicalChildren.push(this),this.SetIsAttached(e.IsAttached),!0},e.prototype.Detach=function(){var e=this.Name;if(e&&!this.NameScope){var t=this.FindNameScope();t&&t.UnregisterName(this.Name)}this._OwnerNameScope=null,this.SetIsAttached(!1);var n=this.ParentNode;if(this.ParentNode=null,n){var r=n._LogicalChildren.indexOf(this);r>-1&&n._LogicalChildren.splice(r,1),this.OnParentChanged(n,null)}},e.prototype.OnParentChanged=function(e,t){},e.prototype.GetInheritedEnumerator=function(){return void 0},e.SetShareable=function(e){e.IsShareable=!0},e}();e.XamlNode=t}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function t(){this.TemplateOwner=null,this.App=null,this._ID=t._LastID++,this.XamlNode=this.CreateNode()}return t.prototype.CreateNode=function(){return new e.XamlNode(this)},Object.defineProperty(t.prototype,"Name",{get:function(){return this.XamlNode.Name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Parent",{get:function(){var e=this.XamlNode.ParentNode;if(e)return e.XObject},enumerable:!0,configurable:!0}),t.prototype.FindName=function(e,t){var n=this.XamlNode.FindName(e,t);return n?n.XObject:void 0},t.prototype.Clone=function(){var e=new this.constructor;return e.CloneCore(this),e},t.prototype.CloneCore=function(e){},t.prototype.IsInheritable=function(e){return!1},t._LastID=0,t}();e.XamlObject=t,e.CoreLibrary.add(t)}(Fayde||(Fayde={}));var DependencyProperty=function(){function e(){this.IsReadOnly=!1,this.IsCustom=!0,this.IsAttached=!1,this.IsInheritable=!1,this.IsImmutable=!1,this.AlwaysChange=!1,this._Coercer=null,this._Validator=null}return e.Register=function(t,n,r,o,i){var a=new e;return a.Name=t,a.GetTargetType=n,a.OwnerType=r,a.DefaultValue=o,a.ChangedCallback=i,a.Store=Fayde.Providers.PropertyStore.Instance,a.FinishRegister(),a},e.RegisterReadOnly=function(t,n,r,o,i){var a=new e;return a.Name=t,a.GetTargetType=n,a.OwnerType=r,a.DefaultValue=o,a.ChangedCallback=i,a.IsReadOnly=!0,a.Store=Fayde.Providers.PropertyStore.Instance,a.FinishRegister(),a},e.RegisterAttached=function(t,n,r,o,i){var a=new e;return a.Name=t,a.GetTargetType=n,a.OwnerType=r,a.DefaultValue=o,a.ChangedCallback=i,a.IsAttached=!0,a.Store=Fayde.Providers.PropertyStore.Instance,a.FinishRegister(),a},e.RegisterCore=function(t,n,r,o,i){var a=new e;return a.Name=t,a.GetTargetType=n,a.OwnerType=r,a.DefaultValue=o,a.ChangedCallback=i,a.IsCustom=!1,a.Store=Fayde.Providers.PropertyStore.Instance,a.FinishRegister(),a},e.RegisterReadOnlyCore=function(t,n,r,o,i){var a=new e;return a.Name=t,a.GetTargetType=n,a.OwnerType=r,a.DefaultValue=o,a.ChangedCallback=i,a.IsCustom=!1,a.IsReadOnly=!0,a.Store=Fayde.Providers.PropertyStore.Instance,a.FinishRegister(),a},e.RegisterAttachedCore=function(t,n,r,o,i){var a=new e;return a.Name=t,a.GetTargetType=n,a.OwnerType=r,a.DefaultValue=o,a.ChangedCallback=i,a.IsCustom=!1,a.IsAttached=!0,a.Store=Fayde.Providers.PropertyStore.Instance,a.FinishRegister(),a},e.RegisterImmutable=function(e,t,n){var r=new ImmutableDependencyProperty;return r.Name=e,r.GetTargetType=t,r.OwnerType=n,r.DefaultValue=void 0,r.IsImmutable=!0,r.Store=Fayde.Providers.ImmutableStore.Instance,r.FinishRegister(),r},e.RegisterInheritable=function(t,n,r,o,i){var a=new e;return a.Name=t,a.GetTargetType=n,a.OwnerType=r,a.DefaultValue=o,a.ChangedCallback=i,a.IsCustom=!0,a.IsInheritable=!0,a.Store=Fayde.Providers.InheritedStore.Instance,a.FinishRegister(),a},e.RegisterFull=function(t,n,r,o,i,a,s,u,l,c,p){var d=new e;return d.Name=t,d.GetTargetType=n,d.OwnerType=r,d.DefaultValue=o,d.ChangedCallback=i,d._Coercer=a,d.AlwaysChange=s,d._Validator=u,d.IsCustom=l!==!1,d.IsReadOnly=c===!0,d.IsAttached=p===!0,d.Store=Fayde.Providers.PropertyStore.Instance,d.FinishRegister(),d},e.prototype.FinishRegister=function(){var t=this.Name,n=this.OwnerType;if(!n||"function"!=typeof n)throw new InvalidOperationException("DependencyProperty does not have a valid OwnerType.");var r=n._RegisteredDPs;if(!r){var r={};Object.defineProperty(n,"_RegisteredDPs",{value:r,enumerable:!1,writable:!1})}if(void 0!==r[t])throw new InvalidOperationException("Dependency Property is already registered. ["+t+"]");if(r[t]=this,this._ID=e._LastID=e._LastID+1,e._IDs[this._ID]=this,!this.IsImmutable){var o=this,i=function(){return this.GetValue(o)},a=function(e){this.SetValue(o,e)};this.IsReadOnly&&(a=function(e){throw new Exception("Property ["+o.Name+"] is readonly.")}),Object.defineProperty(n.prototype,this.Name,{get:i,set:a,configurable:!0})}},e.prototype.ExtendTo=function(e){var t=e._RegisteredDPs;if(!t){var t={};Object.defineProperty(e,"_RegisteredDPs",{value:t,enumerable:!1,writable:!1})}t[this.Name]=this;var n=this,r=function(){return this.GetValue(n)},o=function(e){this.SetValue(n,e)};return Object.defineProperty(e.prototype,this.Name,{get:r,set:o,configurable:!0}),this},e.prototype.ValidateSetValue=function(e,t,n){var r=t;return this._Coercer&&(r=this._Coercer(e,this,r)),n.IsValid=!0,this._Validator&&(n.IsValid=!!this._Validator(e,this,r,t)),r},e.GetDependencyProperty=function(t,n,r){if(!t)return void 0;var o,i=t._RegisteredDPs;if(i&&(o=i[n]),o||(o=e.GetDependencyProperty(nullstone.getTypeParent(t),n,!0)),!o&&!r)throw new Exception("Cannot locate dependency property ["+t.name+"].["+n+"]");return o},e.UnsetValue={},e._IDs=[],e._LastID=0,e}();Fayde.CoreLibrary.add(DependencyProperty);var ImmutableDependencyProperty=function(e){function t(){e.apply(this,arguments),this.IsImmutable=!0}return __extends(t,e),t.prototype.Initialize=function(e){var t=Fayde.Providers.GetStorage(e,this);t.Precedence=Fayde.Providers.PropertyPrecedence.LocalValue;var n=this.GetTargetType(),r=new n;return Object.defineProperty(e,this.Name,{value:r,writable:!1}),t.Local=r},t}(DependencyProperty),Fayde;!function(e){var t;!function(t){function n(e,t){var n=e._PropertyStorage,r=n[t._ID];return r||(n[t._ID]=r=t.Store.CreateStorage(e,t)),r}!function(e){e[e.IsEnabled=0]="IsEnabled",e[e.LocalValue=1]="LocalValue",e[e.LocalStyle=2]="LocalStyle",e[e.ImplicitStyle=3]="ImplicitStyle",e[e.Inherited=4]="Inherited",e[e.InheritedDataContext=5]="InheritedDataContext",e[e.DefaultValue=6]="DefaultValue",e[e.Lowest=6]="Lowest",e[e.Highest=0]="Highest",e[e.Count=7]="Count"}(t.PropertyPrecedence||(t.PropertyPrecedence={}));var r=t.PropertyPrecedence;t.GetStorage=n;var o=function(){function t(){}return t.prototype.GetValue=function(e){var t;return void 0!==(t=e.Local)?t:void 0!==(t=e.LocalStyleValue)?t:void 0!==(t=e.ImplicitStyleValue)?t:e.Property.DefaultValue},t.prototype.GetValuePrecedence=function(e){return void 0!==e.Local?r.LocalValue:void 0!==e.LocalStyleValue?r.LocalStyle:void 0!==e.ImplicitStyleValue?r.ImplicitStyle:r.DefaultValue},t.prototype.SetLocalValue=function(e,t){if(void 0===t||t===DependencyProperty.UnsetValue)return void this.ClearValue(e);var n=e.Property;t&&n.GetTargetType()===String&&"string"!=typeof t&&(t=t.toString());var o={IsValid:!1};if(t=n.ValidateSetValue(e.OwnerNode.XObject,t,o),o.IsValid){var i=e.Precedence-r.LocalValue;if(!n.AlwaysChange&&0>i)return void(e.Local=t);var a=void 0;a=i>0?this.GetValue(e):e.Local,e.Local=t,this.OnPropertyChanged(e,r.LocalValue,a,t)}},t.prototype.SetLocalStyleValue=function(e,t){var n=e.Precedence-r.LocalStyle;if(0>n)return void(e.LocalStyleValue=t);var o=void 0;o=n>0?this.GetValue(e):e.LocalStyleValue,e.LocalStyleValue=t,this.OnPropertyChanged(e,r.LocalStyle,o,t)},t.prototype.SetImplicitStyle=function(e,t){var n=e.Precedence-r.ImplicitStyle;if(0>n)return void(e.ImplicitStyleValue=t);var o=void 0;o=n>0?this.GetValue(e):e.ImplicitStyleValue,e.ImplicitStyleValue=t,this.OnPropertyChanged(e,r.ImplicitStyle,o,t)},t.prototype.ClearValue=function(e){var t=e.Local;void 0!==t&&(e.Local=void 0,this.OnPropertyChanged(e,r.LocalValue,t,void 0))},t.prototype.OnPropertyChanged=function(t,n,r,o){var i=t.Property;if(void 0===o&&(n=this.GetValuePrecedence(t),o=this.GetValue(t)),t.Precedence=n,!i.AlwaysChange&&r===o)return void 0;if(!t.Property.IsCustom&&(r instanceof e.XamlObject&&r.XamlNode.Detach(),o instanceof e.XamlObject)){var a=new BError;o.XamlNode.AttachTo(t.OwnerNode,a)||a.ThrowException()}var s={Property:i,OldValue:r,NewValue:o},u=t.OwnerNode.XObject;i.ChangedCallback&&i.ChangedCallback(u,s);var l=t.PropListeners;if(l)for(var c=l.length,p=0;c>p;p++)l[p].OnPropertyChanged(u,s);return s},t.prototype.ListenToChanged=function(e,t,r,o){var i=n(e,t),a=i.PropListeners;a||(a=i.PropListeners=[]);var s={Detach:function(){var e=a.indexOf(s);e>-1&&a.splice(e,1)},Property:t,OnPropertyChanged:function(e,t){r.call(o,e,t)}};return a.push(s),s},t.prototype.CreateStorage=function(e,t){return{OwnerNode:e.XamlNode,Property:t,Precedence:r.DefaultValue,Animations:void 0,Local:void 0,LocalStyleValue:void 0,ImplicitStyleValue:void 0,PropListeners:void 0}},t.prototype.Clone=function(t,n){var r=this.CreateStorage(t,n.Property);r.Precedence=n.Precedence,r.Local=e.Clone(n.Local);var o=r.Animations=n.Animations;if(o)for(var i=0;i<o.length;i++)o[i].PropStorage=r;return r},t}();t.PropertyStore=o,o.Instance=new o}(t=e.Providers||(e.Providers={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.GetValue=function(e){var n=t.prototype.GetValue.call(this,e);return void 0===n&&(n=e.InheritedValue),n},n.prototype.GetValuePrecedence=function(n){var r=t.prototype.GetValuePrecedence.call(this,n);return r<e.PropertyPrecedence.InheritedDataContext?r:void 0!==n.InheritedValue?e.PropertyPrecedence.InheritedDataContext:e.PropertyPrecedence.DefaultValue},n.prototype.OnInheritedChanged=function(t,n){var r=t.InheritedValue;t.InheritedValue=n,t.Precedence>=e.PropertyPrecedence.InheritedDataContext&&r!==n&&this.OnPropertyChanged(t,e.PropertyPrecedence.InheritedDataContext,r,n)},n.prototype.CreateStorage=function(t,n){return{OwnerNode:t.XamlNode,Property:n,Precedence:e.PropertyPrecedence.DefaultValue,Animations:void 0,Local:void 0,LocalStyleValue:void 0,ImplicitStyleValue:void 0,InheritedValue:void 0,PropListeners:void 0}},n.prototype.OnPropertyChanged=function(n,r,o,i){var a=t.prototype.OnPropertyChanged.call(this,n,r,o,i);if(a){if(r>e.PropertyPrecedence.LocalValue&&this.TryUpdateDataContextExpression(n,a.NewValue))return;n.OwnerNode.OnDataContextChanged(a.OldValue,a.NewValue)}return a},n.prototype.TryUpdateDataContextExpression=function(e,t){var n=(e.InheritedValue,e.OwnerNode.XObject._Expressions),r=n[e.Property._ID];return r?(r.OnDataContextChanged(t),!0):!1},n}(e.PropertyStore);e.DataContextStore=t,t.Instance=new t}(t=e.Providers||(e.Providers={}))}(Fayde||(Fayde={}));var Fayde;!function(e){function t(e,t,o){o===!1?e.ChangedCallback=n(t):e.ChangedCallback=r(t)}function n(e){return function(t,n){e&&e(t,n.OldValue,n.NewValue)}}function r(t){return function(n,r){var o=r.OldValue,i=r.NewValue;e.UnreactTo(o,n),t&&t(n,o,i),e.ReactTo(i,n,function(){return t(n,i,i)})}}e.DPReaction=t}(Fayde||(Fayde={}));var Fayde;!function(e){function t(e,t){if(e){var n=e.$$reactions;if(n)for(var r=e.$$reaction_sources,o=0;o<n.length;o++)n[o].call(r[o],t)}}function n(e,t,n){if(e){var r=e.$$reaction_sources;r||(r=[],Object.defineProperty(e,"$$reaction_sources",{value:r,enumerable:!1})),r.push(t);var o=e.$$reactions;o||(o=[],Object.defineProperty(e,"$$reactions",{value:o,enumerable:!1})),o.push(n)}}function r(e,t){if(e){var n=e.$$reactions;if(n){var r=e.$$reaction_sources,o=r.indexOf(t);0>o||(r.splice(o,1),n.splice(o,1))}}}e.Incite=t,e.ReactTo=n,e.UnreactTo=r}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(t){function r(e){t.call(this,e)}return __extends(r,t),r.prototype.OnParentChanged=function(r,o){t.prototype.OnParentChanged.call(this,r,o);var i=n.DataContextProperty,a=e.Providers.GetStorage(this.XObject,i),s=o?o.DataContext:void 0;i.Store.OnInheritedChanged(a,s)},Object.defineProperty(r.prototype,"DataContext",{get:function(){return this.XObject.DataContext},set:function(t){var r=n.DataContextProperty,o=e.Providers.GetStorage(this.XObject,r);r.Store.OnInheritedChanged(o,t)},enumerable:!0,configurable:!0}),r.prototype.OnDataContextChanged=function(r,o){var i,a=n.DataContextProperty._ID.toString(),s=this.XObject._Expressions;for(var u in s)i=s[u],i instanceof e.Expression&&u!==a&&i.OnDataContextChanged(o);t.prototype.OnDataContextChanged.call(this,r,o)},r}(e.XamlNode);e.DONode=t;var n=function(n){function r(){n.call(this),this._Expressions=[],this._PropertyStorage=[]}return __extends(r,n),r.prototype.CreateNode=function(){return new t(this)},r.prototype.GetValue=function(t){if(!t)throw new ArgumentException("No property specified.");var n=e.Providers.GetStorage(this,t);return t.Store.GetValue(n)},r.prototype.SetValue=function(e,t){if(!e)throw new ArgumentException("No property specified.");if(e.IsReadOnly)throw new InvalidOperationException("DependencyProperty '"+e.OwnerType.name+"."+e.Name+"' is read only.");this.SetValueInternal(e,t)},r.prototype.SetValueInternal=function(t,n){var r;n instanceof e.Expression&&(r=n,r.Seal(this,t));var o=this._Expressions[t._ID],i=!1,a=!1;if(r){if(r!==o){if(r.IsAttached)throw new ArgumentException("Cannot attach the same Expression to multiple FrameworkElements");o&&this._RemoveExpression(t),this._AddExpression(t,r)}a=!0,n=r.GetValue(t)}else if(o)if(o instanceof e.Data.BindingExpressionBase){var s=o.ParentBinding;s.Mode===e.Data.BindingMode.TwoWay?i=!o.IsUpdating&&!t.IsCustom:o.IsUpdating&&s.Mode!==e.Data.BindingMode.OneTime||this._RemoveExpression(t)}else o.IsUpdating||this._RemoveExpression(t);var u=e.Providers.GetStorage(this,t);try{t.Store.SetLocalValue(u,n),i&&o._TryUpdateSourceObject(n)}catch(l){if(!a)throw l;var c="Error setting value: "+l.toString();c+=l.stack,console.warn(c),t.Store.SetLocalValue(u,t.DefaultValue),i&&o._TryUpdateSourceObject(n)}},r.prototype.SetCurrentValue=function(t,n){var r=e.Providers.GetStorage(this,t);t.Store.SetLocalValue(r,n);var o=this._Expressions[t._ID];o instanceof e.Data.BindingExpressionBase&&o._TryUpdateSourceObject(n)},r.prototype.ClearValue=function(t){if(!t)throw new ArgumentException("No dependency property.");if(t.IsReadOnly&&!t.IsCustom)throw new ArgumentException("This property is readonly.");this._RemoveExpression(t);var n=e.Providers.GetStorage(this,t),r=n.Animations;r&&r.length>0||t.Store.ClearValue(n)},r.prototype.ReadLocalValue=function(e){if(!e)throw new ArgumentException("No property specified.");var t,n=this._Expressions[e._ID];return t=n?n.GetValue(e):this.ReadLocalValueInternal(e),void 0===t?DependencyProperty.UnsetValue:t},r.prototype.ReadLocalValueInternal=function(t){var n=e.Providers.GetStorage(this,t);return n.Local},r.prototype._AddExpression=function(e,t){this._Expressions[e._ID]=t,t.OnAttached(this)},r.prototype._RemoveExpression=function(e){var t=this._Expressions[e._ID];t&&(this._Expressions[e._ID]=void 0,t.OnDetached(this))},r.prototype._HasDeferredValueExpression=function(t){var n=this._Expressions[t._ID];return n instanceof e.DeferredValueExpression},r.prototype.GetBindingExpression=function(t){var n=this._Expressions[t._ID];return n instanceof e.Data.BindingExpressionBase?n:void 0},r.prototype.HasValueOrExpression=function(t){return this._Expressions[t._ID]instanceof e.Expression?!0:void 0!==this.ReadLocalValueInternal(t)},r.prototype.SetBinding=function(t,n){if(!t)throw new ArgumentException("propd");if(!n)throw new ArgumentException("binding");var r=new e.Data.BindingExpression(n);return this.SetValueInternal(t,r),r},r.prototype.CloneCore=function(e){var t=e._PropertyStorage,n=this._PropertyStorage;n||(n=this._PropertyStorage=[]);for(var r in t){var o=t[r];n[r]=o.Property.Store.Clone(this,o)}},r.prototype.ListenToChanged=function(e,t,n){return e.Store.ListenToChanged(this,e,t,n)},r.DataContextProperty=DependencyProperty.Register("DataContext",function(){return Object},r),r}(e.XamlObject);e.DependencyObject=n,e.CoreLibrary.add(n),n.DataContextProperty.Store=e.Providers.DataContextStore.Instance}(Fayde||(Fayde={}));var Fayde;!function(e){function t(e,t,a,s,u){var l;if(s===!1)l=a===!1?n(t):o(t);else{var c=e.Name;c=c.charAt(0).toLowerCase()+c.substr(1),l="function"!=typeof s?a===!1?r(t,c):i(t,c):a===!1?r(t,c,s):i(t,c,s)}u?e.Store.ListenToChanged(u,e,l,u):e.ChangedCallback=l}function n(e){return function(t,n){e&&e(t.XamlNode.LayoutUpdater,n.OldValue,n.NewValue,t)}}function r(e,t,n){return function(r,o){var i=o.OldValue,a=o.NewValue,s=r.XamlNode.LayoutUpdater;n?n(a,s.assets[t]):s.assets[t]=a,e&&e(s,i,a,r)}}function o(t){return function(n,r){var o=r.OldValue,i=r.NewValue,a=n.XamlNode.LayoutUpdater;e.UnreactTo(o,n),t&&t(a,o,i,n),e.ReactTo(i,n,function(){return t(a,i,i,n)})}}function i(t,n,r){return function(o,i){var a=i.OldValue,s=i.NewValue,u=o.XamlNode.LayoutUpdater;e.UnreactTo(a,o),r?r(s,u.assets[n]):u.assets[n]=s,t&&t(u,a,s,o),e.ReactTo(s,o,function(){return t&&t(u,s,s,o)})}}e.UIReaction=t}(Fayde||(Fayde={}));var Fayde;!function(e){function t(e,t){e.ChangedCallback=n(nullstone.getTypeName(e.OwnerType)+"."+e.Name,t)}function n(e,t){return function(n,r){var o=r.OldValue,i=r.NewValue,a=n.XamlNode.LayoutUpdater;a.setAttachedValue(e,i),t&&t(a,o,i,n)}}e.UIReactionAttached=t}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.GetValue=function(e){var t;return void 0!==(t=e.Local)?t:void 0!==(t=e.LocalStyleValue)?t:void 0!==(t=e.ImplicitStyleValue)?t:void 0!==(t=e.InheritedValue)?t:e.Property.DefaultValue},r.prototype.GetValuePrecedence=function(e){
var r=n.prototype.GetValuePrecedence.call(this,e);return r<t.PropertyPrecedence.Inherited?r:void 0!==e.InheritedValue?t.PropertyPrecedence.Inherited:t.PropertyPrecedence.DefaultValue},r.prototype.OnPropertyChanged=function(e,r,o,i){var a=n.prototype.OnPropertyChanged.call(this,e,r,o,i);return r<=t.PropertyPrecedence.Inherited&&this.Propagate(e.OwnerNode,e.Property,i),a},r.prototype.CreateStorage=function(e,n){return{OwnerNode:e.XamlNode,Property:n,Precedence:t.PropertyPrecedence.DefaultValue,Animations:void 0,Local:void 0,LocalStyleValue:void 0,ImplicitStyleValue:void 0,InheritedValue:void 0,PropListeners:void 0}},r.PropagateInheritedOnAdd=function(t,n){for(var o,i,a,s,u=n.XObject,l=r.Instance,c=u._PropertyStorage,p=e.InheritableOwner.AllInheritedProperties,d=p.length,h=0;d>h;h++){for(i=p[h],s=t.XamlNode;s&&!s.XObject.IsInheritable(i);)s=s.ParentNode;s&&(a=s.XObject.GetValue(i),a!==i.DefaultValue&&(o=c[i._ID],o||(o=c[i._ID]=l.CreateStorage(u,i)),l.SetInheritedValue(n,i,a)||l.Propagate(n,i,a)))}},r.ClearInheritedOnRemove=function(t,n){for(var o,i=r.Instance,a=e.InheritableOwner.AllInheritedProperties,s=a.length,u=0;s>u;u++)o=a[u],i.SetInheritedValue(n,o,void 0)||i.Propagate(n,o,void 0)},r.prototype.Propagate=function(e,t,n){for(var r,o=e.GetInheritedEnumerator();o.moveNext();)r=o.current,this.SetInheritedValue(r,t,n)||this.Propagate(r,t,n)},r.prototype.SetInheritedValue=function(e,n,r){var o=e.XObject;if(!o.IsInheritable(n))return!1;var i=t.GetStorage(o,n);if(i.Precedence<t.PropertyPrecedence.Inherited)return i.InheritedValue=r,!0;var a=i.InheritedValue;return void 0===a&&(a=n.DefaultValue),i.InheritedValue=r,i.Precedence=t.PropertyPrecedence.Inherited,this.OnPropertyChanged(i,t.PropertyPrecedence.Inherited,a,r),!0},r}(t.PropertyStore);t.InheritedStore=n,n.Instance=new n}(t=e.Providers||(e.Providers={}))}(Fayde||(Fayde={}));var Fayde;!function(e){!function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(e.Orientation||(e.Orientation={}));var t=e.Orientation;e.CoreLibrary.addEnum(t,"Orientation"),function(e){e[e.Visible=0]="Visible",e[e.Collapsed=1]="Collapsed"}(e.Visibility||(e.Visibility={}));var n=e.Visibility;e.CoreLibrary.addEnum(n,"Visibility"),nullstone.registerEnumConverter(n,function(e){return"true"===e||e===!0||e===n.Visible||"Visible"===e?n.Visible:n.Collapsed}),function(e){e[e.Default=0]="Default",e[e.Hand=1]="Hand",e[e.IBeam=2]="IBeam",e[e.Wait=3]="Wait",e[e.SizeNESW=4]="SizeNESW",e[e.SizeNWSE=5]="SizeNWSE",e[e.SizeNS=6]="SizeNS",e[e.SizeWE=7]="SizeWE"}(e.CursorType||(e.CursorType={}));var r=e.CursorType;e.CoreLibrary.addEnum(r,"CursorType"),e.CursorTypeMappings={Default:"",Hand:"pointer",IBeam:"text",Wait:"wait",SizeNESW:"ne-resize",SizeNWSE:"nw-resize",SizeNS:"n-resize",SizeWE:"w-resize"},function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(e.HorizontalAlignment||(e.HorizontalAlignment={}));var o=e.HorizontalAlignment;e.CoreLibrary.addEnum(o,"HorizontalAlignment"),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Stretch=3]="Stretch"}(e.VerticalAlignment||(e.VerticalAlignment={}));var i=e.VerticalAlignment;e.CoreLibrary.addEnum(i,"VerticalAlignment"),function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(e.FlowDirection||(e.FlowDirection={}));var a=e.FlowDirection;e.CoreLibrary.addEnum(a,"FlowDirection"),function(e){e[e.Thin=100]="Thin",e[e.ExtraLight=200]="ExtraLight",e[e.Light=300]="Light",e[e.Normal=400]="Normal",e[e.Medium=500]="Medium",e[e.SemiBold=600]="SemiBold",e[e.Bold=700]="Bold",e[e.ExtraBold=800]="ExtraBold",e[e.Black=900]="Black",e[e.ExtraBlack=950]="ExtraBlack"}(e.FontWeight||(e.FontWeight={}));var s=e.FontWeight;e.CoreLibrary.addEnum(s,"FontWeight"),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Justify=3]="Justify"}(e.TextAlignment||(e.TextAlignment={}));var u=e.TextAlignment;e.CoreLibrary.addEnum(u,"TextAlignment"),function(e){e[e.None=0]="None",e[e.Underline=1]="Underline"}(e.TextDecorations||(e.TextDecorations={}));var l=e.TextDecorations;e.CoreLibrary.addEnum(l,"TextDecorations"),function(e){e[e.MaxHeight=0]="MaxHeight",e[e.BlockLineHeight=1]="BlockLineHeight"}(e.LineStackingStrategy||(e.LineStackingStrategy={}));var c=e.LineStackingStrategy;e.CoreLibrary.addEnum(c,"LineStackingStrategy")}(Fayde||(Fayde={}));var Fayde;!function(e){e.FontStyle=minerva.FontStyle,e.FontStretch=minerva.FontStretch,e.CoreLibrary.addEnum(e.FontStretch,"FontStretch"),e.Font=minerva.Font,e.CoreLibrary.add(minerva.Font)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function t(){}return t.UseLayoutRoundingProperty=DependencyProperty.RegisterInheritable("UseLayoutRounding",function(){return Boolean},t,!0),t.FlowDirectionProperty=DependencyProperty.RegisterInheritable("FlowDirection",function(){return new e.Enum(minerva.FlowDirection)},t,minerva.FlowDirection.LeftToRight),t.ForegroundProperty=DependencyProperty.RegisterInheritable("Foreground",function(){return e.Media.Brush},t),t.FontFamilyProperty=DependencyProperty.RegisterInheritable("FontFamily",function(){return String},t,e.Font.DEFAULT_FAMILY),t.FontSizeProperty=DependencyProperty.RegisterInheritable("FontSize",function(){return Number},t,e.Font.DEFAULT_SIZE),t.FontStretchProperty=DependencyProperty.RegisterInheritable("FontStretch",function(){return String},t,e.Font.DEFAULT_STRETCH),t.FontStyleProperty=DependencyProperty.RegisterInheritable("FontStyle",function(){return String},t,e.Font.DEFAULT_STYLE),t.FontWeightProperty=DependencyProperty.RegisterInheritable("FontWeight",function(){return new e.Enum(e.FontWeight)},t,e.Font.DEFAULT_WEIGHT),t.TextDecorationsProperty=DependencyProperty.RegisterInheritable("TextDecorations",function(){return new e.Enum(e.TextDecorations)},t,e.TextDecorations.None),t.LanguageProperty=DependencyProperty.RegisterInheritable("Language",function(){return String},t),t}();e.InheritableOwner=t,t.AllInheritedProperties=[t.ForegroundProperty,t.FontFamilyProperty,t.FontStretchProperty,t.FontStyleProperty,t.FontWeightProperty,t.FontSizeProperty,t.LanguageProperty,t.FlowDirectionProperty,t.UseLayoutRoundingProperty,t.TextDecorationsProperty],e.CoreLibrary.add(t);var n;!function(n){e.UIReaction(t.UseLayoutRoundingProperty,minerva.core.reactTo.useLayoutRounding,!1),e.UIReaction(t.FlowDirectionProperty,minerva.core.reactTo.flowDirection,!1)}(n||(n={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(t){function n(e){t.call(this,e),this.IsMouseOver=!1,this.IsLoaded=!1;var n=this.LayoutUpdater=e.CreateLayoutUpdater();n.setAttachedValue("$node",this),n.setAttachedValue("$id",this.XObject._ID)}return __extends(n,t),n.prototype.GetVisualRoot=function(){for(var e,t=this;e=t.VisualParentNode;)t=e;return t},n.prototype.SetIsLoaded=function(e){},n.prototype.OnVisualChildAttached=function(t){var n=t.XamlNode;e.Providers.InheritedStore.PropagateInheritedOnAdd(this.XObject,n),n.SetVisualParentNode(this)},n.prototype.OnVisualChildDetached=function(t){var n=t.XamlNode;n.SetVisualParentNode(null),e.Providers.InheritedStore.ClearInheritedOnRemove(this.XObject,n)},n.prototype.SetVisualParentNode=function(e){this.VisualParentNode!==e&&(this.VisualParentNode=e,this.LayoutUpdater.setVisualParent(e?e.LayoutUpdater:null))},n.prototype.Focus=function(e){return!1},n.prototype._EmitFocusChange=function(e){"got"===e?this._EmitGotFocus():"lost"===e&&this._EmitLostFocus()},n.prototype._EmitLostFocus=function(){var t=new e.RoutedEventArgs,n=this.XObject;n.OnLostFocus(t),n.LostFocus.raise(n,t)},n.prototype._EmitGotFocus=function(){var t=new e.RoutedEventArgs,n=this.XObject;n.OnGotFocus(t),n.GotFocus.raise(n,t)},n.prototype._EmitKeyDown=function(e){var t=this.XObject;t.OnKeyDown(e),t.KeyDown.raise(t,e)},n.prototype._EmitKeyUp=function(e){var t=this.XObject;t.OnKeyUp(e),t.KeyUp.raise(t,e)},n.prototype._EmitLostMouseCapture=function(t){var n=this.XObject,r=new e.Input.MouseEventArgs(t);n.OnLostMouseCapture(r),n.LostMouseCapture.raise(n,r)},n.prototype._EmitMouseEvent=function(t,n,r,o){var i=this.XObject;switch(t){case e.Input.MouseInputType.MouseUp:n?(i.OnMouseLeftButtonUp(o),i.MouseLeftButtonUp.raise(i,o)):r&&(i.OnMouseRightButtonUp(o),i.MouseRightButtonUp.raise(i,o));break;case e.Input.MouseInputType.MouseDown:n?(i.OnMouseLeftButtonDown(o),i.MouseLeftButtonDown.raise(i,o)):r&&(i.OnMouseRightButtonDown(o),i.MouseRightButtonDown.raise(i,o));break;case e.Input.MouseInputType.MouseLeave:this.IsMouseOver=!1,i.OnMouseLeave(o),i.MouseLeave.raise(i,o);break;case e.Input.MouseInputType.MouseEnter:this.IsMouseOver=!0,i.OnMouseEnter(o),i.MouseEnter.raise(i,o);break;case e.Input.MouseInputType.MouseMove:i.OnMouseMove(o),i.MouseMove.raise(i,o);break;case e.Input.MouseInputType.MouseWheel:i.OnMouseWheel(o),i.MouseWheel.raise(i,o);break;default:return!1}return o.Handled},n.prototype._EmitTouchEvent=function(t,n){var r=this.XObject;switch(t){case e.Input.TouchInputType.TouchDown:r.OnTouchDown(n),r.TouchDown.raise(r,n);break;case e.Input.TouchInputType.TouchUp:r.OnTouchUp(n),r.TouchUp.raise(r,n);break;case e.Input.TouchInputType.TouchMove:r.OnTouchMove(n),r.TouchMove.raise(r,n);break;case e.Input.TouchInputType.TouchEnter:r.OnTouchEnter(n),r.TouchEnter.raise(r,n);break;case e.Input.TouchInputType.TouchLeave:r.OnTouchLeave(n),r.TouchLeave.raise(r,n);break;default:return!1}return n.Handled},n.prototype._EmitGotTouchCapture=function(e){var t=this.XObject;t.OnGotTouchCapture(e),t.GotTouchCapture.raise(this,e)},n.prototype._EmitLostTouchCapture=function(e){var t=this.XObject;t.OnLostTouchCapture(e),t.LostTouchCapture.raise(this,e)},n.prototype.CanCaptureMouse=function(){return!0},n.prototype.CaptureMouse=function(){return this.IsAttached?(e.Surface.SetMouseCapture(this),!0):!1},n.prototype.ReleaseMouseCapture=function(){this.IsAttached&&e.Surface.ReleaseMouseCapture(this)},n.prototype.IsAncestorOf=function(e){for(var t=e;t&&t!==this;)t=t.VisualParentNode;return t===this},n.prototype.TransformToVisual=function(t){var n=minerva.core.Updater.transformToVisual(this.LayoutUpdater,t?t.LayoutUpdater:null);if(!n)throw new ArgumentException("UIElement not attached.");var r=new e.Media.MatrixTransform;return r.SetCurrentValue(e.Media.MatrixTransform.MatrixProperty,new e.Media.Matrix(n)),r},n}(e.DONode);e.UINode=t;var n=function(n){function r(){n.apply(this,arguments),this.LostFocus=new e.RoutedEvent,this.GotFocus=new e.RoutedEvent,this.LostMouseCapture=new e.RoutedEvent,this.KeyDown=new e.RoutedEvent,this.KeyUp=new e.RoutedEvent,this.MouseLeftButtonUp=new e.RoutedEvent,this.MouseRightButtonUp=new e.RoutedEvent,this.MouseLeftButtonDown=new e.RoutedEvent,this.MouseRightButtonDown=new e.RoutedEvent,this.MouseLeave=new e.RoutedEvent,this.MouseEnter=new e.RoutedEvent,this.MouseMove=new e.RoutedEvent,this.MouseWheel=new e.RoutedEvent,this.TouchDown=new e.RoutedEvent,this.TouchUp=new e.RoutedEvent,this.TouchEnter=new e.RoutedEvent,this.TouchLeave=new e.RoutedEvent,this.TouchMove=new e.RoutedEvent,this.GotTouchCapture=new e.RoutedEvent,this.LostTouchCapture=new e.RoutedEvent}return __extends(r,n),r.prototype.CreateNode=function(){return new t(this)},r.prototype.CreateLayoutUpdater=function(){return new minerva.core.Updater},Object.defineProperty(r.prototype,"IsItemsControl",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"VisualParent",{get:function(){var e=this.XamlNode.VisualParentNode;return e?e.XObject:void 0},enumerable:!0,configurable:!0}),r.prototype.IsInheritable=function(e){return e===r.UseLayoutRoundingProperty},Object.defineProperty(r.prototype,"IsMouseOver",{get:function(){return this.XamlNode.IsMouseOver},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"DesiredSize",{get:function(){var e=this.XamlNode.LayoutUpdater.assets.desiredSize;return new minerva.Size(e.width,e.height)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"RenderSize",{get:function(){var e=this.XamlNode.LayoutUpdater.assets.renderSize;return new minerva.Size(e.width,e.height)},enumerable:!0,configurable:!0}),r.prototype.Focus=function(){return this.XamlNode.Focus()},r.prototype.CaptureMouse=function(){return this.XamlNode.CaptureMouse()},r.prototype.ReleaseMouseCapture=function(){this.XamlNode.ReleaseMouseCapture()},r.prototype.IsAncestorOf=function(e){return e?this.XamlNode.IsAncestorOf(e.XamlNode):!1},r.prototype.TransformToVisual=function(e){var t=e?e.XamlNode:null;return this.XamlNode.TransformToVisual(t)},r.prototype.InvalidateMeasure=function(){this.XamlNode.LayoutUpdater.invalidateMeasure()},r.prototype.Measure=function(e){this.XamlNode.LayoutUpdater.measure(e)},r.prototype.InvalidateArrange=function(){this.XamlNode.LayoutUpdater.invalidateArrange()},r.prototype.Arrange=function(e){this.XamlNode.LayoutUpdater.arrange(e)},r.prototype.OnGotFocus=function(e){},r.prototype.OnLostFocus=function(e){},r.prototype.OnLostMouseCapture=function(e){},r.prototype.OnKeyDown=function(e){},r.prototype.OnKeyUp=function(e){},r.prototype.OnMouseEnter=function(e){},r.prototype.OnMouseLeave=function(e){},r.prototype.OnMouseLeftButtonDown=function(e){},r.prototype.OnMouseLeftButtonUp=function(e){},r.prototype.OnMouseMove=function(e){},r.prototype.OnMouseRightButtonDown=function(e){},r.prototype.OnMouseRightButtonUp=function(e){},r.prototype.OnMouseWheel=function(e){},r.prototype.OnTouchDown=function(e){},r.prototype.OnTouchUp=function(e){},r.prototype.OnTouchEnter=function(e){},r.prototype.OnTouchLeave=function(e){},r.prototype.OnTouchMove=function(e){},r.prototype.OnGotTouchCapture=function(e){},r.prototype.OnLostTouchCapture=function(e){},r.prototype._TriggersChanged=function(t){var n=t.OldValue,r=t.NewValue;n instanceof e.TriggerCollection&&n.DetachTarget(this),r instanceof e.TriggerCollection&&r.AttachTarget(this)},r.ClipProperty=DependencyProperty.RegisterCore("Clip",function(){return e.Media.Geometry},r),r.EffectProperty=DependencyProperty.Register("Effect",function(){return e.Media.Effects.Effect},r),r.IsHitTestVisibleProperty=DependencyProperty.RegisterCore("IsHitTestVisible",function(){return Boolean},r,!0),r.OpacityMaskProperty=DependencyProperty.RegisterCore("OpacityMask",function(){return e.Media.Brush},r),r.OpacityProperty=DependencyProperty.RegisterCore("Opacity",function(){return Number},r,1),r.RenderTransformProperty=DependencyProperty.RegisterCore("RenderTransform",function(){return e.Media.Transform},r),r.RenderTransformOriginProperty=DependencyProperty.Register("RenderTransformOrigin",function(){return Point},r),r.TagProperty=DependencyProperty.Register("Tag",function(){return Object},r),r.TriggersProperty=DependencyProperty.RegisterCore("Triggers",function(){return e.TriggerCollection},r,void 0,function(e,t){return e._TriggersChanged(t)}),r.UseLayoutRoundingProperty=e.InheritableOwner.UseLayoutRoundingProperty.ExtendTo(r),r.VisibilityProperty=DependencyProperty.RegisterCore("Visibility",function(){return new e.Enum(e.Visibility)},r,e.Visibility.Visible),r}(e.DependencyObject);e.UIElement=n,e.CoreLibrary.add(n);var r;!function(t){e.UIReaction(n.ClipProperty,minerva.core.reactTo.clip),e.UIReaction(n.EffectProperty,minerva.core.reactTo.effect),e.UIReaction(n.IsHitTestVisibleProperty,minerva.core.reactTo.isHitTestVisible,!1),e.UIReaction(n.OpacityProperty,minerva.core.reactTo.opacity,!1),e.UIReaction(n.RenderTransformProperty,minerva.core.reactTo.renderTransform),e.UIReaction(n.RenderTransformOriginProperty,minerva.core.reactTo.renderTransformOrigin,!1,minerva.Point.copyTo),e.UIReaction(n.VisibilityProperty,function(t,n,r,o){minerva.core.reactTo.visibility(t,n,r),e.Surface.RemoveFocusFrom(o)},!1)}(r||(r={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.GetValue=function(t){if(void 0!==t.Local)return t.Local;var n=t.Local=new e.ResourceDictionary;return n.AttachTo(t.OwnerNode.XObject),n},r.prototype.GetValuePrecedence=function(e){return t.PropertyPrecedence.LocalValue},r.prototype.SetLocalValue=function(e,t){console.warn("Cannot set Resources.")},r.prototype.SetLocalStyleValue=function(e,t){},r.prototype.SetImplicitStyle=function(e,t){},r.prototype.ClearValue=function(e,t){},r}(t.PropertyStore);t.ResourcesStore=n,n.Instance=new n}(t=e.Providers||(e.Providers={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.GetValue=function(e){return void 0!==e.Local?e.Local:0},n.prototype.GetValuePrecedence=function(t){return e.PropertyPrecedence.LocalValue},n.prototype.SetLocalValue=function(t,n){var r=t.Local;t.Local=n,r!==n&&this.OnPropertyChanged(t,e.PropertyPrecedence.LocalValue,r,n)},n.prototype.SetLocalStyleValue=function(e,t){},n.prototype.SetImplicitStyle=function(e,t){},n.prototype.ClearValue=function(e,t){},n}(e.PropertyStore);e.ActualSizeStore=t,t.Instance=new t}(t=e.Providers||(e.Providers={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(t){function r(r){var o=this;t.call(this,r);var i=this.LayoutUpdater;i.tree.setTemplateApplier(function(){var e=new BError,t=o.ApplyTemplateWithError(e);return e.Message&&e.ThrowException(),t}),i.setSizeUpdater({setActualWidth:function(e){r.SetCurrentValue(n.ActualWidthProperty,e)},setActualHeight:function(e){r.SetCurrentValue(n.ActualHeightProperty,e)},onSizeChanged:function(t,n){r.SizeChanged.raise(r,new e.SizeChangedEventArgs(t,n))}})}return __extends(r,t),r.prototype.SetSubtreeNode=function(e,t){return this.SubtreeNode&&(this.SubtreeNode.Detach(),this.SubtreeNode=null),e&&!e.AttachTo(this,t)?!1:(this.SubtreeNode=e,!0)},r.prototype.GetInheritedEnumerator=function(){return this.GetVisualTreeEnumerator()},r.prototype.GetVisualTreeEnumerator=function(){var e=this.LayoutUpdater.tree.walk();return{current:void 0,moveNext:function(){return e.step()?(this.current=e.current.getAttachedValue("$node"),!0):!1}}},r.prototype.SetIsLoaded=function(e){this.IsLoaded!==e&&(this.IsLoaded=e,this.OnIsLoadedChanged(e))},r.prototype.OnIsLoadedChanged=function(t){var n=this.XObject;n.Resources;t?e.Providers.ImplicitStyleBroker.Set(n,e.Providers.StyleMask.All):(e.Providers.ImplicitStyleBroker.Clear(n,e.Providers.StyleMask.VisualTree),n.Unloaded.raise(n,new e.RoutedEventArgs));for(var r=this.GetVisualTreeEnumerator();r.moveNext();)r.current.SetIsLoaded(t);t&&(n.Loaded.raise(n,new e.RoutedEventArgs),this.InvokeLoaded())},r.prototype.InvokeLoaded=function(){},r.prototype.AttachVisualChild=function(e,t){return this.OnVisualChildAttached(e),this.SetSubtreeNode(e.XamlNode,t)?(e.XamlNode.SetIsLoaded(this.IsLoaded),!0):!1},r.prototype.DetachVisualChild=function(e,t){return this.SetSubtreeNode(null,t)?(this.OnVisualChildDetached(e),e.XamlNode.SetIsLoaded(!1),!0):!1},r.prototype.ApplyTemplateWithError=function(e){if(this.SubtreeNode)return!1;var t=this.DoApplyTemplateWithError(e),n=this.XObject;return t&&n.OnApplyTemplate(),n.TemplateApplied.raise(n,null),t},r.prototype.DoApplyTemplateWithError=function(e){return!1},r.prototype.FinishApplyTemplateWithError=function(e,t){return!e||t.Message?!1:(this.AttachVisualChild(e,t),null==t.Message)},r.prototype.UpdateLayout=function(){console.warn("FENode.UpdateLayout not implemented")},r.DetachFromVisualParent=function(e){var t=e.XamlNode.VisualParentNode;if(t instanceof r){var n=new BError;t.DetachVisualChild(e,n),n.Message&&n.ThrowException()}},r}(e.UINode);e.FENode=t;var n=function(n){function r(){n.apply(this,arguments),this.SizeChanged=new e.RoutedEvent,this.Loaded=new e.RoutedEvent,this.Unloaded=new e.RoutedEvent,this.LayoutUpdated=new nullstone.Event,this.TemplateApplied=new nullstone.Event,this.BindingValidationError=new nullstone.Event}return __extends(r,n),r.prototype.CreateNode=function(){return new t(this)},r.prototype.IsInheritable=function(e){return e===r.FlowDirectionProperty?!0:e===r.LanguageProperty?!0:n.prototype.IsInheritable.call(this,e)},r.prototype.OnApplyTemplate=function(){},r.prototype.OnBindingValidationError=function(e){this.BindingValidationError.raise(this,e)},r.prototype.UpdateLayout=function(){this.XamlNode.UpdateLayout()},r.ActualHeightProperty=DependencyProperty.RegisterReadOnly("ActualHeight",function(){return Number},r),r.ActualWidthProperty=DependencyProperty.RegisterReadOnly("ActualWidth",function(){return Number},r),r.CursorProperty=DependencyProperty.Register("Cursor",function(){return new e.Enum(e.CursorType)},r,e.CursorType.Default),r.FlowDirectionProperty=e.InheritableOwner.FlowDirectionProperty.ExtendTo(r),r.HeightProperty=DependencyProperty.Register("Height",function(){return Length},r,NaN),r.HorizontalAlignmentProperty=DependencyProperty.Register("HorizontalAlignment",function(){return new e.Enum(e.HorizontalAlignment)},r,e.HorizontalAlignment.Stretch),r.LanguageProperty=e.InheritableOwner.LanguageProperty.ExtendTo(r),r.MarginProperty=DependencyProperty.RegisterCore("Margin",function(){return Thickness},r),r.MaxHeightProperty=DependencyProperty.Register("MaxHeight",function(){return Number},r,Number.POSITIVE_INFINITY),r.MaxWidthProperty=DependencyProperty.Register("MaxWidth",function(){return Number},r,Number.POSITIVE_INFINITY),r.MinHeightProperty=DependencyProperty.Register("MinHeight",function(){return Number},r,0),r.MinWidthProperty=DependencyProperty.Register("MinWidth",function(){return Number},r,0),r.StyleProperty=DependencyProperty.Register("Style",function(){return e.Style},r,void 0,function(t,n){return e.Providers.LocalStyleBroker.Set(t,n.NewValue)}),r.VerticalAlignmentProperty=DependencyProperty.Register("VerticalAlignment",function(){return new e.Enum(e.VerticalAlignment)},r,e.VerticalAlignment.Stretch),r.WidthProperty=DependencyProperty.Register("Width",function(){return Length},r,NaN),r.ResourcesProperty=DependencyProperty.Register("Resources",function(){return e.ResourceDictionary},r),r.DefaultStyleKeyProperty=DependencyProperty.Register("DefaultStyleKey",function(){return Function},r),r}(e.UIElement);e.FrameworkElement=n,e.CoreLibrary.add(n),n.ActualWidthProperty.Store=e.Providers.ActualSizeStore.Instance,n.ActualHeightProperty.Store=e.Providers.ActualSizeStore.Instance,n.ResourcesProperty.Store=e.Providers.ResourcesStore.Instance;var r;!function(t){e.UIReaction(n.WidthProperty,minerva.core.reactTo.width,!1),e.UIReaction(n.HeightProperty,minerva.core.reactTo.height,!1),e.UIReaction(n.MaxWidthProperty,minerva.core.reactTo.maxWidth,!1),e.UIReaction(n.MaxHeightProperty,minerva.core.reactTo.maxHeight,!1),e.UIReaction(n.MinWidthProperty,minerva.core.reactTo.minWidth,!1),e.UIReaction(n.MinHeightProperty,minerva.core.reactTo.minHeight,!1),e.UIReaction(n.MarginProperty,minerva.core.reactTo.margin,!1,minerva.Thickness.copyTo),e.UIReaction(n.HorizontalAlignmentProperty,minerva.core.reactTo.horizontalAlignment,!1),e.UIReaction(n.VerticalAlignmentProperty,minerva.core.reactTo.verticalAlignment,!1)}(r||(r={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){e.Content=function(){function e(e,t){nullstone.Annotation(e,"Content",t,!0)}return e.Get=function(e){for(var t=e;t;){var n=nullstone.GetAnnotations(t,"Content");if(n){var r=n[0];if(r)return r}t=nullstone.getTypeParent(t)}return void 0},e}(),e.TextContent=function(){function e(e,t){nullstone.Annotation(e,"TextContent",t,!0)}return e.Get=function(e){for(var t=e;t;){var n=nullstone.GetAnnotations(t,"TextContent");if(n){var r=n[0];if(r)return r}t=nullstone.getTypeParent(t)}return void 0},e}()}(t=e.Markup||(e.Markup={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.call(this),this.DefaultStyleKey=n}return __extends(n,t),n.prototype.CreateLayoutUpdater=function(){return new minerva.controls.border.BorderUpdater},n.BackgroundProperty=DependencyProperty.RegisterCore("Background",function(){return e.Media.Brush},n),n.BorderBrushProperty=DependencyProperty.RegisterCore("BorderBrush",function(){return e.Media.Brush},n),n.BorderThicknessProperty=DependencyProperty.Register("BorderThickness",function(){return Thickness},n),n.ChildProperty=DependencyProperty.Register("Child",function(){return e.UIElement},n),n.CornerRadiusProperty=DependencyProperty.Register("CornerRadius",function(){return CornerRadius},n),n.PaddingProperty=DependencyProperty.Register("Padding",function(){return Thickness},n),n}(e.FrameworkElement);t.Border=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.ChildProperty),e.UIReaction(n.BackgroundProperty,function(e,t,n){e.invalidate()}),e.UIReaction(n.BorderBrushProperty,function(e,t,n){e.invalidate()}),e.UIReaction(n.BorderThicknessProperty,function(e,t,n){return e.invalidateMeasure()},!1,minerva.Thickness.copyTo),e.UIReaction(n.PaddingProperty,function(e,t,n){return e.invalidateMeasure()},!1,minerva.Thickness.copyTo),e.UIReaction(n.CornerRadiusProperty,function(e,t,n){return e.invalidate()},!1,minerva.CornerRadius.copyTo),e.UIReaction(n.ChildProperty,function(t,n,r,o){var i=o.XamlNode,a=new BError;n instanceof e.UIElement&&i.DetachVisualChild(n,a),r instanceof e.UIElement&&i.AttachVisualChild(r,a),a.Message&&a.ThrowException(),t.updateBounds(),t.invalidateMeasure()},!1,!1)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.GetValue=function(e){return e.InheritedValue===!1?!1:n.prototype.GetValue.call(this,e)},r.prototype.GetValuePrecedence=function(e){return e.InheritedValue===!1?t.PropertyPrecedence.IsEnabled:n.prototype.GetValuePrecedence.call(this,e)},r.prototype.SetLocalValue=function(e,n){var r=e.Local;e.Local=n,r!==n&&e.InheritedValue!==!1&&this.OnPropertyChanged(e,t.PropertyPrecedence.LocalValue,r,n)},r.prototype.OnPropertyChanged=function(e,t,r,o){var i=n.prototype.OnPropertyChanged.call(this,e,t,r,o);return e.OwnerNode.OnIsEnabledChanged(r,o),i},r.prototype.CreateStorage=function(e,n){return{OwnerNode:e.XamlNode,Property:n,Precedence:t.PropertyPrecedence.DefaultValue,InheritedValue:!0,Animations:void 0,Local:void 0,LocalStyleValue:void 0,ImplicitStyleValue:void 0,PropListeners:void 0}},r.prototype.EmitInheritedChanged=function(e,r){var o=e.InheritedValue;r!==!1?(e.Precedence=n.prototype.GetValuePrecedence.call(this,e),e.InheritedValue=!0):e.InheritedValue=!1,o!==r&&this.OnPropertyChanged(e,t.PropertyPrecedence.IsEnabled,o,r)},r.EmitInheritedChanged=function(n,r){var o=e.Controls.Control.IsEnabledProperty,i=t.GetStorage(n.XObject,o);o.Store.EmitInheritedChanged(i,r)},r}(t.PropertyStore);t.IsEnabledStore=n,n.Instance=new n}(t=e.Providers||(e.Providers={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){!function(e){e[e.Continue=0]="Continue",e[e.Once=1]="Once",e[e.Cycle=2]="Cycle",e[e.None=3]="None",e[e.Contained=4]="Contained",e[e.Local=5]="Local"}(t.KeyboardNavigationMode||(t.KeyboardNavigationMode={}));var n=t.KeyboardNavigationMode;e.CoreLibrary.addEnum(n,"KeyboardNavigationMode"),function(e){e[e.None=0]="None",e[e.Alt=1]="Alt",e[e.Control=2]="Control",e[e.Shift=4]="Shift",e[e.Windows=8]="Windows",e[e.Apple=16]="Apple"}(t.ModifierKeys||(t.ModifierKeys={}));var r=t.ModifierKeys,o=function(){function e(){}return e.RefreshModifiers=function(t){t.Shift?e.Modifiers|=r.Shift:e.Modifiers&=~r.Shift,t.Ctrl?e.Modifiers|=r.Control:e.Modifiers&=~r.Control,t.Alt?e.Modifiers|=r.Alt:e.Modifiers&=~r.Alt},e.HasControl=function(){return(e.Modifiers&r.Control)===r.Control},e.HasAlt=function(){return(e.Modifiers&r.Alt)===r.Alt},e.HasShift=function(){return(e.Modifiers&r.Shift)===r.Shift},e.Modifiers=r.None,e}();t.Keyboard=o,e.CoreLibrary.add(o)}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(e){t.call(this,e),this.IsFocused=!1}return __extends(n,t),n.prototype.TabTo=function(){var e=this.XObject;return e.IsEnabled&&e.IsTabStop&&this.Focus()},n.prototype.ApplyTemplateWithError=function(e){return t.prototype.ApplyTemplateWithError.call(this,e)?(this.XObject.UpdateValidationState(),!0):!1},n.prototype.DoApplyTemplateWithError=function(e){var t,n=this.XObject,r=n.Template;return r&&(t=r.GetVisualTree(n)),t||(t=this.GetDefaultVisualTree())?(this.TemplateRoot&&this.TemplateRoot!==t&&this.DetachVisualChild(this.TemplateRoot,e),this.TemplateRoot=t,this.TemplateRoot&&this.AttachVisualChild(this.TemplateRoot,e),e.Message?!1:!0):!1},n.prototype.GetDefaultVisualTree=function(){return void 0},n.prototype.OnIsAttachedChanged=function(n){t.prototype.OnIsAttachedChanged.call(this,n),n?e.Media.VSM.VisualStateManager.Activate(this.XObject,this.TemplateRoot):e.Media.VSM.VisualStateManager.Deactivate(this.XObject,this.TemplateRoot)},n.prototype.OnParentChanged=function(e,n){t.prototype.OnParentChanged.call(this,e,n),this.IsEnabled=n?n.IsEnabled:!0},n.prototype.OnTemplateChanged=function(e,t){var n=this.SubtreeNode;if(n){var r=new BError;this.DetachVisualChild(n.XObject,r)||r.ThrowException()}this.LayoutUpdater.invalidateMeasure()},Object.defineProperty(n.prototype,"IsEnabled",{get:function(){return this.XObject.IsEnabled},set:function(t){e.Providers.IsEnabledStore.EmitInheritedChanged(this,t),this.OnIsEnabledChanged(void 0,t)},enumerable:!0,configurable:!0}),n.prototype.OnIsEnabledChanged=function(n,r){r||(this.IsMouseOver=!1,e.Surface.RemoveFocusFrom(this.XObject)&&e.TabNavigationWalker.Focus(this,!0),this.ReleaseMouseCapture()),t.prototype.OnIsEnabledChanged.call(this,n,r)},n.prototype.Focus=function(t){return e.Surface.Focus(this.XObject,t)},n.prototype.CanCaptureMouse=function(){return this.XObject.IsEnabled},n}(e.FENode);t.ControlNode=n;var r=function(r){function i(){r.call(this),this.IsEnabledChanged=new nullstone.Event,e.UIReaction(i.IsEnabledProperty,function(e,t,n,r){var o={Property:i.IsEnabledProperty,OldValue:n,NewValue:t};r.OnIsEnabledChanged(o),t!==!0&&(r.XamlNode.IsMouseOver=!1),r.UpdateVisualState(),r.IsEnabledChanged.raiseAsync(r,o)},!1,!0,this),e.UIReaction(i.PaddingProperty,function(e,t,n){return e.invalidateMeasure()},!1,!0,this),e.UIReaction(i.BorderThicknessProperty,function(e,t,n){return e.invalidateMeasure()},!1,!0,this),e.UIReaction(i.HorizontalContentAlignmentProperty,function(e,t,n){return e.invalidateArrange()},!1,!0,this),e.UIReaction(i.VerticalContentAlignmentProperty,function(e,t,n){return e.invalidateArrange()},!1,!0,this)}return __extends(i,r),i.prototype.CreateNode=function(){return new n(this)},i.prototype.CreateLayoutUpdater=function(){return new minerva.controls.control.ControlUpdater},i.prototype.IsInheritable=function(e){return o.indexOf(e)>-1?!0:r.prototype.IsInheritable.call(this,e)},Object.defineProperty(i.prototype,"IsFocused",{get:function(){return this.XamlNode.IsFocused},enumerable:!0,configurable:!0}),i.prototype.GetTemplateChild=function(e,t){var n=this.XamlNode.TemplateRoot;if(n){var r=n.XamlNode.FindName(e);if(r){var o=r.XObject;return!t||o instanceof t?o:void 0}}},i.prototype.ApplyTemplate=function(){var e=new BError,t=this.XamlNode.ApplyTemplateWithError(e);return e.Message&&e.ThrowException(),t},i.prototype.GetDefaultStyle=function(){return void 0},i.prototype.OnIsEnabledChanged=function(e){},i.prototype.OnGotFocus=function(e){this.XamlNode.IsFocused=!0,this.UpdateValidationState()},i.prototype.OnLostFocus=function(e){this.XamlNode.IsFocused=!1,this.UpdateValidationState()},i.prototype.UpdateVisualState=function(t){var n=this;t=t!==!1;var r=function(r){return e.Media.VSM.VisualStateManager.GoToState(n,r,t)};this.GoToStates(r)},i.prototype.GoToStates=function(e){this.GoToStateCommon(e),this.GoToStateFocus(e),this.GoToStateSelection(e)},i.prototype.GoToStateCommon=function(e){return e(this.IsEnabled?this.IsMouseOver?"MouseOver":"Normal":"Disabled")},i.prototype.GoToStateFocus=function(e){return e(this.IsFocused&&this.IsEnabled?"Focused":"Unfocused")},i.prototype.GoToStateSelection=function(e){return!1},i.prototype.UpdateValidationState=function(t){var n=this;if(void 0===t){var r=e.Validation.GetErrors(this);t=r.Count<1}var o=function(t){return e.Media.VSM.VisualStateManager.GoToState(n,t,!0);
};this.GoToStateValidation(t,o)},i.prototype.GoToStateValidation=function(e,t){return t(e?"Valid":this.IsFocused?"InvalidFocused":"InvalidUnfocused")},i.BackgroundProperty=DependencyProperty.RegisterCore("Background",function(){return e.Media.Brush},i),i.BorderBrushProperty=DependencyProperty.RegisterCore("BorderBrush",function(){return e.Media.Brush},i),i.BorderThicknessProperty=DependencyProperty.RegisterCore("BorderThickness",function(){return Thickness},i),i.FontFamilyProperty=e.InheritableOwner.FontFamilyProperty.ExtendTo(i),i.FontSizeProperty=e.InheritableOwner.FontSizeProperty.ExtendTo(i),i.FontStretchProperty=e.InheritableOwner.FontStretchProperty.ExtendTo(i),i.FontStyleProperty=e.InheritableOwner.FontStyleProperty.ExtendTo(i),i.FontWeightProperty=e.InheritableOwner.FontWeightProperty.ExtendTo(i),i.ForegroundProperty=e.InheritableOwner.ForegroundProperty.ExtendTo(i),i.HorizontalContentAlignmentProperty=DependencyProperty.Register("HorizontalContentAlignment",function(){return new e.Enum(e.HorizontalAlignment)},i,e.HorizontalAlignment.Center),i.IsEnabledProperty=DependencyProperty.Register("IsEnabled",function(){return Boolean},i,!0),i.IsTabStopProperty=DependencyProperty.Register("IsTabStop",function(){return Boolean},i,!0),i.PaddingProperty=DependencyProperty.RegisterCore("Padding",function(){return Thickness},i),i.TabIndexProperty=DependencyProperty.Register("TabIndex",function(){return Number},i),i.TabNavigationProperty=DependencyProperty.Register("TabNavigation",function(){return new e.Enum(e.Input.KeyboardNavigationMode)},i,e.Input.KeyboardNavigationMode.Local),i.TemplateProperty=DependencyProperty.Register("Template",function(){return t.ControlTemplate},i,void 0,function(e,t){return e.XamlNode.OnTemplateChanged(t.OldValue,t.NewValue)}),i.VerticalContentAlignmentProperty=DependencyProperty.Register("VerticalContentAlignment",function(){return new e.Enum(e.VerticalAlignment)},i,e.VerticalAlignment.Center),i}(e.FrameworkElement);t.Control=r,e.CoreLibrary.add(r),r.IsEnabledProperty.Store=e.Providers.IsEnabledStore.Instance;var o=[r.FontFamilyProperty,r.FontSizeProperty,r.FontStretchProperty,r.FontStyleProperty,r.FontWeightProperty,r.ForegroundProperty];t.TemplateVisualStates=nullstone.CreateTypedAnnotation("TemplateVisualState"),t.TemplateParts=nullstone.CreateTypedAnnotation("TemplatePart")}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(e){n.call(this,e),this._DefaultPresenter=null}return __extends(r,n),r.prototype.GetDefaultVisualTree=function(){var n=this.XObject,r=n.Content;if(r instanceof e.UIElement)return r;var o=this._DefaultPresenter;return o||(o=this._DefaultPresenter=new t.ContentPresenter,o.TemplateOwner=this.XObject),o.SetValue(t.ContentPresenter.ContentProperty,new e.TemplateBindingExpression("Content")),o.SetValue(t.ContentPresenter.ContentTemplateProperty,new e.TemplateBindingExpression("ContentTemplate")),o},r.prototype.OnContentChanged=function(t,n){(t instanceof e.UIElement||n instanceof e.UIElement)&&this.CleanOldContent(t)},r.prototype.OnTemplateChanged=function(e,t){e&&this.CleanOldContent(this.XObject.Content),n.prototype.OnTemplateChanged.call(this,e,t)},r.prototype.CleanOldContent=function(n){if(n instanceof e.UIElement)e.FENode.DetachFromVisualParent(n),this.LayoutUpdater.invalidateMeasure();else{var r=this._DefaultPresenter;r&&(r.ClearValue(t.ContentPresenter.ContentProperty),r.ClearValue(t.ContentPresenter.ContentTemplateProperty),e.FENode.DetachFromVisualParent(r),this.LayoutUpdater.invalidateMeasure())}},r}(t.ControlNode);t.ContentControlNode=n;var r=function(t){function r(){t.call(this),this.DefaultStyleKey=r}return __extends(r,t),r.prototype.CreateNode=function(){return new n(this)},r.prototype.OnContentPropertyChanged=function(e){this.XamlNode.OnContentChanged(e.OldValue,e.NewValue),this.OnContentChanged(e.OldValue,e.NewValue)},r.prototype.OnContentUriPropertyChanged=function(t){var n,r=this;t.OldValue instanceof e.Uri&&(this.Content=void 0,n=t.OldValue);var o;t.NewValue instanceof e.Uri&&(o=t.NewValue,e.Markup.Resolve(o).then(function(e){return r._OnLoadedUri(e)},function(e){return r._OnErroredUri(e,o)})),this.OnContentUriChanged(n,o)},r.prototype.OnContentChanged=function(e,t){},r.prototype.OnContentTemplateChanged=function(e,t){},r.prototype.OnContentUriChanged=function(e,t){},r.prototype._OnLoadedUri=function(t){this.Content=e.Markup.Load(this.App,t)},r.prototype._OnErroredUri=function(e,t){console.warn("Error resolving XamlResource: '"+t.toString()+"'.")},r.ContentProperty=DependencyProperty.Register("Content",function(){return Object},r,void 0,function(e,t){return e.OnContentPropertyChanged(t)}),r.ContentTemplateProperty=DependencyProperty.Register("ContentTemplate",function(){return e.DataTemplate},r,void 0,function(e,t){return e.OnContentTemplateChanged(t.OldValue,t.NewValue)}),r.ContentUriProperty=DependencyProperty.Register("ContentUri",function(){return e.Uri},r,void 0,function(e,t){return e.OnContentUriPropertyChanged(t)}),r}(t.Control);t.ContentControl=r,e.CoreLibrary.add(r),e.Markup.Content(r,r.ContentProperty)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){!function(e){e[e.NoWrap=0]="NoWrap",e[e.Wrap=1]="Wrap",e[e.WrapWithOverflow=2]="WrapWithOverflow"}(t.TextWrapping||(t.TextWrapping={}));var n=t.TextWrapping;e.CoreLibrary.addEnum(n,"TextWrapping"),function(e){e[e.Disabled=0]="Disabled",e[e.Auto=1]="Auto",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"}(t.ScrollBarVisibility||(t.ScrollBarVisibility={}));var r=t.ScrollBarVisibility;e.CoreLibrary.addEnum(r,"ScrollBarVisibility"),function(e){e[e.None=0]="None"}(t.TextTrimming||(t.TextTrimming={}));var o=t.TextTrimming;e.CoreLibrary.addEnum(o,"TextTrimming"),function(e){e[e.Release=0]="Release",e[e.Press=1]="Press",e[e.Hover=2]="Hover"}(t.ClickMode||(t.ClickMode={}));var i=t.ClickMode;e.CoreLibrary.addEnum(i,"ClickMode"),function(e){e[e.Bottom=0]="Bottom",e[e.Right=1]="Right",e[e.Mouse=2]="Mouse",e[e.Left=3]="Left",e[e.Top=4]="Top"}(t.PlacementMode||(t.PlacementMode={}));var a=t.PlacementMode;e.CoreLibrary.addEnum(a,"PlacementMode"),function(e){e[e.Single=0]="Single",e[e.Multiple=1]="Multiple",e[e.Extended=2]="Extended"}(t.SelectionMode||(t.SelectionMode={}));var s=t.SelectionMode;e.CoreLibrary.addEnum(s,"SelectionMode"),function(e){e[e.Closed=0]="Closed",e[e.Opening=1]="Opening",e[e.Buffering=4]="Buffering",e[e.Playing=5]="Playing",e[e.Paused=6]="Paused",e[e.Stopped=7]="Stopped"}(t.MediaElementState||(t.MediaElementState={}));var u=t.MediaElementState;e.CoreLibrary.addEnum(u,"MediaElementState")}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(){n.call(this),this.Click=new e.RoutedEvent,this._IsMouseCaptured=!1,this._IsMouseLeftButtonDown=!1,this._IsSpaceKeyDown=!1,this._MousePosition=new Point,this._SuspendStateChanges=!1,this.IsTabStop=!0}return __extends(r,n),r.prototype.OnIsPressedChanged=function(e){this.UpdateVisualState()},r.prototype.OnIsEnabledChanged=function(e){var t=this;e.NewValue||this._DoWithSuspend(function(){t.SetCurrentValue(r.IsFocusedProperty,!1),t.SetCurrentValue(r.IsPressedProperty,!1),t._IsMouseCaptured=!1,t._IsSpaceKeyDown=!1,t._IsMouseLeftButtonDown=!1})},r.prototype.OnMouseEnter=function(e){var o=this;n.prototype.OnMouseEnter.call(this,e),this.UpdateVisualState(),this.ClickMode===t.ClickMode.Hover&&this.IsEnabled&&this._DoWithSuspend(function(){o.SetCurrentValue(r.IsPressedProperty,!0),o.OnClick()})},r.prototype.OnMouseLeave=function(e){var o=this;n.prototype.OnMouseLeave.call(this,e),this.UpdateVisualState(),this.ClickMode===t.ClickMode.Hover&&this.IsEnabled&&this._DoWithSuspend(function(){o.SetCurrentValue(r.IsPressedProperty,!1)})},r.prototype.OnMouseMove=function(e){n.prototype.OnMouseMove.call(this,e),this._MousePosition=e.GetPosition(this),this._IsMouseLeftButtonDown&&this.IsEnabled&&this.ClickMode!==t.ClickMode.Hover&&this._IsMouseCaptured&&!this._IsSpaceKeyDown&&this.SetCurrentValue(r.IsPressedProperty,this._IsValidPosition(this._MousePosition))},r.prototype.OnMouseLeftButtonDown=function(e){var o=this;if(n.prototype.OnMouseLeftButtonDown.call(this,e),this._IsMouseLeftButtonDown=!0,this.IsEnabled){var i=this.ClickMode;i!==t.ClickMode.Hover&&(e.Handled=!0,this._DoWithSuspend(function(){o.Focus(),o._CaptureMouseInternal(),o._IsMouseCaptured&&o.SetCurrentValue(r.IsPressedProperty,!0)}),i===t.ClickMode.Press&&this.OnClick())}},r.prototype.OnMouseLeftButtonUp=function(e){if(n.prototype.OnMouseLeftButtonDown.call(this,e),this._IsMouseLeftButtonDown=!1,this.IsEnabled){var o=this.ClickMode;o!==t.ClickMode.Hover&&(e.Handled=!0,!this._IsSpaceKeyDown&&this.IsPressed&&o===t.ClickMode.Release&&this.OnClick(),this._IsSpaceKeyDown||(this._ReleaseMouseCaptureInternal(),this.SetCurrentValue(r.IsPressedProperty,!1)))}},r.prototype.OnGotFocus=function(e){n.prototype.OnGotFocus.call(this,e),this.SetCurrentValue(r.IsFocusedProperty,!0),this.UpdateVisualState()},r.prototype.OnLostFocus=function(e){var o=this;n.prototype.OnLostFocus.call(this,e),this.SetCurrentValue(r.IsFocusedProperty,!1),this.ClickMode!==t.ClickMode.Hover&&this._DoWithSuspend(function(){o.SetCurrentValue(r.IsPressedProperty,!1),o._ReleaseMouseCaptureInternal(),o._IsSpaceKeyDown=!1})},r.prototype.OnTouchMove=function(e){if(n.prototype.OnTouchMove.call(this,e),this.IsEnabled&&e.Device.Captured===this){var t=e.GetTouchPoint(this);this.SetCurrentValue(r.IsPressedProperty,this._IsValidPosition(t.Position))}},r.prototype.OnTouchDown=function(e){var o=this;n.prototype.OnTouchDown.call(this,e),this.IsEnabled&&(e.Handled=!0,this._DoWithSuspend(function(){o.Focus(),e.Device.Capture(o)&&o.SetCurrentValue(r.IsPressedProperty,!0)}),this.ClickMode===t.ClickMode.Press&&this.OnClick())},r.prototype.OnTouchUp=function(e){n.prototype.OnTouchUp.call(this,e),this.IsEnabled&&(e.Handled=!0,this.IsPressed&&this.ClickMode===t.ClickMode.Release&&this.OnClick(),e.Device.ReleaseCapture(this),this.SetCurrentValue(r.IsPressedProperty,!1))},r.prototype.OnClick=function(){var t=this.Command,n=this.CommandParameter;if(null!=t){var r=t.CanExecute;(null==r||"function"!=typeof r||r(n))&&t.Execute&&"function"==typeof t.Execute&&t.Execute(n)}this.Click.raise(this,new e.RoutedEventArgs)},r.prototype._DoWithSuspend=function(e){this._SuspendStateChanges=!0;try{e()}finally{this._SuspendStateChanges=!1,this.UpdateVisualState()}},r.prototype.UpdateVisualState=function(e){this._SuspendStateChanges||n.prototype.UpdateVisualState.call(this,e)},r.prototype.GoToStateCommon=function(e){return e(this.IsEnabled?this.IsPressed?"Pressed":this.IsMouseOver?"MouseOver":"Normal":"Disabled")},r.prototype._CaptureMouseInternal=function(){this._IsMouseCaptured||(this._IsMouseCaptured=this.CaptureMouse())},r.prototype._ReleaseMouseCaptureInternal=function(){this.ReleaseMouseCapture(),this._IsMouseCaptured=!1},r.prototype._IsValidPosition=function(e){return e.x>=0&&e.x<=this.ActualWidth&&e.y>=0&&e.y<=this.ActualHeight},r.prototype.OnCommandChanged=function(t){var n=e.Input.ICommand_.as(t.OldValue);n&&n.CanExecuteChanged.off(this.OnCommandCanExecuteChanged,this),n=e.Input.ICommand_.as(t.NewValue),n&&(n.CanExecuteChanged.on(this.OnCommandCanExecuteChanged,this),this.IsEnabled=n.CanExecute(this.CommandParameter))},r.prototype.OnCommandCanExecuteChanged=function(e,t){this.IsEnabled=this.Command.CanExecute(this.CommandParameter)},r.prototype.OnCommandParameterChanged=function(e){var t=this.Command;t&&(this.IsEnabled=t.CanExecute(e.NewValue))},r.ClickModeProperty=DependencyProperty.Register("ClickMode",function(){return new e.Enum(t.ClickMode)},r,t.ClickMode.Release),r.IsPressedProperty=DependencyProperty.RegisterReadOnly("IsPressed",function(){return Boolean},r,!1,function(e,t){return e.OnIsPressedChanged(t)}),r.IsFocusedProperty=DependencyProperty.RegisterReadOnly("IsFocused",function(){return Boolean},r,!1),r.CommandProperty=DependencyProperty.RegisterCore("Command",function(){return e.Input.ICommand_},r,void 0,function(e,t){return e.OnCommandChanged(t)}),r.CommandParameterProperty=DependencyProperty.RegisterCore("CommandParameter",function(){return Object},r,void 0,function(e,t){return e.OnCommandParameterChanged(t)}),r}(t.ContentControl);n.ButtonBase=r,e.CoreLibrary.add(r)}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.call(this),this.DefaultStyleKey=t}return __extends(t,e),t.prototype.OnApplyTemplate=function(){e.prototype.OnApplyTemplate.call(this),this.UpdateVisualState(!1)},t.prototype.OnIsEnabledChanged=function(t){e.prototype.OnIsEnabledChanged.call(this,t),this.IsTabStop=t.NewValue},t}(t.Primitives.ButtonBase);t.Button=n,e.CoreLibrary.add(n),t.TemplateVisualStates(n,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Pressed"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(t){function n(){t.apply(this,arguments),this._ht=[]}return __extends(n,t),n.prototype.AttachTo=function(e){var t=new BError;this.XamlNode.AttachTo(e.XamlNode,t)||t.ThrowException()},Object.defineProperty(n.prototype,"Count",{get:function(){return this._ht.length},enumerable:!0,configurable:!0}),n.prototype.GetRange=function(e,t){return this._ht.slice(e,t)},n.prototype.GetValueAt=function(e){return this._ht[e]},n.prototype.SetValueAt=function(e,t){if(!this.CanAdd(t))return!1;if(0>e||e>=this._ht.length)return!1;var n=this._ht[e],r=t,o=new BError;return this.AddingToCollection(r,o)?(this._ht[e]=r,this.RemovedFromCollection(n,!0),this._RaiseItemReplaced(n,r,e),!0):!1},n.prototype.Add=function(e){var t=this.Insert(this._ht.length,e);return t?this._ht.length-1:-1},n.prototype.Insert=function(e,t){if(!this.CanAdd(t))return!1;if(0>e)return!1;var n=this._ht.length;e>n&&(e=n);var r=new BError;if(this.AddingToCollection(t,r))return this._ht.splice(e,0,t),this._RaiseItemAdded(t,e),!0;if(r.Message)throw new Exception(r.Message);return!1},n.prototype.Remove=function(e){var t=this.IndexOf(e);return-1===t?!1:this.RemoveAt(t)},n.prototype.RemoveAt=function(e){if(0>e||e>=this._ht.length)return!1;var t=this._ht[e];return this._ht.splice(e,1),this.RemovedFromCollection(t,!0),this._RaiseItemRemoved(t,e),!0},n.prototype.Clear=function(){var e=this._ht;this._ht=[];for(var t=e.length,n=0;t>n;n++)this.RemovedFromCollection(e[n],!0);return this._RaiseCleared(e),!0},n.prototype.IndexOf=function(e){return this._ht.indexOf(e)},n.prototype.Contains=function(e){return this.IndexOf(e)>-1},n.prototype.CanAdd=function(e){return!0},n.prototype.AddingToCollection=function(t,n){return t instanceof e.XamlObject?t.XamlNode.AttachTo(this.XamlNode,n):!0},n.prototype.RemovedFromCollection=function(t,n){t instanceof e.XamlObject&&t.XamlNode.Detach()},n.prototype.getEnumerator=function(e){return nullstone.IEnumerator_.fromArray(this._ht,e)},n.prototype.GetNodeEnumerator=function(e){var t=this.getEnumerator(e);return{current:void 0,moveNext:function(){if(!t.moveNext())return this.current=void 0,!1;var e=t.current;return this.current=e.XamlNode,!0}}},n.prototype._RaiseItemAdded=function(e,t){},n.prototype._RaiseItemRemoved=function(e,t){},n.prototype._RaiseItemReplaced=function(e,t,n){},n.prototype._RaiseCleared=function(e){},n.prototype.CloneCore=function(t){for(var n=t.getEnumerator();n.moveNext();)this.Add(e.Clone(n.current))},n.prototype.ToArray=function(){return this._ht.slice(0)},n}(e.XamlObject);e.XamlObjectCollection=t,nullstone.ICollection_.mark(t)}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.GetValue=function(e){return e.Local},r.prototype.GetValuePrecedence=function(e){return t.PropertyPrecedence.LocalValue},r.prototype.SetLocalValue=function(e,t){console.warn("Trying to set value for immutable property.")},r.prototype.ClearValue=function(e){console.warn("Trying to clear value for immutable property.")},r.prototype.ListenToChanged=function(e,t,n,r){return{Property:t,OnPropertyChanged:function(e,t){},Detach:function(){}}},r.prototype.Clone=function(r,o){if(o.Local instanceof e.XamlObjectCollection){var i=t.GetStorage(r,o.Property),a=i.Local;a.CloneCore(o.Local);var s=i.Animations=o.Animations;if(s)for(var u=0;u<s.length;u++)s[u].PropStorage=i;return i}return console.warn("Cloning Immutable improperly"),n.prototype.Clone.call(this,r,o)},r}(t.PropertyStore);t.ImmutableStore=n,n.Instance=new n}(t=e.Providers||(e.Providers={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments),this.$$updaters=[]}return __extends(t,e),t.prototype.AddingToCollection=function(t,n){var r=this.XamlNode.ParentNode;return r.AttachVisualChild(t,n)?e.prototype.AddingToCollection.call(this,t,n):!1},t.prototype.RemovedFromCollection=function(t,n){var r=this.XamlNode.ParentNode;r.DetachVisualChild(t,null),e.prototype.RemovedFromCollection.call(this,t,n)},t.prototype._RaiseCleared=function(e){this.$$updaters.length=0},t.prototype._RaiseItemAdded=function(e,t){this.$$updaters.splice(t,0,e.XamlNode.LayoutUpdater)},t.prototype._RaiseItemRemoved=function(e,t){this.$$updaters.splice(t,1)},t.prototype._RaiseItemReplaced=function(e,t,n){this.$$updaters.splice(n,1,t.XamlNode.LayoutUpdater)},t}(e.XamlObjectCollection),r=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.AttachVisualChild=function(e,t){return this.OnVisualChildAttached(e),e.XamlNode.SetIsLoaded(this.IsLoaded),!0},t.prototype.DetachVisualChild=function(e,t){return this.OnVisualChildDetached(e),e.XamlNode.SetIsLoaded(!1),!0},t}(e.FENode);t.PanelNode=r;var o=function(t){function o(){t.call(this);var e=o.ChildrenProperty.Initialize(this);this.XamlNode.LayoutUpdater.setChildren(e.$$updaters);var n=new BError;this.XamlNode.SetSubtreeNode(e.XamlNode,n)}return __extends(o,t),o.prototype.CreateNode=function(){return new r(this)},o.prototype.CreateLayoutUpdater=function(){return new minerva.controls.panel.PanelUpdater},o.GetZIndex=function(e){return e.GetValue(o.ZIndexProperty)},o.SetZIndex=function(e,t){e.SetValue(o.ZIndexProperty,t)},o.BackgroundProperty=DependencyProperty.Register("Background",function(){return e.Media.Brush},o),o.ChildrenProperty=DependencyProperty.RegisterImmutable("Children",function(){return n},o),o.ZIndexProperty=DependencyProperty.RegisterAttached("ZIndex",function(){return Number},o,0),o}(e.FrameworkElement);t.Panel=o,e.CoreLibrary.add(o),e.Markup.Content(o,o.ChildrenProperty);var i;!function(t){e.UIReaction(o.BackgroundProperty,function(e,t,n){n!==t&&e.updateBounds(),e.invalidate()}),e.UIReactionAttached(o.ZIndexProperty,minerva.controls.panel.reactTo.zIndex)}(i||(i={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.CreateLayoutUpdater=function(){return new minerva.controls.canvas.CanvasUpdater},t.GetTop=function(e){return e.GetValue(t.TopProperty)},t.SetTop=function(e,n){e.SetValue(t.TopProperty,n)},t.GetLeft=function(e){return e.GetValue(t.LeftProperty)},t.SetLeft=function(e,n){e.SetValue(t.LeftProperty,n)},t.TopProperty=DependencyProperty.RegisterAttached("Top",function(){return Number},t,0),t.LeftProperty=DependencyProperty.RegisterAttached("Left",function(){return Number},t,0),t}(t.Panel);t.Canvas=n,e.CoreLibrary.add(n);var r;!function(t){e.UIReactionAttached(n.TopProperty,minerva.controls.canvas.reactTo.top),e.UIReactionAttached(n.LeftProperty,minerva.controls.canvas.reactTo.left)}(r||(r={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(t){function n(){t.call(this),this.Checked=new e.RoutedEvent,this.Indeterminate=new e.RoutedEvent,this.Unchecked=new e.RoutedEvent,this.DefaultStyleKey=n}return __extends(n,t),n.prototype.OnApplyTemplate=function(){t.prototype.OnApplyTemplate.call(this),this.UpdateVisualState(!1)},n.prototype.OnContentChanged=function(e,n){t.prototype.OnContentChanged.call(this,e,n),this.UpdateVisualState()},n.prototype.OnClick=function(){this.OnToggle(),t.prototype.OnClick.call(this)},n.prototype.UpdateVisualState=function(n){n=n!==!1,t.prototype.UpdateVisualState.call(this,n);var r=this.IsChecked,o=e.Media.VSM.VisualStateManager;r===!0?o.GoToState(this,"Checked",n):r===!1?o.GoToState(this,"Unchecked",n):o.GoToState(this,"Indeterminate",n)||o.GoToState(this,"Unchecked",n)},n.prototype.OnIsCheckedChanged=function(t){var n=t.NewValue;this.UpdateVisualState();var r=new e.RoutedEventArgs;n===!0?this.Checked.raise(this,r):n===!1?this.Unchecked.raise(this,r):this.Indeterminate.raise(this,r)},n.prototype.OnToggle=function(){var e=this.IsChecked;e===!0?this.IsChecked=this.IsThreeState?null:!1:this.IsChecked=null!=e},n.IsCheckedProperty=DependencyProperty.RegisterCore("IsChecked",function(){return Boolean},n,!1,function(e,t){return e.OnIsCheckedChanged(t)}),n.IsThreeStateProperty=DependencyProperty.RegisterCore("IsThreeState",function(){return Boolean},n,!1),n}(n.ButtonBase);n.ToggleButton=r,e.CoreLibrary.add(r),t.TemplateVisualStates(r,{GroupName:"CommonStates",Name:"Pressed"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"},{GroupName:"CheckStates",Name:"Checked"},{GroupName:"CheckStates",Name:"Unchecked"},{GroupName:"CheckStates",Name:"Indeterminate"})}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.call(this),this.DefaultStyleKey=t}return __extends(t,e),t}(t.Primitives.ToggleButton);t.CheckBox=n,e.CoreLibrary.add(n),t.TemplateVisualStates(n,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Pressed"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"},{GroupName:"CheckStates",Name:"Checked"},{GroupName:"CheckStates",Name:"Unchecked"},{GroupName:"CheckStates",Name:"Indeterminate"},{GroupName:"ValidationStates",Name:"InvalidUnfocused"},{GroupName:"ValidationStates",Name:"InvalidFocused"},{GroupName:"ValidationStates",Name:"Valid"})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e){if(!e||e instanceof o)return e;var n=e.toString(),r=new o;if("auto"===n.toLowerCase())return r.Width=new t.GridLength(0,i.Auto),r;if("*"===n)return r.Width=new t.GridLength(1,i.Star),r;var a=parseFloat(n);if(isNaN(a))throw new XamlParseException("Invalid ColumnDefinition: '"+n+"'.");return r.Width=new t.GridLength(a,"*"===n[n.length-1]?i.Star:i.Pixel),r}function r(e){if(!e||e instanceof a)return e;if("string"==typeof e){for(var t,r=e.split(" "),o=r.length,i=new a,s=0;o>s;s++)(t=n(r[s]))&&i.Add(t);return i}return void 0}var o=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.setActualWidth=function(e){this.SetCurrentValue(r.ActualWidthProperty,e)},r.WidthProperty=DependencyProperty.Register("Width",function(){return t.GridLength},r,void 0,e.Incite),r.MaxWidthProperty=DependencyProperty.Register("MaxWidth",function(){return Number},r,Number.POSITIVE_INFINITY,e.Incite),r.MinWidthProperty=DependencyProperty.Register("MinWidth",function(){return Number},r,0,e.Incite),r.ActualWidthProperty=DependencyProperty.RegisterReadOnly("ActualWidth",function(){return Number},r,0),r}(e.DependencyObject);t.ColumnDefinition=o,e.CoreLibrary.add(o);var i=minerva.controls.grid.GridUnitType;nullstone.registerTypeConverter(o,n);var a=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype._RaiseItemAdded=function(t,n){e.Incite(this,{item:t,index:n,add:!0})},n.prototype._RaiseItemRemoved=function(t,n){e.Incite(this,{item:t,index:n,add:!1})},n}(e.XamlObjectCollection);t.ColumnDefinitionCollection=a,e.CoreLibrary.add(a),nullstone.registerTypeConverter(a,r)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e){if(e instanceof Array)return e;var t=nullstone.IEnumerable_.as(e);if(t){for(var n=[],r=t.getEnumerator();r.moveNext();)n.push(r.current);return n}return null}var r=function(e){function n(t){e.call(this,t),this.ItemsPresenter=null}return __extends(n,e),n.prototype.GetDefaultVisualTree=function(){var e=this.ItemsPresenter;return e||((e=new t.ItemsPresenter).TemplateOwner=this.XObject),e},n}(t.ControlNode);t.ItemsControlNode=r;var o=function(o){function a(){o.call(this),this._IsDataBound=!1,this._SuspendItemsChanged=!1,this._DisplayMemberTemplate=null,this.DefaultStyleKey=a;var e=a.ItemsProperty.Initialize(this);e.ItemsChanged.on(this._OnItemsUpdated,this),this._ItemContainersManager=new t.Internal.ItemContainersManager(this)}return __extends(a,o),a.prototype.CreateNode=function(){return new r(this)},Object.defineProperty(a.prototype,"IsItemsControl",{get:function(){return!0},enumerable:!0,configurable:!0}),a.GetIsItemsHost=function(e){return e.GetValue(a.IsItemsHostProperty)===!0},a.SetIsItemsHost=function(e,t){e.SetValue(a.IsItemsHostProperty,t===!0)},a.prototype.OnDisplayMemberPathChanged=function(e){for(var t=this.ItemContainersManager.GetEnumerator();t.moveNext();)this.UpdateContainerTemplate(t.current,t.CurrentItem)},a.prototype.OnItemsSourceChanged=function(t){var r=e.Collections.INotifyCollectionChanged_.as(t.OldValue);r&&r.CollectionChanged.off(this._OnItemsSourceUpdated,this);var o=this.Items,i=e.Collections.CollectionChangedEventArgs.Reset(o.ToArray());try{this._SuspendItemsChanged=!0,o.Clear()}finally{this._SuspendItemsChanged=!1}this.OnItemsChanged(i),this._IsDataBound=!!t.NewValue;var a=n(t.NewValue);try{this._SuspendItemsChanged=!0,a&&o.AddRange(a)}finally{this._SuspendItemsChanged=!1}a&&this.OnItemsChanged(e.Collections.CollectionChangedEventArgs.AddRange(a,0));var r=e.Collections.INotifyCollectionChanged_.as(t.NewValue);r&&r.CollectionChanged.on(this._OnItemsSourceUpdated,this)},a.prototype.OnItemTemplateChanged=function(e){for(var t=this.ItemContainersManager.GetEnumerator();t.moveNext();)this.UpdateContainerTemplate(t.current,t.CurrentItem)},Object.defineProperty(a.prototype,"ItemContainersManager",{get:function(){return this._ItemContainersManager},enumerable:!0,configurable:!0}),a.prototype.PrepareContainerForItem=function(e,t){if(null!=this.DisplayMemberPath&&null!=this.ItemTemplate)throw new InvalidOperationException("Cannot set 'DisplayMemberPath' and 'ItemTemplate' simultaneously");this.UpdateContainerTemplate(e,t)},a.prototype.ClearContainerForItem=function(e,n){if(e instanceof t.ContentPresenter){var r=e;r.Content===n&&(r.Content=null)}else if(e instanceof t.ContentControl){var o=e;o.Content===n&&(o.Content=null)}},a.prototype.GetContainerForItem=function(){return new t.ContentPresenter},a.prototype.IsItemItsOwnContainer=function(t){return t instanceof e.UIElement},a.prototype._OnItemsUpdated=function(e,t){if(!this._SuspendItemsChanged){if(this._IsDataBound)throw new InvalidOperationException("Cannot modify Items while bound to ItemsSource.");this.OnItemsChanged(t)}},a.prototype._OnItemsSourceUpdated=function(t,n){var r=this.Items;try{switch(this._SuspendItemsChanged=!0,n.Action){case e.Collections.CollectionChangedAction.Add:for(var o=0,i=n.NewItems.length;i>o;o++)r.Insert(n.NewStartingIndex+o,n.NewItems[o]);break;case e.Collections.CollectionChangedAction.Remove:for(var o=0,i=n.OldItems.length;i>o;o++)r.RemoveAt(n.OldStartingIndex);break;case e.Collections.CollectionChangedAction.Replace:r.SetValueAt(n.NewStartingIndex,n.NewItems[0]);break;case e.Collections.CollectionChangedAction.Reset:r.Clear()}}finally{this._SuspendItemsChanged=!1}this.OnItemsChanged(n)},a.prototype.OnItemsChanged=function(t){switch(t.Action){case e.Collections.CollectionChangedAction.Add:this.OnItemsAdded(t.NewStartingIndex,t.NewItems);break;case e.Collections.CollectionChangedAction.Remove:this.OnItemsRemoved(t.OldStartingIndex,t.OldItems);break;case e.Collections.CollectionChangedAction.Replace:this.OnItemsRemoved(t.NewStartingIndex,t.OldItems),this.OnItemsAdded(t.NewStartingIndex,t.NewItems);break;case e.Collections.CollectionChangedAction.Reset:this.OnItemsRemoved(0,t.OldItems)}},a.prototype.OnItemsAdded=function(e,t){this._ItemContainersManager.OnItemsAdded(e,t);var n=this.XamlNode.ItemsPresenter;n&&n.OnItemsAdded(e,t)},a.prototype.OnItemsRemoved=function(e,t){var n=this.XamlNode.ItemsPresenter;n&&n.OnItemsRemoved(e,t),this._ItemContainersManager.OnItemsRemoved(e,t)},a.prototype.UpdateContainerTemplate=function(n,r){if(n&&n!==r){var o;if(r instanceof e.UIElement||(o=this.ItemTemplate||this._GetDisplayMemberTemplate()),n instanceof t.ContentPresenter){var i=n;i.ContentTemplate=o,i.Content=r}else if(n instanceof t.ContentControl){var a=n;a.ContentTemplate=o,a.Content=r}}},a.prototype._GetDisplayMemberTemplate=function(){if(!this._DisplayMemberTemplate){var t=i.create(this.DisplayMemberPath||"");this._DisplayMemberTemplate=e.Markup.Load(this.App,t)}return this._DisplayMemberTemplate},a.DisplayMemberPathProperty=DependencyProperty.Register("DisplayMemberPath",function(){return String},a,null,function(e,t){return e.OnDisplayMemberPathChanged(t)}),a.ItemsPanelProperty=DependencyProperty.Register("ItemsPanel",function(){return t.ItemsPanelTemplate},a),a.ItemsSourceProperty=DependencyProperty.RegisterFull("ItemsSource",function(){return nullstone.IEnumerable_},a,null,function(e,t){return e.OnItemsSourceChanged(t)}),a.ItemsProperty=DependencyProperty.RegisterImmutable("Items",function(){return t.ItemCollection},a),a.ItemTemplateProperty=DependencyProperty.Register("ItemTemplate",function(){return e.DataTemplate},a,void 0,function(e,t){return e.OnItemTemplateChanged(t)}),a.IsItemsHostProperty=DependencyProperty.RegisterAttached("IsItemsHost",function(){return Boolean},a,!1),a}(t.Control);t.ItemsControl=o,e.CoreLibrary.add(o),e.Markup.Content(o,o.ItemsProperty);var i;!function(t){function n(t){return e.Markup.CreateXaml('<DataTemplate xmlns="'+e.XMLNS+'"><Grid><TextBlock Text="{Binding '+t+'}" /></Grid></DataTemplate>',e.XMLNS+"/itemscontrol/displaymember/"+t)}t.create=n}(i||(i={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(r){function o(){r.call(this),this.SelectionChanged=new e.RoutedEvent,this._SelectedItems=new e.Collections.ObservableCollection,this._SelectedItemsIsInvalid=!1,this.$TemplateScrollViewer=null,this._SelectedValueWalker=null,this._Selection=new n.SelectorSelection(this)}return __extends(o,r),Object.defineProperty(o.prototype,"SynchronizeWithCurrentItem",{get:function(){return e.Data.ICollectionView_.is(this.ItemsSource)?this.IsSynchronizedWithCurrentItem!==!1:!1},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"SelectedItems",{get:function(){return this._SelectedItemsIsInvalid&&this._Selection.RepopulateSelectedItems(),this._SelectedItems},enumerable:!0,configurable:!0}),o.prototype._OnIsSynchronizedWithCurrentItemChanged=function(t){if(t.NewValue===!0)throw new ArgumentException("Setting IsSynchronizedWithCurrentItem to 'true' is not supported");if(null!=t.NewValue)return this.SelectedItem=null;var n=e.Data.ICollectionView_.as(this.ItemsSource);n&&(this.SelectedItem=n.CurrentItem)},o.prototype._OnSelectedIndexChanged=function(e){if(!this._Selection.IsUpdating){var t=this.Items;e.NewValue<0||e.NewValue>=t.Count?this._Selection.ClearSelection():this._Selection.Select(t.GetValueAt(e.NewValue))}},o.prototype._OnSelectedItemChanged=function(e){this._Selection.IsUpdating||(null==e.NewValue?this._Selection.ClearSelection():-1!==this.Items.IndexOf(e.NewValue)?this._Selection.Select(e.NewValue):-1!==this.Items.IndexOf(e.OldValue)?this._Selection.Select(e.OldValue):this._Selection.ClearSelection());
},o.prototype._OnSelectedValueChanged=function(e){this._Selection.IsUpdating||this._SelectItemFromValue(e.NewValue,!1)},o.prototype._OnSelectedValuePathChanged=function(t){this._SelectedValueWalker=t.NewValue?new e.Data.PropertyPathWalker(t.NewValue):null,this._SelectItemFromValue(this.SelectedValue,!0)},o.prototype._OnSelectionModeChanged=function(e){if(this._Selection.Mode=e.NewValue,e.NewValue===t.SelectionMode.Single){var n=this.SelectedIndex;-1!==n&&this._Selection.SelectOnly(this.Items.GetValueAt(n))}},o.prototype.OnApplyTemplate=function(){r.prototype.OnApplyTemplate.call(this);var e=this.$TemplateScrollViewer=this.GetTemplateChild("ScrollViewer",t.ScrollViewer);e&&(e.$TemplatedParentHandlesScrolling=!0,e.HorizontalScrollBarVisibility=t.ScrollViewer.GetHorizontalScrollBarVisibility(this),e.VerticalScrollBarVisibility=t.ScrollViewer.GetVerticalScrollBarVisibility(this))},o.prototype.OnItemsChanged=function(n){r.prototype.OnItemsChanged.call(this,n);var o;switch(n.Action){case e.Collections.CollectionChangedAction.Add:var i;n.NewItems[0]instanceof t.ListBoxItem&&(i=n.NewItems[0]),null!=i&&i.IsSelected&&!this.SelectedItems.Contains(i)?this._Selection.Select(i):null!=this.SelectedItem&&this._Selection.Select(this.SelectedItem);break;case e.Collections.CollectionChangedAction.Reset:var a,s=e.Data.ICollectionView_.as(this.ItemsSource);a=s&&this.SynchronizeWithCurrentItem?s.CurrentItem:this.SelectedItem,this.Items.Contains(a)?this._Selection.Select(a):this._Selection.ClearSelection();break;case e.Collections.CollectionChangedAction.Remove:o=n.OldItems[0],this.SelectedItems.Contains(o)?this._Selection.Unselect(o):n.OldStartingIndex<=this.SelectedIndex&&this._Selection.Select(this.SelectedItem);break;case e.Collections.CollectionChangedAction.Replace:o=n.OldItems[0],this._Selection.Unselect(o);break;default:throw new NotSupportedException("Collection changed action '"+n.Action+"' not supported")}},o.prototype.OnItemsSourceChanged=function(t){r.prototype.OnItemsSourceChanged.call(this,t);var n=e.Data.ICollectionView_.as(t.OldValue);n&&n.CurrentChanged.off(this._OnCurrentItemChanged,this),n=e.Data.ICollectionView_.as(t.NewValue),n?(n.CurrentChanged.on(this._OnCurrentItemChanged,this),this.SynchronizeWithCurrentItem?this._Selection.SelectOnly(n.CurrentItem):this._Selection.ClearSelection()):this._Selection.ClearSelection()},o.prototype.OnItemContainerStyleChanged=function(e,t){},o.prototype.ClearContainerForItem=function(e,t){r.prototype.ClearContainerForItem.call(this,e,t);var n=e;n.ParentSelector=null,n!==t&&(n.Content=null)},o.prototype.PrepareContainerForItem=function(e,t){r.prototype.PrepareContainerForItem.call(this,e,t);var n=e;n.ParentSelector=this,this.SelectedItems.Contains(t)&&(n.IsSelected=!0),n.IsSelected&&!this.SelectedItems.Contains(t)&&this._Selection.Select(t)},o.prototype._GetValueFromItem=function(e){return null==this._SelectedValueWalker?e:null==e?e:this._SelectedValueWalker.GetValue(e)},o.prototype._SelectItemFromValue=function(e,t){if(null==e)return void this._Selection.ClearSelection(t);for(var n=this.Items,r=n.Count,o=0;r>o;o++){var i=n.GetValueAt(o),a=this._GetValueFromItem(i);if(nullstone.equals(e,a))return void(this.SelectedItems.Contains(i)||this._Selection.Select(i))}this._Selection.ClearSelection(t)},o.prototype.SelectAll=function(){this._Selection.SelectAll(this.Items.ToArray())},o.prototype._OnCurrentItemChanged=function(e,t){if(!this._Selection.IsUpdating&&this.SynchronizeWithCurrentItem){var n=this.ItemsSource;nullstone.equals(n.CurrentItem,this.SelectedItem)||this._Selection.SelectOnly(n.CurrentItem)}},o.prototype._RaiseSelectionChanged=function(e,r){e||(e=[]),r||(r=[]);for(var o,i,a=e.length,s=0;a>s;s++)i=e[s],null!=i&&(o=null,i instanceof t.ListBoxItem&&(o=i),o=o||this.ItemContainersManager.ContainerFromItem(i),o&&(o.IsSelected=!1));for(var u,l=r.length,s=0;l>s;s++)u=r[s],null!=u&&(o=null,u instanceof t.ListBoxItem&&(o=u),o=o||this.ItemContainersManager.ContainerFromItem(u),o&&(o.IsSelected=!0,o.Focus()));var c=new n.SelectionChangedEventArgs(e,r);this.OnSelectionChanged(c),this.SelectionChanged.raise(this,c)},o.prototype.OnSelectionChanged=function(e){},o.prototype.NotifyListItemClicked=function(e){this._Selection.Select(this.ItemContainersManager.ItemFromContainer(e))},o.prototype.NotifyListItemLoaded=function(e){this.ItemContainersManager.ItemFromContainer(e)===this.SelectedItem&&(e.IsSelected=!0,e.Focus())},o.prototype.NotifyListItemGotFocus=function(e){},o.prototype.NotifyListItemLostFocus=function(e){},o.IsSynchronizedWithCurrentItemProperty=DependencyProperty.Register("IsSynchronizedWithCurrentItem",function(){return Boolean},o,null,function(e,t){return e._OnIsSynchronizedWithCurrentItemChanged(t)}),o.SelectedIndexProperty=DependencyProperty.Register("SelectedIndex",function(){return Number},o,-1,function(e,t){return e._OnSelectedIndexChanged(t)}),o.SelectedItemProperty=DependencyProperty.Register("SelectedItem",function(){return Object},o,void 0,function(e,t){return e._OnSelectedItemChanged(t)}),o.SelectedValueProperty=DependencyProperty.Register("SelectedValue",function(){return Object},o,void 0,function(e,t){return e._OnSelectedValueChanged(t)}),o.SelectedValuePathProperty=DependencyProperty.Register("SelectedValuePath",function(){return String},o,"",function(e,t){return e._OnSelectedValuePathChanged(t)}),o.IsSelectionActiveProperty=DependencyProperty.RegisterReadOnlyCore("IsSelectionActive",function(){return Boolean},o),o.SelectionModeProperty=DependencyProperty.Register("SelectionMode",function(){return new e.Enum(t.SelectionMode)},o,void 0,function(e,t){return e._OnSelectionModeChanged(t)}),o}(t.ItemsControl);n.Selector=r,e.CoreLibrary.add(r)}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(t,n){o++,n=n||"http://gen/"+o.toString();var i=new r(n),a="string"==typeof t?i.loadRoot(t):t;if(!a.isDefaultNamespace(e.XMLNS))throw new XamlParseException("Invalid default namespace. ["+a.lookupNamespaceURI(null)+"]");return i.setRoot(a),i}var r=nullstone.markup.xaml.XamlMarkup,o=0;t.CreateXaml=n}(t=e.Markup||(e.Markup={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(t){return r=r||e.Markup.Load(t,o)}var r,o=e.Markup.CreateXaml('<DataTemplate xmlns="'+e.XMLNS+'"><Grid><TextBlock Text="{Binding}" /></Grid></DataTemplate>',e.XMLNS+"/contentpresenter/default"),i=function(r){function o(e){r.call(this,e)}return __extends(o,r),Object.defineProperty(o.prototype,"ContentRoot",{get:function(){return this._ContentRoot},enumerable:!0,configurable:!0}),o.prototype.DoApplyTemplateWithError=function(n){if(this._ContentRoot)return!1;var r=this.XObject;r.TemplateOwner instanceof t.ContentControl&&(r.HasValueOrExpression(a.ContentProperty)||r.SetValue(a.ContentProperty,new e.TemplateBindingExpression("Content")),r.HasValueOrExpression(a.ContentTemplateProperty)||r.SetValue(a.ContentTemplateProperty,new e.TemplateBindingExpression("ContentTemplate")));var o=r.Content;return o instanceof e.UIElement?(this._ContentRoot=o,r.DataContext=void 0):(r.DataContext=null==o?null:o,this._ContentRoot=this._GetContentTemplate(o?o.constructor:null).GetVisualTree(r)),this._ContentRoot?this.AttachVisualChild(this._ContentRoot,n):!1},o.prototype.ClearRoot=function(){this._ContentRoot&&this.DetachVisualChild(this._ContentRoot,null),this._ContentRoot=null},o.prototype._ContentChanged=function(t){var n=t.NewValue instanceof e.UIElement;n||t.OldValue instanceof e.UIElement?this.ClearRoot():n||(this._ShouldInvalidateImplicitTemplate(t.OldValue,t.NewValue)&&this.ClearRoot(),this.XObject.DataContext=null==t.NewValue?null:t.NewValue),this.LayoutUpdater.invalidateMeasure()},o.prototype._ContentTemplateChanged=function(){this.ClearRoot(),this.LayoutUpdater.invalidateMeasure()},o.prototype._ShouldInvalidateImplicitTemplate=function(e,t){var n=e?e.constructor:null,r=t?t.constructor:null;return n!==r?!0:n===Object?!0:!1},o.prototype._GetContentTemplate=function(t){var r=this.XObject.ContentTemplate;if(r)return r;if(t&&"function"==typeof t){for(var o,i=this;i;){var a=i.XObject;if(a instanceof e.FrameworkElement&&(o=a.Resources)&&(r=o.Get(t),r instanceof e.DataTemplate))return r;i=i.ParentNode}var s=this.LayoutUpdater.tree.surface,u=s?s.App:null;if(u&&(r=u.Resources.Get(t),r instanceof e.DataTemplate))return r}return n(this.XObject.App)},o}(e.FENode);t.ContentPresenterNode=i;var a=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.CreateNode=function(){return new i(this)},n.ContentProperty=DependencyProperty.Register("Content",function(){return Object},n,void 0,function(e,t){return e.XamlNode._ContentChanged(t)}),n.ContentTemplateProperty=DependencyProperty.Register("ContentTemplate",function(){return e.DataTemplate},n,void 0,function(e,t){return e.XamlNode._ContentTemplateChanged()}),n}(e.FrameworkElement);t.ContentPresenter=a,e.CoreLibrary.add(a),e.Markup.Content(a,a.ContentProperty)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=minerva.controls.popup.PopupUpdater,o=function(n){function r(){n.apply(this,arguments),this.ClickedOutside=new nullstone.Event,this._Overlay=null,this._Catcher=null}return __extends(r,n),r.prototype.OnIsAttachedChanged=function(e){n.prototype.OnIsAttachedChanged.call(this,e),this.RegisterInitiator(this.VisualParentNode.XObject),!e&&this.XObject.IsOpen&&(this.XObject.IsOpen=!1)},r.prototype.EnsureOverlay=function(){return this._Overlay||(this._Overlay=new t.Canvas,this.LayoutUpdater.setLayer(this._Overlay.XamlNode.LayoutUpdater)),this._Overlay},r.prototype.EnsureCatcher=function(){var n=this._Catcher;return this.ClickedOutside.has&&!n&&(n=this._Catcher=new t.Canvas,n.Background=e.Media.SolidColorBrush.FromColor(Color.FromRgba(255,255,255,0)),n.LayoutUpdated.on(this.UpdateCatcher,this),n.MouseLeftButtonDown.on(this._RaiseClickedOutside,this),this.EnsureOverlay().Children.Insert(0,n)),n},r.prototype.UpdateCatcher=function(){var e=this._Overlay;if(e){var t=this.LayoutUpdater.tree.initiatorSurface;if(t){e.Width=t.width,e.Height=t.height;var n=this._Catcher;n&&(n.Width=e.Width,n.Height=e.Height)}}},r.prototype._RaiseClickedOutside=function(e,t){this.ClickedOutside.raise(this,null)},r.prototype.RegisterInitiator=function(t){t instanceof e.UIElement&&this.LayoutUpdater.setInitiator(t.XamlNode.LayoutUpdater)},r}(e.FENode);n.PopupNode=o;var i=function(t){function n(){t.apply(this,arguments),this.Opened=new nullstone.Event,this.Closed=new nullstone.Event}return __extends(n,t),n.prototype.CreateNode=function(){return new o(this)},n.prototype.CreateLayoutUpdater=function(){return new r},n.prototype.WatchOutsideClick=function(e,t){this.XamlNode.ClickedOutside.on(e,t),this.XamlNode.EnsureCatcher()},n.ChildProperty=DependencyProperty.Register("Child",function(){return e.UIElement},n),n.HorizontalOffsetProperty=DependencyProperty.Register("HorizontalOffset",function(){return Number},n,0),n.VerticalOffsetProperty=DependencyProperty.Register("VerticalOffset",function(){return Number},n,0),n.IsOpenProperty=DependencyProperty.Register("IsOpen",function(){return Boolean},n,!1),n}(e.FrameworkElement);n.Popup=i,e.CoreLibrary.add(i),e.Markup.Content(i,i.ChildProperty);var a;!function(t){e.UIReaction(i.IsOpenProperty,function(e,t,n,r){n===!0?(r.Opened.raiseAsync(r,null),r.XamlNode.UpdateCatcher()):r.Closed.raiseAsync(r,null),minerva.controls.popup.reactTo.isOpen(e,t,n)},!1),e.UIReaction(i.ChildProperty,function(t,n,r,o){var i=o.XamlNode.EnsureOverlay();n&&(e.Providers.InheritedStore.ClearInheritedOnRemove(o,n.XamlNode),i.Children.Remove(n)),t.setChild(r?r.XamlNode.LayoutUpdater:null),r&&(o.XamlNode.EnsureCatcher(),i.Children.Add(r),e.Providers.InheritedStore.PropagateInheritedOnAdd(o,r.XamlNode))},!1,!1),e.UIReaction(i.HorizontalOffsetProperty,minerva.controls.popup.reactTo.horizontalOffset,!1),e.UIReaction(i.VerticalOffsetProperty,minerva.controls.popup.reactTo.verticalOffset,!1)}(a||(a={}))}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){e.IScrollInfo_=new nullstone.Interface("IScrollInfo")}(t=e.Primitives||(e.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function n(){e.apply(this,arguments),this._IsClipPropertySet=!1,this._ClippingRectangle=null}return __extends(n,e),n.prototype.CreateLayoutUpdater=function(){var e=new minerva.controls.scrollcontentpresenter.ScrollContentPresenterUpdater;return e.assets.scrollData=this._ScrollData=new t.Primitives.ScrollData,e},Object.defineProperty(n.prototype,"ScrollOwner",{get:function(){return this._ScrollData.scrollOwner},set:function(e){this._ScrollData.scrollOwner=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CanHorizontallyScroll",{get:function(){return this._ScrollData.canHorizontallyScroll},set:function(e){var t=this._ScrollData;t.canHorizontallyScroll!==e&&(t.canHorizontallyScroll=e,this.XamlNode.LayoutUpdater.invalidateMeasure())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CanVerticallyScroll",{get:function(){return this._ScrollData.canVerticallyScroll},set:function(e){var t=this._ScrollData;t.canVerticallyScroll!==e&&(t.canVerticallyScroll=e,this.XamlNode.LayoutUpdater.invalidateMeasure())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ExtentWidth",{get:function(){return this._ScrollData.extentWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ExtentHeight",{get:function(){return this._ScrollData.extentHeight},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ViewportWidth",{get:function(){return this._ScrollData.viewportWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ViewportHeight",{get:function(){return this._ScrollData.viewportHeight},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"HorizontalOffset",{get:function(){return this._ScrollData.offsetX},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"VerticalOffset",{get:function(){return this._ScrollData.offsetY},enumerable:!0,configurable:!0}),n.prototype.LineUp=function(){return this.SetVerticalOffset(this._ScrollData.offsetY-16)},n.prototype.LineDown=function(){return this.SetVerticalOffset(this._ScrollData.offsetY+16)},n.prototype.LineLeft=function(){return this.SetHorizontalOffset(this._ScrollData.offsetX-16)},n.prototype.LineRight=function(){return this.SetHorizontalOffset(this._ScrollData.offsetX+16)},n.prototype.MouseWheelUp=function(){return this.SetVerticalOffset(this._ScrollData.offsetY-48)},n.prototype.MouseWheelDown=function(){return this.SetVerticalOffset(this._ScrollData.offsetY+48)},n.prototype.MouseWheelLeft=function(){return this.SetHorizontalOffset(this._ScrollData.offsetX-48)},n.prototype.MouseWheelRight=function(){return this.SetHorizontalOffset(this._ScrollData.offsetX+48)},n.prototype.PageUp=function(){return this.SetVerticalOffset(this._ScrollData.offsetY-this._ScrollData.viewportHeight)},n.prototype.PageDown=function(){return this.SetVerticalOffset(this._ScrollData.offsetY+this._ScrollData.viewportHeight)},n.prototype.PageLeft=function(){return this.SetHorizontalOffset(this._ScrollData.offsetX-this._ScrollData.viewportWidth)},n.prototype.PageRight=function(){return this.SetHorizontalOffset(this._ScrollData.offsetX+this._ScrollData.viewportWidth)},n.prototype.MakeVisible=function(e,t){var n=new minerva.Rect;if(minerva.Rect.isEmpty(t)||!e||e===this||!this.XamlNode.IsAncestorOf(e.XamlNode))return n;var r=e.TransformToVisual(this),o=r.Transform(t);return minerva.Size.copyTo(t,n),minerva.Point.copyTo(o,n),n},n.prototype.SetHorizontalOffset=function(e){if(isNaN(e))throw new ArgumentException("Offset is not a number.");var t=this._ScrollData;return t.canHorizontallyScroll?(e=Math.max(0,Math.min(e,t.extentWidth-t.viewportWidth)),NumberEx.AreClose(this._ScrollData.offsetX,e)?!1:(t.cachedOffsetX=e,this.XamlNode.LayoutUpdater.invalidateArrange(),!0)):!1},n.prototype.SetVerticalOffset=function(e){if(isNaN(e))throw new ArgumentException("Offset is not a number.");var t=this._ScrollData;return t.canVerticallyScroll?(e=Math.max(0,Math.min(e,t.extentHeight-t.viewportHeight)),NumberEx.AreClose(this._ScrollData.offsetY,e)?!1:(t.cachedOffsetY=e,this.XamlNode.LayoutUpdater.invalidateArrange(),!0)):!1},n.prototype.OnApplyTemplate=function(){e.prototype.OnApplyTemplate.call(this);var n;if(this.TemplateOwner instanceof t.ScrollViewer){n=this.TemplateOwner;var r=this.Content,o=t.Primitives.IScrollInfo_.as(r);if(!o&&r instanceof t.ItemsPresenter){var i=r,a=new BError;i.XamlNode.ApplyTemplateWithError(a),a.Message&&a.ThrowException(),o=t.Primitives.IScrollInfo_.as(i.Panel)}o||(o=this),o.CanHorizontallyScroll=n.HorizontalScrollBarVisibility!==t.ScrollBarVisibility.Disabled,o.CanVerticallyScroll=n.VerticalScrollBarVisibility!==t.ScrollBarVisibility.Disabled,o.ScrollOwner=n,n.ScrollInfo=o,n.InvalidateScrollInfo()}},n}(t.ContentPresenter);t.ScrollContentPresenter=n,e.CoreLibrary.add(n),nullstone.addTypeInterfaces(n,t.Primitives.IScrollInfo_)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){function r(e,t,n){return"number"!=typeof n?!1:isNaN(n)?!1:isFinite(n)?!0:!1}function o(e,t,n){return r(e,t,n)?n>=0:!1}var i=function(n){function i(){var r=this;n.call(this),this.ValueChanged=new e.RoutedPropertyChangedEvent,this._Coercer=new t.Internal.RangeCoercer(this,function(e){return r.SetCurrentValue(i.MaximumProperty,e)},function(e){return r.SetCurrentValue(i.ValueProperty,e)})}return __extends(i,n),i.prototype.OnMinimumChanged=function(e,t){},i.prototype.OnMaximumChanged=function(e,t){},i.prototype.OnValueChanged=function(t,n){this.ValueChanged.raise(this,new e.RoutedPropertyChangedEventArgs(t,n))},i.MinimumProperty=DependencyProperty.RegisterFull("Minimum",function(){return Number},i,0,function(e,t){return e._Coercer.OnMinimumChanged(t.OldValue,t.NewValue)},void 0,!1,r),i.MaximumProperty=DependencyProperty.RegisterFull("Maximum",function(){return Number},i,1,function(e,t){return e._Coercer.OnMaximumChanged(t.OldValue,t.NewValue)},void 0,!1,r),i.LargeChangeProperty=DependencyProperty.RegisterFull("LargeChange",function(){return Number},i,1,void 0,void 0,!1,o),i.SmallChangeProperty=DependencyProperty.RegisterFull("SmallChange",function(){return Number},i,.1,void 0,void 0,!1,o),i.ValueProperty=DependencyProperty.RegisterFull("Value",function(){return Number},i,0,function(e,t){return e._Coercer.OnValueChanged(t.OldValue,t.NewValue)},void 0,!1,r),i}(t.Control);n.RangeBase=i,e.CoreLibrary.add(i)}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(){n.call(this),this._KeyboardCausingRepeat=!1,this._MouseCausingRepeat=!1,this._MousePosition=null,this._IntervalID=null,this._NewInterval=null,this.ClickMode=t.ClickMode.Press,this.DefaultStyleKey=r}return __extends(r,n),r.prototype.OnApplyTemplate=function(){n.prototype.OnApplyTemplate.call(this),this.UpdateVisualState(!1)},r.prototype.OnDelayChanged=function(e){if(e.NewValue<0)throw new ArgumentException("Delay Property cannot be negative.")},r.prototype.OnIntervalChanged=function(e){if(e.NewValue<0)throw new ArgumentException("Interval Property cannot be negative.");this._NewInterval=e.NewValue},r.prototype.OnIsEnabledChanged=function(e){n.prototype.OnIsEnabledChanged.call(this,e),this._KeyboardCausingRepeat=!1,this._MouseCausingRepeat=!1,this._UpdateRepeatState()},r.prototype.OnKeyDown=function(r){r.Key===e.Input.Key.Space&&this.ClickMode!==t.ClickMode.Hover&&(this._KeyboardCausingRepeat=!0,this._UpdateRepeatState()),n.prototype.OnKeyDown.call(this,r)},r.prototype.OnKeyUp=function(r){n.prototype.OnKeyUp.call(this,r),r.Key===e.Input.Key.Space&&this.ClickMode!==t.ClickMode.Hover&&(this._KeyboardCausingRepeat=!1,this._UpdateRepeatState()),this.UpdateVisualState()},r.prototype.OnLostFocus=function(e){n.prototype.OnLostFocus.call(this,e),this.ClickMode!==t.ClickMode.Hover&&(this._KeyboardCausingRepeat=!1,this._MouseCausingRepeat=!1,this._UpdateRepeatState())},r.prototype.OnMouseEnter=function(e){n.prototype.OnMouseEnter.call(this,e),this.ClickMode===t.ClickMode.Hover&&(this._MouseCausingRepeat=!0,this._UpdateRepeatState()),this.UpdateVisualState(),this._UpdateMousePosition(e)},r.prototype.OnMouseLeave=function(e){n.prototype.OnMouseLeave.call(this,e),this.ClickMode===t.ClickMode.Hover&&(this._MouseCausingRepeat=!1,this._UpdateRepeatState()),this.UpdateVisualState()},r.prototype.OnMouseLeftButtonDown=function(e){e.Handled||(n.prototype.OnMouseLeftButtonDown.call(this,e),this.ClickMode!==t.ClickMode.Hover&&(this._MouseCausingRepeat=!0,this._UpdateRepeatState()))},r.prototype.OnMouseLeftButtonUp=function(e){e.Handled||(n.prototype.OnMouseLeftButtonUp.call(this,e),this.ClickMode!==t.ClickMode.Hover&&(this._MouseCausingRepeat=!1,this._UpdateRepeatState()),this.UpdateVisualState())},r.prototype.OnMouseMove=function(e){this._UpdateMousePosition(e)},r.prototype._UpdateMousePosition=function(t){for(var n=this.XamlNode,r=n;n instanceof e.FENode;)r=n,n=n.ParentNode;this._MousePosition=t.GetPosition(r.XObject)},r.prototype._UpdateRepeatState=function(){var e=this;this._MouseCausingRepeat||this._KeyboardCausingRepeat?null==this._IntervalID&&(this._IntervalID=window.setInterval(function(){return e._StartRepeatingAfterDelay()},this.Delay)):(null!=this._IntervalID&&window.clearInterval(this._IntervalID),this._IntervalID=null)},r.prototype._StartRepeatingAfterDelay=function(){var e=this;window.clearInterval(this._IntervalID),this._IntervalID=window.setInterval(function(){return e._OnTimeout()},this.Interval)},r.prototype._OnTimeout=function(){var t=this;if(null!=this._NewInterval&&(window.clearInterval(this._IntervalID),this._IntervalID=window.setInterval(function(){return t._OnTimeout()},this._NewInterval),this._NewInterval=null),this.IsPressed){if(this._KeyboardCausingRepeat)return void this.OnClick();var n=e.VisualTreeHelper.FindElementsInHostCoordinates(this._MousePosition,this);n.indexOf(this)>-1&&this.OnClick()}},r.DelayProperty=DependencyProperty.Register("Delay",function(){return Number},r,500,function(e,t){return e.OnDelayChanged(t)}),r.IntervalProperty=DependencyProperty.Register("Interval",function(){return Number},r,33,function(e,t){return e.OnIntervalChanged(t)}),r}(n.ButtonBase);n.RepeatButton=r,e.CoreLibrary.add(r),t.TemplateVisualStates(r,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Pressed"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"})}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(t){function r(){t.call(this),this._PreviousPosition=null,this._Origin=null,this.DragCompleted=new e.RoutedEvent,this.DragDelta=new e.RoutedEvent,this.DragStarted=new e.RoutedEvent,this.DefaultStyleKey=r}return __extends(r,t),r.prototype.OnApplyTemplate=function(){t.prototype.OnApplyTemplate.call(this),this.UpdateVisualState(!1)},r.prototype.OnDraggingChanged=function(e){this.UpdateVisualState()},r.prototype.OnGotFocus=function(n){t.prototype.OnGotFocus.call(this,n),this._FocusChanged(e.Surface.HasFocus(this))},r.prototype.OnLostFocus=function(n){t.prototype.OnLostFocus.call(this,n),this._FocusChanged(e.Surface.HasFocus(this))},r.prototype._FocusChanged=function(e){this.SetCurrentValue(r.IsFocusedProperty,e),this.UpdateVisualState()},r.prototype.OnLostMouseCapture=function(e){this.IsDragging&&this.IsEnabled&&(this.SetCurrentValue(r.IsDraggingProperty,!1),this._RaiseDragCompleted(!1))},r.prototype.OnMouseEnter=function(e){this.IsEnabled&&this.UpdateVisualState()},r.prototype.OnMouseLeave=function(e){this.IsEnabled&&this.UpdateVisualState()},r.prototype.OnMouseLeftButtonDown=function(e){if(t.prototype.OnMouseLeftButtonDown.call(this,e),!e.Handled&&!this.IsDragging&&this.IsEnabled){e.Handled=!0,this.CaptureMouse(),this.SetCurrentValue(r.IsDraggingProperty,!0);var n=this.XamlNode.VisualParentNode;this._Origin=this._PreviousPosition=e.GetPosition(n?n.XObject:void 0);var o=!1;try{this._RaiseDragStarted(),o=!0}finally{o||this.CancelDrag()}}},r.prototype.OnMouseMove=function(e){if(this.IsDragging){var t=this.XamlNode.VisualParentNode,n=e.GetPosition(t?t.XObject:void 0);minerva.Point.isEqual(n,this._PreviousPosition)||(this._RaiseDragDelta(n.x-this._PreviousPosition.x,n.y-this._PreviousPosition.y),this._PreviousPosition=n)}},r.prototype.OnLostTouchCapture=function(e){t.prototype.OnLostTouchCapture.call(this,e),this.IsDragging&&this.IsEnabled&&(this.SetCurrentValue(r.IsDraggingProperty,!1),this._RaiseDragCompleted(!1))},r.prototype.OnTouchEnter=function(e){t.prototype.OnTouchEnter.call(this,e),this.IsEnabled&&this.UpdateVisualState()},r.prototype.OnTouchLeave=function(e){t.prototype.OnTouchLeave.call(this,e),this.IsEnabled&&this.UpdateVisualState()},r.prototype.OnTouchDown=function(e){if(t.prototype.OnTouchDown.call(this,e),!e.Handled&&!this.IsDragging&&this.IsEnabled){e.Handled=!0,e.Device.Capture(this),this.SetCurrentValue(r.IsDraggingProperty,!0);var n=this.XamlNode.VisualParentNode,o=e.GetTouchPoint(n?n.XObject:void 0);this._Origin=this._PreviousPosition=o.Position;var i=!1;try{this._RaiseDragStarted(),i=!0}finally{i||this.CancelDrag()}}},r.prototype.OnTouchUp=function(e){t.prototype.OnTouchUp.call(this,e),!e.Handled&&this.IsDragging&&this.IsEnabled&&(e.Handled=!0,e.Device.ReleaseCapture(this))},r.prototype.OnTouchMove=function(e){if(t.prototype.OnTouchMove.call(this,e),this.IsDragging&&e.Device.Captured===this){var n=this.XamlNode.VisualParentNode,r=e.Device.GetTouchPoint(n?n.XObject:void 0),o=r.Position;minerva.Point.isEqual(o,this._PreviousPosition)||(this._RaiseDragDelta(o.x-this._PreviousPosition.x,o.y-this._PreviousPosition.y),this._PreviousPosition=o)}},r.prototype.CancelDrag=function(){this.IsDragging&&(this.SetCurrentValue(r.IsDraggingProperty,!1),this._RaiseDragCompleted(!0))},r.prototype._RaiseDragStarted=function(){this.DragStarted.raise(this,new n.DragStartedEventArgs(this._Origin.x,this._Origin.y))},r.prototype._RaiseDragDelta=function(e,t){this.DragDelta.raise(this,new n.DragDeltaEventArgs(e,t))},r.prototype._RaiseDragCompleted=function(e){this.DragCompleted.raise(this,new n.DragCompletedEventArgs(this._PreviousPosition.x-this._Origin.x,this._PreviousPosition.y-this._Origin.y,e))},r.prototype.GoToStateCommon=function(e){return e(this.IsEnabled?this.IsDragging?"Pressed":this.IsMouseOver?"MouseOver":"Normal":"Disabled")},r.IsDraggingProperty=DependencyProperty.RegisterReadOnly("IsDragging",function(){return Boolean},r,!1,function(e,t){return e.OnDraggingChanged(t)}),r.IsFocusedProperty=DependencyProperty.RegisterReadOnly("IsFocused",function(){return Boolean},r),r}(t.Control);n.Thumb=r,e.CoreLibrary.add(r),t.TemplateVisualStates(r,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Pressed"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"})}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(t){function r(){t.call(this),this._DragValue=0,this.Scroll=new e.RoutedEvent,this.DefaultStyleKey=r,this.SizeChanged.on(this._HandleSizeChanged,this)}return __extends(r,t),Object.defineProperty(r.prototype,"IsDragging",{get:function(){return this.$HorizontalThumb?this.$HorizontalThumb.IsDragging:this.$VerticalThumb?this.$VerticalThumb.IsDragging:!1},enumerable:!0,configurable:!0}),r.prototype.OnApplyTemplate=function(){t.prototype.OnApplyTemplate.call(this),this.$HorizontalTemplate=this.GetTemplateChild("HorizontalRoot",e.FrameworkElement),this.$HorizontalLargeIncrease=this.GetTemplateChild("HorizontalLargeIncrease",n.RepeatButton),this.$HorizontalLargeDecrease=this.GetTemplateChild("HorizontalLargeDecrease",n.RepeatButton),this.$HorizontalSmallIncrease=this.GetTemplateChild("HorizontalSmallIncrease",n.RepeatButton),this.$HorizontalSmallDecrease=this.GetTemplateChild("HorizontalSmallDecrease",n.RepeatButton),this.$HorizontalThumb=this.GetTemplateChild("HorizontalThumb",n.Thumb),this.$VerticalTemplate=this.GetTemplateChild("VerticalRoot",e.FrameworkElement),this.$VerticalLargeIncrease=this.GetTemplateChild("VerticalLargeIncrease",n.RepeatButton),this.$VerticalLargeDecrease=this.GetTemplateChild("VerticalLargeDecrease",n.RepeatButton),this.$VerticalSmallIncrease=this.GetTemplateChild("VerticalSmallIncrease",n.RepeatButton),this.$VerticalSmallDecrease=this.GetTemplateChild("VerticalSmallDecrease",n.RepeatButton),this.$VerticalThumb=this.GetTemplateChild("VerticalThumb",n.Thumb),this.$HorizontalThumb&&(this.$HorizontalThumb.DragStarted.on(this._OnThumbDragStarted,this),this.$HorizontalThumb.DragDelta.on(this._OnThumbDragDelta,this),this.$HorizontalThumb.DragCompleted.on(this._OnThumbDragCompleted,this)),this.$HorizontalLargeIncrease&&this.$HorizontalLargeIncrease.Click.on(this._LargeIncrement,this),this.$HorizontalLargeDecrease&&this.$HorizontalLargeDecrease.Click.on(this._LargeDecrement,this),this.$HorizontalSmallIncrease&&this.$HorizontalSmallIncrease.Click.on(this._SmallIncrement,this),this.$HorizontalSmallDecrease&&this.$HorizontalSmallDecrease.Click.on(this._SmallDecrement,this),this.$VerticalThumb&&(this.$VerticalThumb.DragStarted.on(this._OnThumbDragStarted,this),this.$VerticalThumb.DragDelta.on(this._OnThumbDragDelta,this),this.$VerticalThumb.DragCompleted.on(this._OnThumbDragCompleted,this)),this.$VerticalLargeIncrease&&this.$VerticalLargeIncrease.Click.on(this._LargeIncrement,this),this.$VerticalLargeDecrease&&this.$VerticalLargeDecrease.Click.on(this._LargeDecrement,this),this.$VerticalSmallIncrease&&this.$VerticalSmallIncrease.Click.on(this._SmallIncrement,this),this.$VerticalSmallDecrease&&this.$VerticalSmallDecrease.Click.on(this._SmallDecrement,this),this._OnOrientationChanged(),this.UpdateVisualState(!1)},r.prototype.OnMaximumChanged=function(e,n){t.prototype.OnMaximumChanged.call(this,e,n),this._UpdateTrackLayout()},r.prototype.OnMinimumChanged=function(e,n){t.prototype.OnMinimumChanged.call(this,e,n),this._UpdateTrackLayout()},r.prototype.OnValueChanged=function(e,n){t.prototype.OnValueChanged.call(this,e,n),this._UpdateTrackLayout()},r.prototype._OnThumbDragStarted=function(e,t){this._DragValue=this.Value},r.prototype._OnThumbDragDelta=function(t,r){var o=0,i=1,a=i,s=this.Maximum,u=this.Minimum,l=s-u,c=this._GetTrackLength(),p=this.Orientation===e.Orientation.Horizontal;if(this.$VerticalThumb&&!p&&(o=a*r.VerticalChange/(c-this.$VerticalThumb.ActualHeight)*l),this.$HorizontalThumb&&p&&(o=a*r.HorizontalChange/(c-this.$HorizontalThumb.ActualWidth)*l),!isNaN(o)&&isFinite(o)){this._DragValue+=o;var d=Math.min(s,Math.max(u,this._DragValue));d!==this.Value&&(this.Value=d,this._RaiseScroll(n.ScrollEventType.ThumbTrack))}},r.prototype._OnThumbDragCompleted=function(e,t){this._RaiseScroll(n.ScrollEventType.EndScroll)},r.prototype._SmallDecrement=function(e,t){var r=this.Value,o=Math.max(r-this.SmallChange,this.Minimum);r!==o&&(this.SetCurrentValue(n.RangeBase.ValueProperty,o),this._RaiseScroll(n.ScrollEventType.SmallDecrement))},r.prototype._SmallIncrement=function(e,t){var r=this.Value,o=Math.min(r+this.SmallChange,this.Maximum);r!==o&&(this.SetCurrentValue(n.RangeBase.ValueProperty,o),this._RaiseScroll(n.ScrollEventType.SmallIncrement))},r.prototype._LargeDecrement=function(e,t){var r=this.Value,o=Math.max(r-this.LargeChange,this.Minimum);r!==o&&(this.SetCurrentValue(n.RangeBase.ValueProperty,o),this._RaiseScroll(n.ScrollEventType.LargeDecrement));
},r.prototype._LargeIncrement=function(e,t){var r=this.Value,o=Math.min(r+this.LargeChange,this.Maximum);r!==o&&(this.SetCurrentValue(n.RangeBase.ValueProperty,o),this._RaiseScroll(n.ScrollEventType.LargeIncrement))},r.prototype._HandleSizeChanged=function(e,t){this._UpdateTrackLayout()},r.prototype._OnOrientationChanged=function(){var t=this.Orientation===e.Orientation.Horizontal;this.$HorizontalTemplate&&(this.$HorizontalTemplate.Visibility=t?e.Visibility.Visible:e.Visibility.Collapsed),this.$VerticalTemplate&&(this.$VerticalTemplate.Visibility=t?e.Visibility.Collapsed:e.Visibility.Visible),this._UpdateTrackLayout()},r.prototype._UpdateTrackLayout=function(){var t=this._GetTrackLength(),n=this.Maximum,r=this.Minimum,o=this.Value,i=(o-r)/(n-r),a=this._UpdateThumbSize(t),s=this.Orientation===e.Orientation.Horizontal;s&&this.$HorizontalLargeDecrease&&this.$HorizontalThumb?this.$HorizontalLargeDecrease.Width=Math.max(0,i*(t-a)):!s&&this.$VerticalLargeDecrease&&this.$VerticalThumb&&(this.$VerticalLargeDecrease.Height=Math.max(0,i*(t-a)))},r.prototype._UpdateThumbSize=function(t){var n=Number.NaN,r=0>=t;if(t>0){var o=this.Orientation===e.Orientation.Horizontal,i=this.Maximum,a=this.Minimum;o&&this.$HorizontalThumb?(i-a!==0&&(n=Math.max(this.$HorizontalThumb.MinWidth,this._ConvertViewportSizeToDisplayUnits(t))),i-a===0||n>this.ActualWidth||t<=this.$HorizontalThumb.MinWidth?r=!0:(this.$HorizontalThumb.Visibility=e.Visibility.Visible,this.$HorizontalThumb.Width=n)):!o&&this.$VerticalThumb&&(i-a!==0&&(n=Math.max(this.$VerticalThumb.MinHeight,this._ConvertViewportSizeToDisplayUnits(t))),i-a===0||n>this.ActualHeight||t<=this.$VerticalThumb.MinHeight?r=!0:(this.$VerticalThumb.Visibility=e.Visibility.Visible,this.$VerticalThumb.Height=n))}return r&&(this.$HorizontalThumb&&(this.$HorizontalThumb.Visibility=e.Visibility.Collapsed),this.$VerticalThumb&&(this.$VerticalThumb.Visibility=e.Visibility.Collapsed)),n},r.prototype._GetTrackLength=function(){var t=NaN;if(this.Orientation===e.Orientation.Horizontal){if(t=this.ActualWidth,this.$HorizontalSmallDecrease){var n=this.$HorizontalSmallDecrease.Margin;t-=this.$HorizontalSmallDecrease.ActualWidth+n.left+n.right}if(this.$HorizontalSmallIncrease){var n=this.$HorizontalSmallIncrease.Margin;t-=this.$HorizontalSmallIncrease.ActualWidth+n.left+n.right}}else{if(t=this.ActualHeight,this.$VerticalSmallDecrease){var n=this.$VerticalSmallDecrease.Margin;t-=this.$VerticalSmallDecrease.ActualHeight+n.top+n.bottom}if(this.$VerticalSmallIncrease){var n=this.$VerticalSmallIncrease.Margin;t-=this.$VerticalSmallIncrease.ActualHeight+n.top+n.bottom}}return t},r.prototype._ConvertViewportSizeToDisplayUnits=function(e){var t=this.ViewportSize;return e*t/(t+this.Maximum-this.Minimum)},r.prototype._RaiseScroll=function(e){var t=new n.ScrollEventArgs(e,this.Value);t.OriginalSource=this,this.Scroll.raise(this,t)},r.OrientationProperty=DependencyProperty.Register("Orientation",function(){return new e.Enum(e.Orientation)},r,e.Orientation.Horizontal,function(e,t){return e._OnOrientationChanged()}),r.ViewportSizeProperty=DependencyProperty.Register("ViewportSize",function(){return Number},r,0,function(e,t){return e._UpdateTrackLayout()}),r}(n.RangeBase);n.ScrollBar=r,e.CoreLibrary.add(r),t.TemplateVisualStates(r,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Disabled"}),t.TemplateParts(r,{Name:"VerticalRoot",Type:e.FrameworkElement},{Name:"VerticalLargeIncrease",Type:n.RepeatButton},{Name:"VerticalLargeDecrease",Type:n.RepeatButton},{Name:"VerticalSmallIncrease",Type:n.RepeatButton},{Name:"VerticalSmallDecrease",Type:n.RepeatButton},{Name:"VerticalThumb",Type:n.Thumb},{Name:"HorizontalRoot",Type:e.FrameworkElement},{Name:"HorizontalLargeIncrease",Type:n.RepeatButton},{Name:"HorizontalLargeDecrease",Type:n.RepeatButton},{Name:"HorizontalSmallIncrease",Type:n.RepeatButton},{Name:"HorizontalSmallDecrease",Type:n.RepeatButton},{Name:"HorizontalThumb",Type:n.Thumb})}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this.$TemplatedParentHandlesScrolling=!1,this._Delta=new Point,this._TouchInitialOffset=new Point,this.DefaultStyleKey=r}return __extends(r,n),r._ScrollBarVisibilityChanged=function(e,n){if(e){if(e instanceof r){var o=e;o.XamlNode.LayoutUpdater.invalidateMeasure();var i=o.ScrollInfo;return i&&(i.CanHorizontallyScroll=o.HorizontalScrollBarVisibility!==t.ScrollBarVisibility.Disabled,i.CanVerticallyScroll=o.VerticalScrollBarVisibility!==t.ScrollBarVisibility.Disabled),void o._UpdateScrollBarVisibility()}if(e instanceof t.ListBox){var a=e;return void(a.$TemplateScrollViewer&&a.$TemplateScrollViewer.SetValue(n.Property,n.NewValue))}}},r.GetHorizontalScrollBarVisibility=function(e){return e.GetValue(r.HorizontalScrollBarVisibilityProperty)},r.SetHorizontalScrollBarVisibility=function(e,t){e.SetValue(r.HorizontalScrollBarVisibilityProperty,t)},Object.defineProperty(r.prototype,"HorizontalScrollBarVisibility",{get:function(){return this.GetValue(r.HorizontalScrollBarVisibilityProperty)},set:function(e){this.SetValue(r.HorizontalScrollBarVisibilityProperty,e)},enumerable:!0,configurable:!0}),r.GetVerticalScrollBarVisibility=function(e){return e.GetValue(r.VerticalScrollBarVisibilityProperty)},r.SetVerticalScrollBarVisibility=function(e,t){e.SetValue(r.VerticalScrollBarVisibilityProperty,t)},Object.defineProperty(r.prototype,"VerticalScrollBarVisibility",{get:function(){return this.GetValue(r.VerticalScrollBarVisibilityProperty)},set:function(e){this.SetValue(r.VerticalScrollBarVisibilityProperty,e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"ScrollInfo",{get:function(){return this._ScrollInfo},set:function(e){this._ScrollInfo=e,e&&(e.CanHorizontallyScroll=this.HorizontalScrollBarVisibility!==t.ScrollBarVisibility.Disabled,e.CanVerticallyScroll=this.VerticalScrollBarVisibility!==t.ScrollBarVisibility.Disabled)},enumerable:!0,configurable:!0}),r.prototype.InvalidateScrollInfo=function(){var t=this.ScrollInfo;t&&(this.SetCurrentValue(r.ExtentWidthProperty,t.ExtentWidth),this.SetCurrentValue(r.ExtentHeightProperty,t.ExtentHeight),this.SetCurrentValue(r.ViewportWidthProperty,t.ViewportWidth),this.SetCurrentValue(r.ViewportHeightProperty,t.ViewportHeight),this._UpdateScrollBar(e.Orientation.Horizontal,t.HorizontalOffset),this._UpdateScrollBar(e.Orientation.Vertical,t.VerticalOffset),this._UpdateScrollBarVisibility());var n=this.XamlNode.LayoutUpdater,o=Math.max(0,this.ExtentWidth-this.ViewportWidth);o!==this.ScrollableWidth&&(this.SetCurrentValue(r.ScrollableWidthProperty,o),n.invalidateMeasure());var i=Math.max(0,this.ExtentHeight-this.ViewportHeight);i!==this.ScrollableHeight&&(this.SetCurrentValue(r.ScrollableHeightProperty,i),n.invalidateMeasure())},r.prototype._UpdateScrollBarVisibility=function(){var n=this.XamlNode.LayoutUpdater,o=this.ScrollInfo,i=e.Visibility.Visible,a=this.HorizontalScrollBarVisibility;switch(a){case t.ScrollBarVisibility.Visible:break;case t.ScrollBarVisibility.Disabled:case t.ScrollBarVisibility.Hidden:i=e.Visibility.Collapsed;break;case t.ScrollBarVisibility.Auto:default:i=!o||o.ExtentWidth<=o.ViewportWidth?e.Visibility.Collapsed:e.Visibility.Visible}i!==this.ComputedHorizontalScrollBarVisibility&&(this.SetCurrentValue(r.ComputedHorizontalScrollBarVisibilityProperty,i),n.invalidateMeasure());var s=e.Visibility.Visible,u=this.VerticalScrollBarVisibility;switch(u){case t.ScrollBarVisibility.Visible:break;case t.ScrollBarVisibility.Disabled:case t.ScrollBarVisibility.Hidden:s=e.Visibility.Collapsed;break;case t.ScrollBarVisibility.Auto:default:s=!o||o.ExtentHeight<=o.ViewportHeight?e.Visibility.Collapsed:e.Visibility.Visible}s!==this.ComputedVerticalScrollBarVisibility&&(this.SetCurrentValue(r.ComputedVerticalScrollBarVisibilityProperty,s),n.invalidateMeasure())},r.prototype._UpdateScrollBar=function(n,o){var i,a;n===e.Orientation.Horizontal?(i=r.HorizontalOffsetProperty,a=this.$HorizontalScrollBar):(i=r.VerticalOffsetProperty,a=this.$VerticalScrollBar);try{this.SetCurrentValue(i,o),a&&a.SetCurrentValue(t.Primitives.RangeBase.ValueProperty,o)}finally{}},r.prototype.OnApplyTemplate=function(){var r=this;n.prototype.OnApplyTemplate.call(this),this.$ScrollContentPresenter=this.GetTemplateChild("ScrollContentPresenter",t.ScrollContentPresenter),this.$HorizontalScrollBar=this.GetTemplateChild("HorizontalScrollBar",t.Primitives.ScrollBar),this.$HorizontalScrollBar&&this.$HorizontalScrollBar.Scroll.on(function(t,n){return r._HandleScroll(e.Orientation.Horizontal,n)},this),this.$VerticalScrollBar=this.GetTemplateChild("VerticalScrollBar",t.Primitives.ScrollBar),this.$VerticalScrollBar&&this.$VerticalScrollBar.Scroll.on(function(t,n){return r._HandleScroll(e.Orientation.Vertical,n)},this),this._UpdateScrollBarVisibility()},r.prototype.OnMouseLeftButtonDown=function(e){!e.Handled&&this.Focus()&&(e.Handled=!0),n.prototype.OnMouseLeftButtonDown.call(this,e)},r.prototype.OnMouseWheel=function(e){if(n.prototype.OnMouseWheel.call(this,e),!e.Handled){var t=this.ScrollInfo;t&&(e.Delta>0&&0!==t.VerticalOffset||e.Delta<0&&t.VerticalOffset<this.ScrollableHeight)&&(e.Delta>=0?t.MouseWheelUp():t.MouseWheelDown(),e.Handled=!0)}},r.prototype.OnTouchDown=function(e){n.prototype.OnTouchDown.call(this,e);var t=this.ScrollInfo;if(!e.Handled&&this.IsEnabled&&t){e.Handled=!0,this.Focus(),e.Device.Capture(this);var r=this._TouchInitialOffset;r.x=t.HorizontalOffset,r.y=t.VerticalOffset,this._TouchOrigin=e.GetTouchPoint(this).Position}},r.prototype.OnTouchUp=function(e){n.prototype.OnTouchUp.call(this,e),!e.Handled&&this.IsEnabled&&(e.Handled=!0,e.Device.ReleaseCapture(this))},r.prototype.OnTouchMove=function(e){if(n.prototype.OnTouchMove.call(this,e),!e.Handled&&e.Device.Captured===this){var t=e.GetTouchPoint(this),r=t.Position,o=this._Delta,i=this._TouchOrigin;o.x=r.x-i.x,o.y=r.y-i.y,this.ScrollToHorizontalOffset(o.x),this.ScrollToVerticalOffset(o.y)}},r.prototype.OnKeyDown=function(r){if(n.prototype.OnKeyDown.call(this,r),!r.Handled&&!this.$TemplatedParentHandlesScrolling){var o=e.Orientation.Vertical,i=t.Primitives.ScrollEventType.ThumbTrack;switch(r.Key){case e.Input.Key.PageUp:i=t.Primitives.ScrollEventType.LargeDecrement;break;case e.Input.Key.PageDown:i=t.Primitives.ScrollEventType.LargeIncrement;break;case e.Input.Key.End:r.Modifiers.Ctrl||(o=e.Orientation.Horizontal),i=t.Primitives.ScrollEventType.Last;break;case e.Input.Key.Home:r.Modifiers.Ctrl||(o=e.Orientation.Horizontal),i=t.Primitives.ScrollEventType.First;break;case e.Input.Key.Left:o=e.Orientation.Horizontal,i=t.Primitives.ScrollEventType.SmallDecrement;case e.Input.Key.Up:i=t.Primitives.ScrollEventType.SmallDecrement;break;case e.Input.Key.Right:o=e.Orientation.Horizontal,i=t.Primitives.ScrollEventType.SmallIncrement;case e.Input.Key.Down:i=t.Primitives.ScrollEventType.SmallIncrement}i!==t.Primitives.ScrollEventType.ThumbTrack&&(r.Handled=!!this._HandleScroll(o,new t.Primitives.ScrollEventArgs(i,0)))}},r.prototype.ScrollInDirection=function(t){switch(t){case e.Input.Key.PageUp:this.PageUp();break;case e.Input.Key.PageDown:this.PageDown();break;case e.Input.Key.End:this.PageEnd();break;case e.Input.Key.Home:this.PageHome();break;case e.Input.Key.Left:this.LineLeft();break;case e.Input.Key.Up:this.LineUp();break;case e.Input.Key.Right:this.LineRight();break;case e.Input.Key.Down:this.LineDown()}},r.prototype.ScrollToHorizontalOffset=function(e){this._HandleHorizontalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.ThumbPosition,e))},r.prototype.ScrollToVerticalOffset=function(e){this._HandleVerticalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.ThumbPosition,e))},r.prototype.LineUp=function(){this._HandleVerticalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.SmallDecrement,0))},r.prototype.LineDown=function(){this._HandleVerticalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.SmallIncrement,0))},r.prototype.LineLeft=function(){this._HandleHorizontalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.SmallDecrement,0))},r.prototype.LineRight=function(){this._HandleHorizontalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.SmallIncrement,0))},r.prototype.PageHome=function(){this._HandleHorizontalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.First,0))},r.prototype.PageEnd=function(){this._HandleHorizontalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.Last,0))},r.prototype.PageUp=function(){this._HandleVerticalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.LargeDecrement,0))},r.prototype.PageDown=function(){this._HandleVerticalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.LargeIncrement,0))},r.prototype.PageLeft=function(){this._HandleHorizontalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.LargeDecrement,0))},r.prototype.PageRight=function(){this._HandleHorizontalScroll(new t.Primitives.ScrollEventArgs(t.Primitives.ScrollEventType.LargeIncrement,0))},r.prototype._HandleScroll=function(t,n){return t!==e.Orientation.Horizontal?this._HandleVerticalScroll(n):this._HandleHorizontalScroll(n)},r.prototype._HandleHorizontalScroll=function(e){var n=this.ScrollInfo;if(!n)return!1;var r=n.HorizontalOffset,o=r;switch(e.ScrollEventType){case t.Primitives.ScrollEventType.SmallDecrement:return n.LineLeft();case t.Primitives.ScrollEventType.SmallIncrement:return n.LineRight();case t.Primitives.ScrollEventType.LargeDecrement:return n.PageLeft();case t.Primitives.ScrollEventType.LargeIncrement:return n.PageRight();case t.Primitives.ScrollEventType.ThumbPosition:case t.Primitives.ScrollEventType.ThumbTrack:o=e.Value;break;case t.Primitives.ScrollEventType.First:o=Number.NEGATIVE_INFINITY;break;case t.Primitives.ScrollEventType.Last:o=Number.POSITIVE_INFINITY}return o=Math.max(o,0),o=Math.min(this.ScrollableWidth,o),NumberEx.AreClose(r,o)?!1:(n.SetHorizontalOffset(o),!0)},r.prototype._HandleVerticalScroll=function(e){var n=this.ScrollInfo;if(!n)return!1;var r=n.VerticalOffset,o=r;switch(e.ScrollEventType){case t.Primitives.ScrollEventType.SmallDecrement:return n.LineUp();case t.Primitives.ScrollEventType.SmallIncrement:return n.LineDown();case t.Primitives.ScrollEventType.LargeDecrement:return n.PageUp();case t.Primitives.ScrollEventType.LargeIncrement:return n.PageDown();case t.Primitives.ScrollEventType.ThumbPosition:case t.Primitives.ScrollEventType.ThumbTrack:o=e.Value;break;case t.Primitives.ScrollEventType.First:o=Number.NEGATIVE_INFINITY;break;case t.Primitives.ScrollEventType.Last:o=Number.POSITIVE_INFINITY}return o=Math.max(o,0),o=Math.min(this.ScrollableHeight,o),NumberEx.AreClose(r,o)?!1:n.SetVerticalOffset(o)},r.HorizontalScrollBarVisibilityProperty=DependencyProperty.RegisterAttachedCore("HorizontalScrollBarVisibility",function(){return new e.Enum(t.ScrollBarVisibility)},r,t.ScrollBarVisibility.Disabled,r._ScrollBarVisibilityChanged),r.VerticalScrollBarVisibilityProperty=DependencyProperty.RegisterAttachedCore("VerticalScrollBarVisibility",function(){return new e.Enum(t.ScrollBarVisibility)},r,t.ScrollBarVisibility.Disabled,r._ScrollBarVisibilityChanged),r.ComputedHorizontalScrollBarVisibilityProperty=DependencyProperty.RegisterReadOnlyCore("ComputedHorizontalScrollBarVisibility",function(){return new e.Enum(e.Visibility)},r),r.ComputedVerticalScrollBarVisibilityProperty=DependencyProperty.RegisterReadOnlyCore("ComputedVerticalScrollBarVisibility",function(){return new e.Enum(e.Visibility)},r),r.HorizontalOffsetProperty=DependencyProperty.RegisterReadOnlyCore("HorizontalOffset",function(){return Number},r),r.VerticalOffsetProperty=DependencyProperty.RegisterReadOnlyCore("VerticalOffset",function(){return Number},r),r.ScrollableWidthProperty=DependencyProperty.RegisterReadOnlyCore("ScrollableWidth",function(){return Number},r),r.ScrollableHeightProperty=DependencyProperty.RegisterReadOnlyCore("ScrollableHeight",function(){return Number},r),r.ViewportWidthProperty=DependencyProperty.RegisterReadOnlyCore("ViewportWidth",function(){return Number},r),r.ViewportHeightProperty=DependencyProperty.RegisterReadOnlyCore("ViewportHeight",function(){return Number},r),r.ExtentWidthProperty=DependencyProperty.RegisterReadOnlyCore("ExtentWidth",function(){return Number},r),r.ExtentHeightProperty=DependencyProperty.RegisterReadOnlyCore("ExtentHeight",function(){return Number},r),r}(t.ContentControl);t.ScrollViewer=n,e.CoreLibrary.add(n),t.TemplateParts(n,{Name:"ScrollContentPresenter",Type:t.ScrollContentPresenter},{Name:"HorizontalScrollBar",Type:t.Primitives.ScrollBar},{Name:"VerticalScrollBar",Type:t.Primitives.ScrollBar})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this.DropDownOpened=new nullstone.Event,this.DropDownClosed=new nullstone.Event,this.$DisplayedItem=null,this.$SelectionBoxItem=null,this.$SelectionBoxItemTemplate=null,this._FocusedIndex=-1,this.DefaultStyleKey=r}return __extends(r,n),r.prototype._IsDropDownOpenChanged=function(n){var r=n.NewValue;if(null!=this.$Popup&&(this.$Popup.IsOpen=r),null!=this.$DropDownToggle&&(this.$DropDownToggle.IsChecked=r),r){if(this._FocusedIndex=this.Items.Count>0?Math.max(this.SelectedIndex,0):-1,this._FocusedIndex>-1){var o=this.ItemContainersManager.ContainerFromIndex(this._FocusedIndex);o instanceof t.ComboBoxItem&&o.Focus()}this.LayoutUpdated.on(this._UpdatePopupSizeAndPosition,this),this.DropDownOpened.raise(this,null)}else this.Focus(),this.LayoutUpdated.off(this._UpdatePopupSizeAndPosition,this),this.DropDownClosed.raise(this,null);var i=this.SelectedItem;this._UpdateDisplayedItem(r&&i instanceof e.UIElement?null:i),this.UpdateVisualState(!0)},r.prototype._MaxDropDownHeightChanged=function(e){this._UpdatePopupMaxHeight(e.NewValue)},r.prototype._GetChildOfType=function(e,t){var n=this.GetTemplateChild(e);return n instanceof t?n:void 0},r.prototype.OnApplyTemplate=function(){if(n.prototype.OnApplyTemplate.call(this),this.UpdateVisualState(!1),this.$ContentPresenter=this._GetChildOfType("ContentPresenter",t.ContentPresenter),this.$Popup=this._GetChildOfType("Popup",t.Primitives.Popup),this.$DropDownToggle=this._GetChildOfType("DropDownToggle",t.Primitives.ToggleButton),null!=this.$ContentPresenter&&(this._NullSelFallback=this.$ContentPresenter.Content),null!=this.$Popup){this._UpdatePopupMaxHeight(this.MaxDropDownHeight),this.$Popup.WatchOutsideClick(this._PopupClickedOutside,this);var e=this.$Popup.Child;null!=e&&(e.KeyDown.on(this._OnChildKeyDown,this),e.SizeChanged.on(this._UpdatePopupSizeAndPosition,this))}null!=this.$DropDownToggle&&(this.$DropDownToggle.Checked.on(this._OnToggleChecked,this),this.$DropDownToggle.Unchecked.on(this._OnToggleUnchecked,this)),this.UpdateVisualState(!1),this._UpdateDisplayedItem(this.SelectedItem)},r.prototype.OnItemContainerStyleChanged=function(e){for(var t=e.NewValue,n=this.ItemContainersManager.GetEnumerator();n.moveNext();){var r=n.current;r&&r!==n.CurrentItem&&(r.Style=t)}},r.prototype.IsItemItsOwnContainer=function(e){return e instanceof t.ComboBoxItem},r.prototype.GetContainerForItem=function(){return new t.ComboBoxItem},r.prototype.PrepareContainerForItem=function(e,t){n.prototype.PrepareContainerForItem.call(this,e,t);var r=e;if(r!==t){var o=this.ItemContainerStyle;!r.Style&&o&&(r.Style=o)}},r.prototype.GoToStateFocus=function(e){var t=this.IsEnabled;return e(this.IsDropDownOpen&&t?"FocusedDropDown":this.IsFocused&&t?"Focused":"Unfocused")},r.prototype.OnIsEnabledChanged=function(e){n.prototype.OnIsEnabledChanged.call(this,e),this.IsEnabled||(this.IsDropDownOpen=!1)},r.prototype.OnMouseLeftButtonDown=function(e){n.prototype.OnMouseLeftButtonDown.call(this,e),e.Handled||(e.Handled=!0,this.SetValueInternal(r.IsSelectionActiveProperty,!0),this.IsDropDownOpen=!this.IsDropDownOpen)},r.prototype.OnMouseEnter=function(e){n.prototype.OnMouseEnter.call(this,e),this.UpdateVisualState(!0)},r.prototype.OnMouseLeave=function(e){n.prototype.OnMouseLeave.call(this,e),this.UpdateVisualState(!0)},r.prototype.OnKeyDown=function(t){if(n.prototype.OnKeyDown.call(this,t),!t.Handled){t.Handled=!0;var r=t.Key;switch(this.FlowDirection===e.FlowDirection.RightToLeft&&(r===e.Input.Key.Left?r=e.Input.Key.Right:r===e.Input.Key.Right&&(r=e.Input.Key.Left)),r){case e.Input.Key.Escape:this.IsDropDownOpen=!1;break;case e.Input.Key.Enter:case e.Input.Key.Space:this.IsDropDownOpen&&this._FocusedIndex!==this.SelectedIndex?(this.SelectedIndex=this._FocusedIndex,this.IsDropDownOpen=!1):this.IsDropDownOpen=!0;break;case e.Input.Key.Right:case e.Input.Key.Down:this.IsDropDownOpen?this._FocusedIndex<this.Items.Count-1&&(this._FocusedIndex++,this.ItemContainersManager.ContainerFromIndex(this._FocusedIndex).Focus()):this.SelectedIndex=Math.min(this.SelectedIndex+1,this.Items.Count-1);break;case e.Input.Key.Left:case e.Input.Key.Up:this.IsDropDownOpen?this._FocusedIndex>0&&(this._FocusedIndex--,this.ItemContainersManager.ContainerFromIndex(this._FocusedIndex).Focus()):this.SelectedIndex=Math.max(this.SelectedIndex-1,0);break;default:t.Handled=!1}}},r.prototype.OnGotFocus=function(e){n.prototype.OnGotFocus.call(this,e),this.UpdateVisualState(!0)},r.prototype.OnLostFocus=function(e){n.prototype.OnLostFocus.call(this,e),this.SetValueInternal(r.IsSelectionActiveProperty,null==this.$Popup?!1:this.$Popup.IsOpen),this.UpdateVisualState(!0)},r.prototype._OnChildKeyDown=function(e,t){this.OnKeyDown(t)},r.prototype.OnSelectionChanged=function(e){this.IsDropDownOpen||this._UpdateDisplayedItem(this.SelectedItem)},r.prototype._OnToggleChecked=function(e,t){this.IsDropDownOpen=!0},r.prototype._OnToggleUnchecked=function(e,t){this.IsDropDownOpen=!1},r.prototype._PopupClickedOutside=function(){this.IsDropDownOpen=!1},r.prototype._UpdateDisplayedItem=function(n){if(this.$ContentPresenter){if(null!=this.$DisplayedItem&&(this.$DisplayedItem.Content=this.$ContentPresenter.Content,this.$DisplayedItem=null),this.$ContentPresenter.Content=null,null==n)return this.$ContentPresenter.Content=this._NullSelFallback,this.$ContentPresenter.ContentTemplate=null,this.$SelectionBoxItem=null,void(this.$SelectionBoxItemTemplate=null);var r=n;r instanceof t.ComboBoxItem&&(r=r.Content);var o=this.ItemContainersManager,i=this.SelectedIndex,a=o.ContainerFromIndex(i);if(a instanceof t.ComboBoxItem&&(this.$DisplayedItem=a),this.$SelectionBoxItem=r,this.$SelectionBoxItemTemplate=this.ItemTemplate,null!=this.$DisplayedItem)this.$SelectionBoxItemTemplate=this.$DisplayedItem.ContentTemplate,r instanceof e.UIElement?this.$DisplayedItem.Content=null:this.$DisplayedItem=null;else{a=o.ContainerFromIndex(i);var s;if(a instanceof t.ComboBoxItem&&(s=a),!s){var u=o.CreateGenerator(i,1);u.Generate()&&u.Current instanceof t.ComboBoxItem&&(s=u.Current,this.PrepareContainerForItem(s,u.CurrentItem))}s&&(this.$SelectionBoxItemTemplate=s.ContentTemplate)}this.$ContentPresenter.Content=this.$SelectionBoxItem,this.$ContentPresenter.ContentTemplate=this.$SelectionBoxItemTemplate}},r.prototype._UpdatePopupSizeAndPosition=function(t,n){var r=this.$Popup;if(r){var o=r.Child;if(o instanceof e.FrameworkElement){o.MinWidth=this.ActualWidth;var i=e.VisualTreeHelper.GetRoot(this);if(i){try{var a=this.TransformToVisual(null)}catch(s){return}var u=new Point(0,this.ActualHeight),l=new Point(u.x+o.ActualWidth,u.y+o.ActualHeight),c=a.Transform(u);l=a.Transform(l);var p=this.FlowDirection===e.FlowDirection.RightToLeft;if(p){var d=l.x;l.x=c.x,c.x=d}var h=new Point,y=i.ActualWidth;l.x>y?h.x=y-l.x:c.x<0?h.x=u.x-c.x:h.x=u.x,p&&(h.x=-h.x);var f=i.ActualHeight;l.y>f?h.y=-o.ActualHeight:h.y=this.RenderSize.height,r.HorizontalOffset=h.x,r.VerticalOffset=h.y,this._UpdatePopupMaxHeight(this.MaxDropDownHeight)}}}},r.prototype._UpdatePopupMaxHeight=function(t){var n;if(this.$Popup&&(n=this.$Popup.Child)&&n instanceof e.FrameworkElement){if(t===Number.POSITIVE_INFINITY){var r=this.XamlNode.LayoutUpdater.tree.surface;r&&(t=r.height/2)}n.MaxHeight=t}},r.IsDropDownOpenProperty=DependencyProperty.Register("IsDropDownOpen",function(){return Boolean},r,!1,function(e,t){return e._IsDropDownOpenChanged(t)}),r.ItemContainerStyleProperty=DependencyProperty.Register("ItemContainerStyle",function(){return e.Style},r,void 0,function(e,t){return e.OnItemContainerStyleChanged(t)}),r.MaxDropDownHeightProperty=DependencyProperty.Register("MaxDropDownHeight",function(){return Number},r,Number.POSITIVE_INFINITY,function(e,t){return e._MaxDropDownHeightChanged(t)}),r.IsSelectionActiveProperty=t.Primitives.Selector.IsSelectionActiveProperty,r}(t.Primitives.Selector);t.ComboBox=n,e.CoreLibrary.add(n),t.TemplateParts(n,{Name:"ContentPresenter",Type:t.ContentPresenter},{Name:"Popup",Type:t.Primitives.Popup},{Name:"ContentPresenterBorder",Type:e.FrameworkElement},{Name:"DropDownToggle",Type:t.Primitives.ToggleButton},{Name:"ScrollViewer",Type:t.ScrollViewer}),t.TemplateVisualStates(n,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"},{GroupName:"FocusStates",Name:"FocusedDropDown"},{GroupName:"ValidationStates",Name:"Valid"},{GroupName:"ValidationStates",Name:"InvalidUnfocused"},{GroupName:"ValidationStates",Name:"InvalidFocused"})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.call(this),this.ParentSelectorChanged=new nullstone.Event,this.DefaultStyleKey=t}return __extends(t,e),Object.defineProperty(t.prototype,"ParentSelector",{get:function(){return this._ParentSelector},set:function(e){this._ParentSelector!==e&&(this._ParentSelector=e,this.ParentSelectorChanged.raise(this,null))},enumerable:!0,configurable:!0}),t.prototype.OnApplyTemplate=function(){e.prototype.OnApplyTemplate.call(this),this.UpdateVisualState(!1)},t.prototype.OnMouseLeftButtonDown=function(e){e.Handled||(e.Handled=!0,this.XamlNode.Focus(!0)&&null!=this._ParentSelector&&this._ParentSelector.NotifyListItemClicked(this))},t.prototype.OnMouseEnter=function(t){e.prototype.OnMouseEnter.call(this,t),this.UpdateVisualState()},t.prototype.OnMouseLeave=function(t){e.prototype.OnMouseLeave.call(this,t),this.UpdateVisualState()},t.prototype.OnGotFocus=function(t){e.prototype.OnGotFocus.call(this,t),this.UpdateVisualState(),null!=this._ParentSelector&&this._ParentSelector.NotifyListItemGotFocus(this)},t.prototype.OnLostFocus=function(t){e.prototype.OnLostFocus.call(this,t),this.UpdateVisualState(),null!=this._ParentSelector&&this._ParentSelector.NotifyListItemLostFocus(this)},t.prototype.GoToStateSelection=function(e){return this.IsSelected?e("SelectedUnfocused")?!0:e("Selected"):e("Unselected")},t.prototype.OnIsSelectedChanged=function(e){this.UpdateVisualState()},t.IsSelectedProperty=DependencyProperty.RegisterCore("IsSelected",function(){return Boolean},t,null,function(e,t){return e.OnIsSelectedChanged(t)}),t}(t.ContentControl);t.ListBoxItem=n,e.CoreLibrary.add(n),t.TemplateVisualStates(n,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"},{GroupName:"SelectionStates",Name:"Unselected"},{GroupName:"SelectionStates",Name:"Selected"},{GroupName:"SelectionStates",Name:"SelectedUnfocused"})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function n(){e.call(this),this.DefaultStyleKey=n}return __extends(n,e),n.prototype.OnMouseLeftButtonUp=function(n){e.prototype.OnMouseLeftButtonUp.call(this,n),this.ParentSelector instanceof t.ComboBox&&(this.ParentSelector.IsDropDownOpen=!1)},n}(t.ListBoxItem);t.ComboBoxItem=n,e.CoreLibrary.add(n),t.TemplateVisualStates(n,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"},{GroupName:"SelectionStates",Name:"Unselected"},{GroupName:"SelectionStates",Name:"Selected"},{GroupName:"SelectionStates",Name:"SelectedUnfocused"})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,n){n instanceof Element&&(e.$$markup=t.CreateXaml(n))}function r(e,t){e.$$resources=t}function o(e,n){var r=t.CreateXaml(n);return i(e,r)}function i(e,t){return a(e,t)}function a(o,i,a,u){function l(t){var n=null,r=t,o=r.indexOf(":");o>-1&&(n=r.substr(0,o),r=r.substr(o+1));var i=g.resolvePrefix(n);return e.TypeManager.resolveType(i,r,d),d.type}function c(t){var n,r=t,o=r.indexOf(".");if(o>-1)n=l(r.substr(0,o)),r=r.substr(o+1);else for(var i=g.walkUpObjects();i.moveNext();){var a=i.current;if(a instanceof e.Style){if(n=a.TargetType,!n)throw new XamlParseException("Style must have a TargetType.");break}}return n?DependencyProperty.GetDependencyProperty(n,r):null}perfex.timer.start("MarkupLoad",i.uri.toString());var p,d={isPrimitive:!1,type:void 0},h=new e.NameScope(!0),y=t.Internal.createActiveObject(o,h,u),f=t.Internal.createPropertyActor(y,l,c),m=t.Internal.createObjectActor(f),v=t.Internal.createResourcesActor(y,a),g=i.createParser().setNamespaces(e.XMLNS,e.XMLNSX),C={resolveType:function(t,n){if(!e.TypeManager.resolveType(t,n,d))throw new XamlParseException("Could not resolve type ["+t+"]["+n+"].");return d},resolveObject:function(n){if(n===e.ResourceDictionary&&!f.isNewResources())return void 0;perfex.timer.start("MarkupCreateObject",n);var r=new n;return r instanceof s?g.skipBranch():r instanceof t.StaticResource&&r.setContext(y.getApp(),a),perfex.timer.stop(),r},resolvePrimitive:function(e,t){return nullstone.convertAnyToType(t,e)},resolveResources:function(e,t){var n=e.Resources;return n},branchSkip:function(e,t){if(t instanceof s){var o=p=t,i=t.Validate();if(i)throw new XamlParseException(i);n(o,e),r(o,v.get())}},object:function(e,t){y.set(e),m.start(),v.start()},objectEnd:function(e,t,n,r){p=e,v.end(),m.end(),y.set(r),y.obj&&(n?(f.startContent(),f.addObject(e,t),f.end()):f.addObject(e,t))},contentText:function(e){f.setContentText(e)},name:function(e){y.setName(e)},propertyStart:function(e,t){f.start(e,t)},propertyEnd:function(e,t){f.end()},attributeStart:function(e,t){},attributeEnd:function(e,t,n){f.setObject(e,t,n)},error:function(e){return!1},end:function(){}};return g.on(C).parse(i.root),p instanceof e.XamlObject&&(p.XamlNode.NameScope=h),perfex.timer.stop(),p}var s=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.Validate=function(){return""},n.prototype.GetVisualTree=function(t){var n=a(this.App,this.$$markup,this.$$resources,t);if(!(n instanceof e.UIElement))throw new XamlParseException("Template root visual is not a UIElement.");return n},n}(e.DependencyObject);t.FrameworkTemplate=s,t.LoadXaml=o,t.Load=i}(t=e.Markup||(e.Markup={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.Validate=function(){return this.TargetType?void 0:"ControlTemplate must have a TargetType."},n.TargetTypeProperty=DependencyProperty.Register("TargetType",function(){return e.IType_},n),n}(e.Markup.FrameworkTemplate);t.ControlTemplate=n,e.CoreLibrary.add(n)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,n){var o=e instanceof t.Primitives.ButtonBase?e:null;o&&(void 0!==n.OldValue&&o.Click.off(r,o),void 0!==n.NewValue&&o.Click.on(r,o))}function r(t,n){var r=e.VisualTreeHelper.GetParentOfType(t,o);r&&(r.DialogResult=o.GetClickResult(t))}var o=function(e){function r(){e.call(this),this._IgnoreResult=!1,this.DefaultStyleKey=r}return __extends(r,e),r.prototype.OnDialogResultChanged=function(e){if(this._IgnoreResult!==!0){
var n=t.Primitives.Overlay.FindOverlay(this);if(n){n.Close(e.NewValue),this._IgnoreResult=!0;try{this.SetCurrentValue(r.DialogResultProperty,void 0)}finally{this._IgnoreResult=!1}}}},r.GetClickResult=function(e){return e.GetValue(r.ClickResultProperty)},r.SetClickResult=function(e,t){e.SetValue(r.ClickResultProperty,t)},r.DialogResultProperty=DependencyProperty.Register("DialogResult",function(){return Boolean},r,void 0,function(e,t){return e.OnDialogResultChanged(t)}),r.ClickResultProperty=DependencyProperty.RegisterAttached("ClickResult",function(){return Boolean},r,void 0,n),r}(t.ContentControl);t.Dialog=o,e.CoreLibrary.add(o)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.call(this),this.DefaultStyleKey=n}return __extends(n,t),n.prototype.CreateLayoutUpdater=function(){return new minerva.controls.usercontrol.UserControlUpdater},n.prototype.InitializeComponent=function(){this.ApplyTemplate()},n.ContentProperty=DependencyProperty.Register("Content",function(){return e.UIElement},n),n}(t.Control);t.UserControl=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.ContentProperty);var r;!function(t){e.UIReaction(n.ContentProperty,function(t,n,r,o){var i=new BError;n instanceof e.UIElement&&o.XamlNode.DetachVisualChild(n,i),r instanceof e.UIElement&&o.XamlNode.AttachVisualChild(r,i),i.Message&&i.ThrowException(),t.updateBounds()},!1,!1)}(r||(r={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this.DefaultStyleKey=r}return __extends(r,n),r.GetAsync=function(n,r){return nullstone.async.create(function(o,i){e.Markup.Resolve(r).then(function(r){TimelineProfile.Parse(!0,"Page");var a=e.Markup.Load(n.App,r);TimelineProfile.Parse(!1,"Page"),a instanceof t.Page?o(a):i("Markup must be a Page.")},i)})},r.TitleProperty=DependencyProperty.Register("Title",function(){return String},r),r}(t.UserControl);t.Page=n,e.CoreLibrary.add(n)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){e.INavigate_=new nullstone.Interface("INavigate")}(t=e.Navigation||(e.Navigation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(t){var n=(t||"").toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),r='<Page xmlns="'+e.XMLNS+'" xmlns:x="'+e.XMLNSX+'" Title="Error">';return r+='<TextBlock Text="'+n+'" />',r+="</Page>",e.Markup.CreateXaml(r,e.XMLNS+"/frame/error")}function r(t,r){return e.Markup.Load(t,n(r))}var o=function(n){function o(){n.call(this),this._NavService=new e.Navigation.NavigationService,this._CurrentRoute=void 0,this.DefaultStyleKey=o,this.Loaded.on(this._FrameLoaded,this)}return __extends(o,n),o.prototype.OnIsLoadingChanged=function(e,t){this.UpdateVisualState()},o.prototype.GoToStates=function(e){this.GoToStateLoading(e)},o.prototype.GoToStateLoading=function(e){return e(this.IsLoading?"Loading":"Idle")},o.prototype.Navigate=function(e){return this._NavService.Navigate(e)},o.prototype.GoForward=function(){},o.prototype.GoBackward=function(){},o.prototype.StopLoading=function(){},o.prototype._FrameLoaded=function(e,t){this.IsDeepLinked&&(this._NavService.LocationChanged.on(this._HandleDeepLink,this),this._HandleDeepLink())},o.prototype._HandleDeepLink=function(){this._LoadContent(this._NavService.CurrentUri)},o.prototype._LoadContent=function(n){var r=this;this.SetCurrentValue(o.CurrentSourceProperty,n),this.StopLoading(),this.SetCurrentValue(o.IsLoadingProperty,!0);var i=n.fragment;"#"===i[0]&&(i=i.substr(1)),TimelineProfile.Navigate(!0,i);var a=new e.Uri(i,nullstone.UriKind.Relative),s=void 0;if(this.RouteMapper){if(this._CurrentRoute=this.RouteMapper.MapUri(a),!this._CurrentRoute)throw new InvalidOperationException("Route could not be mapped."+a.toString());s=this._CurrentRoute.View.toString()}else if(this.UriMapper){var u=this.UriMapper.MapUri(a);if(!u)throw new InvalidOperationException("Uri could not be mapped."+a.toString());s=u.toString()}t.Page.GetAsync(this,s).then(function(e){return r._HandleSuccess(e)},function(e){return r._HandleError(e)})},o.prototype._HandleSuccess=function(e){this._SetPage(e),this.SetCurrentValue(o.IsLoadingProperty,!1),TimelineProfile.Navigate(!1),TimelineProfile.IsNextLayoutPassProfiled=!0},o.prototype._HandleError=function(e){this._SetPage(r(this.App,e)),this.SetCurrentValue(o.IsLoadingProperty,!1),TimelineProfile.Navigate(!1)},o.prototype._SetPage=function(e){document.title=e.Title,this.Content=e,this._CurrentRoute&&(e.DataContext=this._CurrentRoute.DataContext),null==e.DataContext&&(e.DataContext=this.DataContext)},o.prototype.SourcePropertyChanged=function(e){this.Navigate(e.NewValue)},o.IsDeepLinkedProperty=DependencyProperty.Register("IsDeepLinked",function(){return Boolean},o,!0),o.CurrentSourceProperty=DependencyProperty.RegisterReadOnly("CurrentSource",function(){return e.Uri},o),o.SourceProperty=DependencyProperty.Register("Source",function(){return e.Uri},o,void 0,function(e,t){return e.SourcePropertyChanged(t)}),o.UriMapperProperty=DependencyProperty.Register("UriMapper",function(){return e.Navigation.UriMapper},o),o.RouteMapperProperty=DependencyProperty.Register("RouteMapper",function(){return e.Navigation.RouteMapper},o),o.IsLoadingProperty=DependencyProperty.RegisterReadOnly("IsLoading",function(){return Boolean},o,!1,function(e,t){return e.OnIsLoadingChanged(t.OldValue,t.NewValue)}),o}(t.ContentControl);t.Frame=o,e.CoreLibrary.add(o),nullstone.addTypeInterfaces(o,e.Navigation.INavigate_),t.TemplateVisualStates(o,{GroupName:"LoadingStates",Name:"Idle"},{GroupName:"LoadingStates",Name:"Loading"})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.ColumnDefinitionsChanged=function(t,n,r){var o=this.LayoutUpdater,i=o.assets.columnDefinitions;r?(i.splice(n,0,t),e.ReactTo(t,this,function(){return o.invalidateMeasure()})):(e.UnreactTo(t,this),i.splice(n,1)),o.invalidateMeasure()},n.prototype.RowDefinitionsChanged=function(t,n,r){var o=this.LayoutUpdater,i=o.assets.rowDefinitions;r?(i.splice(n,0,t),e.ReactTo(t,this,function(){return o.invalidateMeasure()})):(e.UnreactTo(t,this),i.splice(n,1)),o.invalidateMeasure()},n}(t.PanelNode);t.GridNode=n;var r=function(r){function o(){var t=this;r.call(this);var n=o.ColumnDefinitionsProperty.Initialize(this);e.ReactTo(n,this,function(e){return t.XamlNode.ColumnDefinitionsChanged(e.item,e.index,e.add)});var i=o.RowDefinitionsProperty.Initialize(this);e.ReactTo(i,this,function(e){return t.XamlNode.RowDefinitionsChanged(e.item,e.index,e.add)})}return __extends(o,r),o.prototype.CreateNode=function(){return new n(this)},o.prototype.CreateLayoutUpdater=function(){return new minerva.controls.grid.GridUpdater},o.GetColumn=function(e){return e.GetValue(o.ColumnProperty)},o.SetColumn=function(e,t){e.SetValue(o.ColumnProperty,t)},o.GetColumnSpan=function(e){return e.GetValue(o.ColumnSpanProperty)},o.SetColumnSpan=function(e,t){e.SetValue(o.ColumnSpanProperty,t)},o.GetRow=function(e){return e.GetValue(o.RowProperty)},o.SetRow=function(e,t){e.SetValue(o.RowProperty,t)},o.GetRowSpan=function(e){return e.GetValue(o.RowSpanProperty)},o.SetRowSpan=function(e,t){e.SetValue(o.RowSpanProperty,t)},o.ColumnProperty=DependencyProperty.RegisterAttached("Column",function(){return Number},o,0),o.ColumnSpanProperty=DependencyProperty.RegisterAttached("ColumnSpan",function(){return Number},o,1),o.RowProperty=DependencyProperty.RegisterAttached("Row",function(){return Number},o,0),o.RowSpanProperty=DependencyProperty.RegisterAttached("RowSpan",function(){return Number},o,1),o.ColumnDefinitionsProperty=DependencyProperty.RegisterImmutable("ColumnDefinitions",function(){return t.ColumnDefinitionCollection},o),o.RowDefinitionsProperty=DependencyProperty.RegisterImmutable("RowDefinitions",function(){return t.RowDefinitionCollection},o),o.ShowGridLinesProperty=DependencyProperty.Register("ShowGridLines",function(){return Boolean},o,!1),o}(t.Panel);t.Grid=r,e.CoreLibrary.add(r);var o;!function(t){e.UIReaction(r.ShowGridLinesProperty,minerva.controls.grid.reactTo.showGridLines,!1),e.UIReactionAttached(r.ColumnProperty,minerva.controls.grid.reactTo.column),e.UIReactionAttached(r.ColumnSpanProperty,minerva.controls.grid.reactTo.columnSpan),e.UIReactionAttached(r.RowProperty,minerva.controls.grid.reactTo.row),e.UIReactionAttached(r.RowSpanProperty,minerva.controls.grid.reactTo.rowSpan)}(o||(o={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=minerva.controls.grid.GridUnitType;e.CoreLibrary.addEnum(n,"GridUnitType");var r=function(){function e(e,t){this.Value=null==e?0:e,this.Type=t||n.Auto}return e.Equals=function(e,t){return Math.abs(e.Value-t.Value)<.001&&e.Type==t.Type},e.prototype.Clone=function(){return new t.GridLength(this.Value,this.Type)},e}();t.GridLength=r,e.CoreLibrary.add(r),nullstone.registerTypeConverter(r,function(e){if(e instanceof r)return e;if(!e||"auto"===e.toLowerCase())return new r;var t=n.Pixel;"*"===e[e.length-1]&&(e=e.substr(0,e.length-1),t=n.Star);var o=parseFloat(e);return isNaN(o)&&(o=1),new r(o,t)})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.call(this),this.DefaultStyleKey=n}return __extends(n,t),n.prototype.OnHeaderChanged=function(e,t){},n.prototype.OnHeaderTemplateChanged=function(e,t){},n.HeaderProperty=DependencyProperty.Register("Header",function(){return Object},n,void 0,function(e,t){return e.OnHeaderChanged(t.OldValue,t.NewValue)}),n.HeaderTemplateProperty=DependencyProperty.Register("HeaderTemplate",function(){return e.DataTemplate},n,void 0,function(e,t){return e.OnHeaderTemplateChanged(t.OldValue,t.NewValue)}),n}(t.ContentControl);t.HeaderedContentControl=n,e.CoreLibrary.add(n)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.call(this),this.DefaultStyleKey=n}return __extends(n,t),n.prototype.OnApplyTemplate=function(){t.prototype.OnApplyTemplate.call(this),this.UpdateVisualState(!1)},n.prototype.OnClick=function(){t.prototype.OnClick.call(this);var n=this.NavigateUri;n&&e.Navigation.Navigate(this,this.TargetName,n)},n.NavigateUriProperty=DependencyProperty.Register("NavigateUri",function(){return e.Uri},n),n.TargetNameProperty=DependencyProperty.Register("TargetName",function(){return String},n),n}(t.Primitives.ButtonBase);t.HyperlinkButton=n,e.CoreLibrary.add(n),t.TemplateVisualStates(n,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Pressed"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){!function(e){e[e.Absolute=0]="Absolute",e[e.RelativeToBoundingBox=1]="RelativeToBoundingBox"}(t.BrushMappingMode||(t.BrushMappingMode={}));var n=t.BrushMappingMode;e.CoreLibrary.addEnum(n,"BrushMappingMode"),function(e){e[e.Pad=0]="Pad",e[e.Reflect=1]="Reflect",e[e.Repeat=2]="Repeat"}(t.GradientSpreadMethod||(t.GradientSpreadMethod={}));var r=t.GradientSpreadMethod;e.CoreLibrary.addEnum(r,"GradientSpreadMethod"),function(e){e[e.None=0]="None",e[e.Fill=1]="Fill",e[e.Uniform=2]="Uniform",e[e.UniformToFill=3]="UniformToFill"}(t.Stretch||(t.Stretch={}));var o=t.Stretch;e.CoreLibrary.addEnum(o,"Stretch"),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.AlignmentX||(t.AlignmentX={}));var i=t.AlignmentX;e.CoreLibrary.addEnum(i,"AlignmentX"),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(t.AlignmentY||(t.AlignmentY={}));var a=t.AlignmentY;e.CoreLibrary.addEnum(a,"AlignmentY"),function(e){e[e.Fixed=0]="Fixed",e[e.Animated=1]="Animated"}(t.TextHintingMode||(t.TextHintingMode={}));var s=t.TextHintingMode;e.CoreLibrary.addEnum(s,"TextHintingMode")}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=minerva.controls.image.ImageUpdater,r=function(t){function r(){t.apply(this,arguments),this.ImageOpened=new nullstone.Event,this.ImageFailed=new nullstone.Event}return __extends(r,t),r.prototype.CreateLayoutUpdater=function(){return new n},r._SourceCoercer=function(t,n,r){return"string"==typeof r?new e.Media.Imaging.BitmapImage(new e.Uri(r)):r instanceof e.Uri?new e.Media.Imaging.BitmapImage(r):r},r.prototype.OnImageErrored=function(e,t){this.ImageFailed.raise(this,null)},r.prototype.OnImageLoaded=function(e,t){this.ImageOpened.raise(this,null);var n=this.XamlNode.LayoutUpdater;n.invalidateMeasure()},r.prototype.ImageChanged=function(e){var t=this.XamlNode.LayoutUpdater;t.invalidateMeasure(),t.invalidate()},r.SourceProperty=DependencyProperty.RegisterFull("Source",function(){return e.Media.Imaging.ImageSource},r,void 0,void 0,r._SourceCoercer),r.StretchProperty=DependencyProperty.RegisterCore("Stretch",function(){return new e.Enum(e.Media.Stretch)},r,e.Media.Stretch.Uniform),r}(e.FrameworkElement);t.Image=r,e.CoreLibrary.add(r),e.UIReaction(r.SourceProperty,function(t,n,r,o){n instanceof e.Media.Imaging.BitmapSource&&n.Unlisten(o),r instanceof e.Media.Imaging.BitmapSource?r.Listen(o):(t.updateBounds(),t.invalidate()),t.invalidateMeasure(),t.invalidateMetrics()},!1),e.UIReaction(r.StretchProperty,function(e,t,n){e.invalidateMeasure(),e.invalidateMetrics()},!1)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments),this.ItemsChanged=new nullstone.Event,this.IsReadOnly=!1}return __extends(n,t),n.prototype.ToArray=function(){return this._ht.slice(0)},Object.defineProperty(n.prototype,"Count",{get:function(){return this._ht.length},enumerable:!0,configurable:!0}),n.prototype.GetValueAt=function(e){var t=this._ht;if(0>e||e>=t.length)throw new IndexOutOfRangeException(e);return t[e]},n.prototype.GetRange=function(e,t){return this._ht.slice(e,t+1)},n.prototype.SetValueAt=function(e,t){return this._ValidateReadOnly(),this.SetValueAtImpl(e,t),!0},n.prototype.SetValueAtImpl=function(t,n){var r=this._ht;if(0>t||t>=r.length)throw new IndexOutOfRangeException(t);var o=r[t];r[t]=n,this.ItemsChanged.raise(this,e.Collections.CollectionChangedEventArgs.Replace(n,o,t))},n.prototype.Add=function(e){if(this._ValidateReadOnly(),null==e)throw new ArgumentException("value");return this.AddImpl(e)},n.prototype.AddImpl=function(t){var n=this._ht.push(t)-1;return this.ItemsChanged.raise(this,e.Collections.CollectionChangedEventArgs.Add(t,n)),n},n.prototype.AddRange=function(e){if(this._ValidateReadOnly(),e){for(var t=0;t<e.length;t++)if(null==e[t])throw new ArgumentException("value");this.AddRangeImpl(e)}},n.prototype.AddRangeImpl=function(t){var n=this._ht.length;this._ht=this._ht.concat(t),this.ItemsChanged.raise(this,e.Collections.CollectionChangedEventArgs.AddRange(t,n))},n.prototype.Insert=function(e,t){if(this._ValidateReadOnly(),null==t)throw new ArgumentException("value");return this.InsertImpl(e,t),!0},n.prototype.InsertImpl=function(t,n){var r=this._ht;if(0>t||t>r.length)throw new IndexOutOfRangeException(t);t>=r.length?r.push(n):r.splice(t,0,n),this.ItemsChanged.raise(this,e.Collections.CollectionChangedEventArgs.Add(n,t))},n.prototype.IndexOf=function(e){return this._ht.indexOf(e)},n.prototype.Contains=function(e){return this._ht.indexOf(e)>-1},n.prototype.Remove=function(e){return this._ValidateReadOnly(),this.RemoveImpl(e),!0},n.prototype.RemoveImpl=function(t){var n=this._ht.indexOf(t);0>n||(this._ht.splice(n,1),this.ItemsChanged.raise(this,e.Collections.CollectionChangedEventArgs.Remove(t,n)))},n.prototype.RemoveAt=function(e){if(this._ValidateReadOnly(),0>e||e>=this._ht.length)throw new IndexOutOfRangeException(e);return this.RemoveAtImpl(e),!0},n.prototype.RemoveAtImpl=function(t){var n=this._ht.splice(t,1)[0];this.ItemsChanged.raise(this,e.Collections.CollectionChangedEventArgs.Remove(n,t))},n.prototype.Clear=function(){return this._ValidateReadOnly(),this.ClearImpl(),!0},n.prototype.ClearImpl=function(){var t=this._ht;this._ht=[],this.ItemsChanged.raise(this,e.Collections.CollectionChangedEventArgs.Reset(t))},n.prototype._ValidateReadOnly=function(){if(this.IsReadOnly)throw new InvalidOperationException("The collection is readonly.")},n}(e.XamlObjectCollection);t.ItemCollection=n,e.CoreLibrary.add(n)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.GetVisualTree=function(n){var r=e.prototype.GetVisualTree.call(this,n);if(!(r instanceof t.Panel))throw new XamlParseException("The root element of an ItemsPanelTemplate must be a Panel subclass.");return r},n}(e.Markup.FrameworkTemplate);t.ItemsPanelTemplate=n,e.CoreLibrary.add(n)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(n){return n instanceof t.ListBox?o=o||e.Markup.Load(n.App,a):r=r||e.Markup.Load(n.App,i)}var r,o,i=e.Markup.CreateXaml('<ItemsPanelTemplate xmlns="'+e.XMLNS+'"><StackPanel /></ItemsPanelTemplate>',e.XMLNS+"/itemspresenter/stackpanel/default"),a=e.Markup.CreateXaml('<ItemsPanelTemplate xmlns="'+e.XMLNS+'"><VirtualizingStackPanel /></ItemsPanelTemplate>',e.XMLNS+"/itemspresenter/virtualizingstackpanel/default"),s=function(e){function r(t){e.call(this,t)}return __extends(r,e),Object.defineProperty(r.prototype,"ElementRoot",{get:function(){return this._ElementRoot},enumerable:!0,configurable:!0}),r.prototype.DoApplyTemplateWithError=function(e){if(this._ElementRoot)return!1;var r=this.XObject,o=r.TemplateOwner;if(!(o instanceof t.ItemsControl))return!1;var i;return o.ItemsPanel&&(i=this._ElementRoot=o.ItemsPanel.GetVisualTree(r)),i||(i=this._ElementRoot=n(o).GetVisualTree(r)),t.ItemsControl.SetIsItemsHost(i,!0),this.FinishApplyTemplateWithError(i,e)?(o.XamlNode.ItemsPresenter=r,r.OnItemsAdded(0,o.Items.ToArray()),!0):!1},r}(e.FENode);t.ItemsPresenterNode=s;var u=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.CreateNode=function(){return new s(this)},Object.defineProperty(n.prototype,"ItemsControl",{get:function(){return this.TemplateOwner instanceof t.ItemsControl?this.TemplateOwner:null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Panel",{get:function(){var e=this.XamlNode.ElementRoot;return e instanceof t.Panel?e:void 0},enumerable:!0,configurable:!0}),n.Get=function(e){return e instanceof t.Panel&&t.ItemsControl.GetIsItemsHost(e)&&e.TemplateOwner instanceof n?e.TemplateOwner:null},n.prototype.OnItemsAdded=function(e,n){var r=this.Panel;if(r)if(r instanceof t.VirtualizingPanel)r.OnItemsAdded(e,n);else for(var o=this.ItemsControl,i=r.Children,a=o.ItemContainersManager.CreateGenerator(e,n.length);a.Generate();){var s=a.Current;i.Insert(e+a.GenerateIndex,s),o.PrepareContainerForItem(s,a.CurrentItem)}},n.prototype.OnItemsRemoved=function(e,n){var r=this.Panel;if(r)if(r instanceof t.VirtualizingPanel)r.OnItemsRemoved(e,n);else{var o=(this.ItemsControl.ItemContainersManager,r.Children),i=n?n.length:null;if(null==i||i===o.Count)o.Clear();else for(;i>0;)o.RemoveAt(e),i--}},n}(e.FrameworkElement);t.ItemsPresenter=u,e.CoreLibrary.add(u)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this._FocusedIndex=0,this.DefaultStyleKey=r}return __extends(r,n),r.prototype.ScrollIntoView=function(e){var n=this.$TemplateScrollViewer;if(n){var r=this.Items;if(r.Contains(e)){var o={Value:null},i={Value:null},a=t.VirtualizingStackPanel.GetIsVirtualizing(this);if(!this._IsOnCurrentPage(e,o,i)){var s=o.Value,u=i.Value;if(this._GetIsVerticalOrientation()){if(a)return void n.ScrollToVerticalOffset(this.SelectedIndex);var l=n.VerticalOffset,c=0;s.GetBottom()<u.GetBottom()&&(c=u.GetBottom()-s.GetBottom(),l+=c),u.Y-c<s.Y&&(l-=s.Y-(u.Y-c)),n.ScrollToVerticalOffset(l)}else{if(a)return void n.ScrollToHorizontalOffset(this.SelectedIndex);var p=n.HorizontalOffset,d=0;s.GetRight()<u.GetRight()&&(d=u.GetRight()-s.GetRight(),p+=d),s.X-d<s.X&&(p-=s.X-(u.X-d)),n.ScrollToHorizontalOffset(p)}}}}},r.prototype._NavigateByPage=function(e){var t=this.$TemplateScrollViewer,n=-1,r=-1!==this._FocusedIndex?this.Items.GetValueAt(this._FocusedIndex):null;if(null==r||this._IsOnCurrentPage(r)||(this.ScrollIntoView(r),null!=t&&t.UpdateLayout()),null==r)n=this._GetFirstItemOnCurrentPage(this._FocusedIndex,e);else{var o=this._GetFirstItemOnCurrentPage(this._FocusedIndex,e);o!==this._FocusedIndex?n=o:(null!=t&&(this._GetIsVerticalOrientation()?t.ScrollToVerticalOffset(Math.max(0,Math.min(t.ScrollableHeight,t.VerticalOffset+t.ViewportHeight*(e?1:-1)))):t.ScrollToHorizontalOffset(Math.max(0,Math.min(t.ScrollableWidth,t.HorizontalOffset+t.ViewportWidth*(e?1:-1)))),t.UpdateLayout()),n=this._GetFirstItemOnCurrentPage(this._FocusedIndex,e))}return n},r.prototype._ScrollInDirection=function(e){this.$TemplateScrollViewer&&this.$TemplateScrollViewer.ScrollInDirection(e)},r.prototype._IsOnCurrentPage=function(n,r,o){r||(r={Value:null}),o||(o={Value:null});var i=e.VisualTreeHelper.GetChild(e.VisualTreeHelper.GetChild(this,0),0),a=this.$TemplateScrollViewer;null!=a&&(i=a,null!=a.$ScrollContentPresenter&&(i=a.$ScrollContentPresenter)),i instanceof e.FrameworkElement||(i=null);var s=r.Value=new minerva.Rect,u=o.Value=new minerva.Rect;if(!i)return!1;minerva.Size.copyTo(i.RenderSize,s);var l=this.ItemContainersManager.ContainerFromItem(n);if(!l)return!1;if(minerva.Size.copyTo(l.RenderSize,u),i instanceof t.Control){var c=i.Padding;c&&(s.x=s.x+c.left,s.y=s.y+c.top,s.width=s.width-c.left-c.right,s.height=s.height-c.top-c.bottom)}var p=l.TransformToVisual(i);if(null!=p){var d=p.Transform(new Point),h=p.Transform(new Point(l.RenderSize.width,l.RenderSize.height));u.x=Math.min(d.x,h.x),u.y=Math.min(d.y,h.y),u.width=Math.abs(d.x-h.x),u.height=Math.abs(d.y-h.y)}return this._GetIsVerticalOrientation()?s.y<=u.y&&minerva.Rect.getBottom(s)>=minerva.Rect.getBottom(u):s.x<=u.x&&minerva.Rect.getRight(s)>=minerva.Rect.getRight(u)},r.prototype._GetFirstItemOnCurrentPage=function(e,t){for(var n=t?1:-1,r=-1,o=e,i=this.Items,a=i.Count;o>=0&&a>o&&!this._IsOnCurrentPage(i.GetValueAt(o));)r=o,o+=n;for(;o>=0&&a>o&&this._IsOnCurrentPage(i.GetValueAt(o));)r=o,o+=n;return r},r.prototype.OnItemContainerStyleChanged=function(e){for(var n=e.OldValue,r=e.NewValue,o=this.ItemContainersManager.GetEnumerator();o.moveNext();){var i=o.current;i instanceof t.ListBoxItem&&i.Style===n&&(i.Style=r)}},r.prototype.OnKeyDown=function(n){if(!n.Handled){var r=-1;switch(n.Key){case e.Input.Key.Space:case e.Input.Key.Enter:if((e.Input.Key.Enter!==n.Key||e.Input.KeyboardNavigation.GetAcceptsReturn(this))&&!e.Input.Keyboard.HasAlt()){var o,i=e.Surface.GetFocusedElement(this);i instanceof t.ListBoxItem&&(o=i),o&&(e.Input.Keyboard.HasControl()&&o.IsSelected?this.SelectedItem=null:this.SelectedItem=this.ItemContainersManager.ItemFromContainer(o),n.Handled=!0)}break;case e.Input.Key.Home:r=0;break;case e.Input.Key.End:r=this.Items.Count-1;break;case e.Input.Key.PageUp:r=this._NavigateByPage(!1);break;case e.Input.Key.PageDown:r=this._NavigateByPage(!0);break;case e.Input.Key.Left:this._GetIsVerticalOrientation()?this._ScrollInDirection(e.Input.Key.Left):r=this._FocusedIndex-1;break;case e.Input.Key.Up:this._GetIsVerticalOrientation()?r=this._FocusedIndex-1:this._ScrollInDirection(e.Input.Key.Up);break;case e.Input.Key.Right:this._GetIsVerticalOrientation()?this._ScrollInDirection(e.Input.Key.Right):r=this._FocusedIndex+1;break;case e.Input.Key.Down:this._GetIsVerticalOrientation()?r=this._FocusedIndex+1:this._ScrollInDirection(e.Input.Key.Down)}if(-1!==r&&-1!==this._FocusedIndex&&r!==this._FocusedIndex&&r>=0&&r<this.Items.Count){var a=this.ItemContainersManager,o=a.ContainerFromIndex(r),s=a.ItemFromContainer(o);this.ScrollIntoView(s),e.Input.Keyboard.HasControl()?o.Focus():this.SelectedItem=s,n.Handled=!0}}},r.prototype._GetIsVerticalOrientation=function(){var n=this.XamlNode.ItemsPresenter;if(!n)return!0;var r=n.Panel;return r instanceof t.StackPanel?r.Orientation===e.Orientation.Vertical:r instanceof t.VirtualizingStackPanel?r.Orientation===e.Orientation.Vertical:!0},r.prototype.IsItemItsOwnContainer=function(e){return e instanceof t.ListBoxItem},r.prototype.GetContainerForItem=function(){var e=new t.ListBoxItem,n=this.ItemContainerStyle;return null!=n&&(e.Style=n),e},r.prototype.PrepareContainerForItem=function(e,t){n.prototype.PrepareContainerForItem.call(this,e,t);var r=this.ItemContainerStyle,o=e;!o.Style&&r&&(o.Style=r)},r.prototype.OnGotFocus=function(e){n.prototype.OnGotFocus.call(this,e),this.SetValueInternal(r.IsSelectionActiveProperty,!0)},r.prototype.OnLostFocus=function(e){n.prototype.OnLostFocus.call(this,e),this.SetValueInternal(r.IsSelectionActiveProperty,!1)},r.prototype.NotifyListItemGotFocus=function(e){this._FocusedIndex=this.ItemContainersManager.IndexFromContainer(e)},r.prototype.NotifyListItemLostFocus=function(e){this._FocusedIndex=-1},r.ItemContainerStyleProperty=DependencyProperty.Register("ItemContainerStyle",function(){return e.Style},r,void 0,function(e,t){return e.OnItemContainerStyleChanged(t)}),r.IsSelectionActiveProperty=t.Primitives.Selector.IsSelectionActiveProperty,r}(t.Primitives.Selector);t.ListBox=n,e.CoreLibrary.add(n),t.TemplateVisualStates(n,{GroupName:"ValidationStates",Name:"Valid"},{GroupName:"ValidationStates",Name:"InvalidUnfocused"},{GroupName:"ValidationStates",Name:"InvalidFocused"}),t.TemplateParts(n,{Name:"ScrollViewer",Type:t.ScrollViewer})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.FrameworkElement);t.MediaElement=n,e.CoreLibrary.add(n)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function e(){this.Handled=!1,this.Source=null,this.OriginalSource=null}return e}();e.RoutedEventArgs=t,e.CoreLibrary.add(t)}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){!function(e){e[e.None=0]="None",e[e.Back=1]="Back",e[e.Tab=2]="Tab",e[e.Enter=3]="Enter",e[e.Shift=4]="Shift",e[e.Ctrl=5]="Ctrl",e[e.Alt=6]="Alt",e[e.CapsLock=7]="CapsLock",e[e.Escape=8]="Escape",e[e.Space=9]="Space",e[e.PageUp=10]="PageUp",e[e.PageDown=11]="PageDown",e[e.End=12]="End",e[e.Home=13]="Home",e[e.Left=14]="Left",e[e.Up=15]="Up",e[e.Right=16]="Right",e[e.Down=17]="Down",e[e.Insert=18]="Insert",e[e.Delete=19]="Delete",e[e.D0=20]="D0",e[e.D1=21]="D1",e[e.D2=22]="D2",e[e.D3=23]="D3",e[e.D4=24]="D4",e[e.D5=25]="D5",e[e.D6=26]="D6",e[e.D7=27]="D7",e[e.D8=28]="D8",e[e.D9=29]="D9",e[e.A=30]="A",e[e.B=31]="B",e[e.C=32]="C",e[e.D=33]="D",e[e.E=34]="E",e[e.F=35]="F",e[e.G=36]="G",e[e.H=37]="H",e[e.I=38]="I",e[e.J=39]="J",e[e.K=40]="K",e[e.L=41]="L",e[e.M=42]="M",e[e.N=43]="N",e[e.O=44]="O",e[e.P=45]="P",e[e.Q=46]="Q",e[e.R=47]="R",e[e.S=48]="S",e[e.T=49]="T",e[e.U=50]="U",e[e.V=51]="V",e[e.W=52]="W",e[e.X=53]="X",e[e.Y=54]="Y",e[e.Z=55]="Z",e[e.F1=56]="F1",e[e.F2=57]="F2",e[e.F3=58]="F3",e[e.F4=59]="F4",e[e.F5=60]="F5",e[e.F6=61]="F6",e[e.F7=62]="F7",e[e.F8=63]="F8",e[e.F9=64]="F9",e[e.F10=65]="F10",e[e.F11=66]="F11",e[e.F12=67]="F12",e[e.NumPad0=68]="NumPad0",e[e.NumPad1=69]="NumPad1",e[e.NumPad2=70]="NumPad2",e[e.NumPad3=71]="NumPad3",e[e.NumPad4=72]="NumPad4",e[e.NumPad5=73]="NumPad5",e[e.NumPad6=74]="NumPad6",e[e.NumPad7=75]="NumPad7",e[e.NumPad8=76]="NumPad8",e[e.NumPad9=77]="NumPad9",e[e.Multiply=78]="Multiply",e[e.Add=79]="Add",e[e.Subtract=80]="Subtract",e[e.Decimal=81]="Decimal",e[e.Divide=82]="Divide",e[e.Unknown=255]="Unknown"}(t.Key||(t.Key={}));var n=t.Key;e.CoreLibrary.addEnum(n,"Key");var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.RoutedEventArgs);t.KeyboardEventArgs=r,e.CoreLibrary.add(r);var o=function(e){function t(t,r,o,i){e.call(this),this.Modifiers=t,this.PlatformKeyCode=r,this.Key=o,null==this.Key&&(this.Key=n.Unknown),this.Char=i}return __extends(t,e),t}(r);t.KeyEventArgs=o,e.CoreLibrary.add(o)}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,t,n){return"number"!=typeof n?!1:n>=0}var r=e.Input.Key,o=10,i=function(i){function a(n){var r=this;i.call(this),this._Selecting=!1,this._Captured=!1,this.IsReadOnly=!1,this.AcceptsReturn=!1,this.$ContentProxy=new t.Internal.TextBoxContentProxy;var a=this.$View=this.CreateView();a.MouseLeftButtonDown.on(function(e,t){return r.OnMouseLeftButtonDown(t)},this),a.MouseLeftButtonUp.on(function(e,t){return r.OnMouseLeftButtonUp(t)},this),this.$Proxy=new e.Text.Proxy(n,o),this._SyncFont()}return __extends(a,i),a.prototype._SyncFont=function(){var e=this,n=this.$View,r=[t.Control.ForegroundProperty,t.Control.FontFamilyProperty,t.Control.FontSizeProperty,t.Control.FontStretchProperty,t.Control.FontStyleProperty,t.Control.FontWeightProperty];r.forEach(function(t){return t.Store.ListenToChanged(e,t,function(e,r){return n.setFontProperty(t,r.NewValue)},e)})},a.prototype.CreateView=function(){return new t.Internal.TextBoxView},Object.defineProperty(a.prototype,"Cursor",{get:function(){var t=this.GetValue(e.FrameworkElement.CursorProperty);return t===e.CursorType.Default?e.CursorType.IBeam:t},enumerable:!0,configurable:!0}),a.prototype.OnApplyTemplate=function(){i.prototype.OnApplyTemplate.call(this),this.$ContentProxy.setElement(this.GetTemplateChild("ContentElement",e.FrameworkElement),this.$View)},a.prototype.OnLostFocus=function(e){i.prototype.OnLostFocus.call(this,e),this.$View.setIsFocused(!1)},a.prototype.OnGotFocus=function(e){i.prototype.OnGotFocus.call(this,e),this.$View.setIsFocused(!0)},a.prototype.OnMouseLeftButtonDown=function(e){if(!e.Handled){e.Handled=!0,this.Focus(),this._Captured=this.CaptureMouse(),this._Selecting=!0;var t=this.$View.GetCursorFromPoint(e.GetPosition(this.$View));this.$Proxy.beginSelect(t)}},a.prototype.OnMouseLeftButtonUp=function(e){e.Handled||(this._Captured&&this.ReleaseMouseCapture(),e.Handled=!0,this._Selecting=!1,this._Captured=!1)},a.prototype.OnMouseMove=function(e){if(this._Selecting){e.Handled=!0;var t=this.$View.GetCursorFromPoint(e.GetPosition(this.$View));this.$Proxy.adjustSelection(t)}},a.prototype.OnTouchDown=function(e){if(i.prototype.OnTouchDown.call(this,e),!e.Handled){e.Handled=!0,this.Focus(),e.Device.Capture(this),this._Selecting=!0;var t=e.Device.GetTouchPoint(this.$View).Position,n=this.$View.GetCursorFromPoint(t);this.$Proxy.beginSelect(n)}},a.prototype.OnTouchUp=function(e){i.prototype.OnTouchUp.call(this,e),e.Handled||(e.Device.Captured===this&&e.Device.ReleaseCapture(this),e.Handled=!0,this._Selecting=!1)},a.prototype.OnTouchMove=function(e){if(i.prototype.OnTouchMove.call(this,e),this._Selecting){e.Handled=!0;var t=e.Device.GetTouchPoint(this.$View).Position,n=this.$View.GetCursorFromPoint(t);this.$Proxy.adjustSelection(n)}},a.prototype.OnKeyDown=function(e){switch(e.Key){case r.Shift:case r.Ctrl:case r.Alt:return}var t=this.IsReadOnly,n=!1,o=this.$Proxy;switch(o.begin(),e.Key){case r.Back:if(t)break;n=this._KeyDownBackSpace(e.Modifiers);break;case r.Delete:if(t)break;n=e.Modifiers.Shift?!0:this._KeyDownDelete(e.Modifiers);break;case r.Insert:e.Modifiers.Shift?n=!0:e.Modifiers.Ctrl&&(n=!0);break;case r.PageDown:n=this._KeyDownPageDown(e.Modifiers);break;case r.PageUp:n=this._KeyDownPageUp(e.Modifiers);break;case r.Home:n=this._KeyDownHome(e.Modifiers);break;case r.End:n=this._KeyDownEnd(e.Modifiers);break;case r.Left:n=this._KeyDownLeft(e.Modifiers);break;case r.Right:n=this._KeyDownRight(e.Modifiers);break;case r.Down:n=this._KeyDownDown(e.Modifiers);break;case r.Up:n=this._KeyDownUp(e.Modifiers);break;default:if(e.Modifiers.Ctrl)switch(e.Key){
case r.A:n=!0,o.selectAll();break;case r.C:n=!0;break;case r.X:if(t)break;n=!0;break;case r.Y:t||(n=!0,o.redo());break;case r.Z:t||(n=!0,o.undo())}}n&&(e.Handled=n),o.end(),e.Handled||t||this.PostOnKeyDown(e)},a.prototype.PostOnKeyDown=function(e){if(!e.Handled&&!e.Modifiers.Alt&&!e.Modifiers.Ctrl){var t=this.$Proxy;t.begin(),e.Key===r.Enter?this.AcceptsReturn===!0&&(t.enterText("\n"),e.Handled=!0):null==e.Char||e.Modifiers.Ctrl||e.Modifiers.Alt||(t.enterText(e.Char),e.Handled=!0),t.end()}},a.prototype._KeyDownBackSpace=function(e){if(e.Shift||e.Alt)return!1;var t=this.$Proxy,n=t.selAnchor,r=t.selCursor,o=0,i=0;return r!==n?(i=Math.abs(r-n),o=Math.min(n,r)):e.Ctrl?(o=this.$Advancer.CursorPrevWord(r),i=r-o):r>0&&(o=this.$Advancer.CursorPrevChar(r),i=r-o),t.removeText(o,i),!0},a.prototype._KeyDownDelete=function(e){if(e.Shift||e.Alt)return!1;var t=this.$Proxy,n=t.selAnchor,r=t.selCursor,o=0,i=0;return r!==n?(i=Math.abs(r-n),o=Math.min(n,r)):e.Ctrl?(i=this.$Advancer.CursorNextWord(r)-r,o=r):(i=this.$Advancer.CursorNextChar(r)-r,o=r),t.removeText(o,i)},a.prototype._KeyDownPageDown=function(e){if(e.Alt)return!1;var t=this.$Proxy,n=t.selAnchor,r=t.selCursor;return r=this.$Advancer.CursorDown(r,!0),e.Shift||(n=r),t.setAnchorCursor(n,r)},a.prototype._KeyDownPageUp=function(e){if(e.Alt)return!1;var t=this.$Proxy,n=t.selAnchor,r=t.selCursor;return r=this.$Advancer.CursorUp(r,!0),e.Shift||(n=r),t.setAnchorCursor(n,r)},a.prototype._KeyDownHome=function(e){if(e.Alt)return!1;var t=this.$Proxy,n=t.selAnchor,r=t.selCursor;return r=e.Ctrl?this.$Advancer.CursorBegin(r):this.$Advancer.CursorLineBegin(r),e.Shift||(n=r),t.setAnchorCursor(n,r)},a.prototype._KeyDownEnd=function(e){if(e.Alt)return!1;var t=this.$Proxy,n=t.selAnchor,r=t.selCursor;return r=e.Ctrl?this.$Advancer.CursorEnd(r):this.$Advancer.CursorLineEnd(r),e.Shift||(n=r),t.setAnchorCursor(n,r)},a.prototype._KeyDownLeft=function(e){if(e.Alt)return!1;var t=this.$Proxy,n=t.selAnchor,r=t.selCursor;return r=e.Ctrl?this.$Advancer.CursorPrevWord(r):e.Shift||n===r?this.$Advancer.CursorPrevChar(r):Math.min(n,r),e.Shift||(n=r),t.setAnchorCursor(n,r)},a.prototype._KeyDownRight=function(e){if(e.Alt)return!1;var t=this.$Proxy,n=t.selAnchor,r=t.selCursor;return r=e.Ctrl?this.$Advancer.CursorNextWord(r):e.Shift||n===r?this.$Advancer.CursorNextChar(r):Math.max(n,r),e.Shift||(n=r),t.setAnchorCursor(n,r)},a.prototype._KeyDownDown=function(e){if(e.Alt)return!1;var t=this.$Proxy,n=this.$Advancer.CursorDown(t.selCursor,!1),r=t.selAnchor;return e.Shift||(r=n),t.setAnchorCursor(r,n)},a.prototype._KeyDownUp=function(e){if(e.Alt)return!1;var t=this.$Proxy,n=this.$Advancer.CursorUp(t.selCursor,!1),r=t.selAnchor;return e.Shift||(r=n),t.setAnchorCursor(r,n)},a.CaretBrushProperty=DependencyProperty.RegisterCore("CaretBrush",function(){return e.Media.Brush},a),a.SelectionForegroundProperty=DependencyProperty.RegisterCore("SelectionForeground",function(){return e.Media.Brush},a),a.SelectionBackgroundProperty=DependencyProperty.RegisterCore("SelectionBackground",function(){return e.Media.Brush},a),a.SelectionLengthProperty=DependencyProperty.RegisterFull("SelectionLength",function(){return Number},a,0,void 0,void 0,!0,n),a.SelectionStartProperty=DependencyProperty.RegisterFull("SelectionStart",function(){return Number},a,0,void 0,void 0,!0,n),a.BaselineOffsetProperty=DependencyProperty.Register("BaselineOffset",function(){return Number},a),a.MaxLengthProperty=DependencyProperty.RegisterFull("MaxLength",function(){return Number},a,0,void 0,void 0,void 0,n),a}(t.Control);t.TextBoxBase=i,e.RegisterType(i,e.XMLNSINTERNAL);var a;!function(t){e.DPReaction(i.CaretBrushProperty,function(e,t,n){e.$View.setCaretBrush(n)}),e.DPReaction(i.SelectionStartProperty,function(e,t,n){e.$Proxy.setSelectionStart(n),e.$View.setSelectionStart(n)},!1),e.DPReaction(i.SelectionLengthProperty,function(e,t,n){e.$Proxy.setSelectionLength(n),e.$View.setSelectionLength(n)},!1),e.DPReaction(i.SelectionBackgroundProperty,function(e,t,n){e.$View.setFontAttr("selectionBackground",n),e.XamlNode.LayoutUpdater.invalidate()}),e.DPReaction(i.SelectionForegroundProperty,function(e,t,n){e.$View.setFontAttr("selectionForeground",n),e.XamlNode.LayoutUpdater.invalidate()}),e.DPReaction(i.MaxLengthProperty,function(e,t,n){e.$Proxy.maxLength=n},!1)}(a||(a={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){var o=this;n.call(this,e.Text.EmitChangedType.TEXT),this.DefaultStyleKey=r;var i=this.$Proxy;i.SyncSelectionStart=function(e){return o.SetCurrentValue(r.SelectionStartProperty,e)},i.SyncSelectionLength=function(e){return o.SetCurrentValue(r.SelectionLengthProperty,e)},i.SyncText=function(e){return o.SetCurrentValue(r.PasswordProperty,e)},this.$Advancer=new t.Internal.PasswordBoxCursorAdvancer(this.$Proxy)}return __extends(r,n),Object.defineProperty(r.prototype,"DisplayText",{get:function(){for(var e="",t=this.$Proxy.text.length,n=this.PasswordChar;t>0;)1&t&&(e+=n),t>>=1,n+=n;return e},enumerable:!0,configurable:!0}),r.PasswordCharProperty=DependencyProperty.Register("PasswordChar",function(){return String},r,String.fromCharCode(9679)),r.PasswordProperty=DependencyProperty.Register("Password",function(){return String},r),r}(t.TextBoxBase);t.PasswordBox=n,e.CoreLibrary.add(n),t.TemplateVisualStates(n,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"},{GroupName:"ValidationStates",Name:"Valid"},{GroupName:"ValidationStates",Name:"InvalidUnfocused"},{GroupName:"ValidationStates",Name:"InvalidFocused"});var r;!function(t){e.DPReaction(n.PasswordCharProperty,function(e,t,n){e.$View.setText(e.DisplayText)},!1),e.DPReaction(n.PasswordProperty,function(e,t,n){e.$Proxy.setText(n),e.$View.setText(e.DisplayText)},!1)}(r||(r={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this.DefaultStyleKey=r}return __extends(r,n),r.prototype.OnIsIndeterminateChanged=function(e){this._UpdateIndicator(),this.UpdateVisualState()},r.prototype.OnMinimumChanged=function(e,t){n.prototype.OnMinimumChanged.call(this,e,t),this._UpdateIndicator()},r.prototype.OnMaximumChanged=function(e,t){n.prototype.OnMaximumChanged.call(this,e,t),this._UpdateIndicator()},r.prototype.OnValueChanged=function(e,t){n.prototype.OnValueChanged.call(this,e,t),this._UpdateIndicator()},r.prototype.OnApplyTemplate=function(){n.prototype.OnApplyTemplate.call(this);var t=this._Track;t&&t.SizeChanged.off(this._OnTrackSizeChanged,this),t=this._Track=this.GetTemplateChild("ProgressBarTrack",e.FrameworkElement),this._Indicator=this.GetTemplateChild("ProgressBarIndicator",e.FrameworkElement),t&&t.SizeChanged.on(this._OnTrackSizeChanged,this),this.UpdateVisualState(!1)},r.prototype.GoToStates=function(e){e(this.IsIndeterminate?"Indeterminate":"Determinate")},r.prototype._OnTrackSizeChanged=function(e,t){this._UpdateIndicator()},r.prototype._UpdateIndicator=function(){var n=this.Minimum,r=this.Maximum,o=this.Value,i=this._Indicator;if(i){var a=e.VisualTreeHelper.GetParent(i);if(a){var s=i.Margin,u=s?s.left+s.right:0,l=null;a instanceof t.Border?l=a.Padding:a instanceof t.Control&&(l=a.Padding),l&&(u+=l.left,u+=l.right);var c=1;this.IsIndeterminate||r===n||(c=(o-n)/(r-n));var p=Math.max(0,a.ActualWidth-u);i.Width=p*c}}},r.IsIndeterminateProperty=DependencyProperty.Register("IsIndeterminate",function(){return Boolean},r,!1,function(e,t){return e.OnIsIndeterminateChanged(t)}),r}(t.Primitives.RangeBase);t.ProgressBar=n,e.CoreLibrary.add(n),t.TemplateVisualStates(n,{GroupName:"CommonStates",Name:"Indeterminate"},{GroupName:"CommonStates",Name:"Determinate"}),t.TemplateParts(n,{Name:"ProgressBarIndicator",Type:e.FrameworkElement},{Name:"ProgressBarTrack",Type:e.FrameworkElement})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,t){e||(e="");var n=i[e];n||(i[e]=n=[]),n.push(t)}function r(e,t){e||(e="");var n=i[e];if(n){var r=n.indexOf(t);r>-1&&n.splice(r,1)}}var o=function(e){function t(){e.call(this),this.DefaultStyleKey=t,n("",this)}return __extends(t,e),t.prototype.OnGroupNameChanged=function(e){r(e.OldValue,this),n(e.NewValue,this)},t.prototype.OnIsCheckedChanged=function(t){t.NewValue===!0&&this.UpdateRadioButtonGroup(),e.prototype.OnIsCheckedChanged.call(this,t)},t.prototype.OnToggle=function(){this.IsChecked=!0},t.prototype.UpdateRadioButtonGroup=function(){var e=this.GroupName||"",t=i[e];if(t){var n=null;if(e)for(var r=this.XamlNode.GetVisualRoot(),o=0;o<t.length;o++)n=t[o],n!==this&&n.IsChecked&&r===n.XamlNode.GetVisualRoot()&&(n.IsChecked=!1);else for(var a=this.XamlNode.VisualParentNode,o=0;o<t.length;o++)n=t[o],n!==this&&n.IsChecked&&a===n.XamlNode.VisualParentNode&&(n.IsChecked=!1)}},t.GroupNameProperty=DependencyProperty.Register("GroupName",function(){return String},t,!1,function(e,t){return e.OnGroupNameChanged(t)}),t}(t.Primitives.ToggleButton);t.RadioButton=o,e.CoreLibrary.add(o),t.TemplateVisualStates(o,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Pressed"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"},{GroupName:"CheckStates",Name:"Unchecked"},{GroupName:"CheckStates",Name:"Checked"},{GroupName:"CheckStates",Name:"Indeterminate"},{GroupName:"ValidationStates",Name:"InvalidUnfocused"},{GroupName:"ValidationStates",Name:"InvalidFocused"},{GroupName:"ValidationStates",Name:"Valid"});var i=[]}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function e(){}return e}();t._RichTextBoxView=n,e.RegisterType(n,e.XMLNSINTERNAL);var r=function(e){function t(){e.call(this),this.DefaultStyleKey=t}return __extends(t,e),t}(t.Control);t.RichTextBox=r,e.CoreLibrary.add(r)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e){if(!e||e instanceof o)return e;var n=e.toString(),r=new o;if("auto"===n.toLowerCase())return r.Height=new t.GridLength(0,i.Auto),r;if("*"===n)return r.Height=new t.GridLength(1,i.Star),r;var a=parseFloat(n);if(isNaN(a))throw new XamlParseException("Invalid RowDefinition: '"+n+"'.");return r.Height=new t.GridLength(a,"*"===n[n.length-1]?i.Star:i.Pixel),r}function r(e){if(!e||e instanceof a)return e;if("string"==typeof e){for(var t,r=e.split(" "),o=r.length,i=new a,s=0;o>s;s++)(t=n(r[s]))&&i.Add(t);return i}return void 0}var o=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.setActualHeight=function(e){this.SetCurrentValue(r.ActualHeightProperty,e)},r.HeightProperty=DependencyProperty.Register("Height",function(){return t.GridLength},r,void 0,e.Incite),r.MaxHeightProperty=DependencyProperty.Register("MaxHeight",function(){return Number},r,Number.POSITIVE_INFINITY,e.Incite),r.MinHeightProperty=DependencyProperty.Register("MinHeight",function(){return Number},r,0,e.Incite),r.ActualHeightProperty=DependencyProperty.RegisterReadOnly("ActualHeight",function(){return Number},r,0),r}(e.DependencyObject);t.RowDefinition=o,e.CoreLibrary.add(o);var i=minerva.controls.grid.GridUnitType;nullstone.registerTypeConverter(o,n);var a=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype._RaiseItemAdded=function(t,n){e.Incite(this,{item:t,index:n,add:!0})},n.prototype._RaiseItemRemoved=function(t,n){e.Incite(this,{item:t,index:n,add:!1})},n}(e.XamlObjectCollection);t.RowDefinitionCollection=a,e.CoreLibrary.add(a),nullstone.registerTypeConverter(a,r)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=minerva.controls.grid.GridUnitType,r=function(r){function o(){r.call(this),this._DragValue=0,this.DefaultStyleKey=o,this.SizeChanged.on(this._HandleSizeChanged,this)}return __extends(o,r),o.prototype.OnApplyTemplate=function(){r.prototype.OnApplyTemplate.call(this),this.$HorizontalTemplate=this.GetTemplateChild("HorizontalTemplate",e.FrameworkElement),this.$HorizontalLargeIncrease=this.GetTemplateChild("HorizontalTrackLargeChangeIncreaseRepeatButton",t.Primitives.RepeatButton),this.$HorizontalLargeDecrease=this.GetTemplateChild("HorizontalTrackLargeChangeDecreaseRepeatButton",t.Primitives.RepeatButton),this.$HorizontalThumb=this.GetTemplateChild("HorizontalThumb",t.Primitives.Thumb),this.$VerticalTemplate=this.GetTemplateChild("VerticalTemplate",e.FrameworkElement),this.$VerticalLargeIncrease=this.GetTemplateChild("VerticalTrackLargeChangeIncreaseRepeatButton",t.Primitives.RepeatButton),this.$VerticalLargeDecrease=this.GetTemplateChild("VerticalTrackLargeChangeDecreaseRepeatButton",t.Primitives.RepeatButton),this.$VerticalThumb=this.GetTemplateChild("VerticalThumb",t.Primitives.Thumb),null!=this.$HorizontalThumb&&(this.$HorizontalThumb.DragStarted.on(this._OnThumbDragStarted,this),this.$HorizontalThumb.DragDelta.on(this._OnThumbDragDelta,this)),null!=this.$HorizontalLargeDecrease&&this.$HorizontalLargeDecrease.Click.on(function(e,t){this.Focus(),this.Value-=this.LargeChange},this),null!=this.$HorizontalLargeIncrease&&this.$HorizontalLargeIncrease.Click.on(function(e,t){this.Focus(),this.Value+=this.LargeChange},this),null!=this.$VerticalThumb&&(this.$VerticalThumb.DragStarted.on(this._OnThumbDragStarted,this),this.$VerticalThumb.DragDelta.on(this._OnThumbDragDelta,this)),null!=this.$VerticalLargeDecrease&&this.$VerticalLargeDecrease.Click.on(function(e,t){this.Focus(),this.Value-=this.LargeChange},this),null!=this.$VerticalLargeIncrease&&this.$VerticalLargeIncrease.Click.on(function(e,t){this.Focus(),this.Value+=this.LargeChange},this),this._OnOrientationChanged(),this.UpdateVisualState(!1)},o.prototype.OnIsEnabledChanged=function(e){r.prototype.OnIsEnabledChanged.call(this,e),this.UpdateVisualState()},o.prototype.OnMinimumChanged=function(e,t){r.prototype.OnMinimumChanged.call(this,e,t),this._UpdateTrackLayout()},o.prototype.OnMaximumChanged=function(e,t){r.prototype.OnMaximumChanged.call(this,e,t),this._UpdateTrackLayout()},o.prototype.OnValueChanged=function(e,t){r.prototype.OnValueChanged.call(this,e,t),this._UpdateTrackLayout()},o.prototype._HandleSizeChanged=function(e,t){this._UpdateTrackLayout()},o.prototype._OnOrientationChanged=function(){var t=this.Orientation===e.Orientation.Horizontal;null!=this.$HorizontalTemplate&&(this.$HorizontalTemplate.Visibility=t?e.Visibility.Visible:e.Visibility.Collapsed),null!=this.$VerticalTemplate&&(this.$VerticalTemplate.Visibility=t?e.Visibility.Collapsed:e.Visibility.Visible),this._UpdateTrackLayout()},o.prototype._UpdateTrackLayout=function(){var r=this.Maximum,o=this.Minimum,i=this.Value,a=this.Orientation===e.Orientation.Horizontal,s=a?this.$HorizontalTemplate:this.$VerticalTemplate;if(s instanceof t.Grid){var u,l,c,p=s,d=this.IsDirectionReversed;if(a){var h=p.ColumnDefinitions;u=this.$HorizontalLargeDecrease,l=this.$HorizontalLargeIncrease,c=this.$HorizontalThumb,h&&3===h.Count&&(h.GetValueAt(0).Width=new t.GridLength(1,d?n.Star:n.Auto),h.GetValueAt(2).Width=new t.GridLength(1,d?n.Auto:n.Star),null!=u&&t.Grid.SetColumn(u,d?2:0),null!=l&&t.Grid.SetColumn(l,d?0:2))}else{var y=p.RowDefinitions;u=this.$VerticalLargeDecrease,l=this.$VerticalLargeIncrease,c=this.$VerticalThumb,y&&3===y.Count&&(y.GetValueAt(0).Height=new t.GridLength(1,d?n.Auto:n.Star),y.GetValueAt(2).Height=new t.GridLength(1,d?n.Star:n.Auto),null!=u&&t.Grid.SetRow(u,d?0:2),null!=l&&t.Grid.SetRow(l,d?2:0))}if(r!==o){var f=i/(r-o);null!=u&&null!=c&&(a?u.Width=Math.max(0,f*(this.ActualWidth-c.ActualWidth)):u.Height=Math.max(0,f*(this.ActualHeight-c.ActualHeight)))}}},o.prototype._OnThumbDragStarted=function(e,t){this.Focus(),this._DragValue=this.Value},o.prototype._OnThumbDragDelta=function(t,n){var r=0,o=this.Orientation===e.Orientation.Horizontal;if(o&&null!=this.$HorizontalThumb?r=n.HorizontalChange/(this.ActualWidth-this.$HorizontalThumb.ActualWidth)*(this.Maximum-this.Minimum):o||null==this.$VerticalThumb||(r=-n.VerticalChange/(this.ActualHeight-this.$VerticalThumb.ActualHeight)*(this.Maximum-this.Minimum)),!isNaN(r)&&isFinite(r)){this._DragValue+=this.IsDirectionReversed?-r:r;var i=Math.min(this.Maximum,Math.max(this.Minimum,this._DragValue));i!=this.Value&&(this.Value=i)}},o.prototype.OnMouseEnter=function(t){r.prototype.OnMouseEnter.call(this,t),(this.Orientation===e.Orientation.Horizontal&&null!=this.$HorizontalThumb&&this.$HorizontalThumb.IsDragging||this.Orientation===e.Orientation.Vertical&&null!=this.$VerticalThumb&&this.$VerticalThumb.IsDragging)&&this.UpdateVisualState()},o.prototype.OnMouseLeave=function(t){r.prototype.OnMouseLeave.call(this,t),(this.Orientation===e.Orientation.Horizontal&&null!=this.$HorizontalThumb&&this.$HorizontalThumb.IsDragging||this.Orientation===e.Orientation.Vertical&&null!=this.$VerticalThumb&&this.$VerticalThumb.IsDragging)&&this.UpdateVisualState()},o.prototype.OnMouseLeftButtonDown=function(e){r.prototype.OnMouseLeftButtonDown.call(this,e),e.Handled||(e.Handled=!0,this.Focus(),this.CaptureMouse())},o.prototype.OnLostMouseCapture=function(e){r.prototype.OnLostMouseCapture.call(this,e),this.UpdateVisualState()},o.prototype.OnKeyDown=function(t){if(r.prototype.OnKeyDown.call(this,t),!t.Handled&&this.IsEnabled)switch(t.Key){case e.Input.Key.Left:case e.Input.Key.Down:this.Value+=this.IsDirectionReversed?this.SmallChange:-this.SmallChange;break;case e.Input.Key.Right:case e.Input.Key.Up:this.Value+=this.IsDirectionReversed?-this.SmallChange:this.SmallChange;break;case e.Input.Key.Home:this.Value=this.Minimum;break;case e.Input.Key.End:this.Value=this.Maximum}},o.prototype.OnGotFocus=function(e){r.prototype.OnGotFocus.call(this,e),this.SetValueInternal(o.IsFocusedProperty,!0)},o.prototype.OnLostFocus=function(e){r.prototype.OnLostFocus.call(this,e),this.SetValueInternal(o.IsFocusedProperty,!1)},o.IsDirectionReversedProperty=DependencyProperty.RegisterCore("IsDirectionReversed",function(){return Boolean},o,!1,function(e,t){return e._UpdateTrackLayout()}),o.IsFocusedProperty=DependencyProperty.RegisterReadOnlyCore("IsFocused",function(){return Boolean},o,!1,function(e,t){return e.UpdateVisualState()}),o.OrientationProperty=DependencyProperty.RegisterCore("Orientation",function(){return new e.Enum(e.Orientation)},o,e.Orientation.Horizontal,function(e,t){return e._OnOrientationChanged()}),o}(t.Primitives.RangeBase);t.Slider=r,e.CoreLibrary.add(r),t.TemplateVisualStates(r,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"}),t.TemplateParts(r,{Name:"HorizontalTemplate",Type:e.FrameworkElement},{Name:"HorizontalThumb",Type:t.Primitives.Thumb},{Name:"HorizontalTrackLargeChangeIncreaseRepeatButton",Type:t.Primitives.RepeatButton},{Name:"HorizontalTrackLargeChangeDecreaseRepeatButton",Type:t.Primitives.RepeatButton},{Name:"VerticalTemplate",Type:e.FrameworkElement},{Name:"VerticalThumb",Type:t.Primitives.Thumb},{Name:"VerticalTrackLargeChangeIncreaseRepeatButton",Type:t.Primitives.RepeatButton},{Name:"VerticalTrackLargeChangeDecreaseRepeatButton",Type:t.Primitives.RepeatButton})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.CreateLayoutUpdater=function(){return new minerva.controls.stackpanel.StackPanelUpdater},n.OrientationProperty=DependencyProperty.Register("Orientation",function(){return new e.Enum(e.Orientation)},n,e.Orientation.Vertical),n}(t.Panel);t.StackPanel=n,e.CoreLibrary.add(n);var r;!function(t){e.UIReaction(n.OrientationProperty,function(e,t,n){e.invalidateMeasure(),e.invalidateArrange()},!1)}(r||(r={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=minerva.controls.textblock.TextBlockUpdater,r=function(t){function n(n){t.call(this,n),this._IsDocAuto=!1,this._SettingText=!1,this._SettingInlines=!1,this._AutoRun=new e.Documents.Run}return __extends(n,t),n.prototype.GetInheritedEnumerator=function(){var e=this.XObject,t=e.Inlines;return t?t.GetNodeEnumerator():void 0},n.prototype.TextChanged=function(e){if(!this._SettingInlines&&(this._AutoRun.Text=e.NewValue,!this._IsDocAuto)){this._IsDocAuto=!0,this.LayoutUpdater.tree.clearText(),this._SettingText=!0;var t=this.XObject.Inlines;t.Clear(),t.Add(this._AutoRun),this.LayoutUpdater.invalidateTextMetrics(),this._SettingText=!1}},n.prototype.InlinesChanged=function(t,n,r){var i=this.XObject;r&&e.Providers.InheritedStore.PropagateInheritedOnAdd(i,t.XamlNode);var a=this.LayoutUpdater;if(r?a.tree.onTextAttached(t.TextUpdater,n):a.tree.onTextDetached(t.TextUpdater),r?e.ReactTo(t,this,this.InlineChanged):e.UnreactTo(t,this),!this._SettingText){this._SettingInlines=!0;for(var s=i.Inlines,u="",l=s.getEnumerator();l.moveNext();)u+=l.current._SerializeText();i.SetCurrentValue(o.TextProperty,u),this._SettingInlines=!1,a.invalidateTextMetrics()}},n.prototype.InlineChanged=function(e){switch(e.type){case"font":this.LayoutUpdater.invalidateFont(e.full);break;case"text":this.LayoutUpdater.invalidateTextMetrics()}},n}(e.FENode);t.TextBlockNode=r;var o=function(o){function a(){var t=this;o.call(this);var n=a.InlinesProperty.Initialize(this);n.AttachTo(this),e.ReactTo(n,this,function(e){return t.XamlNode.InlinesChanged(e.item,e.index,e.add)}),e.UIReaction(a.ForegroundProperty,function(e,t,n){return e.invalidate()},!0,!0,this),e.UIReaction(a.PaddingProperty,function(e,t,n){return e.invalidateTextMetrics()},!1,!0,this),e.UIReaction(a.LineStackingStrategyProperty,function(e,t,n){return e.invalidateTextMetrics()},!1,!0,this),e.UIReaction(a.LineHeightProperty,function(e,t,n){return e.invalidateTextMetrics()},!1,!0,this),e.UIReaction(a.TextAlignmentProperty,function(e,t,n){return e.invalidateTextMetrics()},!1,!0,this),e.UIReaction(a.TextTrimmingProperty,function(e,t,n){return e.invalidateTextMetrics()},!1,!0,this),e.UIReaction(a.TextWrappingProperty,function(e,t,n){return e.invalidateTextMetrics()},!1,!0,this)}return __extends(a,o),a.prototype.CreateNode=function(){return new r(this)},a.prototype.CreateLayoutUpdater=function(){return new n},a.prototype.IsInheritable=function(e){return i.indexOf(e)>-1?!0:o.prototype.IsInheritable.call(this,e)},a.PaddingProperty=DependencyProperty.RegisterCore("Padding",function(){return Thickness},a),a.FontFamilyProperty=e.InheritableOwner.FontFamilyProperty.ExtendTo(a),a.FontSizeProperty=e.InheritableOwner.FontSizeProperty.ExtendTo(a),a.FontStretchProperty=e.InheritableOwner.FontStretchProperty.ExtendTo(a),a.FontStyleProperty=e.InheritableOwner.FontStyleProperty.ExtendTo(a),a.FontWeightProperty=e.InheritableOwner.FontWeightProperty.ExtendTo(a),a.ForegroundProperty=e.InheritableOwner.ForegroundProperty.ExtendTo(a),a.TextDecorationsProperty=e.InheritableOwner.TextDecorationsProperty.ExtendTo(a),a.TextProperty=DependencyProperty.Register("Text",function(){return String},a,"",function(e,t){return e.XamlNode.TextChanged(t)}),a.InlinesProperty=DependencyProperty.RegisterImmutable("Inlines",function(){return e.Documents.InlineCollection},a),a.LineStackingStrategyProperty=DependencyProperty.RegisterCore("LineStackingStrategy",function(){return new e.Enum(e.LineStackingStrategy)},a,e.LineStackingStrategy.MaxHeight),a.LineHeightProperty=DependencyProperty.RegisterCore("LineHeight",function(){return Number},a,NaN),a.TextAlignmentProperty=DependencyProperty.RegisterCore("TextAlignment",function(){return new e.Enum(e.TextAlignment)},a,e.TextAlignment.Left),a.TextTrimmingProperty=DependencyProperty.RegisterCore("TextTrimming",function(){return new e.Enum(t.TextTrimming)},a,t.TextTrimming.None),a.TextWrappingProperty=DependencyProperty.RegisterCore("TextWrapping",function(){return new e.Enum(t.TextWrapping)},a,t.TextWrapping.NoWrap),a}(e.FrameworkElement);t.TextBlock=o,e.CoreLibrary.add(o),e.Markup.Content(o,o.InlinesProperty),e.Markup.TextContent(o,o.TextProperty);var i=[o.FontFamilyProperty,o.FontSizeProperty,o.FontStretchProperty,o.FontStyleProperty,o.FontWeightProperty,o.ForegroundProperty]}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){var o=this;n.call(this,e.Text.EmitChangedType.TEXT|e.Text.EmitChangedType.SELECTION),this.DefaultStyleKey=r;var i=this.$Proxy;i.SyncSelectionStart=function(e){return o.SetCurrentValue(r.SelectionStartProperty,e)},i.SyncSelectionLength=function(e){return o.SetCurrentValue(r.SelectionLengthProperty,e)},i.SyncText=function(e){return o.SetCurrentValue(r.TextProperty,e)},this.$Advancer=new t.Internal.TextBoxCursorAdvancer(this.$Proxy)}return __extends(r,n),r.prototype.OnApplyTemplate=function(){n.prototype.OnApplyTemplate.call(this);var e=this.TextWrapping===t.TextWrapping.Wrap?t.ScrollBarVisibility.Disabled:this.HorizontalScrollBarVisibility;this.$ContentProxy.setHorizontalScrollBar(e),this.$ContentProxy.setVerticalScrollBar(this.VerticalScrollBarVisibility)},Object.defineProperty(r.prototype,"DisplayText",{get:function(){return this.Text},enumerable:!0,configurable:!0}),r.prototype.OnMouseEnter=function(e){n.prototype.OnMouseEnter.call(this,e),this.UpdateVisualState()},r.prototype.OnMouseLeave=function(e){n.prototype.OnMouseLeave.call(this,e),this.UpdateVisualState()},r.prototype.OnGotFocus=function(e){n.prototype.OnGotFocus.call(this,e),this.UpdateVisualState()},r.prototype.OnLostFocus=function(e){n.prototype.OnLostFocus.call(this,e),this.UpdateVisualState()},r.prototype.GoToStateCommon=function(e){return e(this.IsEnabled?this.IsReadOnly?"ReadOnly":this.IsMouseOver?"MouseOver":"Normal":"Disabled")},r.prototype.SelectAll=function(){this.$Proxy.selectAll()},r.prototype.Select=function(e,t){this.$Proxy.select(e,t)},r.AcceptsReturnProperty=DependencyProperty.Register("AcceptsReturn",function(){return Boolean},r,!1),r.IsReadOnlyProperty=DependencyProperty.Register("IsReadOnly",function(){return Boolean},r,!1),r.TextProperty=DependencyProperty.Register("Text",function(){return String},r),r.TextAlignmentProperty=DependencyProperty.Register("TextAlignment",function(){return new e.Enum(e.TextAlignment)},r,e.TextAlignment.Left),r.TextWrappingProperty=DependencyProperty.Register("TextWrapping",function(){return new e.Enum(t.TextWrapping)},r,t.TextWrapping.NoWrap),r.HorizontalScrollBarVisibilityProperty=DependencyProperty.Register("HorizontalScrollBarVisibility",function(){return new e.Enum(t.ScrollBarVisibility)},r,t.ScrollBarVisibility.Hidden),r.VerticalScrollBarVisibilityProperty=DependencyProperty.Register("VerticalScrollBarVisibility",function(){return new e.Enum(t.ScrollBarVisibility)},r,t.ScrollBarVisibility.Hidden),r}(t.TextBoxBase);t.TextBox=n,e.CoreLibrary.add(n),t.TemplateVisualStates(n,{GroupName:"CommonStates",Name:"Normal"},{GroupName:"CommonStates",Name:"MouseOver"},{GroupName:"CommonStates",Name:"Disabled"},{GroupName:"CommonStates",Name:"ReadOnly"},{GroupName:"FocusStates",Name:"Unfocused"},{GroupName:"FocusStates",Name:"Focused"},{GroupName:"ValidationStates",Name:"Valid"},{GroupName:"ValidationStates",Name:"InvalidUnfocused"},{GroupName:"ValidationStates",Name:"InvalidFocused"}),t.TemplateParts(n,{Name:"ContentElement",Type:e.FrameworkElement});var r;!function(r){e.DPReaction(n.AcceptsReturnProperty,function(e,t,n){e.$Proxy.acceptsReturn=n===!0},!1),e.DPReaction(n.IsReadOnlyProperty,function(e,t,n){e.$View.setIsReadOnly(n===!0)},!1),e.DPReaction(n.TextAlignmentProperty,function(e,t,n){return e.$View.setTextAlignment(n)},!1),e.DPReaction(n.TextWrappingProperty,function(e,n,r){var o=r===t.TextWrapping.Wrap?t.ScrollBarVisibility.Disabled:e.HorizontalScrollBarVisibility;e.$ContentProxy.setHorizontalScrollBar(o),e.$View.setTextWrapping(r)},!1),e.DPReaction(n.HorizontalScrollBarVisibilityProperty,function(e,n,r){var o=e.TextWrapping===t.TextWrapping.Wrap?t.ScrollBarVisibility.Disabled:e.HorizontalScrollBarVisibility;e.$ContentProxy.setHorizontalScrollBar(o)},!1),e.DPReaction(n.VerticalScrollBarVisibilityProperty,function(e,t,n){e.$ContentProxy.setVerticalScrollBar(n)},!1),e.DPReaction(n.TextProperty,function(e,t,n){e.$Proxy.setText(n),e.$View.setText(e.DisplayText)},!1)}(r||(r={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this._TooltipParent=null,this._TooltipParentDCListener=null,this.PlacementOverride=null,this.PlacementTargetOverride=null,this.Opened=new e.RoutedEvent,this.Closed=new e.RoutedEvent,this._ParentPopup=null,this.DefaultStyleKey=r}return __extends(r,n),Object.defineProperty(r.prototype,"TooltipParent",{get:function(){return this._TooltipParent},set:function(t){this._TooltipParentDCListener&&this._TooltipParentDCListener.Detach(),this._TooltipParent=t,this._TooltipParent&&(this._TooltipParentDCListener=e.DependencyObject.DataContextProperty.Store.ListenToChanged(this._TooltipParent,e.DependencyObject.DataContextProperty,this.OnTooltipParentDataContextChanged,this))},enumerable:!0,configurable:!0}),r.prototype.OnApplyTemplate=function(){n.prototype.OnApplyTemplate.call(this),this.UpdateVisualState(!1)},r.prototype.OnHorizontalOffsetChanged=function(e){e.NewValue!==e.OldValue&&this.OnOffsetChanged(e.NewValue,0)},r.prototype.OnVerticalOffsetChanged=function(e){e.NewValue!==e.OldValue&&this.OnOffsetChanged(0,e.NewValue)},r.prototype.OnIsOpenChanged=function(e){e.NewValue?(this._ParentPopup||this.HookupParentPopup(),this._ParentPopup.IsOpen=!0,this.PerformPlacement(this.HorizontalOffset,this.VerticalOffset)):this._ParentPopup.IsOpen=!1,this.UpdateVisualState()},r.prototype.OnOffsetChanged=function(e,t){this._ParentPopup&&this.IsOpen&&this.PerformPlacement(e,t)},r.prototype.OnLayoutUpdated=function(e,t){this._ParentPopup&&this.PerformPlacement(this.HorizontalOffset,this.VerticalOffset)},r.prototype.OnTooltipParentDataContextChanged=function(e,t){this._ParentPopup&&this.TooltipParent&&(this._ParentPopup.DataContext=this.TooltipParent.DataContext)},r.prototype.HookupParentPopup=function(){console.assert(!this._ParentPopup,"this._parentPopup should be null, we want to set visual tree once");var e=this._ParentPopup=new t.Primitives.Popup;e.DataContext=this.TooltipParent?this.TooltipParent.DataContext:null,e.Opened.on(this.OnPopupOpened,this),e.Closed.on(this.OnPopupClosed,this),this.IsTabStop=!1,e.XamlNode.RegisterInitiator(this._TooltipParent),e.Child=this,e.IsHitTestVisible=!1,this.IsHitTestVisible=!1},r.prototype.OnPopupOpened=function(t,n){var r=new e.RoutedEventArgs;r.OriginalSource=this,this.Opened.raise(this,r),this.LayoutUpdated.on(this.OnLayoutUpdated,this)},r.prototype.OnPopupClosed=function(t,n){var r=new e.RoutedEventArgs;r.OriginalSource=this,this.Closed.raise(this,r),this.LayoutUpdated.off(this.OnLayoutUpdated,this)},r.prototype.PerformPlacement=function(n,r){if(this.IsOpen){var o=e.Application.Current.RootVisual;if(o){var i=null!=this.PlacementOverride?this.PlacementOverride:this.Placement,a=this.PlacementTargetOverride||this.PlacementTarget,s=new minerva.Rect,u=t.ToolTipService.MousePosition;if(i!==t.PlacementMode.Mouse){u=new Point;try{null!=a&&(s=new minerva.Rect(0,0,a.ActualWidth,a.ActualHeight),s=a.TransformToVisual(null).TransformBounds(s),u.x=s.x,u.y=s.y)}catch(l){return void console.warn("Could not transform the tooltip point.")}}switch(i){case t.PlacementMode.Top:u.y=s.y-this.ActualHeight;break;case t.PlacementMode.Bottom:u.y=s.y+s.height;break;case t.PlacementMode.Left:u.x=s.x-this.ActualWidth;break;case t.PlacementMode.Right:u.x=s.x+s.width;break;case t.PlacementMode.Mouse:u.y+=(new t.TextBox).FontSize;break;default:throw new NotSupportedException("PlacementMode '"+i+"' is not supported.")}var c=o.ActualWidth;u.x+this.ActualWidth>c?i===t.PlacementMode.Right?u.x=s.x-this.ActualWidth:u.x=c-this.ActualWidth:u.x<0&&(i===t.PlacementMode.Left?u.x=s.x+s.width:u.x=0);
var p=o.ActualHeight;u.y+this.ActualHeight>p?i===t.PlacementMode.Bottom?u.y=s.y-this.ActualHeight:u.y=p-this.ActualHeight:u.y<0&&(i===t.PlacementMode.Top?u.y=s.y+s.height:u.y=0),this._ParentPopup.VerticalOffset=u.y,this._ParentPopup.HorizontalOffset=u.x}}},r.prototype.GoToStates=function(e){e(this.IsOpen?"Open":"Closed")},r.HorizontalOffsetProperty=DependencyProperty.Register("HorizontalOffset",function(){return Number},r,0,function(e,t){return e.OnHorizontalOffsetChanged(t)}),r.VerticalOffsetProperty=DependencyProperty.Register("VerticalOffset",function(){return Number},r,0,function(e,t){return e.OnVerticalOffsetChanged(t)}),r.IsOpenProperty=DependencyProperty.Register("IsOpen",function(){return Boolean},r,!1,function(e,t){return e.OnIsOpenChanged(t)}),r.PlacementProperty=DependencyProperty.Register("Placement",function(){return new e.Enum(t.PlacementMode)},r,t.PlacementMode.Mouse),r.PlacementTargetProperty=DependencyProperty.Register("PlacementTarget",function(){return e.UIElement},r),r}(t.ContentControl);t.ToolTip=n,e.CoreLibrary.add(n),t.TemplateVisualStates(n,{GroupName:"OpenStates",Name:"Closed"},{GroupName:"OpenStates",Name:"Open"})}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Point=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Clone=function(){return new t(this.x,this.y)},t.LERP=function(e,n,r){var o=e.x+(n.x-e.x)*r,i=e.y+(n.y-e.y)*r;return new t(o,i)},t}(minerva.Point);Fayde.CoreLibrary.addPrimitive(Point),nullstone.registerTypeConverter(Point,function(e){if(!e)return new Point;if(e instanceof Point)return e;if(e instanceof minerva.Point)return new Point(e.x,e.y);var t=Fayde.splitCommaList(e.toString());if(2===t.length){var n=parseFloat(t[0]),r=parseFloat(t[1]);return new Point(n,r)}throw new Exception("Cannot parse Point value '"+e+"'")});var Fayde;!function(e){var t;!function(t){function n(e,t){var n=e,r=t.NewValue;t.OldValue&&c.UnregisterTooltip(n),r&&(c.RegisterTooltip(n,r),c.SetRootVisual(n))}function r(e){return p.indexOf(e)>-1}var o=DependencyProperty.Register("AssignedToolTip",function(){return t.ToolTip},e.UIElement,null),i=100,a=400,s=5e3,u=function(){function r(){}return r.GetToolTip=function(e){return e.GetValue(r.ToolTipProperty)},r.SetToolTip=function(e,t){e.SetValue(r.ToolTipProperty,t)},r.GetPlacement=function(e){return e.GetValue(r.PlacementProperty)},r.SetPlacement=function(e,t){e.SetValue(r.PlacementProperty,t)},r.GetPlacementTarget=function(e){return e.GetValue(r.PlacementTargetProperty)},r.SetPlacementTarget=function(e,t){e.SetValue(r.PlacementTargetProperty,t)},Object.defineProperty(r,"MousePosition",{get:function(){return c.MousePosition},enumerable:!0,configurable:!0}),r.ToolTipProperty=DependencyProperty.RegisterAttached("ToolTip",function(){return e.DependencyObject},r,void 0,n),r.PlacementProperty=DependencyProperty.RegisterAttached("Placement",function(){return new e.Enum(t.PlacementMode)},r),r.PlacementTargetProperty=DependencyProperty.RegisterAttached("PlacementTarget",function(){return e.UIElement},r),r}();t.ToolTipService=u,e.CoreLibrary.add(u);var l=function(){function n(){this.MousePosition=new Point,this._RootVisual=null,this._CurrentTooltip=null,this._LastEnterSource=null,this._LastOpened=0,this._OpenInterval=null,this._CloseInterval=null}return n.prototype.SetRootVisual=function(e){if(!this._RootVisual){var t=e.XamlNode.LayoutUpdater,n=t.tree.surface;if(n){var r=this._RootVisual=n.App.RootVisual;r&&r.MouseMove.on(this.OnRootMouseMove,this)}}},n.prototype.OnRootMouseMove=function(e,t){this.MousePosition=t.GetPosition(null)},n.prototype.RegisterTooltip=function(t,n){console.assert(null!=t,"ToolTip must have an owner"),console.assert(null!=n,"ToolTip can not be null"),t.MouseEnter.on(this.OnOwnerMouseEnter,this),t.MouseLeave.on(this.OnOwnerMouseLeave,this),t.MouseLeftButtonDown.on(this.OnOwnerMouseLeftButtonDown,this),t.KeyDown.on(this.OnOwnerKeyDown,this);var r=this.ConvertToToolTip(n);t.SetValue(o,r),t instanceof e.FrameworkElement&&(r.TooltipParent=t)},n.prototype.UnregisterTooltip=function(e){console.assert(null!=e,"owner element is required");var n=e.GetValue(o);n&&n instanceof t.ToolTip&&(e.MouseEnter.off(this.OnOwnerMouseEnter,this),e.MouseLeave.off(this.OnOwnerMouseLeave,this),e.MouseLeftButtonDown.off(this.OnOwnerMouseLeftButtonDown,this),e.KeyDown.off(this.OnOwnerKeyDown,this),n.TooltipParent=null,n.IsOpen&&(n===this._CurrentTooltip&&(window.clearInterval(this._CloseInterval),this._CurrentTooltip=null,this._Owner=null,this._LastEnterSource=null),n.IsOpen=!1),e.ClearValue(o))},n.prototype.OnOwnerMouseEnter=function(e,t){this.MousePosition=t.GetPosition(null),this.OnOwnerMouseEnterInternal(e,t.OriginalSource)},n.prototype.OnOwnerMouseLeave=function(e,t){return this._CurrentTooltip?void this.CloseAutomaticToolTip():(window.clearInterval(this._OpenInterval),this._Owner=null,void(this._LastEnterSource=null))},n.prototype.OnOwnerMouseLeftButtonDown=function(e,t){return this._LastEnterSource&&this._LastEnterSource===t.OriginalSource||this._Owner!==e?void 0:this._CurrentTooltip?void this.CloseAutomaticToolTip():(window.clearInterval(this._OpenInterval),this._Owner=null,void(this._LastEnterSource=null))},n.prototype.OnOwnerKeyDown=function(e,t){return this._LastEnterSource&&this._LastEnterSource===t.OriginalSource||this._Owner!==e?void 0:this._CurrentTooltip?void(r(t.Key)||this.CloseAutomaticToolTip()):(window.clearInterval(this._OpenInterval),this._Owner=null,void(this._LastEnterSource=null))},n.prototype.OnOwnerMouseEnterInternal=function(e,t){var n=this;if(!this._LastEnterSource||this._LastEnterSource!==t){if(this._CurrentTooltip){if(e.GetValue(o)===this._CurrentTooltip)return;this.CloseAutomaticToolTip()}this._Owner=e,this._LastEnterSource=t,console.assert(!this._CurrentTooltip),this.SetRootVisual(e);var r=(new Date).getTime()-this._LastOpened;i>=r?this.OpenAutomaticToolTip():this._OpenInterval=window.setInterval(function(){return n.OpenAutomaticToolTip()},a)}},n.prototype.ConvertToToolTip=function(n){if(n instanceof t.ToolTip)return n;if(n instanceof e.FrameworkElement){var r=n.Parent;if(r instanceof t.ToolTip)return r}var o=new t.ToolTip;return o.Content=n,o},n.prototype.OpenAutomaticToolTip=function(){var e=this;window.clearInterval(this._OpenInterval),console.assert(null!=this._Owner,"ToolTip owner was not set prior to starting the open timer");var t=this._CurrentTooltip=this._Owner.GetValue(o);null!=t&&(t.PlacementOverride=u.GetPlacement(this._Owner),t.PlacementTargetOverride=u.GetPlacementTarget(this._Owner)||this._Owner,t.IsOpen=!0,this._CloseInterval=window.setInterval(function(){return e.CloseAutomaticToolTip()},s))},n.prototype.CloseAutomaticToolTip=function(){window.clearInterval(this._CloseInterval);var e=this._CurrentTooltip;e.PlacementOverride=null,e.PlacementTargetOverride=null,e.IsOpen=!1,this._CurrentTooltip=null,this._Owner=null,this._LastEnterSource=null,this._LastOpened=(new Date).getTime()},n}(),c=new l,p=[e.Input.Key.Alt,e.Input.Key.Back,e.Input.Key.Delete,e.Input.Key.Down,e.Input.Key.End,e.Input.Key.Home,e.Input.Key.Insert,e.Input.Key.Left,e.Input.Key.PageDown,e.Input.Key.PageUp,e.Input.Key.Right,e.Input.Key.Space,e.Input.Key.Up]}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){!function(e){e[e.Standard=0]="Standard",e[e.Recycling=1]="Recycling"}(t.VirtualizationMode||(t.VirtualizationMode={}));var n=t.VirtualizationMode;e.CoreLibrary.addEnum(n,"VirtualizationMode");var r=function(r){function o(){r.apply(this,arguments)}return __extends(o,r),o.GetVirtualizationMode=function(e){return e.GetValue(o.VirtualizationModeProperty)},o.SetVirtualizationMode=function(e,t){e.SetValue(o.VirtualizationModeProperty,t)},o.GetIsVirtualizing=function(e){return e.GetValue(o.IsVirtualizingProperty)},o.SetIsVirtualizing=function(e,t){e.SetValue(o.IsVirtualizingProperty,t)},Object.defineProperty(o.prototype,"ItemsControl",{get:function(){var e=t.ItemsPresenter.Get(this);return e?e.ItemsControl:null},enumerable:!0,configurable:!0}),o.prototype.OnItemsAdded=function(e,t){this.XamlNode.LayoutUpdater.invalidateMeasure()},o.prototype.OnItemsRemoved=function(e,t){this.XamlNode.LayoutUpdater.invalidateMeasure()},o.VirtualizationModeProperty=DependencyProperty.RegisterAttached("VirtualizationMode",function(){return new e.Enum(n)},o,n.Recycling),o.IsVirtualizingProperty=DependencyProperty.RegisterAttached("IsVirtualizing",function(){return Boolean},o,!1),o}(t.Panel);t.VirtualizingPanel=r,e.CoreLibrary.add(r)}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=14.7,r=3,o=minerva.controls.virtualizingstackpanel.VirtualizingStackPanelUpdater,i=function(i){function a(){i.apply(this,arguments)}return __extends(a,i),a.prototype.CreateLayoutUpdater=function(){var e=new o;return e.assets.scrollData=this._ScrollData=new t.Primitives.ScrollData,e.tree.containerOwner=new t.Internal.VirtualizingPanelContainerOwner(this),e},Object.defineProperty(a.prototype,"ScrollOwner",{get:function(){return this._ScrollData.scrollOwner},set:function(e){this._ScrollData.scrollOwner=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"CanHorizontallyScroll",{get:function(){return this._ScrollData.canHorizontallyScroll},set:function(e){var t=this._ScrollData;t.canHorizontallyScroll!==e&&(t.canHorizontallyScroll=e,this.XamlNode.LayoutUpdater.invalidateMeasure())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"CanVerticallyScroll",{get:function(){return this._ScrollData.canVerticallyScroll},set:function(e){var t=this._ScrollData;t.canVerticallyScroll!==e&&(t.canVerticallyScroll=e,this.XamlNode.LayoutUpdater.invalidateMeasure())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ExtentWidth",{get:function(){return this._ScrollData.extentWidth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ExtentHeight",{get:function(){return this._ScrollData.extentHeight},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ViewportWidth",{get:function(){return this._ScrollData.viewportWidth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ViewportHeight",{get:function(){return this._ScrollData.viewportHeight},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"HorizontalOffset",{get:function(){return this._ScrollData.offsetX},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"VerticalOffset",{get:function(){return this._ScrollData.offsetY},enumerable:!0,configurable:!0}),a.prototype.LineUp=function(){var t=this._ScrollData;return this.Orientation===e.Orientation.Horizontal?this.SetVerticalOffset(t.offsetY-n):this.SetVerticalOffset(t.offsetY-1)},a.prototype.LineDown=function(){var t=this._ScrollData;return this.Orientation===e.Orientation.Horizontal?this.SetVerticalOffset(t.offsetY+n):this.SetVerticalOffset(t.offsetY+1)},a.prototype.LineLeft=function(){var t=this._ScrollData;return this.Orientation===e.Orientation.Vertical?this.SetHorizontalOffset(t.offsetX-n):this.SetHorizontalOffset(t.offsetX-1)},a.prototype.LineRight=function(){var t=this._ScrollData;return this.Orientation===e.Orientation.Vertical?this.SetHorizontalOffset(t.offsetX+n):this.SetHorizontalOffset(t.offsetX+1)},a.prototype.MouseWheelUp=function(){var t=this._ScrollData;return this.Orientation===e.Orientation.Horizontal?this.SetVerticalOffset(t.offsetY-n*r):this.SetVerticalOffset(t.offsetY-r)},a.prototype.MouseWheelDown=function(){var t=this._ScrollData;return this.Orientation===e.Orientation.Horizontal?this.SetVerticalOffset(t.offsetY+n*r):this.SetVerticalOffset(t.offsetY+r)},a.prototype.MouseWheelLeft=function(){var t=this._ScrollData;return this.Orientation===e.Orientation.Vertical?this.SetHorizontalOffset(t.offsetX-n*r):this.SetHorizontalOffset(t.offsetX-r)},a.prototype.MouseWheelRight=function(){var t=this._ScrollData;return this.Orientation===e.Orientation.Vertical?this.SetHorizontalOffset(t.offsetX+n*r):this.SetHorizontalOffset(t.offsetX+r)},a.prototype.PageUp=function(){var e=this._ScrollData;return this.SetVerticalOffset(e.offsetY-e.viewportHeight)},a.prototype.PageDown=function(){var e=this._ScrollData;return this.SetVerticalOffset(e.offsetY+e.viewportHeight)},a.prototype.PageLeft=function(){var e=this._ScrollData;return this.SetHorizontalOffset(e.offsetX-e.viewportWidth)},a.prototype.PageRight=function(){var e=this._ScrollData;return this.SetHorizontalOffset(e.offsetX+e.viewportWidth)},a.prototype.MakeVisible=function(t,n){for(var r=new minerva.Rect,o=this._ScrollData,i=t.XamlNode,a=this.Orientation===e.Orientation.Vertical,s=this.Children.getEnumerator();s.moveNext();){var u=s.current,l=u.XamlNode,c=l.LayoutUpdater.assets.renderSize;if(i===l)return a?(n.x!==o.offsetX&&this.SetHorizontalOffset(n.x),r.width=Math.min(c.width,o.viewportWidth),r.height=c.height,r.x=o.offsetX):(n.y!==o.offsetY&&this.SetVerticalOffset(n.y),r.height=Math.min(c.height,o.viewportHeight),r.width=c.width,r.y=o.offsetY),r;a?r.y+=c.height:r.x+=c.width}throw new ArgumentException("Visual is not a child of this Panel")},a.prototype.SetHorizontalOffset=function(t){var n=this._ScrollData;if(0>t||n.viewportWidth>=n.extentWidth?t=0:t+n.viewportWidth>=n.extentWidth&&(t=n.extentWidth-n.viewportWidth),n.offsetX===t)return!1;n.offsetX=t,this.Orientation===e.Orientation.Horizontal?this.XamlNode.LayoutUpdater.invalidateMeasure():this.XamlNode.LayoutUpdater.invalidateArrange();var r=this.ScrollOwner;return r&&r.InvalidateScrollInfo(),!0},a.prototype.SetVerticalOffset=function(t){var n=this._ScrollData;if(0>t||n.viewportHeight>=n.extentHeight?t=0:t+n.viewportHeight>=n.extentHeight&&(t=n.extentHeight-n.viewportHeight),n.offsetY===t)return!1;n.offsetY=t,this.Orientation===e.Orientation.Vertical?this.XamlNode.LayoutUpdater.invalidateMeasure():this.XamlNode.LayoutUpdater.invalidateArrange();var r=this.ScrollOwner;return r&&r.InvalidateScrollInfo(),!0},a.prototype.OnItemsAdded=function(t,n){i.prototype.OnItemsAdded.call(this,t,n);var r=this.Orientation===e.Orientation.Horizontal,o=r?this.HorizontalOffset:this.VerticalOffset;o>=t&&(r?this.SetHorizontalOffset(o+n.length):this.SetVerticalOffset(o+n.length));var a=this.ScrollOwner;a&&a.InvalidateScrollInfo()},a.prototype.OnItemsRemoved=function(t,n){i.prototype.OnItemsRemoved.call(this,t,n);var r=this.ItemsControl;if(r)for(var o=r.ItemContainersManager,a=this.Children,s=0,u=n.length;u>s;s++){var l=n[s],c=o.ContainerFromItem(l);c&&a.Remove(c)}var p=this.Orientation===e.Orientation.Horizontal,d=p?this.HorizontalOffset:this.VerticalOffset,h=Math.min(d,t+n.length)-t;h>0&&(p?this.SetHorizontalOffset(h):this.SetVerticalOffset(h));var y=this.ScrollOwner;y&&y.InvalidateScrollInfo()},a.OrientationProperty=DependencyProperty.Register("Orientation",function(){return new e.Enum(e.Orientation)},a,e.Orientation.Vertical),a}(t.VirtualizingPanel);t.VirtualizingStackPanel=i,e.CoreLibrary.add(i),nullstone.addTypeInterfaces(i,t.Primitives.IScrollInfo_);var a;!function(t){e.UIReaction(i.OrientationProperty,function(e,t,n){return e.invalidateMeasure()},!1)}(a||(a={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){function t(e){return void 0===e?void 0:null===e?null:e instanceof Array?e.slice(0):e!==Object(e)?e:e.Clone instanceof Function?e.Clone():n(new e.constructor,e)}function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r,o=0,i=t.length;i>o;o++)if(r=t[o])for(var a in r)e[a]=r[a];return e}e.Clone=t}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.DataTypeProperty=DependencyProperty.Register("DataType",function(){return e.IType_},n),n}(e.Markup.FrameworkTemplate);e.DataTemplate=t,e.CoreLibrary.add(t)}(Fayde||(Fayde={}));var DependencyPropertyChangedEventArgs=function(){function e(){}return e}(),Fayde;!function(e){var t=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.ItemsSourceProperty=DependencyProperty.Register("ItemsSource",function(){return nullstone.IEnumerable_},n),n.ItemTemplateProperty=DependencyProperty.Register("ItemTemplate",function(){return e.DataTemplate},n),n.ItemContainerStyleProperty=DependencyProperty.Register("ItemContainerStyle",function(){return e.Style},n),n}(e.DataTemplate);e.HierarchicalDataTemplate=t,e.CoreLibrary.add(t)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function t(){}return t.GetLayoutClip=function(t){var n=new minerva.Rect;minerva.Rect.copyTo(t.XamlNode.LayoutUpdater.assets.layoutClip,n);var r=new e.Media.RectangleGeometry;return r.Rect=n,r},t.GetLayoutSlot=function(e){var t=new minerva.Rect;return minerva.Rect.copyTo(e.XamlNode.LayoutUpdater.assets.layoutSlot,t),t},t}();e.LayoutInformation=t,e.CoreLibrary.add(t)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function e(e){this.IsRoot=!1,this.XNodes={},e&&(this.IsRoot=e)}return e.prototype.FindName=function(e){return this.XNodes[e]},e.prototype.RegisterName=function(e,t){var n=this.XNodes[e];if(n&&n!==t)throw new InvalidOperationException("Name is already registered.");this.XNodes[e]=t},e.prototype.UnregisterName=function(e){this.XNodes[e]=void 0},e.prototype.Absorb=function(e){var t=e.XNodes;for(var n in t)this.RegisterName(n,t[n])},e}();e.NameScope=t}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Get=function(e){for(var t=this.getEnumerator();t.moveNext();){var n=t.current.Get(e);if(void 0!==n)return n}return void 0},t.prototype.AddingToCollection=function(t,n){return e.prototype.AddingToCollection.call(this,t,n)?this._AssertNoCycles(t,t.XamlNode.ParentNode,n):!1},t.prototype._AssertNoCycles=function(e,t,r){for(var o=t;o;){var i=o.XObject;if(i instanceof n){var a=!1;if(i===e?a=!0:i.Source&&nullstone.equals(i.Source,e.Source)&&(a=!0),a)return r.Message="Cycle found in resource dictionaries.",r.Number=BError.InvalidOperation,!1}o=o.ParentNode}for(var s=e.MergedDictionaries.getEnumerator();s.moveNext();)if(!this._AssertNoCycles(s.current,t,r))return!1;return!0},t}(e.XamlObjectCollection);e.ResourceDictionaryCollection=t,e.CoreLibrary.add(t);var n=function(n){function r(){n.apply(this,arguments),this._Keys=[],this._Values=[],this._IsSourceLoaded=!1,this._SourceBacking=null}return __extends(r,n),Object.defineProperty(r.prototype,"MergedDictionaries",{get:function(){var e=this._MergedDictionaries;return e||(e=this._MergedDictionaries=new t,e.AttachTo(this)),e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Count",{get:function(){return this._Values.length},enumerable:!0,configurable:!0}),r.prototype.AttachTo=function(e){var t=new BError;this.XamlNode.AttachTo(e.XamlNode,t)||t.ThrowException()},r.prototype.Contains=function(e){return this._Keys.indexOf(e)>-1},r.prototype.Get=function(e){if(this.Source)return this._GetFromSource(e);var t=this._Keys.indexOf(e);if(t>-1)return this._Values[t];var n=this._MergedDictionaries;return n?n.Get(e):void 0},r.prototype.Set=function(t,n){if(void 0===t)return!1;if(void 0===n)return this.Remove(t);var r=this._Keys.indexOf(t),o=new BError;if(n instanceof e.XamlObject&&!n.XamlNode.AttachTo(this.XamlNode,o)){if(o.Message)throw new Exception(o.Message);return!1}if(0>r)this._Keys.push(t),this._Values.push(n);else{var i=this._Values[r];this._Keys[r]=t,this._Values[r]=n,i instanceof e.XamlObject&&i.XamlNode.Detach()}return!0},r.prototype.Remove=function(t){var n=this._Keys.indexOf(t);if(0>n)return!1;this._Keys.splice(n,1);var r=this._Values.splice(n,1)[0];r instanceof e.XamlObject&&r.XamlNode.Detach()},r.prototype.getEnumerator=function(e){return nullstone.IEnumerator_.fromArray(this._Values,e)},r.prototype.GetNodeEnumerator=function(e){var t=this.getEnumerator(e);return{current:void 0,moveNext:function(){if(t.moveNext())return this.current=void 0,!1;var e=t.current;return this.current=e.XamlNode,!0}}},r.prototype._GetFromSource=function(t){return this._IsSourceLoaded||(this._SourceBacking=e.Markup.Load(this.App,nullstone.markup.xaml.XamlMarkup.create(this.Source)),this._IsSourceLoaded=!0),this._SourceBacking.Get(t)},r}(e.XamlObject);e.ResourceDictionary=n,e.CoreLibrary.add(n)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(nullstone.Event);e.RoutedEvent=t,e.CoreLibrary.add(t)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.RoutedEvent);e.RoutedPropertyChangedEvent=t,e.CoreLibrary.add(t);var n=function(e){function t(t,n){e.call(this),Object.defineProperty(this,"OldValue",{value:t,writable:!1}),Object.defineProperty(this,"NewValue",{value:n,writable:!1})}return __extends(t,e),t}(e.RoutedEventArgs);e.RoutedPropertyChangedEventArgs=n,e.CoreLibrary.add(n)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.RoutedEvent);e.RoutedPropertyChangingEvent=t,e.CoreLibrary.add(t);var n=function(e){function t(t,n,r,o){e.call(this),this._Cancel=!1,this.InCoercion=!1,this.Property=t,this.OldValue=n,this.NewValue=r,this._IsCancelable=o}return __extends(t,e),Object.defineProperty(t.prototype,"IsCancellable",{get:function(){return this._IsCancelable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Cancel",{get:function(){return this._Cancel},set:function(e){if(this._IsCancelable)this._Cancel=e;else if(e)throw new InvalidOperationException("Not cancelable.")},enumerable:!0,configurable:!0}),t}(e.RoutedEventArgs);e.RoutedPropertyChangingEventArgs=n,e.CoreLibrary.add(n)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(e){function t(){e.apply(this,arguments),this._IsSealed=!1}return __extends(t,e),t.prototype.Seal=function(){if(!this._IsSealed){for(var e=this.getEnumerator();e.moveNext();)e.current.Seal();this._IsSealed=!0}},t.prototype.AddingToCollection=function(t,n){return t&&this._ValidateSetter(t,n)?e.prototype.AddingToCollection.call(this,t,n):!1},t.prototype._ValidateSetter=function(e,t){return e.Property instanceof DependencyProperty?void 0!==e.Value||e._HasDeferredValueExpression(n.ValueProperty)?this._IsSealed?(t.Message="Setter is sealed.",!1):!0:(t.Message="Setter must have a Value.",!1):(t.Message="Setter.Property must be a DependencyProperty.",!1)},t}(e.XamlObjectCollection);e.SetterCollection=t,e.CoreLibrary.add(t);var n=function(e){function t(){e.apply(this,arguments),this._IsSealed=!1}return __extends(t,e),t.prototype.Seal=function(){var e=this.Property,n=this.Value,r=e.GetTargetType();this.SetCurrentValue(t.ConvertedValueProperty,nullstone.convertAnyToType(n,r)),this._IsSealed=!0},t.Compare=function(e,t){var n=e.Property,r=t.Property;return n===r?0:n._ID>r._ID?1:-1},t.PropertyProperty=DependencyProperty.Register("Property",function(){return DependencyProperty},t),t.ValueProperty=DependencyProperty.Register("Value",function(){return Object},t),t.ConvertedValueProperty=DependencyProperty.RegisterReadOnly("ConvertedValue",function(){return Object},t),t}(e.DependencyObject);e.Setter=n,e.CoreLibrary.add(n)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(e){function t(t,n){e.call(this),Object.defineProperty(this,"PreviousSize",{value:new minerva.Size,writable:!1}),Object.defineProperty(this,"NewSize",{value:new minerva.Size,writable:!1}),minerva.Size.copyTo(t,this.PreviousSize),minerva.Size.copyTo(n,this.NewSize)}return __extends(t,e),t}(e.RoutedEventArgs);e.SizeChangedEventArgs=t,e.CoreLibrary.add(t)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(t){function n(){t.call(this),this._IsSealed=!1;var e=n.SettersProperty.Initialize(this);e.AttachTo(this)}return __extends(n,t),n.prototype.Seal=function(){if(!this._IsSealed){this.Setters.Seal(),this._IsSealed=!0;var e=this.BasedOn;e&&e.Seal()}},n.prototype.Validate=function(e,t){var n=this.TargetType,r=e.constructor;if(this._IsSealed)return e instanceof n?!0:(t.Number=BError.XamlParse,t.Message="Style.TargetType ("+n.name+") is not a subclass of ("+r.name+")",!1);for(var o=[],i=this;i;){if(o.indexOf(i)>-1)return t.Number=BError.InvalidOperation,t.Message="Circular reference in Style.BasedOn",!1;o.push(i),i=i.BasedOn}o=null,i=this;for(var n;i;){if(n=i.TargetType,i===this){if(!n)return t.Number=BError.InvalidOperation,t.Message="TargetType cannot be null",!1;if(!nullstone.doesInheritFrom(r,n))return t.Number=BError.XamlParse,t.Message="Style.TargetType ("+n.name+") is not a subclass of ("+r.name+")",!1}else if(!n||!nullstone.doesInheritFrom(r,n))return t.Number=BError.InvalidOperation,t.Message="Style.TargetType ("+(n?n.name:"<Not Specified>")+") is not a subclass of ("+r.name+")",!1;r=n,i=i.BasedOn}return this.Seal(),!0},n.SettersProperty=DependencyProperty.RegisterImmutable("Setters",function(){return e.SetterCollection},n),n.BasedOnProperty=DependencyProperty.Register("BasedOn",function(){return n},n),n.TargetTypeProperty=DependencyProperty.Register("TargetType",function(){return e.IType_},n),n}(e.DependencyObject);e.Style=t,e.CoreLibrary.add(t),e.Markup.Content(t,t.SettersProperty)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function t(){}return t.prototype.init=function(e){this.SourceProperty=e},t.prototype.transmute=function(t){return new e.TemplateBindingExpression(this.SourceProperty)},t}();e.TemplateBinding=t,e.CoreLibrary.add(t)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Fire=function(){},t}(e.DependencyObject);e.TriggerAction=t,e.CoreLibrary.add(t);var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Fire=function(){for(var e=this.getEnumerator();e.moveNext();)e.current.Fire()},t}(e.XamlObjectCollection);e.TriggerActionCollection=n,e.CoreLibrary.add(n);var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Attach=function(e){},t.prototype.Detach=function(e){},t}(e.DependencyObject);e.TriggerBase=r,e.CoreLibrary.add(r);var o=function(t){function r(){t.call(this),this._IsAttached=!1;var e=r.ActionsProperty.Initialize(this);e.AttachTo(this)}return __extends(r,t),r.prototype.Attach=function(e){if(!this._IsAttached){var t=this._ParseEventName(e);return t?(this._IsAttached=!0,void t.on(this._FireActions,this)):void console.warn("Could not attach to RoutedEvent: "+this.RoutedEvent)}},r.prototype.Detach=function(e){var t=this._ParseEventName(e);t&&t.off(this._FireActions,this),this._IsAttached=!1},r.prototype._FireActions=function(e,t){var n=this.Actions;n&&n.Fire()},r.prototype._ParseEventName=function(t){var n=this.RoutedEvent,r=n.split(".");if(1===r.length)n=r[0];else{if(2!==r.length)return void 0;n=r[1]}var o=t[n];return o instanceof e.RoutedEvent?o:void 0},r.ActionsProperty=DependencyProperty.RegisterImmutable("Actions",function(){return n},r),r.RoutedEventProperty=DependencyProperty.Register("RoutedEvent",function(){return String},r),r}(r);e.EventTrigger=o,e.CoreLibrary.add(o),e.Markup.Content(o,o.ActionsProperty);var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),Object.defineProperty(t.prototype,"ParentXamlObject",{get:function(){var e=this.XamlNode.ParentNode;return e?e.XObject:void 0},enumerable:!0,configurable:!0}),t.prototype.AddingToCollection=function(t,n){if(!e.prototype.AddingToCollection.call(this,t,n))return!1;var r=this.ParentXamlObject;return r&&t.Attach(r),!0},t.prototype.RemovedFromCollection=function(t,n){e.prototype.RemovedFromCollection.call(this,t,n);var r=this.ParentXamlObject;r&&t.Detach(r)},t.prototype.AttachTarget=function(e){for(var t=this.getEnumerator();t.moveNext();)t.current.Attach(e)},t.prototype.DetachTarget=function(e){for(var t=this.getEnumerator();t.moveNext();)t.current.Detach(e)},t}(e.XamlObjectCollection);e.TriggerCollection=i,e.CoreLibrary.add(i)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function e(){}return e.GetAncestors=function(e){return new n(e)},e}();e.VisualTreeEnum=t;var n=function(){function e(e){this.uie=e}return e.prototype.getEnumerator=function(){var e=this.uie?this.uie.XamlNode:null,t={current:void 0,moveNext:function(){return e=e?e.VisualParentNode:void 0,t.current=e?e.XObject:void 0,void 0!==t.current}};return t},e}()}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function t(){}return t.GetParent=function(t){if(!(t instanceof e.FrameworkElement))throw new InvalidOperationException("Reference is not a valid visual DependencyObject");var n=t.XamlNode.VisualParentNode;return n?n.XObject:void 0},t.GetParentOfType=function(t,n){if(!(t instanceof e.FrameworkElement))throw new InvalidOperationException("Reference is not a valid visual DependencyObject");for(var r=t.XamlNode;r=r.VisualParentNode;)if(r.XObject instanceof n)return r.XObject;return void 0},t.GetRoot=function(t){if(!(t instanceof e.FrameworkElement))throw new InvalidOperationException("Reference is not a valid visual DependencyObject");var n=t.XamlNode.GetVisualRoot();return n?n.XObject:void 0},t.GetChild=function(t,n){if(!(t instanceof e.FrameworkElement))throw new InvalidOperationException("Reference is not a valid visual DependencyObject");var r=t.XamlNode,o=r.SubtreeNode;if(!o)throw new IndexOutOfRangeException(n);var i=o.XObject;if(i instanceof e.XamlObjectCollection)return i.GetValueAt(n);if(i instanceof e.UIElement&&0===n)return i;throw new IndexOutOfRangeException(n)},t.GetChildrenCount=function(t){if(!(t instanceof e.FrameworkElement))throw new InvalidOperationException("Reference is not a valid visual DependencyObject");var n=t.XamlNode,r=n.SubtreeNode;if(!r)return 0;var o=r.XObject;return r.XObject instanceof e.XamlObjectCollection?o.Count:o instanceof e.UIElement?1:0},t.FindElementsInHostCoordinates=function(e,t){return minerva.findElementsInHostSpace(e,t.XamlNode.LayoutUpdater).map(function(e){return e.getAttachedValue("$node").XObject})},t.__Debug=function(n,r){var o;n instanceof e.UIElement?o=n.XamlNode:n instanceof e.UINode?o=n:n instanceof minerva.core.Updater&&(o=n.getAttachedValue("$node"));var i;if(o)i=o.GetVisualRoot();else{var a=e.Application.Current.RootVisual;i=a?a.XamlNode:null}return i?(r||(r=t.__DebugUIElement),t.__DebugTree(i,o,1,r)):"[No top node.]"},t.__DebugTree=function(e,n,r,o){var i="";if(e===n)for(var a=0;r>a;a++)i+=">>>>>>>>";else for(var a=0;r>a;a++)i+="	";var s=e.XObject;i+=s.constructor.name;var u=s._ID;u&&(i+="["+u+"]");var l=e.Name;i+=" [";var c=e.NameScope;i+=c?c.IsRoot?"+":"-":"^",i+=l+"]",o&&(i+=o(e,r)),i+="\n";var p=e.GetVisualTreeEnumerator();if(!p)return i;for(var d;p.moveNext();)d=p.current,i+=t.__DebugTree(d,n,r+1,o);return i},t.__DebugUIElement=function(n,r){if(!n)return"";var o=n.XObject,i="(";i+=o.Visibility===e.Visibility.Visible?"Visible":"Collapsed";var a=n.LayoutUpdater;if(a){i+=" ";var s=a.assets.layoutSlot;i+="("+s.x+","+s.y+")("+s.width+","+s.height+")"}i+=")";var u=o.TemplateOwner;i+="$TO="+(u?u.constructor.name:"(null)");var l=t.__DebugGrid(n,r);return l&&(i+="\n"+l),i},t.__DebugGrid=function(t,n){var r;if(t.XObject instanceof e.Controls.Grid&&(r=t.XObject),!r)return"";for(var o=r.RowDefinitions,i=o.Count,a=r.ColumnDefinitions,s=a.Count,u="",l=0;n>l;l++)u+="	";var c="";if(i>0){c+=u,c+="  Rows ("+i+"):\n";for(var p,d=o.getEnumerator(),l=0;d.moveNext();l++)p=d.current,c+=u,c+="	["+l+"] -> "+p.ActualHeight+"\n"}if(s>0){c+=u,c+="  Columns ("+s+"):\n";for(var h,y=a.getEnumerator(),l=0;y.moveNext();l++)h=y.current,c+=u,c+="	["+l+"] -> "+h.ActualWidth+"\n"}return c},t.__DebugUIElementLayout=function(e,t){return e?e.LayoutUpdater._DebugLayout():""},t.__DebugLayout=function(e){return t.__Debug(e,t.__DebugUIElementLayout)},t.__GetById=function(t){var n=e.Application.Current.RootVisual,r=n?n.XamlNode:null;if(r)for(var o,i=e.DeepTreeWalker(r);o=i.Step();)if(o.XObject._ID===t)return o.XObject},t}();e.VisualTreeHelper=t}(Fayde||(Fayde={}));var Fayde;!function(e){function t(t,n,r){for(var o,i=r.Setters.getEnumerator(!0);i.moveNext();)if(o=i.current,o instanceof e.Setter){var a=o.Property;
a&&(n[a._ID]||(n[a._ID]=o,t.push(o)))}}function n(n){for(var r=[],o=[],i=n;i;)t(o,r,i),i=i.BasedOn;return o.sort(e.Setter.Compare),{Step:function(){return o.shift()}}}function r(n){var r=[];if(n){for(var o=[],i=[],a=n.length,s=0;a>s;s++)for(var u=n[s];u;)i.indexOf(u)>-1||(t(r,o,u),i.push(u),u=u.BasedOn);r.sort(e.Setter.Compare)}return{Step:function(){return r.shift()}}}function o(e,t){var n=void 0,r=l.Logical,o=[e];return t&&(r=t),{Step:function(){if(n)for(var e=n.GetVisualTreeEnumerator(),t=0;e.moveNext();)o.splice(t,0,e.current),t++;var r=o.shift();return r?n=r:void(n=void 0)},SkipBranch:function(){n=void 0}}}function i(e,t){if(!e)return t?-1:0;if(!t)return 1;var n=e.XObject.TabIndex,r=t.XObject.TabIndex;return null==n?null!=r?-1:0:null==r?1:n>r?1:n===r?0:-1}function a(t){for(;t;)return t instanceof e.Controls.ControlNode?t.XObject.TabNavigation:e.Input.KeyboardNavigationMode.Local;return e.Input.KeyboardNavigationMode.Local}function s(t){for(;t;){if(t instanceof e.Controls.ControlNode)return t.XObject.TabNavigation;t=t.VisualParentNode}return e.Input.KeyboardNavigationMode.Local}function u(e,t,n){var r=new c(e,t,n);return r.FocusChild()}!function(e){e[e.Logical=0]="Logical",e[e.Reverse=1]="Reverse",e[e.ZForward=2]="ZForward",e[e.ZReverse=3]="ZReverse"}(e.VisualTreeDirection||(e.VisualTreeDirection={}));var l=e.VisualTreeDirection;e.SingleStyleWalker=n,e.MultipleStylesWalker=r,e.DeepTreeWalker=o;var c=function(){function t(e,t,n){this._Root=e,this._Current=t,this._Forwards=n,this._TabSorted=[]}return t.prototype.FocusChild=function(){for(var t,n,r=-1,a=o(this._Root);t=a.Step();)t!==this._Root&&t instanceof e.Controls.ControlNode&&(this._TabSorted.push(t),a.SkipBranch());this._TabSorted.length>1&&(this._TabSorted.sort(i),this._Forwards||(this._TabSorted=this._TabSorted.reverse()));for(var l=this._TabSorted.length,c=0;l>c;c++)this._TabSorted[c]===this._Current&&(r=c);if(-1!==r&&s(this._Root)===e.Input.KeyboardNavigationMode.Once)return!this._Forwards&&this._Root instanceof e.Controls.ControlNode?this._Root.TabTo():!1;var l=this._TabSorted.length;if(l>0)for(var p=0;l>p&&(p+r+1!==l||s(this._Root)===e.Input.KeyboardNavigationMode.Cycle);p++)if(t=this._TabSorted[(p+r+1)%l],n=t instanceof e.Controls.ControlNode,!n||t.XObject.IsEnabled){if(!this._Forwards&&u(t))return!0;if(n&&t.TabTo())return!0;if(this._Forwards&&u(t))return!0}return-1!==r&&!this._Forwards&&this._Root instanceof e.Controls.ControlNode?this._Root.TabTo():!1},t.Focus=function(t,n){var r=!1,o=t,i=t;if(i.VisualParentNode&&a(i.VisualParentNode)===e.Input.KeyboardNavigationMode.Once||!n&&i&&i.VisualParentNode)for(;(i=i.VisualParentNode)&&!(i instanceof e.Controls.ControlNode)&&i.VisualParentNode;);do{if(r=r||u(i,o,n),!r&&s(i)===e.Input.KeyboardNavigationMode.Cycle)return!0;for(o=i,i=i.VisualParentNode;i&&!(i instanceof e.Controls.ControlNode)&&i.VisualParentNode;)i=i.VisualParentNode}while(!r&&i);return r||(r=r||u(o,null,n)),r},t}();e.TabNavigationWalker=c}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=nullstone.convertAnyToType;t.WarnBrokenPath=!1;var r=function(){function r(e){if(this.BindsDirectlyToSource=!1,this.NotifyOnValidationError=!1,this.ValidatesOnExceptions=!1,this.ValidatesOnDataErrors=!1,this.ValidatesOnNotifyDataErrors=!0,e instanceof r){var n=e;this.StringFormat=n.StringFormat,this.FallbackValue=n.FallbackValue,this.TargetNullValue=n.TargetNullValue,this.BindsDirectlyToSource=n.BindsDirectlyToSource,this.Converter=n.Converter,this.ConverterParameter=n.ConverterParameter,this.ConverterCulture=n.ConverterCulture,this.ElementName=n.ElementName,this.Mode=n.Mode,this.NotifyOnValidationError=n.NotifyOnValidationError,this.RelativeSource=n.RelativeSource?n.RelativeSource.Clone():null,this.Path=n.Path,this.Source=n.Source,this.UpdateSourceTrigger=n.UpdateSourceTrigger,this.ValidatesOnExceptions=n.ValidatesOnExceptions,this.ValidatesOnDataErrors=n.ValidatesOnDataErrors,this.ValidatesOnNotifyDataErrors=n.ValidatesOnNotifyDataErrors}else"string"==typeof e?this.Path=new t.PropertyPath(e):e instanceof t.PropertyPath?this.Path=e:this.Path=new t.PropertyPath("")}return r.prototype.init=function(e){this.Path=new t.PropertyPath(e)},r.prototype.transmute=function(e){return this.$$coerce(),Object.freeze(this),new t.BindingExpression(this)},r.prototype.$$coerce=function(){this.StringFormat=this.StringFormat?this.StringFormat.toString():void 0,this.BindsDirectlyToSource=n(this.BindsDirectlyToSource,Boolean)||!1,this.Mode=e.Enum.fromAny(t.BindingMode,this.Mode),this.NotifyOnValidationError=n(this.NotifyOnValidationError,Boolean)||!1,this.Path=n(this.Path,t.PropertyPath),this.UpdateSourceTrigger=e.Enum.fromAny(t.UpdateSourceTrigger,this.UpdateSourceTrigger),this.ValidatesOnExceptions=n(this.ValidatesOnExceptions,Boolean)||!1,this.ValidatesOnDataErrors=n(this.ValidatesOnDataErrors,Boolean)||!1,this.ValidatesOnNotifyDataErrors=n(this.ValidatesOnNotifyDataErrors,Boolean)!==!1},r.prototype.Clone=function(){return new r(this)},r.fromData=function(e){var t=new r(e.Path);return t.StringFormat=e.StringFormat,t.FallbackValue=e.FallbackValue,t.TargetNullValue=e.TargetNullValue,t.BindsDirectlyToSource=e.BindsDirectlyToSource,t.Converter=e.Converter,t.ConverterParameter=e.ConverterParameter,t.ConverterCulture=e.ConverterCulture,t.ElementName=e.ElementName,t.Mode=e.Mode,t.NotifyOnValidationError=e.NotifyOnValidationError,t.RelativeSource=e.RelativeSource,t.Source=e.Source,t.UpdateSourceTrigger=e.UpdateSourceTrigger,t.ValidatesOnExceptions=e.ValidatesOnExceptions,t.ValidatesOnDataErrors=e.ValidatesOnDataErrors,t.ValidatesOnNotifyDataErrors=e.ValidatesOnNotifyDataErrors,t},r}();t.Binding=r,e.CoreLibrary.add(r)}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.SourceProperty=DependencyProperty.Register("Source",function(){return Object},n),n.ViewProperty=DependencyProperty.Register("View",function(){return t.ICollectionView_},n),n}(e.DependencyObject);t.CollectionViewSource=n}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t=function(){function e(e){this.PropertyName=e,Object.freeze(this)}return e}();e.DataErrorsChangedEventArgs=t}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){!function(e){e[e.TemplatedParent=0]="TemplatedParent",e[e.Self=1]="Self",e[e.FindAncestor=2]="FindAncestor",e[e.ItemsControlParent=3]="ItemsControlParent"}(t.RelativeSourceMode||(t.RelativeSourceMode={}));var n=t.RelativeSourceMode;e.CoreLibrary.addEnum(n,"RelativeSourceMode"),function(e){e[e.OneWay=0]="OneWay",e[e.TwoWay=1]="TwoWay",e[e.OneTime=2]="OneTime",e[e.OneWayToSource=3]="OneWayToSource"}(t.BindingMode||(t.BindingMode={}));var r=t.BindingMode;e.CoreLibrary.addEnum(r,"BindingMode"),function(e){e[e.Default=0]="Default",e[e.PropertyChanged=1]="PropertyChanged",e[e.Explicit=3]="Explicit"}(t.UpdateSourceTrigger||(t.UpdateSourceTrigger={}));var o=t.UpdateSourceTrigger;e.CoreLibrary.addEnum(o,"UpdateSourceTrigger")}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){e.ICollectionView_=new nullstone.Interface("ICollectionView")}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){e.IDataErrorInfo_=new nullstone.Interface("IDataErrorInfo")}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){e.INotifyDataErrorInfo_=new nullstone.Interface("INotifyDataErrorInfo")}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){e.IValueConverter_=new nullstone.Interface("IValueConverter")}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(t,n){if(t instanceof e.DependencyObject){var r=n.AncestorType;if("function"!=typeof r)return void console.warn("RelativeSourceMode.FindAncestor with no AncestorType specified.");var o=n.AncestorLevel;if(isNaN(o))return void console.warn("RelativeSourceMode.FindAncestor with no AncestorLevel specified.");for(var i=e.VisualTreeHelper.GetParent(t);null!=i;i=e.VisualTreeHelper.GetParent(i))if(i instanceof r&&--o<1)return i}}function r(t,n){if(t instanceof e.DependencyObject){var r=n.AncestorLevel;r=r||1;for(var o=e.VisualTreeHelper.GetParent(t);null!=o;o=e.VisualTreeHelper.GetParent(o))if(o.IsItemsControl&&--r<1)return o}}var o=function(){function o(e){if(this.AncestorType=null,e instanceof o){var t=e;this.Mode=t.Mode,this.AncestorLevel=t.AncestorLevel,this.AncestorType=t.AncestorType}}return o.prototype.init=function(e){this.Mode=t.RelativeSourceMode[e]},o.prototype.resolveTypeFields=function(e){"string"==typeof this.AncestorType&&(this.AncestorType=e(this.AncestorType))},o.prototype.transmute=function(n){return null==this.Mode&&"function"==typeof this.AncestorType?this.Mode=t.RelativeSourceMode.FindAncestor:this.Mode=e.Enum.fromAny(t.RelativeSourceMode,this.Mode),this.AncestorLevel=parseInt(this.AncestorLevel)||1,Object.freeze(this),this},o.prototype.Clone=function(){return new o(this)},o.prototype.Find=function(e){switch(this.Mode){case t.RelativeSourceMode.Self:return e;case t.RelativeSourceMode.TemplatedParent:return e.TemplateOwner;case t.RelativeSourceMode.FindAncestor:return n(e,this);case t.RelativeSourceMode.ItemsControlParent:return r(e,this)}},o}();t.RelativeSource=o,e.CoreLibrary.add(o)}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,t,n,s,u){var l;if(s===!1)l=n===!1?r(t):i(t);else{var c=e.Name;c=c.charAt(0).toLowerCase()+c.substr(1),l="function"!=typeof s?n===!1?o(t,c):a(t,c):n===!1?o(t,c,s):a(t,c,s)}u?e.Store.ListenToChanged(u,e,l,u):e.ChangedCallback=l}function r(e){return function(t,n){e&&e(t.TextUpdater,n.OldValue,n.NewValue,t)}}function o(e,t,n){return function(r,o){var i=o.OldValue,a=o.NewValue,s=r.TextUpdater;n?n(a,s.assets[t]):s.assets[t]=a,e&&e(s,i,a,r)}}function i(t){return function(n,r){var o=r.OldValue,i=r.NewValue,a=n.TextUpdater;e.UnreactTo(o,n),t&&t(a,o,i,n),e.ReactTo(i,n,function(){return t(a,i,i,n)})}}function a(t,n,r){return function(o,i){var a=i.OldValue,s=i.NewValue,u=o.TextUpdater;e.UnreactTo(a,o),r?r(s,u.assets[n]):u.assets[n]=s,t&&t(u,a,s,o),e.ReactTo(s,o,function(){return t&&t(u,s,s,o)})}}t.TextReaction=n}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(t,n,r,o){e.Incite(o,{type:"font",full:t.invalidateFont()})}var r=function(e){function t(t,n){e.call(this,t),this.InheritedWalkProperty=n}return __extends(t,e),t.prototype.GetInheritedEnumerator=function(){if(!this.InheritedWalkProperty)return nullstone.IEnumerator_.empty;var e=this.XObject[this.InheritedWalkProperty];return e?e.GetNodeEnumerator():void 0},t}(e.DONode);t.TextElementNode=r;var o=function(o){function a(){o.call(this),this.TextUpdater=new minerva.text.TextUpdater,t.TextReaction(a.ForegroundProperty,function(t,n,r,o){e.Incite(o,{type:"font",full:t.invalidateFont()})},!0,!0,this),t.TextReaction(a.FontFamilyProperty,n,!1,!0,this),t.TextReaction(a.FontSizeProperty,n,!1,!0,this),t.TextReaction(a.FontStretchProperty,n,!1,!0,this),t.TextReaction(a.FontStyleProperty,n,!1,!0,this),t.TextReaction(a.FontWeightProperty,n,!1,!0,this)}return __extends(a,o),a.prototype.CreateNode=function(){return new r(this,null)},a.prototype.IsInheritable=function(e){return i.indexOf(e)>-1},a.prototype._SerializeText=function(){return void 0},a.prototype.Equals=function(e){return this.FontFamily!==e.FontFamily?!1:this.FontSize!==e.FontSize?!1:this.FontStyle!==e.FontStyle?!1:this.FontWeight!==e.FontWeight?!1:this.FontStretch!==e.FontStretch?!1:nullstone.equals(this.Foreground,e.Foreground)?!0:!1},a.FontFamilyProperty=e.InheritableOwner.FontFamilyProperty.ExtendTo(a),a.FontSizeProperty=e.InheritableOwner.FontSizeProperty.ExtendTo(a),a.FontStretchProperty=e.InheritableOwner.FontStretchProperty.ExtendTo(a),a.FontStyleProperty=e.InheritableOwner.FontStyleProperty.ExtendTo(a),a.FontWeightProperty=e.InheritableOwner.FontWeightProperty.ExtendTo(a),a.ForegroundProperty=e.InheritableOwner.ForegroundProperty.ExtendTo(a),a.LanguageProperty=e.InheritableOwner.LanguageProperty.ExtendTo(a),a}(e.DependencyObject);t.TextElement=o,e.CoreLibrary.add(o);var i=[o.FontFamilyProperty,o.FontSizeProperty,o.FontStretchProperty,o.FontStyleProperty,o.FontWeightProperty,o.ForegroundProperty,o.LanguageProperty]}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t.TextElement);t.Block=n,e.CoreLibrary.add(n)}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype._RaiseItemAdded=function(t,n){e.Incite(this,{item:t,index:n,add:!0})},n.prototype._RaiseItemRemoved=function(t,n){e.Incite(this,{item:t,index:n,add:!1})},n}(e.XamlObjectCollection);t.BlockCollection=n,e.CoreLibrary.add(n)}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),t.TextReaction(r.TextDecorationsProperty,function(t,n,r,o){e.Incite(o,{type:"font",full:t.invalidateFont()})},!1,!0,this)}return __extends(r,n),r.prototype.Equals=function(e){return this.TextDecorations!==e.TextDecorations?!1:n.prototype.Equals.call(this,e)},r.prototype.IsInheritable=function(e){return e===r.TextDecorationsProperty?!0:n.prototype.IsInheritable.call(this,e)},r.TextDecorationsProperty=e.InheritableOwner.TextDecorationsProperty.ExtendTo(r),r}(t.TextElement);t.Inline=n,e.CoreLibrary.add(n)}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype._RaiseItemAdded=function(t,n){e.Incite(this,{item:t,index:n,add:!0})},n.prototype._RaiseItemRemoved=function(t,n){e.Incite(this,{item:t,index:n,add:!1})},n}(e.XamlObjectCollection);t.InlineCollection=n,e.CoreLibrary.add(n)}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t.Inline);t.LineBreak=n,e.CoreLibrary.add(n)}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){var t=this;n.call(this);var o=r.InlinesProperty.Initialize(this);o.AttachTo(this),e.ReactTo(o,this,function(e){return t.InlinesChanged(e.item,e.add)})}return __extends(r,n),r.prototype.CreateNode=function(){return new t.TextElementNode(this,"Inlines")},r.prototype.InlinesChanged=function(t,n){var r=this;n&&e.Providers.InheritedStore.PropagateInheritedOnAdd(this,t.XamlNode),n?e.ReactTo(t,this,function(t){return e.Incite(r,t)}):e.UnreactTo(t,this),e.Incite(this,{type:"text",full:!0})},r.InlinesProperty=DependencyProperty.RegisterImmutable("Inlines",function(){return t.InlineCollection},r),r}(t.Block);t.Paragraph=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.InlinesProperty)}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype._SerializeText=function(){return this.Text},n.prototype.IsInheritable=function(e){return e===n.FlowDirectionProperty?!0:t.prototype.IsInheritable.call(this,e)},n.FlowDirectionProperty=e.InheritableOwner.FlowDirectionProperty.ExtendTo(n),n.TextProperty=DependencyProperty.Register("Text",function(){return String},n),n}(t.Inline);t.Run=n,e.CoreLibrary.add(n);var r;!function(r){t.TextReaction(n.TextProperty,function(t,n,r,o){e.Incite(o,{type:"text",full:!0})},!1)}(r||(r={}))}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){var t=this;n.call(this);var o=r.BlocksProperty.Initialize(this);o.AttachTo(this),e.ReactTo(o,this,function(e){return t.BlocksChanged(e.item,e.add)})}return __extends(r,n),r.prototype.CreateNode=function(){return new t.TextElementNode(this,"Blocks")},r.prototype.BlocksChanged=function(t,n){var r=this;n&&e.Providers.InheritedStore.PropagateInheritedOnAdd(this,t.XamlNode),n?e.ReactTo(t,this,function(t){return e.Incite(r,t)}):e.UnreactTo(t,this),e.Incite(this,{type:"text",full:!0})},r.BlocksProperty=DependencyProperty.RegisterImmutable("Blocks",function(){return t.BlockCollection},r),r}(t.TextElement);t.Section=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.BlocksProperty)}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){var t=this;n.call(this);var o=r.InlinesProperty.Initialize(this);o.AttachTo(this),e.ReactTo(o,this,function(e){return t.InlinesChanged(e.item,e.add)})}return __extends(r,n),r.prototype.CreateNode=function(){return new t.TextElementNode(this,"Inlines")},r.prototype._SerializeText=function(){for(var e="",t=this.Inlines.getEnumerator();t.moveNext();)e+=t.current._SerializeText();return e},r.prototype.InlinesChanged=function(t,n){var r=this;n&&e.Providers.InheritedStore.PropagateInheritedOnAdd(this,t.XamlNode),n?e.ReactTo(t,this,function(t){return e.Incite(r,t)}):e.UnreactTo(t,this),e.Incite(this,{type:"text",full:!0})},r.InlinesProperty=DependencyProperty.RegisterImmutable("Inlines",function(){return t.InlineCollection},r),r}(t.Inline);t.Span=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.InlinesProperty)}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t.Span);t.Underline=n,e.CoreLibrary.add(n)}(t=e.Documents||(e.Documents={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(t){function n(){t.call(this),this.Loaded=new nullstone.Event,this.Address=null,this.AllowNavigation=!0,this._IsRunning=!1,this._IsLoaded=!1,this._Storyboards=[],this._ClockTimer=new e.ClockTimer,this._RootVisual=null,this.Resized=new e.RoutedEvent,this.XamlNode.NameScope=new e.NameScope(!0);n.ResourcesProperty.Initialize(this);this.MainSurface=new e.Surface(this),this.Address=new e.Uri(document.URL)}return __extends(n,t),n.prototype.OnThemeNameChanged=function(t){var n=this;this._IsLoaded&&e.ThemeManager.LoadAsync(t.NewValue).then(function(){return n._ApplyTheme()},function(e){return console.error("Could not load theme.",e)})},n.prototype._ApplyTheme=function(){for(var t=this.MainSurface.walkLayers();t.step();)for(var n=t.current.walkDeep();n.step();){var r=n.current.getAttachedValue("$node");e.Providers.ImplicitStyleBroker.Set(r.XObject,e.Providers.StyleMask.Theme)}},n.prototype.OnResized=function(t,n){this.Resized.raise(this,new e.SizeChangedEventArgs(t,n))},Object.defineProperty(n.prototype,"RootVisual",{get:function(){for(var e=this.MainSurface.walkLayers();e.step();){var t=e.current.getAttachedValue("$node");return t.XObject}},enumerable:!0,configurable:!0}),n.prototype.$$SetRootVisual=function(e){this._RootVisual=e},n.prototype.Attach=function(e){this.MainSurface.init(e),this.MainSurface.Attach(this._RootVisual,!0)},n.prototype.Start=function(){this.Update(),this.Render(),this._ClockTimer.RegisterTimer(this),this._IsLoaded=!0,this.Loaded.raiseAsync(this,null)},n.prototype.OnTicked=function(e,t){this.ProcessStoryboards(e,t),this.Update(),this.Render()},n.prototype.StopEngine=function(){this._ClockTimer.UnregisterTimer(this)},n.prototype.ProcessStoryboards=function(e,t){perfex.timer.start("StoryboardsProcess",this);for(var n=0,r=this._Storyboards;n<r.length;n++)r[n].Update(t);perfex.timer.stop()},n.prototype.Update=function(){if(!this._IsRunning){this._IsRunning=!0,perfex.timer.start("UpdateLayout",this);this.MainSurface.updateLayout();perfex.timer.stop(),this._IsRunning=!1}},n.prototype.Render=function(){perfex.timer.start("Render",this),this.MainSurface.render(),perfex.timer.stop()},n.prototype.RegisterStoryboard=function(e){var t=this._Storyboards,n=t.indexOf(e);-1===n&&t.push(e)},n.prototype.UnregisterStoryboard=function(e){var t=this._Storyboards,n=t.indexOf(e);-1!==n&&t.splice(n,1)},n.GetAsync=function(t){return nullstone.async.create(function(r,o){e.Markup.Resolve(t).then(function(t){TimelineProfile.Parse(!0,"App");var i=e.Markup.Load(null,t);TimelineProfile.Parse(!1,"App"),i instanceof n?r(i):o("Markup must be an Application.")},o)})},n.prototype.Resolve=function(){var e=this;return nullstone.async.create(function(t,n){t(e)})},n.ResourcesProperty=DependencyProperty.RegisterImmutable("Resources",function(){return e.ResourceDictionary},n),n.ThemeNameProperty=DependencyProperty.Register("ThemeName",function(){return String},n,"Default",function(e,t){return e.OnThemeNameChanged(t)}),n}(e.DependencyObject);e.Application=t,e.CoreLibrary.add(t)}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,5)}}(),n=function(){function e(){this._Listeners=[],this._LastTime=0}return e.prototype.RegisterTimer=function(e){var t=this._Listeners,n=t.indexOf(e);n>-1||(t.push(e),1===t.length&&this._RequestAnimationTick())},e.prototype.UnregisterTimer=function(e){var t=this._Listeners,n=t.indexOf(e);n>-1&&t.splice(n,1)},e.prototype._DoTick=function(){var e=(new Date).getTime(),t=this._LastTime;this._LastTime=e;var n=this._Listeners,r=n.length;if(0!==r){for(var o=0;r>o;o++)n[o].OnTicked(t,e);this._RequestAnimationTick()}},e.prototype._RequestAnimationTick=function(){var e=this;t(function(){return e._DoTick()})},e}();e.ClockTimer=n}(Fayde||(Fayde={}));var Exception=function(){function e(e){this.Message=e}return e.prototype.toString=function(){var e=this.constructor.name;return e?e+": "+this.Message:this.Message},e}(),ArgumentException=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(Exception),ArgumentNullException=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(Exception),InvalidOperationException=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(Exception),XamlParseException=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(Exception),XamlMarkupParseException=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(Exception),NotSupportedException=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(Exception),IndexOutOfRangeException=function(e){function t(t){e.call(this,t.toString())}return __extends(t,e),t}(Exception),ArgumentOutOfRangeException=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(Exception),AttachException=function(e){function t(t,n){e.call(this,t),this.Data=n}return __extends(t,e),t}(Exception),InvalidJsonException=function(e){function t(t,n){e.call(this,"Invalid json."),this.JsonText=t,this.InnerException=n}return __extends(t,e),t}(Exception),TargetInvocationException=function(e){function t(t,n){e.call(this,t),this.InnerException=n}return __extends(t,e),t}(Exception),UnknownTypeException=function(e){function t(t){e.call(this,t),this.FullTypeName=t}return __extends(t,e),t}(Exception),FormatException=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(Exception),Fayde;!function(e){var t;!function(t){function n(e){for(var t=[];e;)t.push(e),e=e.VisualParentNode;return t}var r=function(){function t(e){this._ChangedEvents=[],this._State=e}return t.prototype.GetFocusToRoot=function(){return this.Node?n(this.Node):null},t.prototype.OnNodeDetached=function(e){for(var t=this.Node;t;){if(t===e)return void this._FocusNode();t=t.VisualParentNode}},t.prototype.TabFocus=function(t){return this.Node?(e.TabNavigationWalker.Focus(this.Node,!t),!0):!1},t.prototype.Focus=function(t,n){if(n=void 0===n||n===!0,!t.IsAttached)return!1;for(var r,o=e.DeepTreeWalker(t);r=o.Step();)if(r.XObject.Visibility===e.Visibility.Visible){if(r instanceof e.Controls.ControlNode){var i=r,a=i.XObject;if(a.IsEnabled){for(var s=t.IsLoaded,u=t;!s&&(u=u.VisualParentNode);)s=s||u.IsLoaded;if(s&&i.LayoutUpdater.assets.totalIsRenderVisible&&a.IsTabStop)return this._FocusNode(i);if(!n)return!1}else{if(!n)return!1;o.SkipBranch()}}}else o.SkipBranch();return!1},t.prototype._FocusNode=function(e){if(e===this.Node)return!0;var t=this.Node;return t&&this._ChangedEvents.push({LostFocus:n(t),GotFocus:null}),this.Node=e,e&&this._ChangedEvents.push({LostFocus:null,GotFocus:n(e)}),this._State.IsFirstUserInitiated&&this.EmitChangesAsync(),!0},t.prototype.EmitChanges=function(){for(var e,t=this._ChangedEvents;e=t.shift();)this._EmitFocusList("lost",e.LostFocus),this._EmitFocusList("got",e.GotFocus)},t.prototype.EmitChangesAsync=function(){var e=this;setTimeout(function(){return e.EmitChanges()},1)},t.prototype._EmitFocusList=function(e,t){if(t)for(var n;n=t.shift();)n._EmitFocusChange(e)},t.prototype.FocusAnyLayer=function(t){if(!this.Node){for(var n,r;t.step()&&(r=t.current.getAttachedValue("$node"),n||(n=r),!e.TabNavigationWalker.Focus(r)););!this.Node&&n&&this._FocusNode(n)}this._State.IsFirstUserInitiated&&this.EmitChangesAsync()},t}();t.FocusManager=r}(t=e.Engine||(e.Engine={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,t,n){var r=e.length-1,o=t.length-1;for(n.Index1=-1,n.Index2=-1;r>=0&&o>=0;){if(e[r]!==t[o])return;n.Index1=r--,n.Index2=o--}}var r=function(){function r(n){this._Cursor=e.CursorType.Default,this.SetCursor=function(e){},this._CurrentPos=null,this._EmittingMouseEvent=!1,this._InputList=[],this._Captured=null,this._PendingCapture=null,this._PendingReleaseCapture=!1,this._CapturedInputList=[],this._Surface=n,this._KeyInterop=e.Input.CreateKeyInterop(),this._MouseInterop=e.Input.CreateMouseInterop(),this._TouchInterop=e.Input.CreateTouchInterop(),this._Focus=new t.FocusManager(this._State={IsUserInitiated:!1,IsFirstUserInitiated:!1})}return Object.defineProperty(r.prototype,"FocusedNode",{get:function(){return this._Focus.Node},enumerable:!0,configurable:!0}),r.prototype.Focus=function(e,t){return this._Focus.Focus(e,t)},r.prototype.Register=function(t){var n=this;this.SetCursor=function(r){return t.style.cursor=e.CursorTypeMappings[e.CursorType[n._Cursor=r]]},this._KeyInterop.RegisterEvents(this),this._MouseInterop.RegisterEvents(this,t),this._TouchInterop.Register(this,t)},r.prototype.OnNodeDetached=function(e){var t=this._InputList;t[t.length-1]===e&&(this._InputList=[]),this._Focus.OnNodeDetached(e)},r.prototype.SetIsUserInitiatedEvent=function(e){this._Focus.EmitChanges(),this._State.IsFirstUserInitiated=this._State.IsFirstUserInitiated||e,this._State.IsUserInitiated=e},r.prototype.HandleKeyDown=function(t){this.SetIsUserInitiatedEvent(!0),e.Input.Keyboard.RefreshModifiers(t.Modifiers);var n=this._Focus.GetFocusToRoot();n&&this._EmitKeyDown(n,t),t.Handled||t.Key!==e.Input.Key.Tab||(this._Focus.TabFocus(t.Modifiers.Shift)||this._Focus.FocusAnyLayer(this._Surface.walkLayers(!0)),t.Handled=!0),this.SetIsUserInitiatedEvent(!1)},r.prototype._EmitKeyDown=function(e,t,n){if(0!==n){n&&-1!==n||(n=e.length);for(var r=0,o=e.shift();o&&n>r;)o._EmitKeyDown(t),o=e.shift(),r++}},r.prototype.HandleMousePress=function(t,n){this.SetIsUserInitiatedEvent(!0);var r=this.HandleMouseEvent(e.Input.MouseInputType.MouseDown,t,n);return this.UpdateCursorFromInputList(),this.SetIsUserInitiatedEvent(!1),r},r.prototype.HandleMouseRelease=function(t,n){this.SetIsUserInitiatedEvent(!0),this.HandleMouseEvent(e.Input.MouseInputType.MouseUp,t,n),this.UpdateCursorFromInputList(),this.SetIsUserInitiatedEvent(!1),this._Captured&&this._PerformReleaseCapture()},r.prototype.HandleMouseEvent=function(t,r,o,i,a,s){if(this._CurrentPos=o,this._EmittingMouseEvent)return!1;var u=this.HitTestPoint(o);if(!u)return!1;this._EmittingMouseEvent=!0;var l={Index1:-1,Index2:-1};n(this._InputList,u,l),(void 0===a||a===!0)&&this._EmitMouseList(e.Input.MouseInputType.MouseLeave,r,o,i,this._InputList,l.Index1),(void 0===s||s===!0)&&this._EmitMouseList(e.Input.MouseInputType.MouseEnter,r,o,i,u,l.Index2);var c=!1;return t!==e.Input.MouseInputType.NoOp&&(c=this._EmitMouseList(t,r,o,i,this._Captured?this._CapturedInputList:u)),this._InputList=u,this._Surface.HitTestCallback&&this._Surface.HitTestCallback(u),this._PendingCapture&&this._PerformCapture(this._PendingCapture),(this._PendingReleaseCapture||this._Captured&&!this._Captured.CanCaptureMouse())&&this._PerformReleaseCapture(),this._EmittingMouseEvent=!1,c},r.prototype._EmitMouseList=function(t,n,r,o,i,a){var s=!1;if(0===a)return s;a&&-1!==a||(a=i.length);var u=this._MouseInterop.CreateEventArgs(t,r,o),l=i[0];l&&u instanceof e.RoutedEventArgs&&(u.Source=l.XObject);var c=this._MouseInterop.IsLeftButton(n),p=this._MouseInterop.IsRightButton(n);if(e.Engine.Inspection.TryHandle(t,c,p,u,i))return!0;for(var d=0;a>d;d++)l=i[d],t===e.Input.MouseInputType.MouseLeave&&(u.Source=l.XObject),l._EmitMouseEvent(t,c,p,u)&&(s=!0),t===e.Input.MouseInputType.MouseLeave&&(u=this._MouseInterop.CreateEventArgs(t,r,o));return s},r.prototype.HitTestPoint=function(e){return this._Surface.hitTest(e).map(function(e){return e.getAttachedValue("$node")})},r.prototype.UpdateCursorFromInputList=function(){for(var t=e.CursorType.Default,n=this._Captured?this._CapturedInputList:this._InputList,r=n.length,o=0;r>o&&(t=n[o].XObject.Cursor,t===e.CursorType.Default);o++);this.SetCursor(t)},r.prototype.SetMouseCapture=function(e){return this._Captured||this._PendingCapture?e===this._Captured||e===this._PendingCapture:this._EmittingMouseEvent?(this._PendingCapture=e,!0):!1},r.prototype.ReleaseMouseCapture=function(e){(e===this._Captured||e===this._PendingCapture)&&(this._EmittingMouseEvent?this._PendingReleaseCapture=!0:this._PerformReleaseCapture())},r.prototype._PerformCapture=function(e){this._Captured=e;for(var t=[];null!=e;)t.push(e),e=e.VisualParentNode;this._CapturedInputList=t,this._PendingCapture=null},r.prototype._PerformReleaseCapture=function(){var t=this._Captured;this._Captured=null,this._PendingReleaseCapture=!1,t._EmitLostMouseCapture(this._CurrentPos),this.HandleMouseEvent(e.Input.MouseInputType.NoOp,null,this._CurrentPos,void 0,!1,!0)},r}();t.InputManager=r}(t=e.Engine||(e.Engine={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,t){p=p||r(),o(t),p.style.left=e.x.toString()+"px",p.style.top=e.y.toString()+"px",p.style.display=""}function r(){var e=document.createElement("div");return e.style.position="absolute",e.style.display="none",e.style.backgroundColor="rgba(128,128,128,1.0)",e.style.padding="5px",e.style.fontFamily="Tahoma",e.oncontextmenu=function(){return!1},document.body.appendChild(e),e}function o(e){p.innerHTML="";for(var t=e.length,n=0;t>n;n++)p.appendChild(i(e[n]))}function i(e){var t=document.createElement("div");return t.style.cursor="pointer",t.innerHTML=a(e),t.onclick=function(){return s(e)},t.onmouseenter=function(){return u(t)},t.onmouseleave=function(){return l(t)},t}function a(e){var t=e.XObject,n="",r=t._ID;r&&(n+="["+r+"] "),n+=t.constructor.name;var o=e.Name;if(o){n+=" [";var i=e.NameScope;n+=i?i.IsRoot?"+":"-":"^",n+=o+"]"}return n}function s(e){p.style.display="none"}function u(e){e.style.textDecoration="underline"}function l(e){e.style.textDecoration="none"}var c=function(){function t(){}return t.TryHandle=function(t,r,o,i,a){if(!e.IsInspectionOn)return!1;if(t!==e.Input.MouseInputType.MouseDown)return!1;if(!o)return!1;if(!e.Input.Keyboard.HasControl())return!1;var s=i.AbsolutePos;return n(s,a),!0},t.Kill=function(){p&&(p.style.display="none")},t}();t.Inspection=c;var p=null}(t=e.Engine||(e.Engine={}))}(Fayde||(Fayde={}));var resizeTimeout,Fayde;!function(e){var t=function(t){function n(n){t.call(this),this.$$root=null,Object.defineProperty(this,"App",{value:n,writable:!1}),this.$$inputMgr=new e.Engine.InputManager(this)}return __extends(n,t),n.prototype.init=function(e){var n=this;t.prototype.init.call(this,e),this.$$stretchCanvas(),document.body.onresize=function(e){
return n.$$handleResize(window.event?window.event:e)},window.onresize=function(e){return n.$$handleResize(window.event?window.event:e)},this.$$inputMgr.Register(e)},n.prototype.Attach=function(t,n){if(n===!0){if(!(t instanceof e.UIElement))throw new Exception("Unsupported top level element.");this.$$root&&this.detachLayer(this.$$root.XamlNode.LayoutUpdater),this.$$root=t}this.attachLayer(t.XamlNode.LayoutUpdater,n)},n.prototype.attachLayer=function(e,n){t.prototype.attachLayer.call(this,e,n);var r=e.getAttachedValue("$node");r.SetIsLoaded(!0),r.SetIsAttached(!0)},n.prototype.Detach=function(e){this.detachLayer(e.XamlNode.LayoutUpdater)},n.prototype.detachLayer=function(e){var n=e.getAttachedValue("$node");n.SetIsLoaded(!1),n.SetIsAttached(!1),t.prototype.detachLayer.call(this,e)},n.prototype.updateLayout=function(){var e=t.prototype.updateLayout.call(this);return e&&this.$$onLayoutUpdated(),e},n.prototype.$$onLayoutUpdated=function(){for(var e=this.walkLayers();e.step();)for(var t=e.current.walkDeep();t.step();){var n=t.current,r=n.getAttachedValue("$node"),o=r.XObject;o.LayoutUpdated.raise(o,null)}},n.prototype.Focus=function(e,t){return this.$$inputMgr.Focus(e,t)},n.HasFocus=function(e){var t=e.XamlNode,n=t.LayoutUpdater.tree.surface;if(!n)return!1;for(var r=n.$$inputMgr.FocusedNode;r;){if(r===t)return!0;r=r.VisualParentNode}return!1},n.Focus=function(e,t){var n=e.XamlNode,r=n.LayoutUpdater.tree.surface;return r?r.$$inputMgr.Focus(n,t):!1},n.GetFocusedElement=function(e){var t=e.XamlNode,n=t.LayoutUpdater.tree.surface;if(!n)return null;var r=n.$$inputMgr.FocusedNode;return r.XObject},n.RemoveFocusFrom=function(e){var t=e.XamlNode,n=t.LayoutUpdater.tree.surface;return n?(n.$$inputMgr.OnNodeDetached(t),!0):!1},n.SetMouseCapture=function(e){var t=e.LayoutUpdater.tree.surface;return t?t.$$inputMgr.SetMouseCapture(e):!1},n.ReleaseMouseCapture=function(e){var t=e.LayoutUpdater.tree.surface;t&&t.$$inputMgr.ReleaseMouseCapture(e)},n.prototype.$$handleResize=function(e){var t=this;resizeTimeout&&clearTimeout(resizeTimeout),resizeTimeout=setTimeout(function(){t.$$stretchCanvas(),resizeTimeout=null},15)},n.prototype.$$stretchCanvas=function(){this.resize(window.innerWidth,window.innerHeight)},n}(minerva.engine.Surface);e.Surface=t}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function t(e,t){this.Resources=null,this.Name=e,this.LibraryUri=t}return t.prototype.LoadAsync=function(){var n=this,r=e.ThemeConfig.GetRequestUri(this.LibraryUri,this.Name);return r?nullstone.async.create(function(o,i){e.Markup.Resolve(r).then(function(t){var r=e.Markup.Load(null,t);r instanceof e.ResourceDictionary||i(new Error("Theme root must be a ResourceDictionary.")),Object.defineProperty(n,"Resources",{value:r,writable:!1}),o(n)},function(){t.WarnMissing&&console.warn("Failed to load Theme. ["+n.LibraryUri+"]["+n.Name+"]"),o(n)})}):nullstone.async.resolve(this)},t.prototype.GetImplicitStyle=function(t){var n=this.Resources;if(!n)return void 0;var r=n.Get(t);return r instanceof e.Style?r:void 0},t.WarnMissing=!1,t}();e.Theme=t,e.CoreLibrary.add(t)}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(t,n){if(e.Uri.isNullOrEmpty(t))return null;var r=a[t.toString()];if(r&&r.none)return null;var o=(r?r.requestTemplateUri:null)||s;return i(t,n,o)}function r(e,t){a[e.toString()]={requestTemplateUri:t}}function o(t,n){if(!t)return void console.warn("Could not configure theme. No library specified.");var r=new e.Uri(t);"http"!==r.scheme&&(r=new e.Uri("lib://"+t)),void 0===n?a[r.toString()]=null:null===n?a[r.toString()]={none:!0}:a[r.toString()]={requestTemplateUri:n}}function i(e,t,n){var r=e.host,o=n;return o=o.replace("<libname>",r),o=o.replace("<themename>",t)}var a={},s="lib/<libname>/themes/<themename>.Theme.xml";t.GetRequestUri=n,t.OverrideRequestUri=r,t.Set=o,r(new e.Uri(e.XMLNS),"lib/fayde/themes/<themename>.theme.xml")}(t=e.ThemeConfig||(e.ThemeConfig={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function t(){this.$$libthemerepos=[],e.TypeManager.libResolver.libraryCreated.on(this.$$onLibraryCreated,this),this.$$libthemerepos.push(new n(new e.Uri(e.XMLNS)))}return t.prototype.$$onLibraryCreated=function(e,t){this.$$libthemerepos.push(new n(t.library.uri))},t.prototype.LoadAsync=function(e){return nullstone.async.many(this.$$libthemerepos.map(function(t){return t.ChangeActive(e)}))},t.prototype.FindStyle=function(e){if(!e)return null;var t=e.$$uri;if(t){var n=this.$$findRepo(t);if(n)return n.Active.GetImplicitStyle(e)}return null},t.prototype.$$findRepo=function(e){for(var t=0,n=this.$$libthemerepos;t<n.length;t++){var r=n[t];if(r.Uri.toString()===e)return r}},t}(),n=function(){function t(e){this.$$themes={},Object.defineProperty(this,"Uri",{value:e,writable:!1})}return Object.defineProperty(t.prototype,"Active",{get:function(){return this.$$active},enumerable:!0,configurable:!0}),t.prototype.Get=function(t){var n=this.$$themes[t];return n||(n=this.$$themes[t]=new e.Theme(t,this.Uri)),n},t.prototype.ChangeActive=function(e){var t=this,n=this.Get(e);return nullstone.async.create(function(e,r){n.LoadAsync().then(function(){t.$$active=n,e(n)},r)})},t}();e.ThemeManager=new t}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(){function e(){this.IsUpdating=!1,this.IsAttached=!1}return e.prototype.Seal=function(e,t){},e.prototype.OnAttached=function(e){this.IsAttached=!0,this.OnDataContextChanged(e.XamlNode.DataContext)},e.prototype.OnDetached=function(e){this.IsAttached=!1,this.OnDataContextChanged(void 0)},e.prototype.GetValue=function(e){},e.prototype.OnDataContextChanged=function(e){},e}();e.Expression=t}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(t){for(var n=t;n;n=n.Parent)if(n instanceof e.FrameworkElement)return n;return null}function r(e){var n=t.IDataErrorInfo_.as(e.FinalNode.GetSource()),r=e.FinalPropertyName;return n&&r?n.GetError(r):null}var o=function(o){function i(e){o.call(this),this._TwoWayLostFocusElement=null,this._CurrentNotifyError=null,this._CurrentError=null,this._Cached=!1,this._CachedValue=void 0,this._IsSealed=!1,Object.isFrozen(e)||Object.freeze(e),Object.defineProperty(this,"ParentBinding",{value:e,writable:!1})}return __extends(i,o),Object.defineProperty(i.prototype,"DataItem",{get:function(){return this.PropertyPathWalker.Source},enumerable:!0,configurable:!0}),i.prototype.Seal=function(n,r){if(!this._IsSealed){this._IsSealed=!0,Object.defineProperty(this,"Target",{value:n,writable:!1});var o=r;Object.defineProperty(this,"Property",{value:o,writable:!1});var i=this.ParentBinding,a=i.Path.Path;if((!a||"."===a)&&i.Mode===t.BindingMode.TwoWay)throw new ArgumentException("TwoWay bindings require a non-empty Path.");i.Mode===t.BindingMode.TwoWay&&(n instanceof e.Controls.TextBox||n instanceof e.Controls.PasswordBox)&&(this._TwoWayLostFocusElement=n),this._IsDataContextBound=!i.ElementName&&!i.Source&&!i.RelativeSource;var s=o===e.DependencyObject.DataContextProperty||o.GetTargetType()===nullstone.IEnumerable_||o.GetTargetType()===t.ICollectionView_,u=this.PropertyPathWalker=new t.PropertyPathWalker(i.Path.ParsePath,i.BindsDirectlyToSource,s,this._IsDataContextBound);i.Mode!==t.BindingMode.OneTime&&u.Listen(this)}},i.prototype.OnAttached=function(n){var r=this;if(!this.IsAttached){if(this.Target&&this.Target!==n)throw new Error("Cannot attach BindingExpression to another DependencyObject.");e.Data.Debug&&window.console&&console.log("[BINDING] OnAttached: ["+n.constructor.name+"] {Path="+this.ParentBinding.Path.Path+"}"),o.prototype.OnAttached.call(this,n),this._SourceAvailableMonitor=this.Target.XamlNode.MonitorIsAttached(function(e){return r._OnSourceAvailable()});var i=this._FindSource();this.PropertyPathWalker.Update(i),this._TwoWayLostFocusElement&&this._TwoWayLostFocusElement.LostFocus.on(this._TargetLostFocus,this),this.ParentBinding.Mode===t.BindingMode.TwoWay&&this.Property.IsCustom&&(this._PropertyListener=this.Property.Store.ListenToChanged(this.Target,this.Property,this._UpdateSourceCallback,this))}},i.prototype.GetValue=function(n){if(this._Cached)return this._CachedValue;if(this.PropertyPathWalker.IsPathBroken){var r=this.Target;if(t.WarnBrokenPath&&r&&r.XamlNode.IsAttached){var o=r instanceof e.FrameworkElement?r:null;(!o||o.XamlNode.IsLoaded)&&console.warn("[BINDING] Path Broken --> Path='"+this.PropertyPathWalker.Path+"'")}this._CachedValue=null}else this._CachedValue=this.PropertyPathWalker.ValueInternal;return this._CachedValue=this._ConvertToType(n,this._CachedValue),this._Cached=!0,this._CachedValue},i.prototype._OnSourceAvailable=function(){this._SourceAvailableMonitor.Detach();var e=this._FindSource();e&&this.PropertyPathWalker.Update(e),this._Invalidate(),this.Target.SetValue(this.Property,this)},i.prototype._FindSource=function(){return this.ParentBinding.Source?this.ParentBinding.Source:null!=this.ParentBinding.ElementName?this._FindSourceByElementName():this.ParentBinding.RelativeSource?this.ParentBinding.RelativeSource.Find(this.Target):this._DataContext},i.prototype._FindSourceByElementName=function(){var e=this.ParentBinding.ElementName,t=this.Target;if(!t)return void 0;var n=t.FindName(e,!0);return n?n:void 0},i.prototype.OnDetached=function(t){if(this.IsAttached){if(e.Data.Debug&&window.console&&console.log("[BINDING] OnDetached: ["+t.constructor.name+"] {Path="+this.ParentBinding.Path.Path+"}"),o.prototype.OnDetached.call(this,t),this._TwoWayLostFocusElement&&this._TwoWayLostFocusElement.LostFocus.off(this._TargetLostFocus,this),null!=this._CurrentError){var r=n(t);r&&e.Validation.RemoveError(r,this._CurrentError),this._CurrentError=null}this._PropertyListener&&(this._PropertyListener.Detach(),this._PropertyListener=null),this.PropertyPathWalker.Update(null),this.Target=void 0}},i.prototype.IsBrokenChanged=function(){this.Refresh()},i.prototype.ValueChanged=function(){this.Refresh()},i.prototype.UpdateSource=function(){return this._UpdateSourceObject()},i.prototype._TryUpdateSourceObject=function(e){this._ShouldUpdateSource()&&this._UpdateSourceObject(e)},i.prototype._UpdateSourceCallback=function(e,t){try{this._ShouldUpdateSource()&&this._UpdateSourceObject(this.Target.GetValue(this.Property))}catch(n){console.warn("[BINDING] UpdateSource: "+n.toString())}},i.prototype._TargetLostFocus=function(e,n){this.ParentBinding.UpdateSourceTrigger!==t.UpdateSourceTrigger.Explicit&&this._UpdateSourceObject()},i.prototype._ShouldUpdateSource=function(){return this.IsUpdating?!1:this._TwoWayLostFocusElement?this.ParentBinding.UpdateSourceTrigger===t.UpdateSourceTrigger.PropertyChanged:this.ParentBinding.UpdateSourceTrigger!==t.UpdateSourceTrigger.Explicit},i.prototype._UpdateSourceObject=function(e){void 0===e&&(e=this.Target.GetValue(this.Property));var n=this.ParentBinding;if(n.Mode===t.BindingMode.TwoWay){var o,i=null,a=this.IsUpdating,s=this.PropertyPathWalker,u=this.PropertyPathWalker.FinalNode;try{if(this.PropertyPathWalker.IsPathBroken)return;if(e=this._ConvertFromTargetToSource(n,u,e),void 0===this._CachedValue&&void 0===e)return;this.IsUpdating=!0,u.SetValue(e),this._CachedValue=e}catch(l){n.ValidatesOnExceptions&&(l instanceof TargetInvocationException&&(o=l.InnerException),o=l)}finally{this.IsUpdating=a,n.ValidatesOnDataErrors&&!o&&(i=r(s))}n.ValidatesOnExceptions?this._MaybeEmitError(null,o):n.ValidatesOnDataErrors&&this._MaybeEmitError(i,o)}},i.prototype.OnDataContextChanged=function(n){if(e.Data.Debug&&window.console&&console.log("[BINDING] DataContextChanged: ["+this.Target._ID+":"+this.Target.constructor.name+"] {Path="+this.ParentBinding.Path.Path+"}"),this._DataContext!==n&&(this._DataContext=n,this._IsDataContextBound)){e.Data.IsCounterEnabled&&e.Data.DataContextCounter++;try{this.PropertyPathWalker.Update(n),this.ParentBinding.Mode===t.BindingMode.OneTime&&this.Refresh()}catch(r){console.warn("[BINDING] DataContextChanged Error: "+r.message)}}},i.prototype._Invalidate=function(){this._Cached=!1,this._CachedValue=void 0},i.prototype.Refresh=function(){var e,t=null;if(this.IsAttached){var n=this.PropertyPathWalker;this._AttachToNotifyError(n.FinalNode.GetSource());var o=this.ParentBinding;!this.IsUpdating&&o.ValidatesOnDataErrors&&(t=r(n));var i=this.IsUpdating;try{this.IsUpdating=!0,this._Invalidate(),this.Target.SetValue(this.Property,this)}catch(a){o.ValidatesOnExceptions?(e=a,e instanceof TargetInvocationException&&(e=e.InnerException)):console.warn(a)}finally{this.IsUpdating=i}o.ValidatesOnExceptions?this._MaybeEmitError(null,e):o.ValidatesOnDataErrors&&this._MaybeEmitError(t,e)}},i.prototype._ConvertFromTargetToSource=function(e,t,n){e.TargetNullValue&&e.TargetNullValue===n&&(n=null);var r=e.Converter;return r&&(n=r.ConvertBack(n,t.ValueType,e.ConverterParameter,e.ConverterCulture)),n},i.prototype._ConvertToType=function(t,n){var r=this.Property.GetTargetType();try{var o=this.ParentBinding;if(!this.PropertyPathWalker.IsPathBroken&&o.Converter&&(n=o.Converter.Convert(n,r,o.ConverterParameter,o.ConverterCulture)),n===DependencyProperty.UnsetValue||this.PropertyPathWalker.IsPathBroken)n=o.FallbackValue,void 0===n&&(n=t.DefaultValue);else if(null==n)n=o.TargetNullValue,null==n&&this._IsDataContextBound&&!o.Path.Path&&(n=t.DefaultValue);else{var i=o.StringFormat;i&&(i.indexOf("{0")<0&&(i="{0:"+i+"}"),n=e.Localization.Format(i,n))}}catch(a){console.warn("[BINDING]"+a.toString()),n=o.FallbackValue}return nullstone.convertAnyToType(n,r)},i.prototype._MaybeEmitError=function(t,r){var o=n(this.Target);if(o){var i=r instanceof Exception||r instanceof Error?r:null;""===t&&(t=null);var a=this._CurrentError;null!=t?this._CurrentError=new e.Validation.ValidationError(t,null,this.PropertyPathWalker.FinalPropertyName):i?this._CurrentError=new e.Validation.ValidationError(null,i,this.PropertyPathWalker.FinalPropertyName):this._CurrentError=null,e.Validation.Emit(o,this.ParentBinding,a,this._CurrentError)}},i.prototype._AttachToNotifyError=function(e){if(t.INotifyDataErrorInfo_.is(e)&&e!==this._CurrentNotifyError&&this.ParentBinding.ValidatesOnNotifyDataErrors){var n=this.PropertyPathWalker.FinalPropertyName;if(this._CurrentNotifyError&&(this._CurrentNotifyError.ErrorsChanged.off(this._NotifyErrorsChanged,this),this._MaybeEmitError(null,null)),this._CurrentNotifyError=e,e)if(e.ErrorsChanged.on(this._NotifyErrorsChanged,this),e.HasErrors){var r=e.GetErrors(n);if(r)for(var o=r.getEnumerator();o.moveNext();)this._MaybeEmitError(o.current,o.current)}else this._MaybeEmitError(null,null)}},i.prototype._NotifyErrorsChanged=function(e,t){var n=this.PropertyPathWalker.FinalPropertyName;if(t.PropertyName===n){var r=this._CurrentNotifyError?this._CurrentNotifyError.GetErrors(n):null;if(!r)return void this._MaybeEmitError(null,null);var o=nullstone.IEnumerable_.toArray(r);if(o.length<=0)return void this._MaybeEmitError(null,null);for(var i=0;i<o.length;i++){var a=o[i];this._MaybeEmitError(a,a)}}},i}(e.Expression);t.BindingExpressionBase=o}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(e.BindingExpressionBase);e.BindingExpression=t}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.GetValue=function(e){return void 0},t.prototype.toString=function(){return"DeferredValueExpression"},t}(e.Expression);e.DeferredValueExpression=t}(Fayde||(Fayde={}));var Fayde;!function(e){function t(e,t){if(t){if(t.Source)return t.Source;if(null!=t.ElementName)return n(e,t.ElementName);if(t.RelativeSource)return t.RelativeSource.Find(e)}return e.XamlNode.DataContext}function n(e,t){var n=e;if(!n)return void 0;var r=n.FindName(t,!0);return r?r:void 0}var r=function(n){function r(t){n.call(this),this.IsUpdating=!1,this.IsAttached=!1,this._CommandWalker=null,this._CommandParameterWalker=null,this._Target=null,this._Event=null,this._EventName=null,this._EventBinding=t;var r=this._EventBinding.CommandBinding;r&&(this._CommandWalker=new e.Data.PropertyPathWalker(r.Path.ParsePath,r.BindsDirectlyToSource,!1,!r.ElementName&&!r.Source&&!r.RelativeSource));var o=this._EventBinding.CommandParameterBinding;o&&(this._CommandParameterWalker=new e.Data.PropertyPathWalker(o.Path.ParsePath,o.BindsDirectlyToSource,!1,!o.ElementName&&!o.Source&&!o.RelativeSource))}return __extends(r,n),r.prototype.Seal=function(e,t){},r.prototype.Init=function(e){this._EventName=e},r.prototype.GetValue=function(e){},r.prototype.OnAttached=function(e){this.IsAttached||(this.IsAttached=!0,this._Target=e,this._Event=e[this._EventName],this._Event&&this._Event.on(this._Callback,this))},r.prototype.OnDetached=function(e){this.IsAttached&&(this._Event&&this._Event.off(this._Callback,this),this._Event=null,this.IsAttached=!1)},r.prototype.OnDataContextChanged=function(e){},r.prototype._Callback=function(n,r){var o=this._Target,i=t(o,this._EventBinding.CommandBinding),a=i,s=a,u=this._CommandWalker;if(u&&(s=u.GetValue(s),a=u.GetContext(),null==a&&(a=i)),!s)return void console.warn("[EVENTBINDING]: Could not find command target for event '"+this._EventName+"'.");var l={sender:n,args:r,parameter:null},c=this._EventBinding.CommandParameterBinding;if(c){var p=this._CommandParameterWalker,d=t(o,c);l.parameter=p.GetValue(d)}if("function"==typeof s)s.call(a,l);else{var h=e.Input.ICommand_.as(s);if(!h)return void console.warn("[EVENTBINDING]: Could not find command target for event '"+this._EventName+"'.");h=s,h.CanExecute.call(a,l)&&h.Execute.call(a,l)}},r}(e.Expression);e.EventBindingExpression=r}(Fayde||(Fayde={}));var Fayde;!function(e){var t=function(t){function n(e){t.call(this),this._IsSealed=!1,this._SourcePropertyName=e}return __extends(n,t),n.prototype.Seal=function(t,n){if(!this._IsSealed){this._IsSealed=!0;var r=t.TemplateOwner;if(!(r instanceof e.DependencyObject))throw new Error("TemplateBinding must be applied to a DependencyObject within a template.");this.SourceProperty=DependencyProperty.GetDependencyProperty(r.constructor,this._SourcePropertyName),this.TargetProperty=n}},n.prototype.GetValue=function(e){var t,n=this._Target,r=n.TemplateOwner;return r&&(t=r.GetValue(this.SourceProperty)),t=nullstone.convertAnyToType(t,this.TargetProperty.GetTargetType())},n.prototype.OnAttached=function(n){t.prototype.OnAttached.call(this,n),this._Target=n,this._DetachListener();var r;this._Target instanceof e.Controls.ContentControl&&(r=this._Target),this._AttachListener()},n.prototype.OnDetached=function(n){t.prototype.OnDetached.call(this,n);var r=this._Listener;if(r){var o;this._Target instanceof e.Controls.ContentControl&&(o=this._Target),this._DetachListener(),this._Target=null}},n.prototype.OnSourcePropertyChanged=function(e,t){if(this.SourceProperty._ID===t.Property._ID)try{this.IsUpdating=!0;var n=this.TargetProperty;try{this._Target.SetCurrentValue(n,this.GetValue(null))}catch(r){var o=n.DefaultValue;this._Target.SetCurrentValue(n,o)}}catch(i){}finally{this.IsUpdating=!1}},n.prototype._AttachListener=function(){var e=this,t=this._Target.TemplateOwner;t&&(this._Listener=this.SourceProperty.Store.ListenToChanged(t,this.SourceProperty,function(t,n){return e.OnSourcePropertyChanged(t,n)},this))},n.prototype._DetachListener=function(){var e=this._Listener;e&&(this._Listener.Detach(),this._Listener=null)},n}(e.Expression);e.TemplateBindingExpression=t}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){e.ICommand_=new nullstone.Interface("ICommand")}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){function r(n,r){if(n!==e.FlowDirection.RightToLeft)return r;switch(r){case t.Key.Left:return t.Key.Right;case t.Key.Right:return t.Key.Left;default:return r}}n.GetLogicalKey=r}(n=t.InteractionHelper||(t.InteractionHelper={}))}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(){return"Microsoft Internet Explorer"===navigator.appName?new a:"Netscape"===navigator.appName?navigator.userAgent.match(/Trident\//)?new a:new l:new o}t.CreateKeyInterop=n;var r=[];r[8]=t.Key.Back,r[9]=t.Key.Tab,r[13]=t.Key.Enter,r[16]=t.Key.Shift,r[17]=t.Key.Ctrl,r[18]=t.Key.Alt,r[20]=t.Key.CapsLock,r[27]=t.Key.Escape,r[32]=t.Key.Space,r[33]=t.Key.PageUp,r[34]=t.Key.PageDown,r[35]=t.Key.End,r[36]=t.Key.Home,r[37]=t.Key.Left,r[38]=t.Key.Up,r[39]=t.Key.Right,r[40]=t.Key.Down,r[45]=t.Key.Insert,r[46]=t.Key.Delete,r[48]=t.Key.D0,r[49]=t.Key.D1,r[50]=t.Key.D2,r[51]=t.Key.D3,r[52]=t.Key.D4,r[53]=t.Key.D5,r[54]=t.Key.D6,r[55]=t.Key.D7,r[56]=t.Key.D8,r[57]=t.Key.D9,r[65]=t.Key.A,r[66]=t.Key.B,r[67]=t.Key.C,r[68]=t.Key.D,r[69]=t.Key.E,r[70]=t.Key.F,r[71]=t.Key.G,r[72]=t.Key.H,r[73]=t.Key.I,r[74]=t.Key.J,r[75]=t.Key.K,r[76]=t.Key.L,r[77]=t.Key.M,r[78]=t.Key.N,r[79]=t.Key.O,r[80]=t.Key.P,r[81]=t.Key.Q,r[82]=t.Key.R,r[83]=t.Key.S,r[84]=t.Key.T,r[85]=t.Key.U,r[86]=t.Key.V,r[87]=t.Key.W,r[88]=t.Key.X,r[89]=t.Key.Y,r[90]=t.Key.Z,r[96]=t.Key.NumPad0,r[97]=t.Key.NumPad1,r[98]=t.Key.NumPad2,r[99]=t.Key.NumPad3,r[100]=t.Key.NumPad4,r[101]=t.Key.NumPad5,r[102]=t.Key.NumPad6,r[103]=t.Key.NumPad7,r[104]=t.Key.NumPad8,r[105]=t.Key.NumPad9,r[106]=t.Key.Multiply,r[107]=t.Key.Add,r[109]=t.Key.Subtract,r[110]=t.Key.Decimal,r[111]=t.Key.Divide,r[112]=t.Key.F1,r[113]=t.Key.F2,r[114]=t.Key.F3,r[115]=t.Key.F4,r[116]=t.Key.F5,r[117]=t.Key.F6,r[118]=t.Key.F7,r[119]=t.Key.F8,r[120]=t.Key.F9,r[121]=t.Key.F10,r[122]=t.Key.F11,r[123]=t.Key.F12;var o=function(){function e(){}return e.prototype.RegisterEvents=function(e){var t=this;document.onkeypress=function(n){var r=t.CreateArgsPress(n);return r&&(e.HandleKeyDown(r),r.Handled)?(n.preventDefault(),!1):void 0},document.onkeydown=function(n){var r=t.CreateArgsDown(n);return r&&(e.HandleKeyDown(r),r.Handled)?(n.preventDefault(),!1):void 0}},e.prototype.CreateArgsPress=function(e){return void 0},e.prototype.CreateArgsDown=function(e){return void 0},e}(),i=[];i[41]=48,i[33]=49,i[64]=50,i[35]=51,i[36]=52,i[37]=53,i[94]=54,i[38]=55,i[42]=56,i[34]=t.Key.Unknown;var a=function(n){function o(){n.apply(this,arguments)}return __extends(o,n),o.prototype.CreateArgsPress=function(n){if(n["char"]){var o={Shift:n.shiftKey,Ctrl:n.ctrlKey,Alt:n.altKey},a=n.keyCode,s=i[a];s&&(a=s);var u=new e.Input.KeyEventArgs(o,a,r[a],n["char"]);if(u.Key===t.Key.Unknown&&n.key){u.Char=n.key;var l=u.Char.toUpperCase().charCodeAt(0);u.Key=r[l],null==u.Key&&(u.Key=t.Key.Unknown)}return u}},o.prototype.CreateArgsDown=function(t){if(!t["char"]||8===t.keyCode||9===t.keyCode){var n={Shift:t.shiftKey,Ctrl:t.ctrlKey,Alt:t.altKey};return new e.Input.KeyEventArgs(n,t.keyCode,r[t.keyCode])}},o}(o),s=[];s[8]=t.Key.Back,s[9]=t.Key.Tab,s[20]=t.Key.CapsLock,s[27]=t.Key.Escape,s[33]=t.Key.PageUp,s[34]=t.Key.PageDown,s[35]=t.Key.End,s[36]=t.Key.Home,s[37]=t.Key.Left,s[38]=t.Key.Up,s[39]=t.Key.Right,s[40]=t.Key.Down,s[45]=t.Key.Insert,s[46]=t.Key.Delete;var u=[];u[41]=48,u[33]=49,u[64]=50,u[35]=51,u[36]=52,u[37]=53,u[94]=54,u[38]=55,u[42]=56,u[34]=t.Key.Unknown;var l=function(n){function o(){n.apply(this,arguments)}return __extends(o,n),o.prototype.CreateArgsPress=function(n){var o={Shift:n.shiftKey,Ctrl:n.ctrlKey,Alt:n.altKey},i=n.keyCode,a=u[i];a&&(i=a);var s=new e.Input.KeyEventArgs(o,i,r[i],String.fromCharCode(n.which||n.keyCode));return"'"===s.Char&&(s.Key=t.Key.Unknown),s},o.prototype.CreateArgsDown=function(t){if(void 0===s[t.keyCode])return null;var n={Shift:t.shiftKey,Ctrl:t.ctrlKey,Alt:t.altKey};return new e.Input.KeyEventArgs(n,t.keyCode,r[t.keyCode])},o}(o)}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function n(){}return n.GetAcceptsReturn=function(e){return e.GetValue(n.AcceptsReturnProperty)},n.SetAcceptsReturn=function(e,t){e.SetValue(n.AcceptsReturnProperty,t)},n.GetControlTabNavigation=function(e){return e.GetValue(n.ControlTabNavigationProperty)},n.SetControlTabNavigation=function(e,t){e.SetValue(n.ControlTabNavigationProperty,t)},n.GetDirectionalNavigation=function(e){return e.GetValue(n.DirectionalNavigationProperty)},n.SetDirectionalNavigation=function(e,t){e.SetValue(n.DirectionalNavigationProperty,t)},n.GetIsTabStop=function(e){return e.GetValue(n.IsTabStopProperty)},n.SetIsTabStop=function(e,t){e.SetValue(n.IsTabStopProperty,t)},n.GetTabIndex=function(e){return e.GetValue(n.TabIndexProperty)},n.SetTabIndex=function(e,t){e.SetValue(n.TabIndexProperty,t)},n.GetTabNavigation=function(e){return e.GetValue(n.TabNavigationProperty)},n.SetTabNavigation=function(e,t){e.SetValue(n.TabNavigationProperty,t)},n.AcceptsReturnProperty=DependencyProperty.RegisterAttached("AcceptsReturn",function(){return Boolean},n),n.ControlTabNavigationProperty=DependencyProperty.RegisterAttached("ControlTabNavigation",function(){return new e.Enum(t.KeyboardNavigationMode)},n),n.DirectionalNavigationProperty=DependencyProperty.RegisterAttached("DirectionalNavigation",function(){return new e.Enum(t.KeyboardNavigationMode)},n),n.IsTabStopProperty=DependencyProperty.RegisterAttached("IsTabStop",function(){return Boolean},n),n.TabIndexProperty=DependencyProperty.RegisterAttached("TabIndex",function(){return Number},n),n.TabNavigationProperty=DependencyProperty.RegisterAttached("TabNavigation",function(){return new e.Enum(t.KeyboardNavigationMode)},n),n}();t.KeyboardNavigation=n,e.CoreLibrary.add(n)}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(e){t.call(this),Object.defineProperty(this,"AbsolutePos",{value:e,writable:!1})}return __extends(n,t),n.prototype.GetPosition=function(t){var n=this.AbsolutePos.Clone();if(!t)return n;if(!(t instanceof e.UIElement))throw new ArgumentException("Specified relative object must be a UIElement.");return minerva.core.Updater.transformPoint(t.XamlNode.LayoutUpdater,n),n},n}(e.RoutedEventArgs);t.MouseEventArgs=n,e.CoreLibrary.add(n);var r=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(n);t.MouseButtonEventArgs=r,e.CoreLibrary.add(r);var o=function(e){function t(t,n){e.call(this,t),Object.defineProperty(this,"Delta",{value:n,writable:!1})}return __extends(t,e),t}(n);t.MouseWheelEventArgs=o,e.CoreLibrary.add(o)}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(){return"Microsoft Internet Explorer"===navigator.appName?new a:"Netscape"===navigator.appName?navigator.userAgent.match(/Trident\//)?new a:new s:new i}function r(e){return{Shift:e.shiftKey,Ctrl:e.ctrlKey,Alt:e.altKey}}!function(e){e[e.NoOp=0]="NoOp",e[e.MouseUp=1]="MouseUp",e[e.MouseDown=2]="MouseDown",e[e.MouseLeave=3]="MouseLeave",e[e.MouseEnter=4]="MouseEnter",e[e.MouseMove=5]="MouseMove",e[e.MouseWheel=6]="MouseWheel"}(t.MouseInputType||(t.MouseInputType={}));var o=t.MouseInputType;t.CreateMouseInterop=n;var i=function(){function n(){this._CanvasOffset=null,this._IsContextMenuDisabled=!1}return n.prototype.RegisterEvents=function(e,t){var n=this;this._Input=e,this._CanvasOffset=this._CalcOffset(t),t.addEventListener("contextmenu",function(e){return n._HandleContextMenu(window.event?window.event:e)}),t.addEventListener("mousedown",function(e){return n._HandleButtonPress(window.event?window.event:e)}),t.addEventListener("mouseup",function(e){return n._HandleButtonRelease(window.event?window.event:e)}),t.addEventListener("mouseout",function(e){return n._HandleOut(window.event?window.event:e)}),t.addEventListener("mousemove",function(e){return n._HandleMove(window.event?window.event:e)}),t.addEventListener("mousewheel",function(e){return n._HandleWheel(window.event?window.event:e)}),t.addEventListener("DOMMouseScroll",function(e){return n._HandleWheel(window.event?window.event:e)})},n.prototype._CalcOffset=function(e){var t=0,n=0,r=e;if(r.offsetParent)do t+=r.offsetLeft,n+=r.offsetTop;while(r=r.offsetParent);return{left:t,top:n}},n.prototype._GetMousePosition=function(e){return new Point(e.clientX+window.pageXOffset+this._CanvasOffset.left,e.clientY+window.pageYOffset+this._CanvasOffset.top)},n.prototype.IsLeftButton=function(e){return 1===e},n.prototype.IsRightButton=function(e){return 2===e},n.prototype._HandleContextMenu=function(e){return this._IsContextMenuDisabled?(this._IsContextMenuDisabled=!1,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,!1):void 0},n.prototype._HandleButtonPress=function(n){e.Engine.Inspection.Kill(),t.Keyboard.RefreshModifiers(r(n));var o=n.which?n.which:n.button,i=this._GetMousePosition(n);this._Input.HandleMousePress(o,i)&&this.DisableNextContextMenu()},n.prototype._HandleButtonRelease=function(e){t.Keyboard.RefreshModifiers(r(e));var n=e.which?e.which:e.button,o=this._GetMousePosition(e);this._Input.HandleMouseRelease(n,o)},n.prototype._HandleOut=function(e){t.Keyboard.RefreshModifiers(r(e));var n=this._GetMousePosition(e);this._Input.HandleMouseEvent(o.MouseLeave,null,n)},n.prototype._HandleMove=function(e){t.Keyboard.RefreshModifiers(r(e));var n=this._GetMousePosition(e);this._Input.HandleMouseEvent(o.MouseMove,null,n),this._Input.UpdateCursorFromInputList()},n.prototype._HandleWheel=function(e){t.Keyboard.RefreshModifiers(r(e));var n=0;e.wheelDelta?n=e.wheelDelta/120:e.detail&&(n=-e.detail/3),e.preventDefault&&e.preventDefault(),e.returnValue=!1,this._Input.HandleMouseEvent(o.MouseWheel,null,this._GetMousePosition(e),n),this._Input.UpdateCursorFromInputList()},n.prototype.CreateEventArgs=function(t,n,r){switch(t){case o.MouseUp:return new e.Input.MouseButtonEventArgs(n);case o.MouseDown:return new e.Input.MouseButtonEventArgs(n);case o.MouseLeave:return new e.Input.MouseEventArgs(n);case o.MouseEnter:return new e.Input.MouseEventArgs(n);case o.MouseMove:return new e.Input.MouseEventArgs(n);case o.MouseWheel:return new e.Input.MouseWheelEventArgs(n,r)}},n.prototype.DisableNextContextMenu=function(){this._IsContextMenuDisabled=!0},n}(),a=function(e){function t(){e.apply(this,arguments),this.StopIEContextMenu=!1}return __extends(t,e),t.prototype.DisableNextContextMenu=function(){e.prototype.DisableNextContextMenu.call(this),this.StopIEContextMenu=!0},t.prototype.RegisterEvents=function(t,n){var r=this;e.prototype.RegisterEvents.call(this,t,n),n.oncontextmenu=function(e){return r._HandleIEContextMenu(e)}},t.prototype._HandleIEContextMenu=function(e){return this.StopIEContextMenu?(this.StopIEContextMenu=!1,!1):!0},t}(i),s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.IsRightButton=function(e){return 3===e},t}(i)}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(t){e.call(this),this.Device=t}return __extends(t,e),t.prototype.GetTouchPoint=function(e){return this.Device.GetTouchPoint(e)},t}(e.RoutedEventArgs);t.TouchEventArgs=n,e.CoreLibrary.add(n)}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){function t(){return navigator.msPointerEnabled||navigator.pointerEnabled?new e.TouchInternal.PointerTouchInterop:"ontouchstart"in window?new e.TouchInternal.NonPointerTouchInterop:new n}!function(e){e[e.NoOp=0]="NoOp",e[e.TouchDown=1]="TouchDown",e[e.TouchUp=2]="TouchUp",e[e.TouchMove=3]="TouchMove",e[e.TouchEnter=4]="TouchEnter",e[e.TouchLeave=5]="TouchLeave"}(e.TouchInputType||(e.TouchInputType={}));e.TouchInputType;e.CreateTouchInterop=t;var n=function(){function e(){}return e.prototype.Register=function(e,t){},e}()}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function e(e,t){Object.defineProperty(this,"Position",{value:e,writable:!1}),Object.defineProperty(this,"Force",{value:t,writable:!1})}return e}();t.TouchPoint=n,e.CoreLibrary.add(n)}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t,n=function(){function e(){}return e.Init=function(){t=document.createElement("input"),t.type="text";var e=t.style;e.opacity="0",e.cssFloat="left",e.width="0",e.height="0",e.borderWidth="0",document.body.insertBefore(t,document.body.firstElementChild);
},e.Launch=function(){console.log("Launch"),t.focus()},e}();e.VirtualKeyboard=n}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var TimeSpan=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];if(this._Ticks=0,0!==t.length){if(1===t.length)return void(this._Ticks=t[0]||0);var r=0,o=0,i=0,a=0,s=0;3===t.length?(o=t[0]||0,i=t[1]||0,a=t[2]||0):(r=t[0]||0,o=t[1]||0,i=t[2]||0,a=t[3]||0,s=t[4]||0),this._Ticks=r*e._TicksPerDay+o*e._TicksPerHour+i*e._TicksPerMinute+a*e._TicksPerSecond+s*e._TicksPerMillisecond}}return Object.defineProperty(e,"Zero",{get:function(){return new e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MinValue",{get:function(){return new e(Number.MIN_VALUE)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MaxValue",{get:function(){return new e(Number.MAX_VALUE)},enumerable:!0,configurable:!0}),e.FromDays=function(t){return new e(t*this._TicksPerDay)},e.FromHours=function(t){return new e(t*this._TicksPerHour)},e.FromMinutes=function(t){return new e(t*this._TicksPerMinute)},e.FromSeconds=function(t){return new e(t*this._TicksPerSecond)},e.FromMilliseconds=function(t){return new e(t*this._TicksPerMillisecond)},Object.defineProperty(e.prototype,"Days",{get:function(){return this._Ticks>0?Math.floor(this._Ticks/e._TicksPerDay):Math.ceil(this._Ticks/e._TicksPerDay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Hours",{get:function(){var t=this._Ticks%e._TicksPerDay;return t>0?Math.floor(t/e._TicksPerHour):Math.ceil(t/e._TicksPerHour)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Minutes",{get:function(){var t=this._Ticks%e._TicksPerDay;return t%=e._TicksPerHour,t>0?Math.floor(t/e._TicksPerMinute):Math.ceil(t/e._TicksPerMinute)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Seconds",{get:function(){var t=this._Ticks%e._TicksPerDay;return t%=e._TicksPerHour,t%=e._TicksPerMinute,t>0?Math.floor(t/e._TicksPerSecond):Math.ceil(t/e._TicksPerSecond)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Milliseconds",{get:function(){var t=this._Ticks%e._TicksPerDay;return t%=e._TicksPerHour,t%=e._TicksPerMinute,t%=e._TicksPerSecond,t>0?Math.floor(t/e._TicksPerMillisecond):Math.ceil(t/e._TicksPerMillisecond)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Ticks",{get:function(){return this._Ticks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalDays",{get:function(){return this._Ticks/e._TicksPerDay},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalHours",{get:function(){return this._Ticks/e._TicksPerHour},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalMinutes",{get:function(){return this._Ticks/e._TicksPerMinute},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalSeconds",{get:function(){return this._Ticks/e._TicksPerSecond},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalMilliseconds",{get:function(){return this._Ticks/e._TicksPerMillisecond},enumerable:!0,configurable:!0}),e.prototype.AddTicks=function(e){null!=e&&(isNaN(e)||(this._Ticks+=e))},e.prototype.AddMilliseconds=function(t){this.AddTicks(t*e._TicksPerMillisecond)},e.prototype.Add=function(t){var n=new e;return n._Ticks=this._Ticks+t._Ticks,n},e.prototype.Subtract=function(t){var n=new e;return n._Ticks=this._Ticks-t._Ticks,n},e.prototype.Multiply=function(t){var n=new e;return n._Ticks=Math.round(this._Ticks*t),n},e.prototype.Divide=function(t){var n=new e;return n._Ticks=this._Ticks/t._Ticks,n},e.prototype.CompareTo=function(e){return this._Ticks===e._Ticks?0:this._Ticks>e._Ticks?1:-1},e.prototype.IsZero=function(){return 0===this._Ticks},e.prototype.GetJsDelay=function(){return this._Ticks*e._TicksPerMillisecond},e.prototype.toString=function(e){return e?Fayde.Localization.FormatSingle(this,e):Fayde.Localization.FormatSingle(this,"c")},e.prototype.valueOf=function(){return this.Ticks},e._TicksPerMillisecond=1,e._TicksPerSecond=1e3,e._TicksPerMinute=60*e._TicksPerSecond,e._TicksPerHour=60*e._TicksPerMinute,e._TicksPerDay=24*e._TicksPerHour,e}();Fayde.CoreLibrary.addPrimitive(TimeSpan),nullstone.registerTypeConverter(TimeSpan,function(e){if(e instanceof TimeSpan)return e;if(e instanceof Duration){var t=e;if(t.HasTimeSpan)return new TimeSpan(t.TimeSpan.Ticks);throw new Exception("Forever")}if("number"==typeof e)return new TimeSpan(e);e=e.toString();var n=e.split(":");if(1===n.length){var r=parseFloat(e);if(!isNaN(r))return new TimeSpan(r);throw new Exception("Invalid TimeSpan format '"+e+"'.")}if(3!==n.length)throw new Exception("Invalid TimeSpan format '"+e+"'.");var o,i,a,s=0,u=0,l=n[0].split(".");return 2===l.length?(s=parseInt(l[0]),o=parseInt(l[1])):1===l.length&&(o=parseInt(l[0])),i=parseInt(n[1]),a=parseFloat(n[2]),u=a%1,a-=u,u*=1e3,new TimeSpan(s,o,i,a,u)});var DayOfWeek;!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(DayOfWeek||(DayOfWeek={})),Fayde.CoreLibrary.addEnum(DayOfWeek,"DayOfWeek");var DateTimeKind;!function(e){e[e.Unspecified=0]="Unspecified",e[e.Local=1]="Local",e[e.Utc=2]="Utc"}(DateTimeKind||(DateTimeKind={})),Fayde.CoreLibrary.addEnum(DateTimeKind,"DateTimeKind");var DateTime=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];this._InternalDate=null;var r=null,o=DateTimeKind.Unspecified,i=0,a=0,s=0,u=0,l=0,c=0,p=0;if(1===t.length){var d=t[0];r=d instanceof Date?d.getTime():t[0]}else if(2===t.length){var d=t[0];r=d instanceof Date?d.getTime():t[0],o=t[1]}else 3===t.length?(i=t[0],a=t[1],s=t[2]):6===t.length?(i=t[0],a=t[1],s=t[2],u=t[3],l=t[4],c=t[5]):7===t.length?(i=t[0],a=t[1],s=t[2],u=t[3],l=t[4],c=t[5],p=t[6]):8===t.length?(i=t[0],a=t[1],s=t[2],u=t[3],l=t[4],c=t[5],p=t[6],o=t[7]):r=0;if(this._Kind=o||DateTimeKind.Unspecified,isNaN(r)||r<e.MIN_TICKS||r>e.MAX_TICKS)throw new Error("DateTime is out of range.");if(null!=r)return void(this._InternalDate=new Date(r));var h=this._InternalDate=new Date;this._Kind===DateTimeKind.Utc?(h.setUTCFullYear(i,a-1,s),h.setUTCHours(u),h.setUTCMinutes(l),h.setUTCSeconds(c),h.setMilliseconds(p)):(h.setFullYear(i,a-1,s),h.setHours(u),h.setMinutes(l),h.setSeconds(c),h.setMilliseconds(p))}return Object.defineProperty(e,"MinValue",{get:function(){return new e(e.MIN_TICKS)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MaxValue",{get:function(){return new e(e.MAX_TICKS)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Now",{get:function(){return new e((new Date).getTime(),DateTimeKind.Local)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Today",{get:function(){return e.Now.Date},enumerable:!0,configurable:!0}),e.Compare=function(e,t){var n=e._InternalDate.getTime(),r=t._InternalDate.getTime();return r>n?-1:n>r?1:0},e.DaysInMonth=function(t,n){var r=new Date(t,n-1+1,1).getTime()-TimeSpan._TicksPerDay,o=new e(r);return o.Day},Object.defineProperty(e.prototype,"Ticks",{get:function(){return this._InternalDate.getTime()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Kind",{get:function(){return this._Kind},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Date",{get:function(){var t=this._InternalDate.getTime(),n=new Date(t);return this._Kind===DateTimeKind.Utc?(n.setUTCHours(0),n.setUTCMinutes(0),n.setUTCSeconds(0),n.setUTCMilliseconds(0)):(n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0)),new e(n.getTime(),this._Kind)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Day",{get:function(){return this._Kind===DateTimeKind.Utc?this._InternalDate.getUTCDate():this._InternalDate.getDate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DayOfWeek",{get:function(){return this._Kind===DateTimeKind.Utc?this._InternalDate.getUTCDay():this._InternalDate.getDay()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DayOfYear",{get:function(){var t=this.Date,n=new e(t.Year,1,1,0,0,0,0,this.Kind),r=new TimeSpan(t.Ticks-n.Ticks);return Math.floor(r.TotalDays)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Hour",{get:function(){return this._Kind===DateTimeKind.Utc?this._InternalDate.getUTCHours():this._InternalDate.getHours()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Millisecond",{get:function(){return this._Kind===DateTimeKind.Utc?this._InternalDate.getUTCMilliseconds():this._InternalDate.getMilliseconds()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Minute",{get:function(){return this._Kind===DateTimeKind.Utc?this._InternalDate.getUTCMinutes():this._InternalDate.getMinutes()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Month",{get:function(){return this._Kind===DateTimeKind.Utc?this._InternalDate.getUTCMonth()+1:this._InternalDate.getMonth()+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Second",{get:function(){return this._Kind===DateTimeKind.Utc?this._InternalDate.getUTCSeconds():this._InternalDate.getSeconds()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeOfDay",{get:function(){var e=this._InternalDate;return this._Kind===DateTimeKind.Utc?new TimeSpan(0,e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()):new TimeSpan(0,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Year",{get:function(){return this._Kind===DateTimeKind.Utc?this._InternalDate.getUTCFullYear():this._InternalDate.getFullYear()},enumerable:!0,configurable:!0}),e.prototype.AddYears=function(t){var n=new Date(this._InternalDate.getTime()),r=Math.floor(t);if(isNaN(r))throw new ArgumentOutOfRangeException("years");return this.Kind===DateTimeKind.Utc?n.setUTCFullYear(n.getUTCFullYear()+r):n.setFullYear(n.getFullYear()+r),new e(n,this.Kind)},e.prototype.AddMonths=function(t){var n=new Date(this._InternalDate.getTime()),r=Math.floor(t);if(isNaN(r))throw new ArgumentOutOfRangeException("months");return this.Kind===DateTimeKind.Utc?n.setUTCMonth(n.getUTCMonth()+r):n.setMonth(n.getMonth()+r),new e(n,this.Kind)},e.prototype.AddDays=function(e){return this.Add(TimeSpan.FromDays(e))},e.prototype.AddHours=function(e){return this.Add(TimeSpan.FromHours(e))},e.prototype.AddMinutes=function(e){return this.Add(TimeSpan.FromMinutes(e))},e.prototype.AddSeconds=function(e){return this.Add(TimeSpan.FromSeconds(e))},e.prototype.AddMilliseconds=function(e){return this.Add(TimeSpan.FromMilliseconds(e))},e.prototype.Add=function(t){var n=new Date(this._InternalDate.getTime());return this.Kind===DateTimeKind.Utc?(n.setUTCDate(n.getUTCDate()+t.Days),n.setUTCHours(n.getUTCHours()+t.Hours),n.setUTCMinutes(n.getUTCMinutes()+t.Minutes),n.setUTCSeconds(n.getUTCSeconds()+t.Seconds),n.setUTCMilliseconds(n.getUTCMilliseconds()+t.Milliseconds)):(n.setDate(n.getDate()+t.Days),n.setHours(n.getHours()+t.Hours),n.setMinutes(n.getMinutes()+t.Minutes),n.setSeconds(n.getSeconds()+t.Seconds),n.setMilliseconds(n.getMilliseconds()+t.Milliseconds)),new e(n,this.Kind)},e.prototype.AddTicks=function(t){return new e(this.Ticks+t,this.Kind)},e.prototype.Subtract=function(t){return t instanceof e?new TimeSpan(this.Ticks-t.Ticks):t instanceof TimeSpan?new e(this.Ticks-t.Ticks,this.Kind):new e(this.Ticks,this.Kind)},e.prototype.ToUniversalTime=function(){if(this.Kind===DateTimeKind.Utc)return new e(this.Ticks,DateTimeKind.Utc);var t=this._InternalDate;return new e(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds(),DateTimeKind.Utc)},e.prototype.toString=function(e){return e?Fayde.Localization.FormatSingle(this,e):Fayde.Localization.FormatSingle(this,"s")},e.prototype.valueOf=function(){return this.Ticks},e.MAX_TICKS=864e13,e.MIN_TICKS=-864e13,e}();Fayde.CoreLibrary.addPrimitive(DateTime),nullstone.registerTypeConverter(DateTime,function(e){if(e instanceof DateTime)return e;if(e instanceof Date)return new DateTime(e);if("string"==typeof e)return new DateTime(Date.parse(e));if("number"==typeof e)return new DateTime(e);throw new Exception("Cannot parse DateTime value '"+e+"'")});var Fayde;!function(e){var t;!function(e){var t=function(){function e(){this.ID=1,this.Eras=[1],this.EraNames=["A.D."],this.CurrentEraValue=1,this.TwoDigitYearMax=2029,this.MaxSupportedDateTime=new DateTime(9999,12,31,23,59,59,999),this.MinSupportedDateTime=new DateTime(1,1,1,0,0,0,0)}return e}();e.Calendar=t}(t=e.Localization||(e.Localization={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){!function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(e.CalendarWeekRule||(e.CalendarWeekRule={}));var t=e.CalendarWeekRule,n=function(){function n(){this.AbbreviatedDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.AbbreviatedMonthGenitiveNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],this.AbbreviatedMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.AMDesignator="AM",this.Calendar=new e.Calendar,this.CalendarWeekRule=t.FirstDay,this.DateSeparator="/",this.DayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.FirstDayOfWeek=DayOfWeek.Sunday,this.FullDateTimePattern="dddd, MMMM dd, yyyy h:mm:ss tt",this.LongDatePattern="dddd, MMMM dd, yyyy",this.LongTimePattern="h:mm:ss tt",this.MonthDayPattern="MMMM dd",this.MonthGenitiveNames=["January","February","March","April","May","June","July","August","September","October","November","December",""],this.MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],this.PMDesignator="PM",this.RFC1123Pattern="ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",this.ShortDatePattern="M/d/yyyy",this.ShortestDayNames=["Su","Mo","Tu","We","Th","Fr","Sa"],this.ShortTimePattern="h:mm tt",this.SortableDateTimePattern="yyyy'-'MM'-'dd'T'HH':'mm':'ss",this.TimeSeparator=":",this.UniversalSortableDateTimePattern="yyyy'-'MM'-'dd HH':'mm':'ss'Z'",this.YearMonthPattern="MMMM, yyyy",this.HasForceTwoDigitYears=!1}return n.prototype.GetEraName=function(e){if(0===e&&(e=this.Calendar.CurrentEraValue),0>e)throw new ArgumentException("era");var t=this.Calendar.EraNames;if(e>=t.length)throw new ArgumentException("era");return t[e]},n.ParseRepeatPattern=function(e,t,n){for(var r=e.length,o=t+1,i=n.charCodeAt(0);r>o&&e.charCodeAt(o)===i;)++o;return o-t},n.ParseNextChar=function(e,t){return t>=e.length-1?-1:e.charCodeAt(t+1)},n.ParseQuoteString=function(e,t,n){for(var r=e.length,o=t,i=e[t++],a=!1,s=String.fromCharCode(92);r>t;){var u=e[t++];if(u===i){a=!0;break}if(u===s){if(t>=r)throw new FormatException("Invalid format string.");n.push(e[t++])}else n.push(u)}if(a)return t-o;throw new FormatException("Bad quote: "+i)},n.FormatDigits=function(e,t,n,r){!r&&n>2&&(n=2);for(var o=Math.floor(t).toString();o.length<n;)o="0"+o;e.push(o)},n.FormatMonth=function(e,t,n){return 3===t?n.AbbreviatedMonthNames[e-1]:n.MonthNames[e-1]},n.FormatDayOfWeek=function(e,t,n){return 3===t?n.AbbreviatedDayNames[e]:n.DayNames[e]},n.HebrewFormatDigits=function(e,t){return console.warn("Hebrew not implemented"),t.toString()},n.FormatHebrewMonthName=function(e,t,r,o){return console.warn("Hebrew not implemented"),n.FormatMonth(t,r,o)},n.Instance=new n,n}();e.DateTimeFormatInfo=n}(t=e.Localization||(e.Localization={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){function t(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=[];return r(o,e,t),o.join("")}function n(e,t){return l(e,t)}function r(e,t,n,r){if(null==t||null==n)throw new ArgumentNullException(null==t?"format":"args");for(var s=0,u=t.length,l=0;;){var c=!1,p=0,d=!1;do{if(u>s){if(l=t.charCodeAt(s),++s,125===l){if(!(u>s&&125===t.charCodeAt(s)))throw a();++s}if(123!==l){e.push(String.fromCharCode(l)),d=!0;break}if(!(s>=u||123!==t.charCodeAt(s))){d=!0,++s;break}--s}if(s==u)return;var h=s+1;if(h===u||(l=t.charCodeAt(h))<48||l>57)throw a();var y=0;do{if(y=10*y+l-48,++h,h==u)throw a();l=t.charCodeAt(h)}while(l>=48&&57>=l&&1e6>y);if(y>=n.length)throw new FormatException("Index out of range.");for(;u>h&&32===(l=t.charCodeAt(h));)++h;c=!1;var f=0;if(44===l){for(++h;u>h&&32===t.charCodeAt(h);)++h;if(h==u)throw a();if(l=t.charCodeAt(h),45===l){if(c=!0,++h,h==u)throw a();l=t.charCodeAt(h)}if(48>l||l>57)throw a();do{if(f=10*f+l-48,++h,h==u)throw a();l=t.charCodeAt(h)}while(l>=48&&57>=l&&1e6>f)}for(;u>h&&32===(l=t.charCodeAt(h));)++h;var m=n[y],v=null;if(58===l){for(var g=h+1;;){if(g===u)throw a();if(l=t.charCodeAt(g),++g,123===l){if(!(u>g&&123===t.charCodeAt(g)))throw a();++g}else if(125===l){if(!(u>g&&125===t.charCodeAt(g)))break;++g}v=v||[],v.push(String.fromCharCode(l))}h=g-1}if(125!==l)throw a();s=h+1;var C=o(m,v,r)||"";p=f-C.length,!c&&p>0&&i(e," ",p),e.push(C)}while(!c||0>=p);d||i(e," ",p)}}function o(e,t,n){var r=null,o=null;if(null==o){null==r&&null!=t&&(r=s(t));var i=null==r?null==e?"":e.toString():l(e,r,n);void 0!==i&&(o=i)}return o}function i(e,t,n){for(var r=n-1;r>=0;r--)e.push(t)}function a(){return new FormatException("Invalid format string.")}function s(e){return e.join("")}function u(e,t){c[e]=t}function l(e,t,n){if(null==e)return void 0;var r=e.constructor,o=c[r];return o?o(e,t,n):void 0}e.Format=t,e.FormatSingle=n;var c=[];e.RegisterFormattable=u}(t=e.Localization||(e.Localization={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){function t(e,t){if(1!==t.length)return void 0;var n=t[0];if(!n)return void 0;var r=s[n];return r?r(e):void 0}function n(e){return 10>e?"0"+e.toString():e.toString()}function r(t,n,s){for(var u,l=e.DateTimeFormatInfo.Instance,c=l.Calendar,p=[],d=8===c.ID,h=!0,y=0;y<n.length;){var f=n[y];switch(f){case"m":u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f),e.DateTimeFormatInfo.FormatDigits(p,t.Minute,u);break;case"s":u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f),e.DateTimeFormatInfo.FormatDigits(p,t.Second,u);break;case"t":if(u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f),1===u){if(t.Hour<12){if(l.AMDesignator.length>=1){p.push(l.AMDesignator[0]);break}break}if(l.PMDesignator.length>=1){p.push(l.PMDesignator[0]);break}break}p.push(t.Hour<12?l.AMDesignator:l.PMDesignator);break;case"y":var m=t.Year;u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f),l.HasForceTwoDigitYears?e.DateTimeFormatInfo.FormatDigits(p,m,2>=u?u:2):8===c.ID?e.DateTimeFormatInfo.HebrewFormatDigits(p,m):2>=u?e.DateTimeFormatInfo.FormatDigits(p,m%100,u):p.push(e.FormatSingle(m,"D"+u.toString())),h=!1;break;case"z":u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f),console.warn("DateTime 'z' not implemented");break;case"K":u=1,console.warn("DateTime 'K' not implemented");break;case"M":u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f);var v=t.Month;2>=u?d?e.DateTimeFormatInfo.HebrewFormatDigits(p,v):e.DateTimeFormatInfo.FormatDigits(p,v,u):d?p.push(e.DateTimeFormatInfo.FormatHebrewMonthName(t,v,u,l)):p.push(e.DateTimeFormatInfo.FormatMonth(v,u,l)),h=!1;break;case"\\":var g=e.DateTimeFormatInfo.ParseNextChar(n,y);if(0>g)throw a();p.push(String.fromCharCode(g)),u=2;break;case"d":if(u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f),2>=u){var C=t.Day;d?e.DateTimeFormatInfo.HebrewFormatDigits(p,C):e.DateTimeFormatInfo.FormatDigits(p,C,u)}else{var P=t.DayOfWeek;p.push(e.DateTimeFormatInfo.FormatDayOfWeek(P,u,l))}h=!1;break;case"f":if(u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f),u>7)throw a();p.push(o(t.Millisecond,u));break;case"F":if(u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f),u>7)throw a();p.push(i(t.Millisecond,u));break;case"g":u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f),p.push(l.GetEraName(1));break;case"h":u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f);var S=t.Hour%12;0===S&&(S=12),e.DateTimeFormatInfo.FormatDigits(p,S,u);break;case"/":p.push(l.DateSeparator),u=1;break;case":":p.push(l.TimeSeparator),u=1;break;case"H":u=e.DateTimeFormatInfo.ParseRepeatPattern(n,y,f),e.DateTimeFormatInfo.FormatDigits(p,t.Hour,u);break;case'"':case"'":u=e.DateTimeFormatInfo.ParseQuoteString(n,y,p);break;case"%":var I=e.DateTimeFormatInfo.ParseNextChar(n,y);if(0>I||37===I)throw a();p.push(r(t,String.fromCharCode(I),s)),u=2;break;default:p.push(f),u=1}y+=u}return p.join("")}function o(e,t){for(var n=Math.abs(e).toString();n.length<3;)n="0"+n;return n+="0000",n.substr(0,t)}function i(e,t){for(var n=o(e,t),r=n.length-1;r>=0&&"0"===n[r];r--);return n.slice(0,r+1)}function a(){return new FormatException("Invalid format string.")}e.RegisterFormattable(DateTime,function(e,n,o){if(!n)return void 0;if(null==e)return null;if(e.constructor!==DateTime)return null;var i=t(e,n);return void 0!=i?i:r(e,n,TimeSpan.MinValue)});var s=[];s.d=function(e){return[e.Month.toString(),e.Day.toString(),e.Year.toString()].join("/")},s.D=function(t){var n=e.DateTimeFormatInfo.Instance;return[n.DayNames[t.DayOfWeek],", ",n.MonthNames[t.Month-1]," ",t.Day.toString(),", ",t.Year.toString()].join("")},s.f=function(e){return[s.D(e),s.t(e)].join(" ")},s.F=function(e){return[s.D(e),s.T(e)].join(" ")},s.g=function(e){return[s.d(e),s.t(e)].join(" ")},s.G=function(e){return[s.d(e),s.T(e)].join(" ")},s.m=s.M=function(t){var n=e.DateTimeFormatInfo.Instance;return[n.MonthNames[t.Month-1],t.Day].join(" ")},s.r=s.R=function(t){var n=t.ToUniversalTime(),r=e.DateTimeFormatInfo.Instance;return[r.AbbreviatedDayNames[n.DayOfWeek],", ",n.Day," ",r.AbbreviatedMonthNames[n.Month-1]," ",n.Year," ",n.Hour,":",n.Minute,":",n.Second," GMT"].join("")},s.s=function(e){return[e.Year,"-",n(e.Month),"-",n(e.Day),"T",n(e.Hour),":",n(e.Minute),":",n(e.Second)].join("")},s.t=function(t){var n=e.DateTimeFormatInfo.Instance,r=t.Hour,o=n.AMDesignator;return r>12&&(r-=12,o=n.PMDesignator),[r.toString(),":",t.Minute.toString()," ",o].join("")},s.T=function(t){var n=e.DateTimeFormatInfo.Instance,r=t.Hour,o=n.AMDesignator;return r>12&&(r-=12,o=n.PMDesignator),[r.toString(),":",t.Minute.toString(),":",t.Second.toString()," ",o].join("")},s.u=function(e){return[e.Year.toString(),"-",n(e.Month),"-",n(e.Day)," ",n(e.Hour),":",n(e.Minute),":",n(e.Second),"Z"].join("")},s.U=function(t){var n=e.DateTimeFormatInfo.Instance,r=t.Hour,o=n.AMDesignator;return r>12&&(r-=12,o=n.PMDesignator),[n.DayNames[t.DayOfWeek],", ",n.MonthNames[t.Month-1]," ",t.Day.toString(),", ",t.Year.toString()," ",r.toString(),":",t.Minute.toString(),":",t.Second.toString()," ",o].join("")},s.y=s.Y=function(t){var n=e.DateTimeFormatInfo.Instance;return[n.MonthNames[t.Month-1],t.Year].join(", ")}}(t=e.Localization||(e.Localization={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){function t(e,t){if(e.length<4)return e;var n=e.length%3;return 0!==n&&(n=3-n,e=new Array(n+1).join("0")+e),e.match(/\d\d\d/g).join(t).substr(n)}function n(e,t,n){return e?e.length>t?n?e:e.substr(0,t):n?new Array(t-e.length+1).join("0")+e:e+new Array(t-e.length+1).join("0"):new Array(t+1).join("0")}function r(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function o(e,t){var n=e.toString(),o=n.indexOf(".");return o>-1?r(e,t-o):r(e,t-n.length)}var i=function(){function e(){this.CurrencyDecimalDigits=2,this.CurrencyDecimalSeparator=".",this.CurrencyGroupSeparator=",",this.CurrencyGroupSizes=[3],this.CurrencyNegativePattern=0,this.CurrencyPositivePattern=0,this.CurrencySymbol="$",this.NaNSymbol="NaN",this.NegativeInfinitySymbol="-Infinity",this.PositiveInfinitySymbol="Infinity",this.NegativeSign="-",this.PositiveSign="+",this.NumberDecimalDigits=2,this.NumberDecimalSeparator=".",this.NumberGroupSeparator=",",this.NumberGroupSizes=[3],this.NumberNegativePattern=1,this.PercentDecimalDigits=2,this.PercentDecimalSeparator=".",this.PercentGroupSeparator=",",this.PercentGroupSizes=[3],this.PercentNegativePattern=0,this.PercentPositivePattern=0,this.PercentSymbol="%",this.PerMilleSymbol="‰"}return e.prototype.FormatCurrency=function(e,t){null==t&&(t=this.CurrencyDecimalDigits);var n=this.FormatRawNumber(Math.abs(e),t,this.CurrencyDecimalSeparator,this.CurrencyGroupSeparator,this.CurrencyGroupSizes);if(0>e)switch(this.CurrencyNegativePattern){case 0:default:return"("+this.CurrencySymbol+n+")";case 1:return[this.NegativeSign,this.CurrencySymbol,n].join("");case 2:return[this.CurrencySymbol,this.NegativeSign,n].join("");case 3:return[this.CurrencySymbol,n,this.NegativeSign].join("");case 4:return"("+n+this.CurrencySymbol+")";case 5:return[this.NegativeSign,n,this.CurrencySymbol].join("");case 6:return[n,this.NegativeSign,this.CurrencySymbol].join("");case 7:return[n,this.CurrencySymbol,this.NegativeSign].join("");case 8:return[this.NegativeSign,n," ",this.CurrencySymbol].join("");case 9:return[this.NegativeSign,this.CurrencySymbol," ",n].join("");case 10:return[n," ",this.CurrencySymbol,this.NegativeSign].join("");case 11:return[this.CurrencySymbol," ",n,this.NegativeSign].join("");case 12:return[this.CurrencySymbol," ",this.NegativeSign,n].join("");case 13:return[n,this.NegativeSign," ",this.CurrencySymbol].join("");case 14:return"("+this.CurrencySymbol+" "+n+")";case 15:return"("+n+" "+this.CurrencySymbol+")"}else switch(this.CurrencyPositivePattern){case 0:default:return[this.CurrencySymbol,n].join("");case 1:return[n,this.CurrencySymbol].join("");case 2:return[this.CurrencySymbol,n].join(" ");case 3:return[n,this.CurrencySymbol].join(" ")}},e.prototype.FormatNumber=function(e,t,n){null==t&&(t=this.NumberDecimalDigits);var r=this.FormatRawNumber(Math.abs(e),t,this.NumberDecimalSeparator,n?"":this.NumberGroupSeparator,this.NumberGroupSizes);if(e>=0)return r;switch(this.NumberNegativePattern){case 0:return"("+r+")";case 1:default:return[this.NegativeSign,r].join("");case 2:return[this.NegativeSign,r].join(" ");case 3:return[r,this.NegativeSign].join("");case 4:return[r,this.NegativeSign].join(" ")}},e.prototype.FormatPercent=function(e,t){null==t&&(t=this.PercentDecimalDigits);var n=this.FormatRawNumber(Math.abs(100*e),t,this.PercentDecimalSeparator,this.PercentGroupSeparator,this.PercentGroupSizes),r=this.PercentSymbol;if(0>e){var o=this.NegativeSign;switch(this.PercentNegativePattern){case 0:default:return[o,n," ",r].join("");case 1:return[o,n,r].join("");case 2:return[o,r,n].join("");case 3:return[r,o,n].join("");case 4:return[r,n,o].join("");case 5:return[n,o,r].join("");case 6:return[n,r,o].join("");case 7:return[o,r," ",n].join("");case 8:return[o,r," ",n].join("");case 9:return[r," ",n,o].join("");case 10:return[r," ",o,n].join("");case 11:return[n,o," ",r].join("")}}else switch(this.PercentPositivePattern){case 0:default:return[n,this.PercentSymbol].join(" ");case 1:return[n,this.PercentSymbol].join("");case 2:return[this.PercentSymbol,n].join("");case 3:return[this.PercentSymbol,n].join(" ")}},e.prototype.FormatGeneral=function(e,t){null==t&&(t=6);var n=o(Math.abs(e),t),r=n.toString();return e>=0?r:this.NegativeSign+r},e.prototype.FormatDecimal=function(e,t){var r=this.FormatRawNumber(Math.abs(e),0,"","",null),o=n(r,t||0,!0);return 0>e&&(o=this.NegativeSign+o),o},e.prototype.FormatExponential=function(e,t){null==t&&(t=6);var r=e.toExponential(t),o=r.split("e+");return o[0]+"e"+this.PositiveSign+n(o[1],3,!0)},e.prototype.FormatHexadecimal=function(e,t){if(null==t&&(t=2),e=parseInt(e),e>=0)return n(e.toString(16),t,!0);var r=(Math.pow(2,32)+e).toString(16);if(t>=r.length)return n(r,t,!0);for(var o=0;r.length-o>t&&"f"===r[o];)o++;return r.substr(o)},e.prototype.FormatRawNumber=function(e,o,i,a,s){var u=r(e,o),l=Math.floor(u).toString(),c=u.toString().split(".")[1],p=n(c,o);return p?[t(l,a),p].join(i):t(l,a)},e.Instance=new e,e}();e.NumberFormatInfo=i}(t=e.Localization||(e.Localization={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){function t(e,t){var r=t[0];if(!r)return void 0;var o=r.toLowerCase();if("a">o||o>"z")return void 0;var i=null;if(t.length>1){var i=parseInt(t.substr(1));if(isNaN(i))return void 0}var a=n[r]||n[o];return a?a(e,i):void 0}e.RegisterFormattable(Number,function(e,n,r){if(null==e)return null;if(e.constructor!==Number)return null;var o=t(e,n);return void 0!=o?o:n});var n=[];n.c=function(t,n){return e.NumberFormatInfo.Instance.FormatCurrency(t,n)},n.d=function(t,n){return e.NumberFormatInfo.Instance.FormatDecimal(t,n)},n.E=function(t,n){return e.NumberFormatInfo.Instance.FormatExponential(t,n).toUpperCase()},n.e=function(t,n){return e.NumberFormatInfo.Instance.FormatExponential(t,n)},n.f=function(t,n){return e.NumberFormatInfo.Instance.FormatNumber(t,n,!0)},n.g=function(t,n){return e.NumberFormatInfo.Instance.FormatGeneral(t,n)},n.n=function(t,n){return e.NumberFormatInfo.Instance.FormatNumber(t,n)},n.p=function(t,n){return e.NumberFormatInfo.Instance.FormatPercent(t,n)},n.X=function(t,n){return e.NumberFormatInfo.Instance.FormatHexadecimal(t,n).toUpperCase()},n.x=function(t,n){return e.NumberFormatInfo.Instance.FormatHexadecimal(t,n)}}(t=e.Localization||(e.Localization={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){function t(e,t){if(1!==t.length)return void 0;var n=t[0];if(!n)return void 0;var r=s[n];return r?r(e):void 0}function n(t,r){for(var s,u=Math.abs(t.Days),l=Math.abs(t.Hours),c=Math.abs(t.Minutes),p=Math.abs(t.Seconds),d=Math.abs(t.Milliseconds),h=0,y=[];h<r.length;){var f=r[h];switch(f){case"m":if(s=e.DateTimeFormatInfo.ParseRepeatPattern(r,h,f),s>2)throw a();e.DateTimeFormatInfo.FormatDigits(y,c,s);break;case"s":if(s=e.DateTimeFormatInfo.ParseRepeatPattern(r,h,f),s>2)throw a();e.DateTimeFormatInfo.FormatDigits(y,p,s);break;case"\\":var m=e.DateTimeFormatInfo.ParseNextChar(r,h);if(0>m)throw a();y.push(String.fromCharCode(m)),s=2;break;case"d":if(s=e.DateTimeFormatInfo.ParseRepeatPattern(r,h,f),s>8)throw a();e.DateTimeFormatInfo.FormatDigits(y,u,s,!0);break;case"f":if(s=e.DateTimeFormatInfo.ParseRepeatPattern(r,h,f),s>7)throw a();y.push(o(d,s));break;case"F":if(s=e.DateTimeFormatInfo.ParseRepeatPattern(r,h,f),s>7)throw a();y.push(i(d,s));break;case"h":if(s=e.DateTimeFormatInfo.ParseRepeatPattern(r,h,f),s>2)throw a();e.DateTimeFormatInfo.FormatDigits(y,l,s);break;case'"':case"'":s=e.DateTimeFormatInfo.ParseQuoteString(r,h,y);break;case"%":var v=e.DateTimeFormatInfo.ParseNextChar(r,h);if(0>v||37===v)throw a();y.push(n(t,String.fromCharCode(v))),s=2;break;default:throw a()}h+=s}return y.join("")}function r(e){var t=Math.abs(e).toString();return 1===t.length?"0"+t:t}function o(e,t){for(var n=Math.abs(e).toString();n.length<3;)n="0"+n;return n+="0000",n.substr(0,t)}function i(e,t){for(var n=o(e,t),r=n.length-1;r>=0&&"0"===n[r];r--);return n.slice(0,r+1)}function a(){return new FormatException("Invalid format string.")}e.RegisterFormattable(TimeSpan,function(e,r,o){if(!r)return void 0;if(null==e)return null;if(e.constructor!==TimeSpan)return null;var i=t(e,r);return void 0!=i?i:n(e,r)});var s=[];s.c=s.t=s.T=function(t){var n=e.DateTimeFormatInfo.Instance,i=[r(t.Hours),r(t.Minutes),r(t.Seconds)].join(n.TimeSeparator),a=t.Days;a&&(i=Math.abs(a)+"."+i);var s=t.Milliseconds;return s&&(i+="."+o(s,7)),t.Ticks<0&&(i="-"+i),i},s.g=function(t){var n=e.DateTimeFormatInfo.Instance,o=[Math.abs(t.Hours),r(t.Minutes),r(t.Seconds)].join(n.TimeSeparator),a=t.Days;a&&(o=Math.abs(a)+":"+o);var s=t.Milliseconds;return s&&(o+="."+i(s,7)),t.Ticks<0&&(o="-"+o),o},s.G=function(t){var n=e.DateTimeFormatInfo.Instance,i=[Math.abs(t.Days),r(t.Hours),r(t.Minutes),r(t.Seconds)].join(n.TimeSeparator),a=t.Milliseconds;return i+="."+o(a,7),t.Ticks<0&&(i="-"+i),i}}(t=e.Localization||(e.Localization={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){function t(e){var t=n(e),i=[],a=[],s={Notify:function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];for(var n=0;n<e.length;n++){var r=e[n];"string"==typeof r?i.push(r):Array.isArray(r)&&(i=i.concat(r))}return s},Validate:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=a[e];return r?a[e]=r.concat(t):a[e]=t,
s},Finish:function(){for(var e=0,n=r(i),s=n.length;s>e;e++){var u=n[e];o(t,u,a[u])}return t}};return s}function n(e){return"function"==typeof e?e.prototype:e}function r(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];t.indexOf(r)>-1||t.push(r)}return t}function o(e,t,n){var r=e[t],o="_$"+t+"$_";e[o]=r,n&&n.length>0?Object.defineProperty(e,t,{get:function(){return this[o]},set:function(e){this[o]=e,i(this,e,t,n),this.OnPropertyChanged(t)}}):Object.defineProperty(e,t,{get:function(){return this[o]},set:function(e){this[o]=e,this.OnPropertyChanged(t)}})}function i(e,t,n,r){var o=a(e,t,n,r);if(e.ClearErrors&&e.ClearErrors(n),e.AddError)for(var i=0;i<o.length;i++)e.AddError(n,o[i])}function a(e,t,n,r){for(var o=[],i=0;i<r.length;i++){var a=r[i],s=a(t,n,e);s&&(o=o.concat(s))}return o}e.AutoModel=t}(t=e.MVVM||(e.MVVM={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,t){for(var n=t.length,r=0;n>r;r++)!function(){var n=t[r],o="$"+n+"$";Object.defineProperty(e.prototype,n,{get:function(){return this[o]},set:function(e){this[o]=e,this.OnPropertyChanged(n)}})}()}t.NotifyProperties=n;var r=function(){function t(){this.PropertyChanged=new nullstone.Event}return t.prototype.OnPropertyChanged=function(t){this.PropertyChanged.raise(this,new e.PropertyChangedEventArgs(t))},t}();t.ObservableObject=r,e.CoreLibrary.add(r)}(t=e.MVVM||(e.MVVM={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t.ObservableObject);t.ViewModelBase=n,e.CoreLibrary.add(n)}(t=e.MVVM||(e.MVVM={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t=function(t){function n(n){var r=this;t.call(this),this.IsOpen=!1,this.OverlayDataContext=null,this.RequestOpenCommand=new e.RelayCommand(function(e){return r.RequestOpen_Execute(e)},function(e){return r.RequestOpen_CanExecute(e)}),this.ClosedCommand=new e.RelayCommand(function(e){return r.Closed_Execute(e)}),n&&(this.AcceptAction=n.AcceptAction,this.CompleteAction=n.CompleteAction,this.ViewModelBuilder=n.ViewModelBuilder,this.CanOpen=n.CanOpen)}return __extends(n,t),n.prototype.Closed_Execute=function(e){e.Result===!0&&this.AcceptAction&&this.AcceptAction(e.Data||void 0),this.CompleteAction&&this.CompleteAction(e)},n.prototype.RequestOpen_Execute=function(e){if(null!=this.ViewModelBuilder){var t=this.ViewModelBuilder(e);if(null==t)return;this.OverlayDataContext=t}this.IsOpen=!0},n.prototype.RequestOpen_CanExecute=function(e){return!this.CanOpen||this.CanOpen(e)},n}(e.ViewModelBase);e.DialogViewModel=t,e.NotifyProperties(t,["IsOpen","OverlayDataContext","RequestOpenCommand","ClosedCommand"])}(t=e.MVVM||(e.MVVM={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function t(){this.PropertyChanged=new nullstone.Event,this._Errors={},this.ErrorsChanged=new nullstone.Event}return t.prototype.OnPropertyChanged=function(t){this.PropertyChanged.raise(this,new e.PropertyChangedEventArgs(t))},Object.defineProperty(t.prototype,"HasErrors",{get:function(){return Object.keys(this._Errors).length>0},enumerable:!0,configurable:!0}),t.prototype.AddError=function(t,n){var r=this._Errors[t];r?r.push(n):this._Errors[t]=[n],this.ErrorsChanged.raise(this,new e.Data.DataErrorsChangedEventArgs(t))},t.prototype.RemoveError=function(t,n){var r=this._Errors[t];if(r){var o=r.indexOf(n);o>=0&&r.splice(o,1),r.length<1&&delete this._Errors[t],this.ErrorsChanged.raise(this,new e.Data.DataErrorsChangedEventArgs(t))}},t.prototype.ClearErrors=function(t){var n=this._Errors[t];n&&(delete this._Errors[t],this.ErrorsChanged.raise(this,new e.Data.DataErrorsChangedEventArgs(t)))},t.prototype.GetErrors=function(e){var t=this._Errors[e];return t?nullstone.IEnumerable_.fromArray(t):null},t.ApplyTo=function(n){var r=n,o=t.prototype;return Object.defineProperties(r,{_Errors:{value:{}},HasErrors:{get:function(){return Object.keys(this._Errors).length>0}}}),r.PropertyChanged=new nullstone.Event,r.OnPropertyChanged=o.OnPropertyChanged.bind(r),r.ErrorsChanged=new nullstone.Event,r.AddError=o.AddError.bind(r),r.RemoveError=o.RemoveError.bind(r),r.ClearErrors=o.ClearErrors.bind(r),r.GetErrors=o.GetErrors.bind(r),e.Data.INotifyDataErrorInfo_.mark(r),r},t}();t.Entity=n,e.Data.INotifyDataErrorInfo_.mark(n)}(t=e.MVVM||(e.MVVM={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function e(e,t,n){this.View=e,this.HashParams=t,this.DataContext=n}return e}();t.Route=n,e.CoreLibrary.add(n)}(t=e.Navigation||(e.Navigation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){e.IViewModelProvider_=new nullstone.Interface("IViewModelProvider"),e.IViewModelProvider_.is=function(e){return e&&"function"==typeof e.ResolveViewModel}}(t=e.MVVM||(e.MVVM={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function e(e,t){this.CanExecuteChanged=new nullstone.Event,e&&(this.Execute=e),t&&(this.CanExecute=t)}return e.prototype.Execute=function(e){},e.prototype.CanExecute=function(e){return!0},e.prototype.ForceCanExecuteChanged=function(){this.CanExecuteChanged.raise(this,null)},e}();t.RelayCommand=n,e.CoreLibrary.add(n),nullstone.addTypeInterfaces(n,e.Input.ICommand_)}(t=e.MVVM||(e.MVVM={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){t.IEventFilter_=new nullstone.Interface("IEventFilter");var n=function(){function t(){this.CommandPath=null,this.Command=null,this.CommandParameter=null,this.CommandBinding=null,this.CommandParameterBinding=null,this.Filter=null}return t.prototype.init=function(e){this.CommandPath=e},t.prototype.transmute=function(t){return this.$$coerce(),Object.freeze(this),new e.EventBindingExpression(this)},t.prototype.$$coerce=function(){this.Command&&(this.CommandBinding=this.Command.ParentBinding.Clone(),this.Command=null),this.CommandPath&&(this.CommandBinding=new e.Data.Binding(this.CommandPath)),this.CommandParameter&&(this.CommandParameterBinding=this.CommandParameter.ParentBinding.Clone(),this.CommandParameter=null)},t}();t.EventBinding=n,e.CoreLibrary.add(n)}(t=e.Markup||(e.Markup={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(t){return nullstone.async.create(function(n,i){r.create(t).loadAsync().then(function(t){var r=o.create();return nullstone.async.many([t.resolve(e.TypeManager,r.collect),r.resolve()]).then(function(){return n(t)},i)},i)})}var r=nullstone.markup.xaml.XamlMarkup;t.Resolve=n;var o;!function(t){function r(){var t=[];return{collect:function(n,r,o,i){n===e.XMLNS&&"ResourceDictionary"===r&&"Source"===o&&t.push(i)},resolve:function(){return nullstone.async.many(t.map(n))}}}t.create=r}(o||(o={}))}(t=e.Markup||(e.Markup={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function t(){}return t.prototype.init=function(e){this.ResourceKey=e},t.prototype.transmute=function(t){var n=this.$$resources;this.$$resources=void 0;for(var r,o=this.ResourceKey,i=t.length-1;i>=0;i--){var a=t[i];a instanceof e.FrameworkElement?(r=a.ReadLocalValue(e.FrameworkElement.ResourcesProperty),r===DependencyProperty.UnsetValue&&(r=void 0)):a instanceof e.Application?r=a.Resources:a instanceof e.ResourceDictionary&&(r=a);var s=r?r.Get(o):void 0;if(void 0!==s)return s}for(var i=n?n.length-1:-1;i>=0;i--){var s=n[i].Get(o);if(void 0!==s)return s}if(this.$$app){var r=this.$$app.Resources;if(r){var s=r.Get(o);if(void 0!==s)return s}}throw new Error("Could not resolve StaticResource: '"+o+"'.")},t.prototype.setContext=function(e,t){this.$$app=e,this.$$resources=t},t}();t.StaticResource=n,e.CoreLibrary.add(n)}(t=e.Markup||(e.Markup={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this._CachedBounds=null,this._CachedBrush=null,e.XamlNode.SetShareable(this.XamlNode)}return __extends(r,n),r.prototype.isTransparent=function(){return!1},r.prototype.setupBrush=function(e,t){if(!(this._CachedBrush&&this._CachedBounds&&minerva.Rect.isEqual(this._CachedBounds,t))){this._CachedBounds=new minerva.Rect(t.x,t.y,t.width,t.height);var n=this.Transform;if(n){var r=n.TransformBounds(t),o=n.Value._Raw,i=this.CreateBrush(e,t),a=new minerva.Rect;minerva.Rect.copyTo(t,a),minerva.Rect.grow(a,o[4],o[5],0,0);var s=document.createElement("canvas");s.width=Math.max(r.width,t.width),s.height=Math.max(r.height,t.height);var u=s.getContext("2d");u.setTransform(o[0],o[1],o[2],o[3],o[4],o[5]),u.fillStyle=i,u.fillRect(a.x,a.y,a.width,a.height),this._CachedBrush=e.createPattern(s,"no-repeat")}else this._CachedBrush=this.CreateBrush(e,t)}},r.prototype.toHtml5Object=function(){return this._CachedBrush},r.prototype.CreateBrush=function(e,t){return void 0},r.prototype.InvalidateBrush=function(){this._CachedBrush=null,this._CachedBounds=null,e.Incite(this)},r.TransformProperty=DependencyProperty.RegisterCore("Transform",function(){return t.Transform},r),r}(e.DependencyObject);t.Brush=n,e.CoreLibrary.add(n);var r;!function(t){e.DPReaction(n.TransformProperty,function(e,t,n){return e.InvalidateBrush()})}(r||(r={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){n.call(this),this._Path=null,this._LocalBounds=new minerva.Rect,this._LocalBounds.width=Number.NEGATIVE_INFINITY,this._LocalBounds.height=Number.NEGATIVE_INFINITY}return __extends(r,n),r.prototype.GetBounds=function(e){var t=minerva.Rect.isEmpty(this._LocalBounds);this._Path||(this._Path=this._Build(),t=!0),t&&minerva.Rect.copyTo(this.ComputePathBounds(e),this._LocalBounds);var n=new minerva.Rect;minerva.Rect.copyTo(this._LocalBounds,n);var r=this.Transform;return null!=r&&(n=r.TransformBounds(n)),n},r.prototype.Draw=function(e){if(this._Path){var t=e.raw,n=this.Transform;null!=n&&(t.save(),e.apply(n.Value._Raw)),this._Path.draw(t),null!=n&&t.restore()}},r.prototype.ComputePathBounds=function(e){return this._Path||(this._Path=this._Build()),this._Path?this._Path.calcBounds(e):new minerva.Rect},r.prototype.InvalidateGeometry=function(){this._Path=null;var t=this._LocalBounds;t.x=t.y=0,t.width=t.height=Number.NEGATIVE_INFINITY,e.Incite(this)},r.prototype._Build=function(){return void 0},r.prototype.Serialize=function(){var e=this._Path;if(e)return e.Serialize()},r.TransformProperty=DependencyProperty.Register("Transform",function(){return t.Transform},r),r}(e.DependencyObject);t.Geometry=n,e.CoreLibrary.add(n);var r;!function(t){e.DPReaction(n.TransformProperty,function(e,t,n){return e.InvalidateGeometry()})}(r||(r={}));var o=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.AddingToCollection=function(n,r){var o=this;return t.prototype.AddingToCollection.call(this,n,r)?(e.ReactTo(n,this,function(){return e.Incite(o)}),e.Incite(this),!0):!1},n.prototype.RemovedFromCollection=function(n,r){t.prototype.RemovedFromCollection.call(this,n,r),e.UnreactTo(n,this),e.Incite(this)},n}(e.XamlObjectCollection);t.GeometryCollection=o,e.CoreLibrary.add(o)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._Build=function(){var e=this.RadiusX,t=this.RadiusY,n=this.Center,r=n?n.x:0,o=n?n.y:0,i=new minerva.path.Path;return i.ellipse(r-e,o-t,2*e,2*t),i},t.CenterProperty=DependencyProperty.Register("Center",function(){return Point},t,void 0,function(e,t){return e.InvalidateGeometry()}),t.RadiusXProperty=DependencyProperty.Register("RadiusX",function(){return Number},t,0,function(e,t){return e.InvalidateGeometry()}),t.RadiusYProperty=DependencyProperty.Register("RadiusY",function(){return Number},t,0,function(e,t){return e.InvalidateGeometry()}),t}(t.Geometry);t.EllipseGeometry=n,e.CoreLibrary.add(n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Transform=function(e){return new Point(e.x,e.y)},t.prototype.TransformBounds=function(e){return e},t.prototype.TryTransform=function(e,t){return!1},t}(e.DependencyObject);t.GeneralTransform=n,e.CoreLibrary.add(n);var r=function(e){function n(t){e.call(this),this._Raw=t}return __extends(n,e),Object.defineProperty(n.prototype,"Inverse",{get:function(){return new n(mat4.inverse(this._Raw,mat4.create()))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Value",{get:function(){return t.Matrix3D.FromRaw(this._Raw)},enumerable:!0,configurable:!0}),n.prototype.getRaw=function(){return this._Raw},n.prototype.Transform=function(e){var t=vec4.create(e.x,e.y,0,1),n=vec4.create(0,0,0,0);if(mat4.transformVec4(this._Raw,t,n),0!==n[3]){var r=1/n[3];return new Point(n[0]*r,n[1]*r)}return new Point(NaN,NaN)},n.prototype.TransformBounds=function(e){if(!e)return void 0;var t=new minerva.Rect;return minerva.Rect.copyTo(e,t),minerva.Rect.transform4(t,this._Raw),t},n.prototype.CreateMatrix3DProjection=function(){var e=new t.Matrix3DProjection;return e.ProjectionMatrix=this.Inverse.Value,e},n}(n);t.InternalTransform=r,e.CoreLibrary.add(r)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){!function(e){e[e.None=0]="None",e[e.Empty=1]="Empty",e[e.Normal=2]="Normal",e[e.Degenerate=4]="Degenerate",e[e.Radii=8]="Radii"}(t.ShapeFlags||(t.ShapeFlags={}));t.ShapeFlags;!function(e){e[e.Flat=0]="Flat",e[e.Square=1]="Square",e[e.Round=2]="Round",e[e.Triangle=3]="Triangle"}(t.PenLineCap||(t.PenLineCap={}));var n=t.PenLineCap;e.CoreLibrary.addEnum(n,"PenLineCap"),function(e){e[e.Miter=0]="Miter",e[e.Bevel=1]="Bevel",e[e.Round=2]="Round"}(t.PenLineJoin||(t.PenLineJoin={}));var r=t.PenLineJoin;e.CoreLibrary.addEnum(r,"PenLineJoin"),function(e){e[e.EvenOdd=0]="EvenOdd",e[e.NonZero=1]="NonZero"}(t.FillRule||(t.FillRule={}));var o=t.FillRule;e.CoreLibrary.addEnum(o,"FillRule"),function(e){e[e.Counterclockwise=0]="Counterclockwise",e[e.Clockwise=1]="Clockwise"}(t.SweepDirection||(t.SweepDirection={}));var i=t.SweepDirection;e.CoreLibrary.addEnum(i,"SweepDirection")}(t=e.Shapes||(e.Shapes={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){var t=this;n.call(this);var o=r.ChildrenProperty.Initialize(this);o.AttachTo(this),e.ReactTo(o,this,function(){return t.InvalidateGeometry()})}return __extends(r,n),r.prototype.ComputePathBounds=function(e){for(var t,n=new minerva.Rect,r=this.Children.getEnumerator();r.moveNext();)t=r.current.GetBounds(e),t.width<=0&&t.height<=0||(n.width<=0&&n.height<=0?minerva.Rect.copyTo(t,n):minerva.Rect.union(n,t));return n},r.prototype.Draw=function(e){var t=this.Transform;null!=t&&(e.save(),e.apply(t.Value._Raw));for(var n=this.Children.getEnumerator();n.moveNext();)n.current.Draw(e);null!=t&&e.restore()},r.FillRulleProperty=DependencyProperty.Register("FillRule",function(){return new e.Enum(e.Shapes.FillRule)},r,e.Shapes.FillRule.EvenOdd),r.ChildrenProperty=DependencyProperty.RegisterImmutable("Children",function(){return t.GeometryCollection},r),r}(t.Geometry);t.GeometryGroup=n,e.CoreLibrary.add(n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){var t=this;n.call(this);var o=r.GradientStopsProperty.Initialize(this);o.AttachTo(this),e.ReactTo(o,this,function(){return t.InvalidateBrush()})}return __extends(r,n),r.prototype.CreateBrush=function(e,n){var r=this.SpreadMethod;switch(r){case t.GradientSpreadMethod.Pad:default:return this.CreatePad(e,n);case t.GradientSpreadMethod.Repeat:return this.CreateRepeat(e,n);case t.GradientSpreadMethod.Reflect:return this.CreateReflect(e,n)}},r.prototype.CreatePad=function(e,t){},r.prototype.CreateRepeat=function(e,t){},r.prototype.CreateReflect=function(e,t){},r.GradientStopsProperty=DependencyProperty.RegisterImmutable("GradientStops",function(){return t.GradientStopCollection},r),r.MappingModeProperty=DependencyProperty.Register("MappingMode",function(){return new e.Enum(t.BrushMappingMode)},r,t.BrushMappingMode.RelativeToBoundingBox,function(e,t){return e.InvalidateBrush()}),r.SpreadMethodProperty=DependencyProperty.Register("SpreadMethod",function(){return new e.Enum(t.GradientSpreadMethod)},r,t.GradientSpreadMethod.Pad,function(e,t){return e.InvalidateBrush()}),r}(t.Brush);t.GradientBrush=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.GradientStopsProperty)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.toString=function(){return this.Color.toString()+" @ "+this.Offset.toString()},n.ColorProperty=DependencyProperty.Register("Color",function(){return Color},n,void 0,e.Incite),n.OffsetProperty=DependencyProperty.Register("Offset",function(){return Number},n,0,e.Incite),n}(e.DependencyObject);t.GradientStop=n,e.CoreLibrary.add(n);var r=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.AddingToCollection=function(n,r){var o=this;return t.prototype.AddingToCollection.call(this,n,r)?(e.ReactTo(n,this,function(){return e.Incite(o)}),e.Incite(this),!0):!1},n.prototype.RemovedFromCollection=function(n,r){return t.prototype.RemovedFromCollection.call(this,n,r)?(e.UnreactTo(n,this),void e.Incite(this)):!1},n.prototype.getPaddedEnumerable=function(){for(var e=Number.MAX_VALUE,t=null,n=Number.MIN_VALUE,r=null,o=this.getEnumerator();o.moveNext();)o.current.Offset<e&&(t=o.current,e=o.current.Offset),o.current.Offset>n&&(r=o.current,n=o.current.Offset);var i=this._ht.slice(0);return t&&i.unshift({Offset:0,Color:t.Color}),r&&i.push({Offset:1,Color:r.Color}),nullstone.IEnumerable_.fromArray(i)},n}(e.XamlObjectCollection);t.GradientStopCollection=r,e.CoreLibrary.add(r)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._Build=function(){var e=this.StartPoint,t=this.EndPoint,n=new minerva.path.Path;return n.move(e.x,e.y),n.line(t.x,t.y),n},t.StartPointProperty=DependencyProperty.Register("StartPoint",function(){return Point},t,void 0,function(e,t){return e.InvalidateGeometry()}),t.EndPointProperty=DependencyProperty.Register("EndPoint",function(){return Point},t,void 0,function(e,t){return e.InvalidateGeometry()}),t}(t.Geometry);t.LineGeometry=n,e.CoreLibrary.add(n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.CreatePad=function(e,t){for(var n=this._GetPointData(t),r=e.createLinearGradient(n.start.x,n.start.y,n.end.x,n.end.y),o=this.GradientStops.getEnumerator();o.moveNext();){var i=o.current;r.addColorStop(i.Offset,i.Color.toString())}return r},n.prototype.CreateRepeat=function(e,n){var r=this._GetPointData(n);return this.CreateInterpolated(e,t.LinearGradient.createRepeatInterpolator(r.start,r.end,n))},n.prototype.CreateReflect=function(e,n){var r=this._GetPointData(n);return this.CreateInterpolated(e,t.LinearGradient.createReflectInterpolator(r.start,r.end,n))},n.prototype.CreateInterpolated=function(e,t){for(var n=e.createLinearGradient(t.x0,t.y0,t.x1,t.y1),r=this.GradientStops.getPaddedEnumerable();t.step();)for(var o=r.getEnumerator();o.moveNext();){var i=o.current,a=t.interpolate(i.Offset);a>=0&&1>=a&&n.addColorStop(a,i.Color.toString())}return n},n.prototype._GetPointData=function(e){var n=this.StartPoint;n=n?n.Clone():new Point(0,0);var r=this.EndPoint;return r=r?r.Clone():new Point(1,1),this.MappingMode!==t.BrushMappingMode.Absolute&&(n.x*=e.width,n.y*=e.height,r.x*=e.width,r.y*=e.height),n.x+=e.x,n.y+=e.y,r.x+=e.x,r.y+=e.y,{start:n,end:r}},n.prototype.toString=function(){for(var e=[],t=this.GradientStops.getEnumerator();t.moveNext();)e.push(t.current.toString());return"LinearGradientBrush("+this.StartPoint.toString()+" --> "+this.EndPoint.toString()+" ["+e.toString()+"])"},n.StartPointProperty=DependencyProperty.RegisterCore("StartPoint",function(){return Point},n,void 0,function(e,t){return e.InvalidateBrush()}),n.EndPointProperty=DependencyProperty.RegisterCore("EndPoint",function(){return Point},n,void 0,function(e,t){return e.InvalidateBrush()}),n}(t.GradientBrush);t.LinearGradientBrush=n,e.CoreLibrary.add(n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function t(e){this._Inverse=null,this._Raw=e||mat3.identity()}return Object.defineProperty(t,"Identity",{get:function(){return new t(mat3.identity())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"M11",{get:function(){return this._Raw[0]},set:function(e){this._Raw[0]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"M12",{get:function(){return this._Raw[1]},set:function(e){this._Raw[1]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"M21",{get:function(){return this._Raw[2]},set:function(e){this._Raw[2]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"M22",{get:function(){return this._Raw[3]},set:function(e){this._Raw[3]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OffsetX",{get:function(){return this._Raw[4]},set:function(e){this._Raw[4]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OffsetY",{get:function(){return this._Raw[5]},set:function(e){this._Raw[5]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Inverse",{get:function(){var e=this._Inverse;if(!e){if(e=new t,e._Raw=mat3.inverse(this._Raw,mat3.identity()),!e._Raw)return void 0;this._Inverse=e}return e},enumerable:!0,configurable:!0}),t.prototype._OnChanged=function(){this._Inverse=null,e.Incite(this)},t.prototype.Clone=function(){return this._Raw?new t(mat3.create(this._Raw)):new t},t}();t.Matrix=n,e.CoreLibrary.add(n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function e(){this._Inverse=null,this._Listeners=[]}return e.FromRaw=function(t){var n=new e;return n._Raw=t,n},Object.defineProperty(e.prototype,"M11",{get:function(){return this._Raw[0]},set:function(e){this._Raw[0]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M12",{get:function(){return this._Raw[1]},set:function(e){this._Raw[1]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M13",{get:function(){return this._Raw[2]},set:function(e){this._Raw[2]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M14",{get:function(){return this._Raw[3]},set:function(e){this._Raw[3]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M21",{get:function(){return this._Raw[4]},set:function(e){this._Raw[4]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M22",{get:function(){return this._Raw[5]},set:function(e){this._Raw[5]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M23",{get:function(){return this._Raw[6]},set:function(e){this._Raw[6]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M24",{get:function(){return this._Raw[7]},set:function(e){this._Raw[7]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M31",{get:function(){return this._Raw[8]},set:function(e){this._Raw[8]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M32",{get:function(){return this._Raw[9]},set:function(e){this._Raw[9]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M33",{get:function(){return this._Raw[10]},set:function(e){this._Raw[10]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M34",{get:function(){return this._Raw[11]},set:function(e){this._Raw[11]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OffsetX",{get:function(){return this._Raw[12]},set:function(e){this._Raw[12]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OffsetY",{get:function(){return this._Raw[13]},set:function(e){this._Raw[13]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OffsetZ",{get:function(){return this._Raw[14]},set:function(e){this._Raw[14]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"M44",{get:function(){return this._Raw[15]},set:function(e){this._Raw[15]=e,this._OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Inverse",{get:function(){var t=this._Inverse;if(!t){if(t=new e,t._Raw=mat4.inverse(this._Raw,mat4.identity()),!t._Raw)return void 0;this._Inverse=t}return t},enumerable:!0,configurable:!0}),e.prototype.Listen=function(e){var t=this._Listeners,n={Callback:e,Detach:function(){var e=t.indexOf(n);e>-1&&t.splice(e,1)}};return t.push(n),n},e.prototype._OnChanged=function(){this._Inverse=null;for(var e=this._Listeners,t=e.length,n=0;t>n;n++)e[n].Callback(this)},e}();t.Matrix3D=n,e.CoreLibrary.add(n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments),this._ProjectionMatrix=null,this._ObjectWidth=0,this._ObjectHeight=0}return __extends(n,t),Object.defineProperty(n.prototype,"ObjectWidth",{get:function(){return this._ObjectWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ObjectHeight",{get:function(){return this._ObjectHeight},enumerable:!0,configurable:!0}),n.prototype.setObjectSize=function(e,t){var n=Math.max(e,1),r=Math.max(t,1);n!==this._ObjectWidth&&r!==this._ObjectHeight&&(this._ObjectWidth=n,this._ObjectHeight=r,this._ProjectionMatrix=null)},n.prototype.getDistanceFromXYPlane=function(){return NaN},n.prototype.getTransform=function(){var e=this._ProjectionMatrix;return e||(e=this._ProjectionMatrix=this.CreateProjectionMatrix()),e?mat4.create(e._Raw):mat4.identity()},n.prototype.CreateProjectionMatrix=function(){return null},n.prototype.InvalidateProjection=function(){this._ProjectionMatrix=null,e.Incite(this)},n}(e.DependencyObject);t.Projection=n,e.CoreLibrary.add(n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.CreateProjectionMatrix=function(){return this.ProjectionMatrix},n.ProjectionMatrixProperty=DependencyProperty.Register("ProjectionMatrix",function(){return t.Matrix3D},n,void 0,function(e,t){return e.InvalidateProjection()}),n}(t.Projection);t.Matrix3DProjection=n,e.CoreLibrary.add(n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e){return new o(e).ParseGeometryImpl()}function r(e){return new o(e).ParseShapePoints()}t.ParseGeometry=n,t.ParseShapePoints=r;var o=function(){function n(e){this.index=0,this.str=e,this.len=e.length}return n.prototype.ParseGeometryImpl=function(){for(var n,r,o,i=new Point,a=new Point,s=e.Shapes.FillRule.EvenOdd,u=!1,l=!1,c=new Point,p=new Point,d=new minerva.path.Path;this.index<this.len;){for(var h;this.index<this.len&&" "===(h=this.str.charAt(this.index));)this.index++;this.index++;var y=!1;switch(h){case"f":case"F":if(h=this.str.charAt(this.index),"0"===h)s=e.Shapes.FillRule.EvenOdd;else{if("1"!==h)return null;s=e.Shapes.FillRule.NonZero}this.index++,h=this.str.charAt(this.index);break;case"m":y=!0;case"M":if(n=this.ParsePoint(),null==n)break;for(y&&(n.x+=i.x,n.y+=i.y),d.move(n.x,n.y),a.x=i.x=n.x,a.y=i.y=n.y,this.Advance();this.MorePointsAvailable()&&null!=(n=this.ParsePoint());)y&&(n.x+=i.x,n.y+=i.y),d.line(n.x,n.y);i.x=n.x,i.y=n.y,u=l=!1;break;case"l":y=!0;case"L":for(;this.MorePointsAvailable()&&null!=(n=this.ParsePoint());)y&&(n.x+=i.x,n.y+=i.y),d.line(n.x,n.y),i.x=n.x,i.y=n.y,this.Advance();u=l=!1;break;case"h":y=!0;case"H":var f=this.ParseDouble();if(null==f)break;y&&(f+=i.x),i=new Point(f,i.y),d.line(i.x,i.y),u=l=!1;break;case"v":y=!0;case"V":var m=this.ParseDouble();if(null==m)break;y&&(m+=i.y),i=new Point(i.x,m),d.line(i.x,i.y),u=l=!1;break;case"c":y=!0;case"C":for(;this.MorePointsAvailable()&&null!=(n=this.ParsePoint())&&(y&&(n.x+=i.x,n.y+=i.y),this.Advance(),null!=(r=this.ParsePoint()))&&(y&&(r.x+=i.x,r.y+=i.y),this.Advance(),null!=(o=this.ParsePoint()));)y&&(o.x+=i.x,o.y+=i.y),this.Advance(),d.cubicBezier(n.x,n.y,r.x,r.y,o.x,o.y),n.x=o.x,n.y=o.y;i.x=o.x,i.y=o.y,u=!0,c.x=r.x,c.y=r.y,l=!1;break;case"s":y=!0;case"S":for(;this.MorePointsAvailable()&&null!=(r=this.ParsePoint())&&(y&&(r.x+=i.x,r.y+=i.y),this.Advance(),null!=(o=this.ParsePoint()));)y&&(o.x+=i.x,o.y+=i.y),u?(n.x=2*i.x-c.x,n.y=2*i.y-c.y):n=i,d.cubicBezier(n.x,n.y,r.x,r.y,o.x,o.y),u=!0,c.x=r.x,c.y=r.y,i.x=o.x,i.y=o.y,this.Advance();l=!1;break;case"q":y=!0;case"Q":for(;this.MorePointsAvailable()&&null!=(n=this.ParsePoint())&&(y&&(n.x+=i.x,n.y+=i.y),this.Advance(),null!=(r=this.ParsePoint()));)y&&(r.x+=i.x,r.y+=i.y),this.Advance(),d.quadraticBezier(n.x,n.y,r.x,r.y),i.x=r.x,i.y=r.y;l=!0,p.x=n.x,p.y=n.y,u=!1;break;case"t":y=!0;case"T":for(;this.MorePointsAvailable()&&null!=(r=this.ParsePoint());)y&&(r.x+=i.x,r.y+=i.y),l?(n.x=2*i.x-p.x,n.y=2*i.y-p.y):n=i,d.quadraticBezier(n.x,n.y,r.x,r.y),l=!0,p.x=n.x,p.y=n.y,i.x=r.x,i.y=r.y,this.Advance();u=!1;break;case"a":y=!0;case"A":for(;this.MorePointsAvailable()&&null!=(n=this.ParsePoint());){var v=this.ParseDouble(),g=0!==this.ParseDouble(),C=minerva.SweepDirection.Counterclockwise;if(0!==this.ParseDouble()&&(C=minerva.SweepDirection.Clockwise),null==(r=this.ParsePoint()))break;y&&(r.x+=i.x,r.y+=i.y),d.ellipticalArc(n.x,n.y,v,g,C,r.x,r.y),i.x=r.x,i.y=r.y,this.Advance()}u=l=!1;break;case"z":case"Z":d.close(),i.x=a.x,i.y=a.y,u=l=!1}}var P=new t.PathGeometry;return P.OverridePath(d),P.FillRule=s,P},n.prototype.ParseShapePoints=function(){for(var e,t=[];this.MorePointsAvailable()&&null!=(e=this.ParsePoint());)t.push(e);return t},n.prototype.ParsePoint=function(){var e=this.ParseDouble();if(null==e)return null;for(var t;this.index<this.len&&(" "===(t=this.str.charAt(this.index))||","===t);)this.index++;if(this.index>=this.len)return null;var n=this.ParseDouble();return null==n?null:new Point(e,n)},n.prototype.ParseDouble=function(){this.Advance();var e=!1;if(this.Match("-")?(e=!0,this.index++):this.Match("+")&&this.index++,this.Match("Infinity"))return this.index+=8,e?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;if(this.Match("NaN"))return NaN;for(var t="";this.index<this.len;){var n=this.str.charCodeAt(this.index),r=this.str[this.index];if(n>=48&&57>=n)t+=r;else if(46===n)t+=r;else{if("E"!==r&&"e"!==r)break;t+=r,"-"===this.str[this.index+1]&&(t+="-",this.index++)}this.index++}if(0===t.length)return null;var o=parseFloat(t);return e?-o:o},n.prototype.Match=function(e){for(var t,n,r=0;r<e.length&&this.index+r<this.len;r++)if(t=e.charAt(r),n=this.str.charAt(this.index+r),t!==n)return!1;return!0},n.prototype.Advance=function(){for(var e,t;this.index<this.len&&(e=this.str.charCodeAt(this.index),!(e>=65&&90>=e||e>=97&&122>=e||e>=48&&57>=e))&&(t=String.fromCharCode(e),"."!==t)&&"-"!==t&&"+"!==t;)this.index++},n.prototype.MorePointsAvailable=function(){for(var e;this.index<this.len&&(","===(e=this.str.charAt(this.index))||" "===e);)this.index++;if(this.index>=this.len)return!1;if("."===e||"-"===e||"+"===e)return!0;var t=this.str.charCodeAt(this.index);return t>=48&&57>=t},n}();nullstone.registerTypeConverter(t.Geometry,function(e){return e instanceof t.Geometry?e:"string"==typeof e?n(e):e})}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){var t=this;n.call(this),this._Path=null;var o=r.SegmentsProperty.Initialize(this);o.AttachTo(this),e.ReactTo(o,this,function(){return t.InvalidatePathFigure();
})}return __extends(r,n),r.prototype._OnSegmentsSourceChanged=function(e){this.Segments.SetSource(e.NewValue)},r.prototype._Build=function(){var e=new minerva.path.Path,t=this.StartPoint;e.move(t.x,t.y);for(var n=this.Segments.getEnumerator();n.moveNext();)n.current._Append(e);return this.IsClosed&&e.close(),e},r.prototype.InvalidatePathFigure=function(){this._Path=null,e.Incite(this)},r.prototype.MergeInto=function(e){this._Path||(this._Path=this._Build()),minerva.path.Path.Merge(e,this._Path)},r.IsClosedProperty=DependencyProperty.RegisterCore("IsClosed",function(){return Boolean},r,!1,function(e,t){return e.InvalidatePathFigure()}),r.StartPointProperty=DependencyProperty.RegisterCore("StartPoint",function(){return Point},r,void 0,function(e,t){return e.InvalidatePathFigure()}),r.IsFilledProperty=DependencyProperty.RegisterCore("IsFilled",function(){return Boolean},r,!0,function(e,t){return e.InvalidatePathFigure()}),r.SegmentsProperty=DependencyProperty.RegisterImmutable("Segments",function(){return t.PathSegmentCollection},r),r.SegmentsSourceProperty=DependencyProperty.Register("SegmentsSource",function(){return nullstone.IEnumerable_},r,void 0,function(e,t){return e._OnSegmentsSourceChanged(t)}),r}(e.DependencyObject);t.PathFigure=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.SegmentsProperty);var r=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.AddingToCollection=function(n,r){var o=this;return t.prototype.AddingToCollection.call(this,n,r)?(e.ReactTo(n,this,function(){return e.Incite(o)}),e.Incite(this),!0):!1},n.prototype.RemovedFromCollection=function(n,r){t.prototype.RemovedFromCollection.call(this,n,r),e.UnreactTo(n,this),e.Incite(this)},n}(e.XamlObjectCollection);t.PathFigureCollection=r,e.CoreLibrary.add(r)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function r(){var t=this;n.call(this),this._OverridePath=null;var o=r.FiguresProperty.Initialize(this);o.AttachTo(this),e.ReactTo(o,this,function(){return t.InvalidateFigures()})}return __extends(r,n),Object.defineProperty(r.prototype,"fillRule",{get:function(){return this.FillRule},enumerable:!0,configurable:!0}),r.prototype.OverridePath=function(e){this._OverridePath=e},r.prototype._Build=function(){if(this._OverridePath)return this._OverridePath;var e=new minerva.path.Path,t=this.Figures;if(t){for(var n=t.getEnumerator();n.moveNext();)n.current.MergeInto(e);return e}},r.prototype.InvalidateFigures=function(){this._OverridePath=null,this.InvalidateGeometry()},r.FillRuleProperty=DependencyProperty.Register("FillRule",function(){return new e.Enum(e.Shapes.FillRule)},r,e.Shapes.FillRule.EvenOdd,function(e,t){return e.InvalidateGeometry()}),r.FiguresProperty=DependencyProperty.RegisterImmutable("Figures",function(){return t.PathFigureCollection},r),r}(t.Geometry);t.PathGeometry=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.FiguresProperty)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._Append=function(e){},t}(e.DependencyObject);t.PathSegment=n,e.CoreLibrary.add(n);var r=function(t){function n(){t.apply(this,arguments),this._Modifying=!1,this._Source=null}return __extends(n,t),n.prototype.AddingToCollection=function(n,r){var o=this;return this._Modifying||null==this._Source?t.prototype.AddingToCollection.call(this,n,r)?(e.ReactTo(n,this,function(){return e.Incite(o)}),e.Incite(this),!0):!1:(console.warn("Cannot modify Path Segments Collection when bound to SegmentsSource."),!1)},n.prototype.RemovedFromCollection=function(n,r){t.prototype.RemovedFromCollection.call(this,n,r),e.UnreactTo(n,this),e.Incite(this)},n.prototype.SetSource=function(t){var n=e.Collections.INotifyCollectionChanged_.as(this._Source);n&&n.CollectionChanged.off(this._OnSegmentsCollectionChanged,this);var r=nullstone.IEnumerable_.as(this._Source);r&&this.Clear(),this._Source=t;var o=nullstone.IEnumerable_.as(this._Source);if(o){this._Modifying=!0;try{for(var i=o.getEnumerator();i.moveNext();)this.Add(i.current)}finally{this._Modifying=!1}}var a=e.Collections.INotifyCollectionChanged_.as(this._Source);a&&a.CollectionChanged.on(this._OnSegmentsCollectionChanged,this)},n.prototype._OnSegmentsCollectionChanged=function(e,t){this._Modifying=!0;try{for(var n=0,r=t.OldItems,o=r?r.length:0;o>n;n++)this.RemoveAt(n);for(var n=0,r=t.NewItems,o=r?r.length:0;o>n;n++)this.Insert(t.NewStartingIndex+n,r[n])}finally{this._Modifying=!1}},n}(e.XamlObjectCollection);t.PathSegmentCollection=r,e.CoreLibrary.add(r)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype._Append=function(e){var t=this.Size,n=t?t.width:0,r=t?t.height:0,o=this.Point,i=o?o.x:0,a=o?o.y:0;e.ellipticalArc(n,r,this.RotationAngle,this.IsLargeArc,this.SweepDirection,i,a)},n.IsLargeArcProperty=DependencyProperty.RegisterCore("IsLargeArc",function(){return Boolean},n,!1,function(t,n){return e.Incite(t)}),n.PointProperty=DependencyProperty.Register("Point",function(){return Point},n,void 0,function(t,n){return e.Incite(t)}),n.RotationAngleProperty=DependencyProperty.Register("RotationAngle",function(){return Number},n,0,function(t,n){return e.Incite(t)}),n.SizeProperty=DependencyProperty.Register("Size",function(){return minerva.Size},n,void 0,function(t,n){return e.Incite(t)}),n.SweepDirectionProperty=DependencyProperty.Register("SweepDirection",function(){return new e.Enum(e.Shapes.SweepDirection)},n,e.Shapes.SweepDirection.Counterclockwise,function(t,n){return e.Incite(t)}),n}(t.PathSegment);t.ArcSegment=n,e.CoreLibrary.add(n);var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._Append=function(e){var t=this.Point1,n=this.Point2,r=this.Point3,o=t?t.x:0,i=t?t.y:0,a=n?n.x:0,s=n?n.y:0,u=r?r.x:0,l=r?r.y:0;e.cubicBezier(o,i,a,s,u,l)},t.Point1Property=DependencyProperty.Register("Point1",function(){return Point},t),t.Point2Property=DependencyProperty.Register("Point2",function(){return Point},t),t.Point3Property=DependencyProperty.Register("Point3",function(){return Point},t),t}(t.PathSegment);t.BezierSegment=r,e.CoreLibrary.add(r);var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._Append=function(e){var t=this.Point,n=t?t.x:0,r=t?t.y:0;e.line(n,r)},t.PointProperty=DependencyProperty.Register("Point",function(){return Point},t),t}(t.PathSegment);t.LineSegment=o,e.CoreLibrary.add(o);var i=function(t){function n(){t.call(this),n.PointsProperty.Initialize(this)}return __extends(n,t),n.prototype._Append=function(e){var t=this.Points;if(t&&t.Count%3===0)for(var n,r,o,i=t.getEnumerator();i.moveNext();)n=i.current,i.moveNext(),r=i.current,i.moveNext(),o=i.current,e.cubicBezier(n.x,n.y,r.x,r.y,o.x,o.y)},n.PointsProperty=DependencyProperty.RegisterImmutable("Points",function(){return e.Shapes.PointCollection},n),n}(t.PathSegment);t.PolyBezierSegment=i,e.CoreLibrary.add(i),e.Markup.Content(i,i.PointsProperty);var a=function(t){function n(){t.call(this),n.PointsProperty.Initialize(this)}return __extends(n,t),n.prototype._Append=function(e){for(var t,n=this.Points.getEnumerator();n.moveNext();)t=n.current,e.line(t.x,t.y);console.warn("PolyLineSegment._Append")},n.PointsProperty=DependencyProperty.RegisterImmutable("Points",function(){return e.Shapes.PointCollection},n),n}(t.PathSegment);t.PolyLineSegment=a,e.CoreLibrary.add(a),e.Markup.Content(a,a.PointsProperty);var s=function(t){function n(){t.call(this),n.PointsProperty.Initialize(this)}return __extends(n,t),n.prototype._Append=function(e){var t=this.Points;if(t&&t.Count%2===0)for(var n,r,o,i,a,s,u=e.endX,l=e.endY,c=t.getEnumerator();c.moveNext();)n=c.current.x,r=c.current.y,c.moveNext(),o=c.current.x,i=c.current.y,a=o,s=i,o=n+(o-n)/3,i=r+(i-r)/3,n=u+2*(n-u)/3,r=l+2*(r-l)/3,e.cubicBezier(n,r,o,i,a,s),u=a,l=s},n.PointsProperty=DependencyProperty.RegisterImmutable("Points",function(){return e.Shapes.PointCollection},n),n}(t.PathSegment);t.PolyQuadraticBezierSegment=s,e.CoreLibrary.add(s),e.Markup.Content(s,s.PointsProperty);var u=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._Append=function(e){var t=this.Point1,n=this.Point2,r=t?t.x:0,o=t?t.y:0,i=n?n.x:0,a=n?n.y:0;e.quadraticBezier(r,o,i,a)},t.Point1Property=DependencyProperty.Register("Point1",function(){return Point},t),t.Point2Property=DependencyProperty.Register("Point2",function(){return Point},t),t}(t.PathSegment);t.QuadraticBezierSegment=u,e.CoreLibrary.add(u)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=57/180*Math.PI,r=999,o=1,i=65536,a=o*i/(o-i)*(1-r)/r,s=Math.PI/180,u=function(e){function u(){e.apply(this,arguments)}return __extends(u,e),u.prototype.getDistanceFromXYPlane=function(){var e=Math.max(this.ObjectWidth,1),t=Math.max(this.ObjectHeight,1),n=[e/2,t/2,0,1],r=this.getTransform();return mat4.transformVec4(r,n,n),0===n[3]?NaN:a-n[2]/n[3]},u.prototype.CreateProjectionMatrix3D=function(){var e=this.RotationX,a=this.RotationY,u=this.RotationZ,l=(e||0)*s,c=(a||0)*s,p=(u||0)*s,d=this.GlobalOffsetX,h=this.GlobalOffsetY,y=this.GlobalOffsetZ,f=d||0,m=h||0,v=y||0,g=this.LocalOffsetX,C=this.LocalOffsetY,P=this.LocalOffsetZ,S=g||0,I=C||0,_=P||0,T=this.ObjectWidth,F=this.ObjectHeight,b=2*r*Math.tan(n/2),w=b/F,D=mat4.createTranslate(-T*this.CenterOfRotationX,-F*this.CenterOfRotationY,-this.CenterOfRotationZ),O=mat4.createScale(1,-1,1),x=mat4.createTranslate(S,-I,_),V=mat4.createRotateX(l),R=mat4.createRotateX(c),E=mat4.createRotateX(p),N=mat4.createTranslate(T*(this.CenterOfRotationX-.5)+f,-F*(this.CenterOfRotationY-.5)-m,this.CenterOfRotationZ-r+v),M=mat4.createPerspective(n,T/F,o,i),A=mat4.createScale(w,w,1),L=mat4.createViewport(T,F),B=mat4.multiply(D,O);mat4.multiply(B,x,B),mat4.multiply(B,V,B),mat4.multiply(B,R,B),mat4.multiply(B,E,B),mat4.multiply(B,N,B),mat4.multiply(B,M,B),mat4.multiply(B,A,B),mat4.multiply(B,L,B);var k=new t.Matrix3D;return k._Raw=B,k},u.CenterOfRotationXProperty=DependencyProperty.Register("CenterOfRotationX",function(){return Number},u,.5,function(e,t){return e.InvalidateProjection()}),u.CenterOfRotationYProperty=DependencyProperty.Register("CenterOfRotationY",function(){return Number},u,.5,function(e,t){return e.InvalidateProjection()}),u.CenterOfRotationZProperty=DependencyProperty.Register("CenterOfRotationZ",function(){return Number},u,.5,function(e,t){return e.InvalidateProjection()}),u.GlobalOffsetXProperty=DependencyProperty.Register("GlobalOffsetX",function(){return Number},u,0,function(e,t){return e.InvalidateProjection()}),u.GlobalOffsetYProperty=DependencyProperty.Register("GlobalOffsetY",function(){return Number},u,0,function(e,t){return e.InvalidateProjection()}),u.GlobalOffsetZProperty=DependencyProperty.Register("GlobalOffsetZ",function(){return Number},u,0,function(e,t){return e.InvalidateProjection()}),u.LocalOffsetXProperty=DependencyProperty.Register("LocalOffsetX",function(){return Number},u,0,function(e,t){return e.InvalidateProjection()}),u.LocalOffsetYProperty=DependencyProperty.Register("LocalOffsetY",function(){return Number},u,0,function(e,t){return e.InvalidateProjection()}),u.LocalOffsetZProperty=DependencyProperty.Register("LocalOffsetZ",function(){return Number},u,0,function(e,t){return e.InvalidateProjection()}),u.RotationXProperty=DependencyProperty.Register("RotationX",function(){return Number},u,0,function(e,t){return e.InvalidateProjection()}),u.RotationYProperty=DependencyProperty.Register("RotationY",function(){return Number},u,0,function(e,t){return e.InvalidateProjection()}),u.RotationZProperty=DependencyProperty.Register("RotationZ",function(){return Number},u,0,function(e,t){return e.InvalidateProjection()}),u}(t.Projection);t.PlaneProjection=u,e.CoreLibrary.add(u)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=document.createElement("canvas"),r=n.getContext("2d"),o=1e-10,i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.CreatePad=function(e,t){for(var n=this._GetPointData(t),o=(n.balanced?e:r).createRadialGradient(n.x0,n.y0,0,n.x1,n.y1,n.r1),i=this.GradientStops.getEnumerator();i.moveNext();){var a=i.current;o.addColorStop(a.Offset,a.Color.toString())}return this.FitPattern(e,o,n,t)},i.prototype.CreateRepeat=function(e,t){var n=this._GetPointData(t);return this.CreateInterpolated(n,t,!1)},i.prototype.CreateReflect=function(e,t){var n=this._GetPointData(t);return this.CreateInterpolated(n,t,!0)},i.prototype.CreateInterpolated=function(e,o,i){n.width=o.width,n.height=o.height,r.save(),e.balanced||r.scale(e.sx,e.sy),r.globalCompositeOperation="destination-over";for(var a=!1,s=this.GradientStops.getPaddedEnumerable(),u=t.RadialGradient.createExtender(e,o);u.step();a=!a){for(var l=u.createGradient(r),c=s.getEnumerator();c.moveNext();){var p=c.current.Offset;i&&a&&(p=1-p),l.addColorStop(p,c.current.Color.toString())}r.fillStyle=l,r.beginPath(),r.arc(u.x1,u.y1,u.r1,0,2*Math.PI,!1),r.closePath(),r.fill()}var d=r.createPattern(n,"no-repeat");return r.restore(),d},i.prototype.FitPattern=function(e,t,o,i){if(o.balanced)return t;n.width=i.width,n.height=i.height,r.save(),r.scale(o.sx,o.sy),r.fillStyle=t,r.fillRect(0,0,o.side,o.side);var a=e.createPattern(n,"no-repeat");return r.restore(),a},i.prototype._GetPointData=function(e){var n=this.Center;n=n?n.Clone():new Point(.5,.5);var r=this.GradientOrigin;r=r?r.Clone():new Point(.5,.5);var i=this.RadiusX;null==i&&(i=.5);var a=this.RadiusY;null==a&&(a=.5),this.MappingMode!==t.BrushMappingMode.Absolute&&(n.x*=e.width,n.y*=e.height,r.x*=e.width,r.y*=e.height,i*=e.width,a*=e.height),n.x+=e.x,n.y+=e.y,r.x+=e.x,r.y+=e.y;var s=Math.max(i,a),u=Math.max(e.width,e.height),l=e.width/u,c=e.height/u;return{x0:r.x/l,y0:r.y/c,x1:n.x/l,y1:n.y/c,r1:s,side:u,sx:e.width/u,sy:e.height/u,balanced:Math.abs(i-a)<o}},i.CenterProperty=DependencyProperty.RegisterCore("Center",function(){return Point},i,void 0,function(e,t){return e.InvalidateBrush()}),i.GradientOriginProperty=DependencyProperty.RegisterCore("GradientOrigin",function(){return Point},i,void 0,function(e,t){return e.InvalidateBrush()}),i.RadiusXProperty=DependencyProperty.RegisterCore("RadiusX",function(){return Number},i,.5,function(e,t){return e.InvalidateBrush()}),i.RadiusYProperty=DependencyProperty.RegisterCore("RadiusY",function(){return Number},i,.5,function(e,t){return e.InvalidateBrush()}),i}(t.GradientBrush);t.RadialGradientBrush=i,e.CoreLibrary.add(i)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._Build=function(){var e=this.Rect;if(!e)return null;var t=this.RadiusX,n=this.RadiusY,r=new minerva.path.Path;return r.roundedRect(e.x,e.y,e.width,e.height,t,n),r},t.RectProperty=DependencyProperty.RegisterCore("Rect",function(){return Rect},t,void 0,function(e,t){return e.InvalidateGeometry()}),t.RadiusXProperty=DependencyProperty.RegisterCore("RadiusX",function(){return Number},t,0,function(e,t){return e.InvalidateGeometry()}),t.RadiusYProperty=DependencyProperty.RegisterCore("RadiusY",function(){return Number},t,0,function(e,t){return e.InvalidateGeometry()}),t}(t.Geometry);t.RectangleGeometry=n,e.CoreLibrary.add(n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e){if(!e)return void 0;if(e instanceof t.Brush)return e;var n=new r;return n.Color=nullstone.convertAnyToType(e,Color),n}var r=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];e.call(this),t&&1===t.length&&t[0]instanceof Color&&(this.Color=t[0])}return __extends(t,e),t.prototype.isTransparent=function(){var e=this.Color;return!e||e.A<=0},t.FromColor=function(e){var n=new t;return n.Color=e,n},t.prototype.setupBrush=function(e,t){this._CachedBrush||(this._CachedBrush=this.CreateBrush(e,t))},t.prototype.CreateBrush=function(e,t){var n=this.Color;return n?n.toString():"#000000"},t.ColorProperty=DependencyProperty.Register("Color",function(){return Color},t,void 0,function(e,t){return e.InvalidateBrush()}),t}(t.Brush);t.SolidColorBrush=r,e.CoreLibrary.add(r),nullstone.registerTypeConverter(t.Brush,n),nullstone.registerTypeConverter(r,n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function n(){}return n.GetTextHintingMode=function(e){return e.GetValue(n.TextHintingModeProperty)},n.SetTextHintingMode=function(e,t){e.SetValue(n.TextHintingModeProperty,t)},n.TextHintingModeProperty=DependencyProperty.RegisterAttached("TextHintingMode",function(){return new e.Enum(t.TextHintingMode)},n),n}();t.TextOptions=n,e.CoreLibrary.add(n)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,n,r,o,i,a,s){var u=e/r,l=n/o;if(0===e&&(u=1),0===n&&(l=1),i===t.Stretch.Fill)return mat3.createScale(u,l);var c=1,p=0,d=0;switch(i){case t.Stretch.Uniform:c=l>u?u:l;break;case t.Stretch.UniformToFill:c=l>u?l:u;break;case t.Stretch.None:}switch(a){case t.AlignmentX.Left:p=0;break;case t.AlignmentX.Center:p=(e-c*r)/2;break;case t.AlignmentX.Right:default:p=e-c*r}switch(s){case t.AlignmentY.Top:d=0;break;case t.AlignmentY.Center:d=(n-c*o)/2;break;case t.AlignmentY.Bottom:default:d=n-c*o}var h=mat3.createScale(c,c);return mat3.translate(h,p,d),h}var r=function(r){function o(){r.apply(this,arguments)}return __extends(o,r),o.prototype.CreateBrush=function(e,t){var r=this.GetTileExtents(),o=document.createElement("canvas");o.width=t.width,o.height=t.height;var i=o.getContext("2d"),a=n(t.width,t.height,r.width,r.height,this.Stretch,this.AlignmentX,this.AlignmentY);return i.setTransform(a[0],a[1],a[2],a[3],a[4],a[5]),this.DrawTile(i,t),e.createPattern(o,"no-repeat")},o.prototype.GetTileExtents=function(){return void 0},o.prototype.DrawTile=function(e,t){},o.AlignmentXProperty=DependencyProperty.RegisterCore("AlignmentX",function(){return new e.Enum(t.AlignmentX)},o,t.AlignmentX.Center,function(e,t){return e.InvalidateBrush()}),o.AlignmentYProperty=DependencyProperty.RegisterCore("AlignmentY",function(){return new e.Enum(t.AlignmentY)},o,t.AlignmentY.Center,function(e,t){return e.InvalidateBrush()}),o.StretchProperty=DependencyProperty.RegisterCore("Stretch",function(){return new e.Enum(t.Stretch)},o,t.Stretch.Fill,function(e,t){return e.InvalidateBrush()}),o}(t.Brush);t.TileBrush=r,e.CoreLibrary.add(r)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(n){function o(){n.call(this),e.XamlNode.SetShareable(this.XamlNode)}return __extends(o,n),Object.defineProperty(o.prototype,"Value",{get:function(){var e=this._Value;return e||(this._Value=e=new t.Matrix,e._Raw=this._BuildValue()),e},enumerable:!0,configurable:!0}),o.prototype.getRaw=function(){return this.Value._Raw},Object.defineProperty(o.prototype,"Inverse",{get:function(){var e=this.Value.Inverse;if(!e)return null;var t=new r;return t.Matrix=e,t},enumerable:!0,configurable:!0}),o.prototype.Transform=function(e){var t,n=this.Value;return n&&(t=n._Raw)?(t=mat3.transformVec2(t,vec2.create(e.x,e.y)),new Point(t[0],t[1])):new Point(e.x,e.y)},o.prototype.TransformBounds=function(e){if(!e)return void 0;var t=this.Value,n=new minerva.Rect;return minerva.Rect.copyTo(e,n),t&&t._Raw?minerva.Rect.transform(n,t._Raw):n},o.prototype.TryTransform=function(e,t){return!1},o.prototype.InvalidateValue=function(){void 0!==this._Value&&(this._Value=void 0),e.Incite(this)},o.prototype._BuildValue=function(){return void 0},o.copyMatTo=function(e,t){mat3.copyTo(e.Value._Raw,t)},o}(t.GeneralTransform);t.Transform=n,e.CoreLibrary.add(n);var r=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._BuildValue=function(){var e=this.Matrix;return e?e._Raw:mat3.identity()},n.prototype.Clone=function(){var e=new n;return e.Matrix=this.Matrix.Clone(),e},n.MatrixProperty=DependencyProperty.RegisterFull("Matrix",function(){return t.Matrix},n),n}(n);t.MatrixTransform=r,e.CoreLibrary.add(r);var o;!function(t){e.DPReaction(r.MatrixProperty,function(e,t,n){return e.InvalidateValue()})}(o||(o={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._BuildValue=function(){var e=this.CenterX,t=this.CenterY,n=this.Angle,r=Math.PI/180*n,o=mat3.createRotate(r);return 0===e&&0===t?o:(mat3.multiply(mat3.createTranslate(-e,-t),o,o),mat3.translate(o,e,t),o)},t.AngleProperty=DependencyProperty.Register("Angle",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t.CenterXProperty=DependencyProperty.Register("CenterX",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t.CenterYProperty=DependencyProperty.Register("CenterY",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t}(t.Transform);t.RotateTransform=n,e.CoreLibrary.add(n);var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._BuildValue=function(){var e=this.CenterX,t=this.CenterY,n=mat3.createScale(this.ScaleX,this.ScaleY);return 0===e&&0===t?n:(mat3.multiply(mat3.createTranslate(-e,-t),n,n),mat3.translate(n,e,t),n)},t.CenterXProperty=DependencyProperty.Register("CenterX",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t.CenterYProperty=DependencyProperty.Register("CenterY",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t.ScaleXProperty=DependencyProperty.Register("ScaleX",function(){return Number},t,1,function(e,t){return e.InvalidateValue()}),t.ScaleYProperty=DependencyProperty.Register("ScaleY",function(){return Number},t,1,function(e,t){return e.InvalidateValue()}),t}(t.Transform);t.ScaleTransform=r,e.CoreLibrary.add(r);var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._BuildValue=function(){var e=this.CenterX,t=this.CenterY,n=Math.PI/180*this.AngleX,r=Math.PI/180*this.AngleY,o=mat3.createSkew(n,r);return 0===e&&0===t?o:(mat3.multiply(mat3.createTranslate(-e,-t),o,o),mat3.translate(o,e,t),o)},t.AngleXProperty=DependencyProperty.Register("AngleX",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t.AngleYProperty=DependencyProperty.Register("AngleY",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t.CenterXProperty=DependencyProperty.Register("CenterX",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t.CenterYProperty=DependencyProperty.Register("CenterY",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t}(t.Transform);t.SkewTransform=o,e.CoreLibrary.add(o);var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._BuildValue=function(){return mat3.createTranslate(this.X,this.Y)},t.XProperty=DependencyProperty.Register("X",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t.YProperty=DependencyProperty.Register("Y",function(){return Number},t,0,function(e,t){return e.InvalidateValue()}),t}(t.Transform);t.TranslateTransform=i,e.CoreLibrary.add(i);var a=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.AddingToCollection=function(n,r){var o=this;return t.prototype.AddingToCollection.call(this,n,r)?(e.ReactTo(n,this,function(){return e.Incite(o)}),e.Incite(this),!0):!1},n.prototype.RemovedFromCollection=function(n,r){return t.prototype.RemovedFromCollection.call(this,n,r)?(e.UnreactTo(n,this),void e.Incite(this)):!1},n}(e.XamlObjectCollection);t.TransformCollection=a,e.CoreLibrary.add(a);var s=function(t){function n(){var r=this;t.call(this);var o=n.ChildrenProperty.Initialize(this);o.AttachTo(this),e.ReactTo(o,this,function(){return r.InvalidateValue()})}return __extends(n,t),n.prototype._BuildValue=function(){for(var e=this.Children.getEnumerator(),t=mat3.identity();e.moveNext();)mat3.multiply(t,e.current.Value._Raw,t);return t},n.ChildrenProperty=DependencyProperty.RegisterImmutable("Children",function(){return a},n),n}(t.Transform);t.TransformGroup=s,e.CoreLibrary.add(s),e.Markup.Content(s,s.ChildrenProperty)}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,t,n){if(!r(t)){if(o(e,n,t))return;if(!s(n))throw new NotSupportedException("Navigation Failed")}var i=e.App;if(!i||!i.AllowNavigation)throw new InvalidOperationException("Navigation is now allowed.");var a=u(n,i);if(!a.isAbsoluteUri)throw new InvalidOperationException("Navigation Failed ["+a.toString()+"]");l(t||"_self",a.originalString)}function r(e){if(!e)return!1;switch(e.toLowerCase()){case"_blank":case"_media":case"_search":case"_parent":case"_self":case"_top":return!0;default:return!1}}function o(n,r,o){for(var s=n,u=a(n);u.moveNext();){var l=u.current;if(l&&(t.INavigate_.is(l)||!e.VisualTreeHelper.GetParent(l))){var c=i(l,s,o);if(c)return c.Navigate(r);s=l}}return!1}function i(n,r,o){if(!n||n===r)return null;var a=t.INavigate_.as(n);if(a&&(!o||o===n.Name))return a;if(n instanceof e.Controls.Primitives.Popup)return i(n.Child,r,o);for(var s=0,u=e.VisualTreeHelper.GetChildrenCount(n);u>s;s++){var l=i(e.VisualTreeHelper.GetChild(n,s),r,o);if(l)return l}return null}function a(e){var t={current:e,moveNext:function(){return t.current?(t.current=t.current.VisualParent||t.current.Parent,!!t.current):!1}};return t}function s(e){return!e.isAbsoluteUri&&e.originalString&&"/"!==e.originalString[0]?!1:!0}function u(t,n){var r=t;if(!r.isAbsoluteUri){if(r.originalString&&"/"!==r.originalString[0])throw new NotSupportedException("HyperlinkButton_GetAbsoluteUri_PageRelativeUri");if(!n)throw new NotSupportedException("HyperlinkButton_GetAbsoluteUri_NoApplication");r=new e.Uri(n.Address,r)}return r}function l(e,t){c=c||document.createElement("a"),c.href=t,c.target=e,c.click()}t.Navigate=n;var c}(t=e.Navigation||(e.Navigation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function t(){var e=this;this.LocationChanged=new nullstone.Event,this.Href=window.location.href,this.Hash=window.location.hash,"#"===this.Href[this.Href.length-1]&&(this.Hash="#"),this.Hash&&(this.Hash=this.Hash.substr(1),this.Href=this.Href.substring(0,this.Href.indexOf("#"))),window.onhashchange=function(){return e._HandleFragmentChange()}}return Object.defineProperty(t.prototype,"CurrentUri",{get:function(){return new e.Uri(this.Href+"#"+this.Hash)},enumerable:!0,configurable:!0}),t.prototype.Navigate=function(e){return window.location.hash=e.toString(),!0},t.prototype._HandleFragmentChange=function(){this.Hash=window.location.hash,this.Hash&&(this.Hash=this.Hash.substr(1)),this.LocationChanged.raise(this,null)},t}();t.NavigationService=n,e.CoreLibrary.add(n)}(t=e.Navigation||(e.Navigation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.call(this),n.RouteMappingsProperty.Initialize(this)}return __extends(n,t),n.prototype.MapUri=function(e){for(var t,n=this.RouteMappings.getEnumerator();n.moveNext();)if(t=n.current.MapUri(e)){var r=this.ViewModelProvider?this.ViewModelProvider.ResolveViewModel(t):null;return t.DataContext=r,t}return void 0},n.RouteMappingsProperty=DependencyProperty.RegisterImmutable("RouteMappings",function(){return e.XamlObjectCollection},n),n.ViewModelProviderProperty=DependencyProperty.Register("ViewModelProvider",function(){return e.MVVM.IViewModelProvider_},n),n}(e.DependencyObject);t.RouteMapper=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.RouteMappingsProperty)}(t=e.Navigation||(e.Navigation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,t){function n(){var t={Identifier:null,Terminator:null,Value:null},n=e.indexOf("}",o);if(0>n)throw new InvalidOperationException("Invalid Uri format. '{' needs a closing '}'.");var r=n-o+1;if(t.Identifier=e.substr(o+1,r-2),!t.Identifier)throw new InvalidOperationException("Invalid Uri format. '{}' must contain an identifier.");return o+=r,t.Terminator=o+1<e.length?e[o]:"\x00",t}function r(e){if("\x00"===e.Terminator)return e.Value=t.substr(i),e.Value&&(i+=e.Value.length),e;for(e.Value="";i<t.length;){if(t[i]==e.Terminator)return;e.Value+=t[i],i++}}var o=0,i=0;return{Match:function(){var a=[];if(0===e.length)return 0===t.length?a:null;for(;o<e.length&&i<t.length;)if("{"!==e[o]){if(e[o]!==t[o])return null;o++,i++}else a.push(r(n()));return a}}}var r=function(r){function o(){r.apply(this,arguments)}return __extends(o,r),o.prototype.MapUri=function(e){var r=n(this.Uri.toString(),e.toString()),o=r.Match();if(!o)return void 0;if(!this.View)throw new InvalidOperationException("RouteMapping must have a view. ("+this.Uri.toString()+")");for(var i={},a=0;a<o.length;a++){var s=o[a].Identifier,u=o[a].Value;i[s]=u}return new t.Route(this.View,i,null)},o.ViewProperty=DependencyProperty.Register("View",function(){return e.Uri},o),o.UriProperty=DependencyProperty.Register("Uri",function(){return e.Uri},o),o}(e.DependencyObject);t.RouteMapping=r,e.CoreLibrary.add(r)}(t=e.Navigation||(e.Navigation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(t){function n(){t.call(this),n.UriMappingsProperty.Initialize(this)}return __extends(n,t),n.prototype.MapUri=function(e){for(var t,n=this.UriMappings.getEnumerator();n.moveNext();)if(t=n.current.MapUri(e))return t;return e},n.UriMappingsProperty=DependencyProperty.RegisterImmutable("UriMappings",function(){return e.XamlObjectCollection},n),n}(e.DependencyObject);t.UriMapper=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.UriMappingsProperty)}(t=e.Navigation||(e.Navigation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,t,n){function r(){var t={Identifier:null,Terminator:null,Value:null},n=e.indexOf("}",a);if(0>n)throw new InvalidOperationException("Invalid Uri format. '{' needs a closing '}'.");var r=n-a+1;if(t.Identifier=e.substr(a+1,r-2),!t.Identifier)throw new InvalidOperationException("Invalid Uri format. '{}' must contain an identifier.");return a+=r,t.Terminator=a+1<e.length?e[a]:"\x00",t}function o(e){if("\x00"===e.Terminator)return e.Value=n.substr(s),e.Value&&(s+=e.Value.length),e;for(e.Value="";s<n.length;){if(n[s]==e.Terminator)return;e.Value+=n[s],s++}}function i(e){for(var n,r=t,o=e.length,i=0;o>i;i++)n=e[i],r=r.replace("{"+n.Identifier+"}",n.Value);return r}var a=0,s=0;return{Match:function(){var t=[];if(0===e.length)return 0===n.length?i(t):null;for(;a<e.length&&s<n.length;)if("{"!==e[a]){if(e[a]!==n[a])return null;a++,s++}else t.push(o(r()));return i(t)}}}var r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype.MapUri=function(t){var r=n(this.Uri.toString(),this.MappedUri.toString(),t.toString()),o=r.Match();return o?new e.Uri(o):void 0},r.MappedUriProperty=DependencyProperty.Register("MappedUri",function(){return e.Uri},r),r.UriProperty=DependencyProperty.Register("Uri",function(){return e.Uri},r),r}(e.DependencyObject);t.UriMapping=r,e.CoreLibrary.add(r)}(t=e.Navigation||(e.Navigation={}))}(Fayde||(Fayde={}));var Color=function(){function e(){this.R=0,this.G=0,this.B=0,this.A=1}return e.prototype.Add=function(t){var n=new e;return n.R=this.R+t.R,n.G=this.G+t.G,n.B=this.B+t.B,n.A=this.A+t.A,n},e.prototype.Subtract=function(t){var n=new e;return n.R=this.R-t.R,n.G=this.G-t.G,n.B=this.B-t.B,n.A=this.A-t.A,n},e.prototype.Multiply=function(t){var n=new e;return n.R=this.R*t,n.G=this.G*t,n.B=this.B*t,n.A=this.A*t,n},e.prototype.Equals=function(e){return this.R===e.R&&this.G===e.G&&this.B===e.B&&this.A===e.A},e.prototype.toString=function(){var e=Math.round(this.R)||0,t=Math.round(this.G)||0,n=Math.round(this.B)||0,r=this.A||0;return"rgba("+e+", "+t+", "+n+", "+r+")"},e.prototype.ToHexStringNoAlpha=function(){return"#"+this.R.toString(16)+this.G.toString(16)+this.B.toString(16);
},e.prototype.Clone=function(){return e.FromRgba(this.R,this.G,this.B,this.A)},e.LERP=function(t,n,r){var o=new e;return o.R=t.R+(n.R-t.R)*r,o.G=t.G+(n.G-t.G)*r,o.B=t.B+(n.B-t.B)*r,o.A=t.A+(n.A-t.A)*r,o},e.FromRgba=function(t,n,r,o){var i=new e;return i.R=t,i.G=n,i.B=r,i.A=o,i},e.FromHex=function(t){var n,r=new e;return null!=(n=e.__AlphaRegex.exec(t))?(r.A=parseInt(n[1],16)/255,r.R=parseInt(n[2],16),r.G=parseInt(n[3],16),r.B=parseInt(n[4],16)):null!=(n=e.__NoAlphaRegex.exec(t))&&(r.A=1,r.R=parseInt(n[1],16),r.G=parseInt(n[2],16),r.B=parseInt(n[3],16)),r},e.__NoAlphaRegex=/#([0-9a-fA-F][0-9a-fA-F]){1}([0-9a-fA-F][0-9a-fA-F]){1}([0-9a-fA-F][0-9a-fA-F]){1}/,e.__AlphaRegex=/#([0-9a-fA-F][0-9a-fA-F]){1}([0-9a-fA-F][0-9a-fA-F]){1}([0-9a-fA-F][0-9a-fA-F]){1}([0-9a-fA-F][0-9a-fA-F]){1}/,e.KnownColors={AliceBlue:e.FromHex("#FFF0F8FF"),AntiqueWhite:e.FromHex("#FFFAEBD7"),Aqua:e.FromHex("#FF00FFFF"),Aquamarine:e.FromHex("#FF7FFFD4"),Azure:e.FromHex("#FFF0FFFF"),Beige:e.FromHex("#FFF5F5DC"),Bisque:e.FromHex("#FFFFE4C4"),Black:e.FromHex("#FF000000"),BlanchedAlmond:e.FromHex("#FFFFEBCD"),Blue:e.FromHex("#FF0000FF"),BlueViolet:e.FromHex("#FF8A2BE2"),Brown:e.FromHex("#FFA52A2A"),BurlyWood:e.FromHex("#FFDEB887"),CadetBlue:e.FromHex("#FF5F9EA0"),Chartreuse:e.FromHex("#FF7FFF00"),Chocolate:e.FromHex("#FFD2691E"),Coral:e.FromHex("#FFFF7F50"),CornflowerBlue:e.FromHex("#FF6495ED"),Cornsilk:e.FromHex("#FFFFF8DC"),Crimson:e.FromHex("#FFDC143C"),Cyan:e.FromHex("#FF00FFFF"),DarkBlue:e.FromHex("#FF00008B"),DarkCyan:e.FromHex("#FF008B8B"),DarkGoldenrod:e.FromHex("#FFB8860B"),DarkGray:e.FromHex("#FFA9A9A9"),DarkGreen:e.FromHex("#FF006400"),DarkKhaki:e.FromHex("#FFBDB76B"),DarkMagenta:e.FromHex("#FF8B008B"),DarkOliveGreen:e.FromHex("#FF556B2F"),DarkOrange:e.FromHex("#FFFF8C00"),DarkOrchid:e.FromHex("#FF9932CC"),DarkRed:e.FromHex("#FF8B0000"),DarkSalmon:e.FromHex("#FFE9967A"),DarkSeaGreen:e.FromHex("#FF8FBC8F"),DarkSlateBlue:e.FromHex("#FF483D8B"),DarkSlateGray:e.FromHex("#FF2F4F4F"),DarkTurquoise:e.FromHex("#FF00CED1"),DarkViolet:e.FromHex("#FF9400D3"),DeepPink:e.FromHex("#FFFF1493"),DeepSkyBlue:e.FromHex("#FF00BFFF"),DimGray:e.FromHex("#FF696969"),DodgerBlue:e.FromHex("#FF1E90FF"),Firebrick:e.FromHex("#FFB22222"),FloralWhite:e.FromHex("#FFFFFAF0"),ForestGreen:e.FromHex("#FF228B22"),Fuchsia:e.FromHex("#FFFF00FF"),Gainsboro:e.FromHex("#FFDCDCDC"),GhostWhite:e.FromHex("#FFF8F8FF"),Gold:e.FromHex("#FFFFD700"),Goldenrod:e.FromHex("#FFDAA520"),Gray:e.FromHex("#FF808080"),Green:e.FromHex("#FF008000"),GreenYellow:e.FromHex("#FFADFF2F"),Honeydew:e.FromHex("#FFF0FFF0"),HotPink:e.FromHex("#FFFF69B4"),IndianRed:e.FromHex("#FFCD5C5C"),Indigo:e.FromHex("#FF4B0082"),Ivory:e.FromHex("#FFFFFFF0"),Khaki:e.FromHex("#FFF0E68C"),Lavender:e.FromHex("#FFE6E6FA"),LavenderBlush:e.FromHex("#FFFFF0F5"),LawnGreen:e.FromHex("#FF7CFC00"),LemonChiffon:e.FromHex("#FFFFFACD"),LightBlue:e.FromHex("#FFADD8E6"),LightCoral:e.FromHex("#FFF08080"),LightCyan:e.FromHex("#FFE0FFFF"),LightGoldenrodYellow:e.FromHex("#FFFAFAD2"),LightGray:e.FromHex("#FFD3D3D3"),LightGreen:e.FromHex("#FF90EE90"),LightPink:e.FromHex("#FFFFB6C1"),LightSalmon:e.FromHex("#FFFFA07A"),LightSeaGreen:e.FromHex("#FF20B2AA"),LightSkyBlue:e.FromHex("#FF87CEFA"),LightSlateGray:e.FromHex("#FF778899"),LightSteelBlue:e.FromHex("#FFB0C4DE"),LightYellow:e.FromHex("#FFFFFFE0"),Lime:e.FromHex("#FF00FF00"),LimeGreen:e.FromHex("#FF32CD32"),Linen:e.FromHex("#FFFAF0E6"),Magenta:e.FromHex("#FFFF00FF"),Maroon:e.FromHex("#FF800000"),MediumAquamarine:e.FromHex("#FF66CDAA"),MediumBlue:e.FromHex("#FF0000CD"),MediumOrchid:e.FromHex("#FFBA55D3"),MediumPurple:e.FromHex("#FF9370DB"),MediumSeaGreen:e.FromHex("#FF3CB371"),MediumSlateBlue:e.FromHex("#FF7B68EE"),MediumSpringGreen:e.FromHex("#FF00FA9A"),MediumTurquoise:e.FromHex("#FF48D1CC"),MediumVioletRed:e.FromHex("#FFC71585"),MidnightBlue:e.FromHex("#FF191970"),MintCream:e.FromHex("#FFF5FFFA"),MistyRose:e.FromHex("#FFFFE4E1"),Moccasin:e.FromHex("#FFFFE4B5"),NavajoWhite:e.FromHex("#FFFFDEAD"),Navy:e.FromHex("#FF000080"),OldLace:e.FromHex("#FFFDF5E6"),Olive:e.FromHex("#FF808000"),OliveDrab:e.FromHex("#FF6B8E23"),Orange:e.FromHex("#FFFFA500"),OrangeRed:e.FromHex("#FFFF4500"),Orchid:e.FromHex("#FFDA70D6"),PaleGoldenrod:e.FromHex("#FFEEE8AA"),PaleGreen:e.FromHex("#FF98FB98"),PaleTurquoise:e.FromHex("#FFAFEEEE"),PaleVioletRed:e.FromHex("#FFDB7093"),PapayaWhip:e.FromHex("#FFFFEFD5"),PeachPuff:e.FromHex("#FFFFDAB9"),Peru:e.FromHex("#FFCD853F"),Pink:e.FromHex("#FFFFC0CB"),Plum:e.FromHex("#FFDDA0DD"),PowderBlue:e.FromHex("#FFB0E0E6"),Purple:e.FromHex("#FF800080"),Red:e.FromHex("#FFFF0000"),RosyBrown:e.FromHex("#FFBC8F8F"),RoyalBlue:e.FromHex("#FF4169E1"),SaddleBrown:e.FromHex("#FF8B4513"),Salmon:e.FromHex("#FFFA8072"),SandyBrown:e.FromHex("#FFF4A460"),SeaGreen:e.FromHex("#FF2E8B57"),SeaShell:e.FromHex("#FFFFF5EE"),Sienna:e.FromHex("#FFA0522D"),Silver:e.FromHex("#FFC0C0C0"),SkyBlue:e.FromHex("#FF87CEEB"),SlateBlue:e.FromHex("#FF6A5ACD"),SlateGray:e.FromHex("#FF708090"),Snow:e.FromHex("#FFFFFAFA"),SpringGreen:e.FromHex("#FF00FF7F"),SteelBlue:e.FromHex("#FF4682B4"),Tan:e.FromHex("#FFD2B48C"),Teal:e.FromHex("#FF008080"),Thistle:e.FromHex("#FFD8BFD8"),Tomato:e.FromHex("#FFFF6347"),Transparent:e.FromHex("#00FFFFFF"),Turquoise:e.FromHex("#FF40E0D0"),Violet:e.FromHex("#FFEE82EE"),Wheat:e.FromHex("#FFF5DEB3"),White:e.FromHex("#FFFFFFFF"),WhiteSmoke:e.FromHex("#FFF5F5F5"),Yellow:e.FromHex("#FFFFFF00"),YellowGreen:e.FromHex("#FF9ACD32")},e}();Fayde.CoreLibrary.addPrimitive(Color),nullstone.registerTypeConverter(Color,function(e){if(!e)return void 0;if(e instanceof Color)return e;if(e=e.toString(),"#"!==e[0]){var t=Color.KnownColors[e];if(!t)throw new NotSupportedException("Unknown Color: "+e);return t}return Color.FromHex(e)});var CornerRadius=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Clone=function(){return new t(this.topLeft,this.topRight,this.bottomRight,this.bottomLeft)},t}(minerva.CornerRadius);Fayde.CoreLibrary.addPrimitive(CornerRadius),nullstone.registerTypeConverter(CornerRadius,function(e){if(!e)return new CornerRadius;if(e instanceof CornerRadius)return e;if("number"==typeof e)return new CornerRadius(e,e,e,e);var t,n,r,o,i=Fayde.splitCommaList(e.toString());if(1===i.length)t=n=r=o=parseFloat(i[0]);else{if(4!==i.length)throw new Exception("Cannot parse CornerRadius value '"+e+"'");t=parseFloat(i[0]),n=parseFloat(i[1]),r=parseFloat(i[2]),o=parseFloat(i[3])}return new CornerRadius(t,n,r,o)});var DurationType;!function(e){e[e.Automatic=0]="Automatic",e[e.Forever=1]="Forever",e[e.TimeSpan=2]="TimeSpan"}(DurationType||(DurationType={}));var Duration=function(){function e(e){this._Type=DurationType.TimeSpan,this._TimeSpan=e}return e.prototype.Clone=function(){var t=new e;return t._Type=this._Type,t._TimeSpan=this._TimeSpan,t},Object.defineProperty(e.prototype,"Type",{get:function(){return this._Type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeSpan",{get:function(){return this._Type===DurationType.TimeSpan?this._TimeSpan:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HasTimeSpan",{get:function(){return this._Type===DurationType.TimeSpan},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsForever",{get:function(){return this._Type===DurationType.Forever},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsAutomatic",{get:function(){return this._Type===DurationType.Automatic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsZero",{get:function(){return this._Type===DurationType.TimeSpan&&0===this._TimeSpan.Ticks},enumerable:!0,configurable:!0}),e.Automatic=function(){var t=new e;return t._Type=DurationType.Automatic,t}(),e.Forever=function(){var t=new e;return t._Type=DurationType.Forever,t}(),e}();Fayde.CoreLibrary.addPrimitive(Duration),nullstone.registerTypeConverter(Duration,function(e){if(e instanceof Duration)return e;if(!e||"automatic"===e.toString().toLowerCase())return Duration.Automatic;if("forever"===e.toString().toLowerCase())return Duration.Forever;var t=nullstone.convertAnyToType(e,TimeSpan);return new Duration(t)});var FontFamily=function(){function e(e){this.FamilyNames=e}return e.prototype.toString=function(){return this.FamilyNames},e.prototype.Clone=function(){return new e(this.FamilyNames)},e}();Fayde.CoreLibrary.addPrimitive(FontFamily),nullstone.registerTypeConverter(FontFamily,function(e){return new FontFamily(e?e.toString():minerva.Font.DEFAULT_FAMILY)});var KeyTime=function(){function e(){this._IsPaced=!1,this._IsUniform=!1,this._TimeSpan=null,this._Percent=null,this.IsValid=!0}return e.CreateUniform=function(){var t=new e;return t._IsUniform=!0,t},e.CreateTimeSpan=function(t){var n=new e;return n._TimeSpan=t,n},e.prototype.Clone=function(){var t=new e;return t._TimeSpan=this._TimeSpan,t._IsPaced=this._IsPaced,t._IsUniform=this._IsUniform,t._Percent=this._Percent,t},Object.defineProperty(e.prototype,"IsPaced",{get:function(){return this._IsPaced},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsUniform",{get:function(){return this._IsUniform},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HasTimeSpan",{get:function(){return null!=this._TimeSpan},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeSpan",{get:function(){return this._TimeSpan},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HasPercent",{get:function(){return null!=this._Percent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Percent",{get:function(){return this._Percent},enumerable:!0,configurable:!0}),e}();Fayde.CoreLibrary.addPrimitive(KeyTime),nullstone.registerTypeConverter(KeyTime,function(e){if(!e||"uniform"===e.toString().toLowerCase())return KeyTime.CreateUniform();var t=nullstone.convertAnyToType(e,TimeSpan);return KeyTime.CreateTimeSpan(t)});var Length=function(){function e(){}return e}();Fayde.CoreLibrary.addPrimitive(Length),nullstone.registerTypeConverter(Length,function(e){return e&&"auto"!==e.toString().toLowerCase()?"number"==typeof e?e:parseFloat(e.toString()):Number.NaN});var Rect=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Clone=function(){return new t(this.x,this.y,this.width,this.height)},t}(minerva.Rect);Fayde.CoreLibrary.addPrimitive(Rect),nullstone.registerTypeConverter(Rect,function(e){if(!e)return new Rect;if(e instanceof Rect)return e;var t=Fayde.splitCommaList(e.toString());if(4===t.length)return new Rect(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]));throw new Error("Cannot parse Rect value '"+e+"'")});var Size=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Clone=function(){return new t(this.width,this.height)},t}(minerva.Size);Fayde.CoreLibrary.addPrimitive(Size),nullstone.registerTypeConverter(Size,function(e){if(!e)return new Size;if(e instanceof Size)return e;if(e instanceof minerva.Size)return new Size(e.width,e.height);var t=Fayde.splitCommaList(e.toString());if(2===t.length){var n=parseFloat(t[0]),r=parseFloat(t[1]);return new Size(n,r)}throw new Exception("Cannot parse Size value '"+e+"'")});var Thickness=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Clone=function(){return new t(this.left,this.top,this.right,this.bottom)},t.prototype.toString=function(){var e=this.left||0,t=this.top||0,n=this.right||0,r=this.bottom||0;return[e,t,n,r].join(",")},t}(minerva.Thickness);Fayde.CoreLibrary.addPrimitive(Thickness),nullstone.registerTypeConverter(Thickness,function(e){if(!e)return new Thickness;if("number"==typeof e)return new Thickness(e,e,e,e);if(e instanceof Thickness){var t=e;return new Thickness(t.left,t.top,t.right,t.bottom)}var n,r,o,i,a=Fayde.splitCommaList(e.toString());if(1===a.length)n=r=o=i=parseFloat(a[0]);else if(2===a.length)n=o=parseFloat(a[0]),r=i=parseFloat(a[1]);else{if(4!==a.length)throw new Exception("Cannot parse Thickness value '"+e+"'");n=parseFloat(a[0]),r=parseFloat(a[1]),o=parseFloat(a[2]),i=parseFloat(a[3])}return new Thickness(n,r,o,i)});var Fayde;!function(e){function t(e){for(var t=[],n=0,r=e.split(" ").join(",").split(",");n<r.length;n++){var o=r[n];o&&t.push(o)}return t}e.splitCommaList=t}(Fayde||(Fayde={}));var BError=function(){function e(){}return e.prototype.ThrowException=function(){var t;switch(this.Number){case e.Attach:t=new AttachException(this.Message,this.Data);break;case e.Argument:t=new ArgumentException(this.Message);break;case e.InvalidOperation:t=new InvalidOperationException(this.Message);break;case e.XamlParse:t=new XamlParseException(this.Message);break;default:t=new Exception(this.Message)}throw t},e.Argument=2,e.InvalidOperation=3,e.XamlParse=5,e.Attach=6,e}(),Fayde;!function(e){function t(e){var t=document.body.getAttribute("fayde-app");if(!t)return void console.warn("No application specified.");var r=document.getElementsByTagName("canvas")[0];r||document.body.appendChild(r=document.createElement("canvas")),n(t,r,e)}function n(t,n,r){function o(){perfex.phases.start("ResolveConfig"),e.LoadConfigJson(function(e,t){t&&console.warn("Could not load fayde configuration file.",t),i()})}function i(){perfex.phases.start("ResolveApp"),e.Application.GetAsync(t).then(a,s)}function a(t){perfex.phases.start("ResolveTheme"),c=e.Application.Current=t,e.ThemeManager.LoadAsync(c.ThemeName).then(u,s)}function s(e){console.error("An error occurred retrieving the application.",e)}function u(){perfex.phases.start("StartApp"),c.Attach(n),c.Start(),l()}function l(){r&&r(c),perfex.phases.start("Running")}var c;o()}e.Bootstrap=t}(Fayde||(Fayde={}));var Fayde;!function(e){function t(e){require(["text!"+r],function(t){return n(t,e)},function(t){return e(t)})}function n(e,t){var n;try{n=JSON.parse(e)}catch(r){return t(null,r)}n&&(o.configure(n.libs||{}),i.configure(n.themes||{}),a.configure(n.debug||{})),t(n)}var r="fayde.json";e.LoadConfigJson=t;var o;!function(t){function n(e){var t=[];for(var n in e)t.push(r(n,e[n]));for(var i=0;i<t.length;i++)o(t[i])}function r(e,t){return{name:e,path:t.path,base:t.base,deps:t.deps,exports:t.exports,useMin:t.useMin}}function o(t){var n=new e.Uri(t.name);"http"!==n.scheme&&(n=new e.Uri("lib://"+t.name));var r=e.TypeManager.resolveLibrary(n.toString());t.path&&(r.sourcePath=t.path),t.base&&(r.basePath=t.base),t.exports&&(r.exports=t.exports),t.deps&&(r.deps=t.deps),r.useMin=t.useMin===!0,r.$configModule()}t.configure=n}(o||(o={}));var i;!function(t){function n(t){for(var n in t){var r=t[n],o="none"===r?null:r.path?r.path:void 0;e.ThemeConfig.Set(n,o)}}t.configure=n}(i||(i={}));var a;!function(t){function n(t){r(t.warnMissingThemes)&&(e.Theme.WarnMissing=!0),r(t.warnBrokenPath)&&(e.Data.WarnBrokenPath=!0)}function r(e){return"true"===e||e===!0}t.configure=n}(a||(a={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){e.Debug=!1,e.DebugIndent=0}(t=e.Render||(e.Render={}));var n;!function(e){e.Debug=!1,e.DebugIndent=0}(n=e.Layout||(e.Layout={}));var r;!function(e){var t;!function(e){e.Log=!1,e.LogApply=!1}(t=e.Animation||(e.Animation={}));var n;!function(e){e.Debug=!1}(n=e.VSM||(e.VSM={}))}(r=e.Media||(e.Media={}));var o;!function(e){e.Debug=!1,e.IsCounterEnabled=!1,e.DataContextCounter=0}(o=e.Data||(e.Data={})),e.IsInspectionOn=!1}(Fayde||(Fayde={}));var NumberEx;!function(e){function t(e,t){if(e===t)return!0;var n=(Math.abs(e)+Math.abs(t)+i)*o,r=e-t;return r>-n&&n>r}function n(e,n){return e>n||!t(e,n)}function r(e,n){return e>n||!t(e,n)}var o=1.192093e-7,i=10;e.AreClose=t,e.IsLessThanClose=n,e.IsGreaterThanClose=r}(NumberEx||(NumberEx={}));var StringEx;!function(e){function t(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];arguments;return e.replace(/{(\d+)}/g,function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=parseInt(n[0]);return"undefined"!=typeof t[o]?t[o]:e})}e.Format=t}(StringEx||(StringEx={}));var TimelineProfile=function(){function e(){}return e.Parse=function(t,n){return t?void e._Events.push({Type:"Parse",Name:n,Time:(new Date).valueOf()}):e._FinishEvent("Parse",n)},e.Navigate=function(t,n){return t?void e._Events.push({Type:"Navigate",Name:n,Time:(new Date).valueOf()}):e._FinishEvent("Navigate",n)},e.LayoutPass=function(t){return e.IsNextLayoutPassProfiled?t?void e._Events.push({Type:"LayoutPass",Name:"",Time:(new Date).valueOf()}):(e.IsNextLayoutPassProfiled=!1,e._FinishEvent("LayoutPass")):void 0},e._FinishEvent=function(t,n){for(var r,o=e._Events,i=o.length,a=i-1;a>=0;a--){if(r=o[a],r.Type===t&&(!n||r.Name===n)){o.splice(a,1);break}r=null}r&&e.Groups.push({Type:r.Type,Data:r.Name,Start:r.Time-e.TimelineStart,Length:(new Date).valueOf()-r.Time})},e._Events=[],e.Groups=[],e.TimelineStart=0,e.IsNextLayoutPassProfiled=!0,e}();TimelineProfile.TimelineStart=(new Date).valueOf();var Fayde;!function(e){var t;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.XamlObjectCollection);t.DoubleCollection=n,e.CoreLibrary.add(n)}(t=e.Shapes||(e.Shapes={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,t){var n=e.XamlNode.LayoutUpdater;n.invalidateMeasure()}function r(e,t,n){return n instanceof Thickness?n.left:n}var o=minerva.shapes.shape.ShapeUpdater,i=function(i){function a(){i.call(this),e.FrameworkElement.WidthProperty.Store.ListenToChanged(this,e.FrameworkElement.WidthProperty,n,this),e.FrameworkElement.HeightProperty.Store.ListenToChanged(this,e.FrameworkElement.HeightProperty,n,this)}return __extends(a,i),a.prototype.CreateLayoutUpdater=function(){return new o},a.FillProperty=DependencyProperty.Register("Fill",function(){return e.Media.Brush},a),a.StretchProperty=DependencyProperty.Register("Stretch",function(){return new e.Enum(e.Media.Stretch)},a,e.Media.Stretch.None),a.StrokeProperty=DependencyProperty.Register("Stroke",function(){return e.Media.Brush},a),a.StrokeThicknessProperty=DependencyProperty.RegisterFull("StrokeThickness",function(){return Number},a,1,void 0,r),a.StrokeDashArrayProperty=DependencyProperty.Register("StrokeDashArray",function(){return t.DoubleCollection},a),a.StrokeDashCapProperty=DependencyProperty.Register("StrokeDashCap",function(){return new e.Enum(t.PenLineCap)},a,t.PenLineCap.Flat),a.StrokeDashOffsetProperty=DependencyProperty.Register("StrokeDashOffset",function(){return Number},a,0),a.StrokeEndLineCapProperty=DependencyProperty.Register("StrokeEndLineCap",function(){return new e.Enum(t.PenLineCap)},a,t.PenLineCap.Flat),a.StrokeLineJoinProperty=DependencyProperty.Register("StrokeLineJoin",function(){return new e.Enum(t.PenLineJoin)},a,t.PenLineJoin.Miter),a.StrokeMiterLimitProperty=DependencyProperty.Register("StrokeMiterLimit",function(){return Number},a,10),a.StrokeStartLineCapProperty=DependencyProperty.Register("StrokeStartLineCap",function(){return new e.Enum(t.PenLineCap)},a,t.PenLineCap.Flat),a}(e.FrameworkElement);t.Shape=i,e.CoreLibrary.add(i);var a;!function(t){e.UIReaction(i.StretchProperty,function(e,t,n){return e.invalidateMeasure()},!1),e.UIReaction(i.FillProperty,function(e,t,n){return e.invalidateNaturalBounds()}),e.UIReaction(i.StrokeProperty,function(e,t,n){return e.invalidateNaturalBounds()}),e.UIReaction(i.StrokeThicknessProperty,function(e,t,n){return e.invalidateNaturalBounds()},!1),e.UIReaction(i.StrokeDashArrayProperty,function(e,t,n){return e.invalidateNaturalBounds()}),e.UIReaction(i.StrokeDashCapProperty,function(e,t,n){return e.invalidateNaturalBounds()},!1),e.UIReaction(i.StrokeDashOffsetProperty,function(e,t,n){return e.invalidateNaturalBounds()},!1),e.UIReaction(i.StrokeEndLineCapProperty,function(e,t,n){return e.invalidateNaturalBounds()},!1),e.UIReaction(i.StrokeLineJoinProperty,function(e,t,n){return e.invalidateNaturalBounds()},!1),e.UIReaction(i.StrokeMiterLimitProperty,function(e,t,n){return e.invalidateNaturalBounds()},!1),e.UIReaction(i.StrokeStartLineCapProperty,function(e,t,n){return e.invalidateNaturalBounds()},!1)}(a||(a={}))}(t=e.Shapes||(e.Shapes={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=minerva.shapes.ellipse.EllipseUpdater,r=function(t){function r(){t.call(this),this.Stretch=e.Media.Stretch.Fill}return __extends(r,t),r.prototype.CreateLayoutUpdater=function(){return new n},r}(t.Shape);t.Ellipse=r,e.CoreLibrary.add(r)}(t=e.Shapes||(e.Shapes={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=minerva.shapes.line.LineUpdater,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.CreateLayoutUpdater=function(){return new n},t.X1Property=DependencyProperty.Register("X1",function(){return Number},t,0),t.Y1Property=DependencyProperty.Register("Y1",function(){return Number},t,0),t.X2Property=DependencyProperty.Register("X2",function(){return Number},t,0),t.Y2Property=DependencyProperty.Register("Y2",function(){return Number},t,0),t}(t.Shape);t.Line=r,e.CoreLibrary.add(r);var o;!function(t){e.UIReaction(r.X1Property,function(e,t,n){return e.invalidatePath()},!1),e.UIReaction(r.Y1Property,function(e,t,n){return e.invalidatePath()},!1),e.UIReaction(r.X2Property,function(e,t,n){return e.invalidatePath()},!1),e.UIReaction(r.Y2Property,function(e,t,n){return e.invalidatePath()},!1)}(o||(o={}))}(t=e.Shapes||(e.Shapes={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=minerva.shapes.path.PathUpdater,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype.CreateLayoutUpdater=function(){return new n},r._DataCoercer=function(t,n,r){return"string"==typeof r?e.Media.ParseGeometry(r):r},r.DataProperty=DependencyProperty.RegisterFull("Data",function(){return e.Media.Geometry},r,void 0,void 0,r._DataCoercer,void 0,void 0,!1),r}(t.Shape);t.Path=r,e.CoreLibrary.add(r);var o;!function(t){e.UIReaction(r.DataProperty,function(e,t,n){return e.invalidateNaturalBounds()})}(o||(o={}))}(t=e.Shapes||(e.Shapes={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function t(){this._ht=[]}return Object.defineProperty(t.prototype,"Count",{get:function(){return this._ht.length},enumerable:!0,configurable:!0}),t.FromData=function(n){var r=new t;return r._ht=r._ht.concat(e.Media.ParseShapePoints(n)),r},t.FromArray=function(e){var n=new t;return n._ht=n._ht.concat(e),n},t.prototype.GetValueAt=function(e){return this._ht[e]},t.prototype.SetValueAt=function(t,n){if(0>t||t>=this._ht.length)return!1;var r=(this._ht[t],n);this._ht[t]=r,e.Incite(this)},t.prototype.Add=function(t){this._ht.push(t),e.Incite(this)},t.prototype.AddRange=function(t){this._ht.push.apply(this._ht,t),e.Incite(this)},t.prototype.Insert=function(t,n){if(!(0>t)){var r=this._ht.length;t>r&&(t=r),this._ht.splice(t,0,n),e.Incite(this)}},t.prototype.Remove=function(t){var n=this.IndexOf(t);return-1===n?!1:(this.RemoveAt(n),e.Incite(this),!0)},t.prototype.RemoveAt=function(t){if(!(0>t||t>=this._ht.length)){this._ht.splice(t,1)[0];e.Incite(this)}},t.prototype.Clear=function(){this._ht=[],e.Incite(this)},t.prototype.IndexOf=function(e){for(var t=this._ht.length,n=0;t>n;n++)if(nullstone.equals(e,this._ht[n]))return n;return-1},t.prototype.Contains=function(e){return this.IndexOf(e)>-1},t.prototype.getEnumerator=function(e){return nullstone.IEnumerator_.fromArray(this._ht,e)},t}();t.PointCollection=n,e.CoreLibrary.add(n),nullstone.ICollection_.mark(n),nullstone.registerTypeConverter(n,function(t){var r=new n;return r.AddRange(e.Media.ParseShapePoints(t)),r})}(t=e.Shapes||(e.Shapes={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=minerva.shapes.polygon.PolygonUpdater,r=function(r){function o(){r.call(this),this.Points=new t.PointCollection}return __extends(o,r),o.prototype.CreateLayoutUpdater=function(){return new n},o._PointsCoercer=function(e,n,r){return"string"==typeof r&&(r=t.PointCollection.FromData(r)),r instanceof Array&&(r=t.PointCollection.FromArray(r)),r},o.FillRuleProperty=DependencyProperty.RegisterCore("FillRule",function(){return new e.Enum(t.FillRule)},o,t.FillRule.EvenOdd),o.PointsProperty=DependencyProperty.RegisterFull("Points",function(){return t.PointCollection},o,void 0,void 0,o._PointsCoercer),o}(t.Shape);t.Polygon=r,e.CoreLibrary.add(r);var o;!function(t){e.UIReaction(r.FillRuleProperty,function(e,t,n){return e.invalidateFillRule()},!1),e.UIReaction(r.PointsProperty,function(e,t,n){e.assets.points=n._ht,e.invalidatePath()},!0,!1)}(o||(o={}))}(t=e.Shapes||(e.Shapes={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=minerva.shapes.polyline.PolylineUpdater,r=function(r){function o(){r.call(this),this.Points=new t.PointCollection}return __extends(o,r),o.prototype.CreateLayoutUpdater=function(){return new n},o._PointsCoercer=function(e,n,r){return"string"==typeof r&&(r=t.PointCollection.FromData(r)),r instanceof Array&&(r=t.PointCollection.FromArray(r)),r},o.FillRuleProperty=DependencyProperty.RegisterCore("FillRule",function(){return new e.Enum(t.FillRule)},o,t.FillRule.EvenOdd),o.PointsProperty=DependencyProperty.RegisterFull("Points",function(){return t.PointCollection},o,void 0,void 0,o._PointsCoercer),o}(t.Shape);t.Polyline=r,e.CoreLibrary.add(r);var o;!function(t){e.UIReaction(r.FillRuleProperty,function(e,t,n){return e.invalidateFillRule()},!1),e.UIReaction(r.PointsProperty,function(e,t,n){e.assets.points=n._ht,e.invalidatePath()},!0,!1)}(o||(o={}))}(t=e.Shapes||(e.Shapes={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=minerva.shapes.rectangle.RectangleUpdater,r=function(t){function r(){t.call(this),this.Stretch=e.Media.Stretch.Fill}return __extends(r,t),r.prototype.CreateLayoutUpdater=function(){return new n},r.RadiusXProperty=DependencyProperty.Register("RadiusX",function(){return Number},r,0),r.RadiusYProperty=DependencyProperty.Register("RadiusY",function(){return Number},r,0),r}(t.Shape);t.Rectangle=r,e.CoreLibrary.add(r);var o;!function(t){e.UIReaction(r.RadiusXProperty,function(e,t,n){return e.invalidate()},!1),e.UIReaction(r.RadiusYProperty,function(e,t,n){return e.invalidate()},!1)}(o||(o={}))}(t=e.Shapes||(e.Shapes={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){function t(e,t,n){return e?e.slice(0,t)+e.slice(t+n):""}function n(e,t,n){return e?[e.slice(0,t),n,e.slice(t)].join(""):n}function r(e,t,n,r){return e?[e.slice(0,t),r,e.slice(t+n)].join(""):r}e.cut=t,e.insert=n,e.replace=r}(t=e.Buffer||(e.Buffer={}))}(t=e.Text||(e.Text={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){!function(e){e[e.NOTHING=0]="NOTHING",e[e.SELECTION=1]="SELECTION",e[e.TEXT=2]="TEXT"}(e.EmitChangedType||(e.EmitChangedType={}));var t=e.EmitChangedType,n=function(){function n(n,r){this.selAnchor=0,this.selCursor=0,this.selText="",this.text="",this.maxLength=0,this.acceptsReturn=!1,this.$$batch=0,this.$$emit=t.NOTHING,this.$$syncing=!1,this.$$eventsMask=n,this.$$history=new e.History.Tracker(r),this.SyncSelectionStart=function(e){},this.SyncSelectionLength=function(e){},this.SyncText=function(e){}}return n.prototype.setAnchorCursor=function(e,n){return this.selAnchor===e&&this.selCursor===n?!1:(this.SyncSelectionStart(Math.min(e,n)),this.SyncSelectionLength(Math.abs(n-e)),this.selAnchor=e,this.selCursor=n,this.$$emit|=t.SELECTION,!0)},n.prototype.enterText=function(n){var r=this.selAnchor,o=this.selCursor,i=Math.abs(o-r),a=Math.min(r,o);return this.maxLength>0&&this.text.length>=this.maxLength||"\r"===n&&!this.acceptsReturn?!1:(i>0?(this.$$history.replace(r,o,this.text,a,i,n),this.text=e.Buffer.replace(this.text,a,i,n)):(this.$$history.enter(r,o,a,n),this.text=e.Buffer.insert(this.text,a,n)),this.$$emit|=t.TEXT,o=a+1,r=o,this.setAnchorCursor(r,o))},n.prototype.removeText=function(n,r){return 0>=r?!1:(this.$$history["delete"](this.selAnchor,this.selCursor,this.text,n,r),this.text=e.Buffer.cut(this.text,n,r),this.$$emit|=t.TEXT,this.setAnchorCursor(n,n))},n.prototype.undo=function(){var e=this.$$history.undo(this);if(e){var n=e.SelectionAnchor,r=e.SelectionCursor;this.$$batch++,this.SyncSelectionStart(Math.min(n,r)),this.SyncSelectionLength(Math.abs(r-n)),this.$$emit=t.TEXT|t.SELECTION,this.selAnchor=n,this.selCursor=r,this.$$batch--,this.$syncEmit()}},n.prototype.redo=function(){var e=this.$$history.redo(this);if(null!=e){var n=e;this.$$batch++,this.SyncSelectionStart(Math.min(e,n)),this.SyncSelectionLength(Math.abs(n-e)),this.$$emit=t.TEXT|t.SELECTION,this.selAnchor=e,this.selCursor=n,this.$$batch--,this.$syncEmit()}},n.prototype.begin=function(){this.$$emit=t.NOTHING,this.$$batch++},n.prototype.end=function(){this.$$batch--,this.$syncEmit()},n.prototype.beginSelect=function(e){this.$$batch++,this.$$emit=t.NOTHING,this.SyncSelectionStart(e),this.SyncSelectionLength(0),this.$$batch--,this.$syncEmit()},n.prototype.adjustSelection=function(e){var n=this.selAnchor;this.$$batch++,this.$$emit=t.NOTHING,this.SyncSelectionStart(Math.min(n,e)),this.SyncSelectionLength(Math.abs(e-n)),this.selAnchor=n,this.selCursor=e,this.$$batch--,this.$syncEmit()},n.prototype.selectAll=function(){this.select(0,this.text.length)},n.prototype.clearSelection=function(e){this.$$batch++,this.SyncSelectionStart(e),this.SyncSelectionLength(0),this.$$batch--},n.prototype.select=function(e,t){return e=Math.min(Math.max(0,e),this.text.length),t=Math.min(Math.max(0,t),this.text.length-e),this.$$batch++,this.SyncSelectionStart(e),this.SyncSelectionLength(t),this.$$batch--,this.$syncEmit(),!0},n.prototype.setSelectionStart=function(e){var n=Math.abs(this.selCursor-this.selAnchor),r=e;if(r>this.text.length)return void this.SyncSelectionStart(this.text.length);r+n>this.text.length&&(this.$$batch++,n=this.text.length-r,this.SyncSelectionLength(n),this.$$batch--);this.selAnchor!==r;this.selCursor=r+n,this.selAnchor=r,this.$$emit|=t.SELECTION,this.$syncEmit()},n.prototype.setSelectionLength=function(e){var n=Math.min(this.selAnchor,this.selCursor),r=e;if(n+r>this.text.length)return r=this.text.length-n,void this.SyncSelectionLength(r);this.selCursor!==n+r;this.selCursor=n+r,this.selAnchor=n,this.$$emit|=t.SELECTION,this.$syncEmit()},n.prototype.setText=function(n){var r=n||"";this.$$syncing||(this.text.length>0?(this.$$history.replace(this.selAnchor,this.selCursor,this.text,0,this.text.length,r),this.text=e.Buffer.replace(this.text,0,this.text.length,r)):(this.$$history.insert(this.selAnchor,this.selCursor,0,r),this.text=r+this.text),this.$$emit|=t.TEXT,this.clearSelection(0),this.$syncEmit(!1))},n.prototype.$syncEmit=function(e){e=e!==!1,0===this.$$batch&&this.$$emit!==t.NOTHING&&(e&&this.$$emit&t.TEXT&&this.$syncText(),this.$$emit=t.NOTHING)},n.prototype.$syncText=function(){this.$$syncing=!0,this.SyncText(this.text),this.$$syncing=!1},n}();e.Proxy=n}(t=e.Text||(e.Text={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e,n,o,i){o&&i?(t.AddError(e,i),t.RemoveError(e,o),n.NotifyOnValidationError&&(r(e,new t.ValidationErrorEventArgs(t.ValidationErrorEventAction.Removed,o)),r(e,new t.ValidationErrorEventArgs(t.ValidationErrorEventAction.Added,i)))):o?(t.RemoveError(e,o),n.NotifyOnValidationError&&r(e,new t.ValidationErrorEventArgs(t.ValidationErrorEventAction.Removed,o))):i&&(t.AddError(e,i),n.NotifyOnValidationError&&r(e,new t.ValidationErrorEventArgs(t.ValidationErrorEventAction.Added,i)))}function r(t,n){n.OriginalSource=t;for(var r=t;r&&!n.Handled;r=e.VisualTreeHelper.GetParent(r))r instanceof e.FrameworkElement&&r.OnBindingValidationError(n)}t.Emit=n}(t=e.Validation||(e.Validation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(e){if(!e)throw new ArgumentNullException("element");var t=e.GetValue(p);return null==t&&(t=new u,e.SetValue(p,t)),t}function r(e){if(!e)throw new ArgumentNullException("element");var r=e.GetValue(t.ErrorsProperty);return null==r&&(r=new l(n(e)),e.SetValue(t.ErrorsProperty,r)),r}function o(e){if(null==e)throw new ArgumentNullException("element");return e.GetValue(t.HasErrorProperty)===!0}function i(e,n){e.SetValue(t.HasErrorProperty,n===!0)}function a(t,o){var a=n(t);
r(t),a.Add(o),1===a.Count&&i(t,!0),t instanceof e.Controls.Control&&t.UpdateValidationState(!1)}function s(t,o){var a=n(t);r(t),a.Remove(o)&&0===a.Count&&(i(t,!1),t instanceof e.Controls.Control&&t.UpdateValidationState(!0))}var u=e.Collections.ObservableCollection,l=e.Collections.ReadOnlyObservableCollection,c=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.DependencyObject);e.CoreLibrary.add(c,"Validation"),t.HasErrorProperty=DependencyProperty.RegisterAttached("HasError",function(){return Boolean},c),t.ErrorsProperty=DependencyProperty.RegisterAttached("Errors",function(){return l},c);var p=DependencyProperty.RegisterAttached("ErrorsCore",function(){return u},c);t.GetErrors=r,t.GetHasError=o,t.AddError=a,t.RemoveError=s}(t=e.Validation||(e.Validation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this.ErrorContent=e,this.Exception=t,this.PropertyName=n,this.Exception instanceof Exception&&(this.ErrorContent=this.ErrorContent||t.Message),this.Exception instanceof Error&&(this.ErrorContent=this.ErrorContent||t.message),Object.freeze(this)}return e}();e.ValidationError=t}(t=e.Validation||(e.Validation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){!function(e){e[e.Added=0]="Added",e[e.Removed=1]="Removed"}(e.ValidationErrorEventAction||(e.ValidationErrorEventAction={}));e.ValidationErrorEventAction}(t=e.Validation||(e.Validation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(e){function t(t,n){e.call(this),Object.defineProperties(this,{Action:{value:t,writable:!1},Error:{value:n,writable:!1}})}return __extends(t,e),t}(e.RoutedEventArgs);t.ValidationErrorEventArgs=n}(t=e.Validation||(e.Validation={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this.$textOwner=e}return e.prototype.CursorDown=function(e,t){return e},e.prototype.CursorUp=function(e,t){return e},e.prototype.CursorNextWord=function(e){return e},e.prototype.CursorPrevWord=function(e){return e},e.prototype.CursorNextChar=function(e){var t=this.$textOwner.text;return t&&"\r"===t.charAt(e)&&"\n"===t.charAt(e+1)?e+2:Math.min(t.length,e+1)},e.prototype.CursorPrevChar=function(e){var t=this.$textOwner.text;return e>=2&&t&&"\r"===t.charAt(e-2)&&"\n"===t.charAt(e-1)?e-2:Math.max(0,e-1)},e.prototype.CursorLineBegin=function(e){var t=this.$textOwner.text,n=t.lastIndexOf("\r",e),r=t.lastIndexOf("\n",e);return Math.max(n,r,0)},e.prototype.CursorLineEnd=function(e){var t=this.$textOwner.text,n=t.length,r=t.indexOf("\r",e);0>r&&(r=n);var o=t.indexOf("\n",e);return 0>o&&(o=n),Math.min(r,o)},e.prototype.CursorBegin=function(e){return 0},e.prototype.CursorEnd=function(e){return this.$textOwner.text.length},e}();e.TextBoxCursorAdvancer=t;var n=function(){function e(e){this.$textOwner=e}return e.prototype.CursorDown=function(e,t){return this.CursorEnd(e)},e.prototype.CursorUp=function(e,t){return this.CursorBegin(e)},e.prototype.CursorNextWord=function(e){return this.CursorEnd(e)},e.prototype.CursorPrevWord=function(e){return this.CursorBegin(e)},e.prototype.CursorNextChar=function(e){var t=this.$textOwner.text;return t&&"\r"===t.charAt(e)&&"\n"===t.charAt(e+1)?e+2:Math.min(t.length-1,e+1)},e.prototype.CursorPrevChar=function(e){var t=this.$textOwner.text;return e>=2&&t&&"\r"===t.charAt(e-2)&&"\n"===t.charAt(e-1)?e-2:Math.max(0,e-1)},e.prototype.CursorLineBegin=function(e){return this.CursorBegin(e)},e.prototype.CursorLineEnd=function(e){return this.CursorEnd(e)},e.prototype.CursorBegin=function(e){return this.$textOwner.text.length},e.prototype.CursorEnd=function(e){return 0},e}();e.PasswordBoxCursorAdvancer=n}(t=e.Internal||(e.Internal={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(e){this.Owner=e,this._Items=[],this._Containers=[],this._Cache=[]}return Object.defineProperty(n.prototype,"IsRecycling",{get:function(){var n=this.Owner;return n instanceof e.DependencyObject?t.VirtualizingPanel.GetVirtualizationMode(n)===t.VirtualizationMode.Recycling:!1},enumerable:!0,configurable:!0}),n.prototype.IndexFromContainer=function(e){return this._Containers.indexOf(e)},n.prototype.ContainerFromIndex=function(e){return this._Containers[e]},n.prototype.ItemFromContainer=function(e){var t=this._Containers.indexOf(e);return 0>t?null:this._Items[t]},n.prototype.ContainerFromItem=function(e){if(null==e)return null;var t=this._Items.indexOf(e);return 0>t?null:this._Containers[t]},n.prototype.OnItemsAdded=function(e,t){for(var n=this._Items,r=this._Containers,o=0,i=t.length;i>o;o++)n.splice(e+o,0,t[o]),r.splice(e+o,0,null)},n.prototype.OnItemsRemoved=function(e,t){this.DisposeContainers(e,t.length),this._Items.splice(e,t.length),this._Containers.splice(e,t.length)},n.prototype.DisposeContainers=function(e,t){var n=this._Containers,r=this._Items;if(null==e&&(e=0),null==t&&(t=n.length),this.IsRecycling)for(var o=0,i=this._Cache,a=n.slice(e,e+t),s=a.length;s>o;o++){var u=a[o];u&&i.push(u)}for(var l=[],c=this.Owner,o=e;e+t>o;o++){var u=n[o];if(u){l.push(u);var p=r[o];c.ClearContainerForItem(u,p),n[o]=null}}return l},n.prototype.CreateGenerator=function(t,n){var r={IsCurrentNew:!1,Current:void 0,CurrentItem:void 0,CurrentIndex:t-1,GenerateIndex:-1,Generate:function(){return!1}},o=this.Owner,i=this._Containers,a=this._Items,s=this._Cache;return r.Generate=function(){return r.GenerateIndex++,r.CurrentIndex++,r.IsCurrentNew=!1,r.CurrentIndex<0||r.GenerateIndex>=n||r.CurrentIndex>=i.length?(r.Current=void 0,r.CurrentItem=void 0,!1):(r.CurrentItem=a[r.CurrentIndex],null==(r.Current=i[r.CurrentIndex])&&(o.IsItemItsOwnContainer(r.CurrentItem)?(r.CurrentItem instanceof e.UIElement&&(r.Current=r.CurrentItem),r.IsCurrentNew=!0):s.length>0?(r.Current=s.pop(),r.IsCurrentNew=!0):(r.Current=o.GetContainerForItem(),r.IsCurrentNew=!0),i[r.CurrentIndex]=r.Current),!0)},r},n.prototype.GetEnumerator=function(e,t){var n=this._Containers,r=this._Items,o=(e||0)-1,i=null==t?n.length:t,a=0,s={moveNext:void 0,current:void 0,CurrentItem:void 0,CurrentIndex:-1};return s.moveNext=function(){return a++,o++,s.CurrentIndex=o,a>i||o>=n.length?(s.current=void 0,s.CurrentItem=void 0,!1):(s.current=n[o],s.CurrentItem=r[o],!0)},s},n}();n.ItemContainersManager=r}(n=t.Internal||(t.Internal={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this.Range=e,this.OnCoerceMaximum=t,this.OnCoerceValue=n,this.InitialMax=1,this.InitialVal=0,this.RequestedMax=1,this.RequestedVal=0,this.PreCoercedMax=1,this.PreCoercedVal=0,this.CoerceDepth=0,this.PreCoercedMax=this.RequestedMax=this.InitialMax=e.Maximum,this.PreCoercedVal=this.RequestedVal=this.InitialVal=e.Value}return Object.defineProperty(e.prototype,"Minimum",{get:function(){return this.Range.Minimum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Maximum",{get:function(){return this.Range.Maximum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Value",{get:function(){return this.Range.Value},enumerable:!0,configurable:!0}),e.prototype.OnMinimumChanged=function(e,t){if(0===this.CoerceDepth&&(this.InitialMax=this.Maximum,this.InitialVal=this.Value),this.CoerceDepth++,this.CoerceMaximum(),this.CoerceValue(),this.CoerceDepth--,!(this.CoerceDepth>0)){this.Range.OnMinimumChanged(e,t);var n=this.Maximum;NumberEx.AreClose(this.InitialMax,n)||this.Range.OnMaximumChanged(this.InitialMax,n);var r=this.Value;NumberEx.AreClose(this.InitialVal,r)||this.Range.OnValueChanged(this.InitialVal,r)}},e.prototype.OnMaximumChanged=function(e,t){if(0===this.CoerceDepth&&(this.RequestedMax=t,this.InitialMax=e,this.InitialVal=this.Value),this.CoerceDepth++,this.CoerceMaximum(),this.CoerceValue(),this.CoerceDepth--,0===this.CoerceDepth){this.PreCoercedMax=t;var n=this.Maximum;NumberEx.AreClose(this.InitialMax,n)||this.Range.OnMaximumChanged(this.InitialMax,n);var r=this.Value;NumberEx.AreClose(this.InitialVal,r)||this.Range.OnValueChanged(this.InitialVal,r)}},e.prototype.OnValueChanged=function(e,t){if(0===this.CoerceDepth&&(this.RequestedVal=t,this.InitialVal=e),this.CoerceDepth++,this.CoerceValue(),this.CoerceDepth--,0===this.CoerceDepth){this.PreCoercedVal=t;var n=this.Value;NumberEx.AreClose(this.InitialVal,n)||this.Range.OnValueChanged(this.InitialVal,n)}},e.prototype.CoerceMaximum=function(){var e=this.Minimum,t=this.Maximum;!NumberEx.AreClose(this.RequestedMax,t)&&this.RequestedMax>=e?this.OnCoerceMaximum(this.RequestedMax):e>t&&this.OnCoerceMaximum(e)},e.prototype.CoerceValue=function(){var e=this.Minimum,t=this.Maximum,n=this.Value;!NumberEx.AreClose(this.RequestedVal,n)&&this.RequestedVal>=e&&this.RequestedVal<=t?this.OnCoerceValue(this.RequestedVal):e>n?this.OnCoerceValue(e):n>t&&this.OnCoerceValue(t)},e}();e.RangeCoercer=t}(t=e.Internal||(e.Internal={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){this.$$element=null}return t.prototype.setElement=function(t,n){this.$$element=t,t&&(t instanceof e.ContentPresenter?t.SetValue(e.ContentPresenter.ContentProperty,n):t instanceof e.ContentControl?t.SetValue(e.ContentControl.ContentProperty,n):t instanceof e.Border?t.SetValue(e.Border.ChildProperty,n):t instanceof e.Panel?t.Children.Add(n):console.warn("TextBox does not have a valid content element."))},t.prototype.setHorizontalScrollBar=function(e){var t=this.$$element;if(t){var n=t.constructor,r=DependencyProperty.GetDependencyProperty(n,"HorizontalScrollBarVisibility",!0);r&&t.SetValueInternal(r,e)}},t.prototype.setVerticalScrollBar=function(e){var t=this.$$element;if(t){var n=t.constructor,r=DependencyProperty.GetDependencyProperty(n,"VerticalScrollBarVisibility",!0);r&&t.SetValueInternal(r,e)}},t}();t.TextBoxContentProxy=n}(t=e.Internal||(e.Internal={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=minerva.controls.textboxview.TextBoxViewUpdater,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.FENode);t.TextBoxViewNode=r;var o=function(t){function r(){t.call(this),this._AutoRun=new e.Documents.Run,this.XamlNode.LayoutUpdater.tree.onTextAttached(this._AutoRun.TextUpdater),e.ReactTo(this._AutoRun,this,this._InlineChanged)}return __extends(r,t),r.prototype.CreateLayoutUpdater=function(){return new n},r.prototype._InlineChanged=function(e){var t=this.XamlNode.LayoutUpdater;switch(e.type){case"font":t.invalidateFont(e.full);break;case"text":t.invalidateTextMetrics()}},r.prototype.setFontProperty=function(e,t){this._AutoRun.SetValue(e,t)},r.prototype.setFontAttr=function(e,t){var n=this._AutoRun,r=n.TextUpdater;r.assets[e]=t},r.prototype.setCaretBrush=function(e){var t=this.XamlNode.LayoutUpdater;t.assets.caretBrush=e,t.invalidateCaret()},r.prototype.setIsFocused=function(e){var t=this.XamlNode.LayoutUpdater;t.assets.isFocused!==e&&(t.assets.isFocused=e,t.resetCaretBlinker(!1))},r.prototype.setIsReadOnly=function(e){var t=this.XamlNode.LayoutUpdater;t.assets.isReadOnly!==e&&(t.assets.isReadOnly=e,t.resetCaretBlinker(!1))},r.prototype.setTextAlignment=function(e){var t=this.XamlNode.LayoutUpdater;t.assets.textAlignment!==e&&(t.assets.textAlignment=e,t.invalidateMeasure(),t.updateBounds(!0),t.invalidate())},r.prototype.setTextWrapping=function(e){var t=this.XamlNode.LayoutUpdater;t.assets.textWrapping!==e&&(t.assets.textWrapping=e,t.invalidateMeasure(),t.updateBounds(!0),t.invalidate())},r.prototype.setSelectionStart=function(e){var t=this.XamlNode.LayoutUpdater;t.assets.selectionStart!==e&&(t.assets.selectionStart=e,t.invalidateSelectionStart())},r.prototype.setSelectionLength=function(e){var t=this.XamlNode.LayoutUpdater;if(t.assets.selectionLength!==e){var n=0===t.assets.selectionLength!=(0===e);t.assets.selectionLength=e,t.invalidateSelectionLength(n)}},r.prototype.setText=function(e){this._AutoRun.Text=e||""},r.prototype.GetCursorFromPoint=function(e){return this.XamlNode.LayoutUpdater.getCursorFromPoint(e)},r}(e.FrameworkElement);t.TextBoxView=o,e.RegisterType(o,e.XMLNSINTERNAL)}(n=t.Internal||(t.Internal={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){var t={current:void 0,generate:function(){return!1}},n=function(){function e(e){this.$$panel=e}return Object.defineProperty(e.prototype,"itemCount",{get:function(){var e=this.$$panel,t=e?e.ItemsControl:null;return t?t.Items.Count:0},enumerable:!0,configurable:!0}),e.prototype.createGenerator=function(e,n){var r=this.$$panel,o=r?r.ItemsControl:null,i=o?o.ItemContainersManager:null;if(!i)return t;var a=i.CreateGenerator(e,n),s=r.Children;return{current:void 0,generate:function(){if(this.current=void 0,!a.Generate())return!1;var e=a.Current;return a.IsCurrentNew&&(s.Insert(a.GenerateIndex,e),o.PrepareContainerForItem(e,a.CurrentItem)),this.current=e.XamlNode.LayoutUpdater,!0}}},e.prototype.remove=function(e,t){var n=this.$$panel,r=n?n.ItemsControl:null,o=r?r.ItemContainersManager:null;if(o)for(var i=o.DisposeContainers(e,t),a=n.Children,s=0,u=i.length;u>s;s++)a.Remove(i[s])},e}();e.VirtualizingPanelContainerOwner=n}(t=e.Internal||(e.Internal={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function t(t,n,r){e.call(this),Object.defineProperty(this,"HorizontalChange",{value:t,writable:!1}),Object.defineProperty(this,"VerticalChange",{value:n,writable:!1}),Object.defineProperty(this,"Canceled",{value:r,writable:!1})}return __extends(t,e),t}(e.RoutedEventArgs);t.DragCompletedEventArgs=n,e.CoreLibrary.add(n);var r=function(e){function t(t,n){e.call(this),Object.defineProperty(this,"HorizontalChange",{value:t,writable:!1}),Object.defineProperty(this,"VerticalChange",{value:n,writable:!1})}return __extends(t,e),t}(e.RoutedEventArgs);t.DragDeltaEventArgs=r,e.CoreLibrary.add(r);var o=function(e){function t(t,n){e.call(this),Object.defineProperty(this,"HorizontalOffset",{value:t,writable:!1}),Object.defineProperty(this,"VerticalOffset",{value:n,writable:!1})}return __extends(t,e),t}(e.RoutedEventArgs);t.DragStartedEventArgs=o,e.CoreLibrary.add(o)}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=minerva.controls.overlay.OverlayUpdater,o="#33000000",i=function(n){function r(){n.apply(this,arguments),this._Layer=null,this._Mask=null}return __extends(r,n),r.prototype.EnsureLayer=function(){return this._Layer||(this._Layer=new t.Panel,this.LayoutUpdater.setLayer(this._Layer.XamlNode.LayoutUpdater)),this._Layer},r.prototype.EnsureMask=function(){return this._Mask||(this._Mask=new t.Border,this._Mask.MouseLeftButtonDown.on(this._OnMaskMouseDown,this),this.UpdateMask()),this._Mask},r.prototype._OnMaskMouseDown=function(e,t){this.XObject.SetCurrentValue(a.IsOpenProperty,!1)},r.prototype.UpdateMask=function(){var t=this._Mask;if(t){var n=this.XObject.MaskBrush;void 0===n&&(n=nullstone.convertAnyToType(o,e.Media.Brush)),this._Mask.Background=n}},r.prototype.OnIsAttachedChanged=function(e){n.prototype.OnIsAttachedChanged.call(this,e),this.RegisterInitiator(this.VisualParentNode.XObject),e&&this.EnsureLayer().Children.Insert(0,this.EnsureMask()),!e&&this.XObject.IsOpen&&(this.XObject.IsOpen=!1)},r.prototype.RegisterInitiator=function(t){t instanceof e.UIElement&&this.LayoutUpdater.setInitiator(t.XamlNode.LayoutUpdater)},r}(e.FENode);n.OverlayNode=i;var a=function(o){function a(){o.call(this),this.Opened=new nullstone.Event,this.Closed=new nullstone.Event,this._ContentControlForUri=null,this._IgnoreClose=!1,this.DefaultStyleKey=a,this.InitBindings()}return __extends(a,o),a.prototype.CreateNode=function(){return new i(this)},a.prototype.CreateLayoutUpdater=function(){return new r},a.prototype.InitBindings=function(){this.SetBinding(a.VisualViewModelProperty,new e.Data.Binding("OverlayDataContext"));var t=new e.Data.Binding("IsOpen");t.Mode=e.Data.BindingMode.TwoWay,this.SetBinding(a.IsOpenProperty,t),this.SetBinding(a.ClosedCommandProperty,new e.Data.Binding("ClosedCommand"))},a.prototype._OnVisualChanged=function(e){if(null!=this.VisualUri)throw new Error("Cannot set Visual if VisualUri is set.");var t=this.XamlNode.EnsureLayer();e.OldValue&&t.Children.Remove(e.OldValue),e.NewValue&&t.Children.Add(e.NewValue)},a.prototype._OnVisualUriChanged=function(e){if(null!=this.Visual)throw new Error("Cannot set VisualUri if Visual is set.");e.NewValue?this._SetVisualUri(e.NewValue):this._ClearVisualUri()},a.prototype._OnVisualViewModelChanged=function(e){var t,n;(t=this._ContentControlForUri)?t.DataContext=e.NewValue:(n=this.Visual)&&(n.DataContext=e.NewValue)},a.prototype._SetVisualUri=function(e){var n=this._ContentControlForUri;if(!n){var r=this.XamlNode.EnsureLayer();n=this._ContentControlForUri=new t.ContentControl,n.SetValue(u,this),r.Children.Add(n)}n.ContentUri=e;var o=this.VisualViewModel;void 0!==o&&(n.DataContext=o)},a.prototype._ClearVisualUri=function(){var e=this._ContentControlForUri;if(e){var t=this.XamlNode.EnsureLayer();t.Children.Remove(e),e.ContentUri=null,e.DataContext=void 0}},a.prototype._OnIsOpenChanged=function(e){var t=e.OldValue||!1,n=e.NewValue||!1;t!==n&&(n===!0?this._DoOpen():this._DoClose())},a.prototype._DoOpen=function(){var e=this.XamlNode.LayoutUpdater;minerva.controls.overlay.reactTo.isOpen(e,!1,!0),this.Opened.raise(this,null)},a.prototype._DoClose=function(e){var t=this.XamlNode.LayoutUpdater;minerva.controls.overlay.reactTo.isOpen(t,!0,!1),void 0===e&&(e=this._GetDialogResult());var r={Result:e,Data:this.VisualViewModel},o=this.ClosedCommand;!o||o.CanExecute&&!o.CanExecute(r)||o.Execute(r),this.Closed.raise(this,new n.OverlayClosedEventArgs(r.Result,r.Data))},a.prototype.Open=function(){this.IsOpen=!0},a.prototype.Close=function(e){if(this.IsOpen===!0){this._IgnoreClose=!0;try{this.SetCurrentValue(a.IsOpenProperty,!1)}finally{this._IgnoreClose=!1}this._DoClose(e)}},a.prototype._GetDialogResult=function(){var n=this.Visual||this._ContentControlForUri;if(!n)return void 0;var r=e.VisualTreeHelper.GetChildrenCount(n)>0?e.VisualTreeHelper.GetChild(n,0):null;return r instanceof t.Dialog?r.DialogResult:null},a.FindOverlay=function(t){for(var n=e.VisualTreeEnum.GetAncestors(t).getEnumerator();n.moveNext();){var r=n.current.GetValue(u);if(r instanceof a)return r}return void 0},a.VisualProperty=DependencyProperty.Register("Visual",function(){return e.UIElement},a,void 0,function(e,t){return e._OnVisualChanged(t)}),a.VisualUriProperty=DependencyProperty.Register("VisualUri",function(){return e.Uri},a,void 0,function(e,t){return e._OnVisualUriChanged(t)}),a.VisualViewModelProperty=DependencyProperty.Register("VisualViewModel",function(){return Object},a,void 0,function(e,t){return e._OnVisualViewModelChanged(t)}),a.IsOpenProperty=DependencyProperty.Register("IsOpen",function(){return Boolean},a,void 0,function(e,t){return e._OnIsOpenChanged(t)}),a.MaskBrushProperty=DependencyProperty.Register("MaskBrush",function(){return e.Media.Brush},a),a.ClosedCommandProperty=DependencyProperty.Register("ClosedCommand",function(){return e.Input.ICommand_},a),a}(e.FrameworkElement);n.Overlay=a,e.CoreLibrary.add(a),e.Markup.Content(a,a.VisualProperty);var s;!function(t){e.DPReaction(a.MaskBrushProperty,function(e,t,n){e.XamlNode.UpdateMask()})}(s||(s={}));var u=DependencyProperty.RegisterAttached("OverlayOwner",function(){return a},a)}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t){Object.defineProperties(this,{Result:{value:e,writable:!1},Data:{value:t,writable:!1}})}return e}();e.OverlayClosedEventArgs=t}(t=e.Primitives||(e.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){this.canHorizontallyScroll=!1,this.canVerticallyScroll=!1,this.offsetX=0,this.offsetY=0,this.cachedOffsetX=0,this.cachedOffsetY=0,this.viewportWidth=0,this.viewportHeight=0,this.extentWidth=0,this.extentHeight=0,this.maxDesiredWidth=0,this.maxDesiredHeight=0,this.scrollOwner=null}return e.prototype.invalidate=function(){this.scrollOwner&&this.scrollOwner.InvalidateScrollInfo()},e}();e.ScrollData=t}(t=e.Primitives||(e.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){!function(e){e[e.SmallDecrement=0]="SmallDecrement",e[e.SmallIncrement=1]="SmallIncrement",e[e.LargeDecrement=2]="LargeDecrement",e[e.LargeIncrement=3]="LargeIncrement",e[e.ThumbPosition=4]="ThumbPosition",e[e.ThumbTrack=5]="ThumbTrack",e[e.First=6]="First",e[e.Last=7]="Last",e[e.EndScroll=8]="EndScroll"}(t.ScrollEventType||(t.ScrollEventType={}));var n=t.ScrollEventType;e.CoreLibrary.addEnum(n,"ScrollEventType");var r=function(e){function t(t,n){e.call(this),Object.defineProperty(this,"ScrollEventType",{value:t,writable:!1}),Object.defineProperty(this,"Value",{value:n,writable:!1})}return __extends(t,e),t}(e.RoutedEventArgs);t.ScrollEventArgs=r,e.CoreLibrary.add(r)}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function t(t,n){e.call(this),Object.defineProperty(this,"OldValues",{value:t.slice(0),writable:!1}),Object.defineProperty(this,"NewValues",{value:n.slice(0),writable:!1})}return __extends(t,e),t}(e.RoutedEventArgs);t.SelectionChangedEventArgs=n,e.CoreLibrary.add(n)}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){function r(e,t){for(var n,r=[],o=0,i=e.length;i>o;o++)n=e[o],t.indexOf(n)<0&&r.push(n);return r}var o=function(){function n(e){this._SelectedItems=[],this._SelectedItem=null,this._IsUpdating=!1,this._AnchorIndex=-1,this.Mode=t.SelectionMode.Single,this._Owner=e,this._Owner.SelectedItems.CollectionChanged.on(this._HandleOwnerSelectionChanged,this)}return Object.defineProperty(n.prototype,"IsUpdating",{get:function(){return this._IsUpdating},enumerable:!0,configurable:!0}),n.prototype._HandleOwnerSelectionChanged=function(n,r){if(!this._IsUpdating){if(this.Mode===t.SelectionMode.Single)throw new InvalidOperationException("SelectedItems cannot be modified directly when in Single select mode");try{var o=this._SelectedItems;switch(this._IsUpdating=!0,r.Action){case e.Collections.CollectionChangedAction.Add:o.indexOf(r.NewItems[0])<0&&this.AddToSelected(r.NewItems[0]);break;case e.Collections.CollectionChangedAction.Remove:o.indexOf(r.OldItems[0])>-1&&this.RemoveFromSelected(r.OldItems[0]);break;case e.Collections.CollectionChangedAction.Replace:o.indexOf(r.OldItems[0])>-1&&this.RemoveFromSelected(r.OldItems[0]),o.indexOf(r.NewItems[0])<0&&this.AddToSelected(r.NewItems[0]);break;case e.Collections.CollectionChangedAction.Reset:for(var i,a=this._Owner.SelectedItems,s=a.getEnumerator();s.moveNext();)i=s.current,a.Contains(i)||o.indexOf(i)>-1&&this.RemoveFromSelected(i);for(s=a.getEnumerator();s.moveNext();)i=s.current,o.indexOf(i)<0&&this.AddToSelected(i)}this._Owner._SelectedItemsIsInvalid=!0}finally{this._IsUpdating=!1}}},n.prototype.RepopulateSelectedItems=function(){if(!this._IsUpdating)try{this._IsUpdating=!0;var e=this._Owner.SelectedItems;e.Clear(),e.AddRange(this._SelectedItems)}finally{this._IsUpdating=!1}},n.prototype.ClearSelection=function(e){if(void 0===e&&(e=!1),0===this._SelectedItems.length)return void this.UpdateSelectorProperties(null,-1,e?this._Owner.SelectedValue:null);try{this._IsUpdating=!0;var t=this._SelectedItems.slice(0);this._SelectedItems=[],this._SelectedItem=null,this.UpdateSelectorProperties(null,-1,e?this._Owner.SelectedValue:null),this._Owner._SelectedItemsIsInvalid=!0,this._Owner._RaiseSelectionChanged(t,[])}finally{this._IsUpdating=!1}},n.prototype.Select=function(e){if(this._Owner.Items.Contains(e)){var n=this._SelectedItems.indexOf(e);try{switch(this._IsUpdating=!0,this.Mode){case t.SelectionMode.Single:return this._SelectSingle(e,n);case t.SelectionMode.Extended:return this._SelectExtended(e,n);case t.SelectionMode.Multiple:return this._SelectMultiple(e,n);default:throw new NotSupportedException("SelectionMode "+this.Mode+" is not supported.")}}finally{this._IsUpdating=!1}}},n.prototype._SelectSingle=function(e,t){return-1===t?this.ReplaceSelection(e):void 0},n.prototype._SelectExtended=function(t,n){this._Owner.Items.IndexOf(t);if(e.Input.Keyboard.HasShift()){var r=this._Owner.Items,o=this._AnchorIndex;-1===o&&(o=r.IndexOf(this._SelectedItem)),o=Math.max(o,0);var i=r.IndexOf(t);return this.SelectRange(Math.min(o,i),Math.max(o,i))}return this._AnchorIndex=n,e.Input.Keyboard.HasControl()?n>-1?this.RemoveFromSelected(t):this.AddToSelected(t):this.ReplaceSelection(t)},n.prototype._SelectMultiple=function(e,t){return t>-1?this.RemoveFromSelected(e):this.AddToSelected(e)},n.prototype.SelectRange=function(e,t){var n=this._Owner.Items,o=this._SelectedItems;this._SelectedItems=n.GetRange(e,t);var i=r(o,this._SelectedItems),a=r(this._SelectedItems,o);-1===this._SelectedItems.indexOf(this._SelectedItem)&&(this._SelectedItem=this._SelectedItems[0],this.UpdateSelectorProperties(this._SelectedItem,null==this._SelectedItem?-1:n.IndexOf(this._SelectedItem),this._Owner._GetValueFromItem(this._SelectedItem))),this._Owner._SelectedItemsIsInvalid=!0,this._Owner._RaiseSelectionChanged(i,a)},n.prototype.SelectAll=function(e){try{if(this._IsUpdating=!0,this.Mode===t.SelectionMode.Single)throw new NotSupportedException("Cannot call SelectAll when in Single select mode");var n=this._SelectedItems,o=r(e,n);if(0===o.length)return;var i=this._Owner;n.push(o),null==this._SelectedItem&&(this._SelectedItem=o[0],this.UpdateSelectorProperties(this._SelectedItem,i.Items.IndexOf(this._SelectedItem),i._GetValueFromItem(this._SelectedItem))),i._SelectedItemsIsInvalid=!0,i._RaiseSelectionChanged([],o)}finally{this._IsUpdating=!1}},n.prototype.SelectOnly=function(e){if(this._SelectedItem!==e||1!==this._SelectedItems.length)try{this._IsUpdating=!0,this.ReplaceSelection(e)}finally{this._IsUpdating=!1}},n.prototype.Unselect=function(e){if(!(this._SelectedItems.indexOf(e)<0))try{this._IsUpdating=!0,this.RemoveFromSelected(e)}finally{this._IsUpdating=!1}},n.prototype.AddToSelected=function(e){this._SelectedItems.push(e);var t=this._Owner;1===this._SelectedItems.length&&(this._SelectedItem=e,this.UpdateSelectorProperties(e,t.Items.IndexOf(e),t._GetValueFromItem(e))),t._SelectedItemsIsInvalid=!0,t._RaiseSelectionChanged([],[e])},n.prototype.RemoveFromSelected=function(e){var t=this._SelectedItems,n=t.indexOf(e);n>-1&&t.splice(n,1);var r=this._Owner;if(this._SelectedItem===e){var o=t[0];this._SelectedItem=o,this.UpdateSelectorProperties(o,null==o?-1:r.Items.IndexOf(o),r._GetValueFromItem(e))}r._SelectedItemsIsInvalid=!0,r._RaiseSelectionChanged([e],[])},n.prototype.ReplaceSelection=function(e){var t=this._Owner;if(!this.UpdateCollectionView(e))return void this.UpdateSelectorProperties(this._SelectedItem,t.Items.IndexOf(this._SelectedItem),t._GetValueFromItem(this._SelectedItem));var n=this._SelectedItems.slice(0),r=[],o=n.indexOf(e);o>-1?n.splice(o,1):r.push(e),this._SelectedItems=[e],this._SelectedItem=e,this.UpdateSelectorProperties(e,t.Items.IndexOf(e),t._GetValueFromItem(e)),(0!==r.length||0!==n.length)&&(t._SelectedItemsIsInvalid=!0,t._RaiseSelectionChanged(n,r))},n.prototype.UpdateSelectorProperties=function(e,t,n){var r=this._Owner;r.SelectedItem!==e&&(r.SelectedItem=e),r.SelectedIndex!==t&&(r.SelectedIndex=t),r.SelectedValue!==n&&(r.SelectedValue=n),this.UpdateCollectionView(e)},n.prototype.UpdateCollectionView=function(t){var n=e.Data.ICollectionView_.as(this._Owner.ItemsSource);return n?(n.MoveCurrentTo(t),t===n.CurrentItem):!0},n}();n.SelectorSelection=o,e.CoreLibrary.add(o)}(n=t.Primitives||(t.Primitives={}))}(t=e.Controls||(e.Controls={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(t,n){var u=[];if(0!=(n&s.Theme)&&(u[a.Theme]=r(t)),0!=(n&s.ApplicationResources)){var l=e.Application.Current;l&&(u[a.ApplicationResources]=o(l,t))}return 0!=(n&s.VisualTree)&&(u[a.VisualTree]=i(t)),u}function r(t){if(t instanceof e.Controls.Control){var n=t.GetDefaultStyle();if(n)return n}return e.ThemeManager.FindStyle(t.DefaultStyleKey)}function o(e,t){return e.Resources.Get(t.DefaultStyleKey)}function i(t){for(var n,r=t.DefaultStyleKey,o=t,i=o instanceof e.Controls.Control,a=t.XamlNode;a;)if(o=a.XObject,!o.TemplateOwner||t.TemplateOwner){if(!i&&o===t.TemplateOwner)break;if(n=o.Resources){var s=n.Get(r);if(s)return s}a=a.VisualParentNode}else o=o.TemplateOwner,a=o.XamlNode;return void 0}!function(e){e[e.VisualTree=0]="VisualTree",e[e.ApplicationResources=1]="ApplicationResources",e[e.Theme=2]="Theme",e[e.Count=3]="Count"}(t.StyleIndex||(t.StyleIndex={}));var a=t.StyleIndex;!function(e){e[e.None=0]="None",e[e.VisualTree=1]="VisualTree",e[e.ApplicationResources=2]="ApplicationResources",e[e.Theme=4]="Theme",e[e.All=7]="All"}(t.StyleMask||(t.StyleMask={}));var s=t.StyleMask,u=function(){function r(){}return r.Set=function(e,t,o){if(o||(o=n(e,t)),o)for(var i=new BError,s=a.Count,u=0;s>u;u++){var l=o[u];if(l&&!l.Validate(e,i))return void i.ThrowException()}r.SetImpl(e,t,o)},r.SetImpl=function(e,t,n){if(n){var o=e.XamlNode._ImplicitStyles,i=[null,null,null];o&&(i[a.Theme]=o[a.Theme],i[a.ApplicationResources]=o[a.ApplicationResources],i[a.VisualTree]=o[a.VisualTree]),t&s.Theme&&(i[a.Theme]=n[a.Theme]),t&s.ApplicationResources&&(i[a.ApplicationResources]=n[a.ApplicationResources]),t&s.VisualTree&&(i[a.VisualTree]=n[a.VisualTree]),r.ApplyStyles(e,t,n)}},r.Clear=function(e,t){var n=e.XamlNode,o=n._ImplicitStyles;if(o){var i=o.slice(0);t&s.Theme&&(i[a.Theme]=null),t&s.ApplicationResources&&(i[a.ApplicationResources]=null),t&s.VisualTree&&(i[a.VisualTree]=null),r.ApplyStyles(e,n._StyleMask&~t,i)}},r.ApplyStyles=function(n,r,o){var i=n.XamlNode,s=i._ImplicitStyles,u=!s||r!==i._StyleMask;if(!u)for(var l=0;l<a.Count;l++)if(o[l]!==s[l]){u=!0;break}u&&(t.SwapStyles(n,e.MultipleStylesWalker(s),e.MultipleStylesWalker(o),!0),i._ImplicitStyles=o,i._StyleMask=r)},r}();t.ImplicitStyleBroker=u}(t=e.Providers||(e.Providers={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function n(){}return n.Set=function(n,r){var o=n.XamlNode;r&&r.Seal(),t.SwapStyles(n,e.SingleStyleWalker(o._LocalStyle),e.SingleStyleWalker(r),!1),o._LocalStyle=r},n}();t.LocalStyleBroker=n}(t=e.Providers||(e.Providers={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){function n(t,n,r,o){for(var i,a,s,u=t._PropertyStorage,l=n.Step(),c=r.Step();l||c;){if(l&&c)switch(e.Setter.Compare(l,c)){case 0:a=c.ConvertedValue,s=c.Property,l=n.Step(),c=r.Step();break;case-1:a=void 0,s=l.Property,l=n.Step();break;case 1:a=c.ConvertedValue,s=c.Property,c=r.Step()}else c?(a=c.ConvertedValue,s=c.Property,c=r.Step()):(a=void 0,s=l.Property,l=n.Step());i=u[s._ID],i||(i=u[s._ID]=s.Store.CreateStorage(t,s)),o?s.Store.SetImplicitStyle(i,a):s.Store.SetLocalStyleValue(i,a)}}t.SwapStyles=n}(t=e.Providers||(e.Providers={}))}(Fayde||(Fayde={}));var Fayde;!function(Fayde){var Data;!function(Data){function lookupType(name){lookupNamespaces||(lookupNamespaces=[Fayde,Fayde.Controls,Fayde.Media,Fayde.Controls.Primitives,Fayde.Shapes,window]);for(var len=lookupNamespaces.length,i=0;len>i;i++){var potentialType=lookupNamespaces[i][name];if("function"==typeof potentialType)return potentialType}return eval(name)}function handlePeriod(e){if(e.tickOpen)return!0;if(null!=e.res){var t=null;if(null==(t=e.lu.GetValue(e.res)))return!1;if(!(t instanceof Fayde.DependencyObject))return!1;var n=t;if(e.promotedValues&&null==e.promotedValues[t._ID]&&!(t instanceof Fayde.UIElement)){
var r=Fayde.Clone(t);r instanceof Fayde.DependencyObject&&(n=r,e.lu.SetCurrentValue(e.res,r),r=e.lu.GetValue(e.res),e.promotedValues[r._ID]=r)}e.lu=n}return e.expressionFound=!1,e.prop=e.path.substr(e.index),!0}function handleLeftBracket(e){if(!(e.index>=e.end)){for(var t=!1;"0"===e.path.charAt(e.index);)t=!0,e.index++;if(e.i=parseInt(e.path.substr(e.index),10),isNaN(e.i)||(e.index+=e.i.toString().length),isNaN(e.i)&&t&&(e.i=0),"]"!==e.path.charAt(e.index)||"."!==e.path.charAt(e.index+1))return!0;e.prop=e.path=e.path.substr(e.index+2),e.index=0,e.end=e.path.length;var n=null;return e.expressionFound&&(e.expressionFound=!1,null==(n=e.lu.GetValue(e.res)))?!1:n instanceof Fayde.XamlObjectCollection?(e.collection=n,null==(n=e.collection.GetValueAt(e.i))?!1:n instanceof Fayde.DependencyObject?(e.lu=n,!0):(e.lu=null,!1)):(e.collection=null,!1)}}function handleDefault(e){e.expressionFound=!0;for(var t,n=e.index-1;e.index<e.end&&(t=e.path.charAt(e.index),!("."===t&&!e.tickOpen||e.parenOpen&&")"===t||"["===t))&&(e.index++,"'"!==t||(e.tickOpen=!e.tickOpen,e.tickOpen)););if(e.index===e.end)e.type=e.lu.constructor;else{if(t=e.path.charAt(e.index),"."===t){if(e.index-n===11&&"textelement"===e.path.substr(n,11).toLowerCase())e.type=Fayde.Controls.TextBlock,e.explicitType=!0;else{var r=e.index;"'"!==e.path.charAt(e.index-1)||e.tickOpen||(r=e.index-1);var o=e.path.slice(n,r);e.type=lookupType(o),e.explicitType=!0,e.type||(e.type=e.lu.constructor)}for(e.index++,n=e.index;e.index<e.end&&(t=e.path.charAt(e.index),!(e.parenOpen&&")"===t||"."===t&&!e.tickOpen))&&(e.index++,"'"!==t||(e.tickOpen=!e.tickOpen,e.tickOpen)););if(e.index===n)return!1}else e.type=e.lu.constructor,e.explicitType=!1;if(t=e.path.charAt(e.index),")"!==t&&e.parenOpen||null==e.type)return!1}return o=e.path.slice(n,e.index),null==(e.res=DependencyProperty.GetDependencyProperty(e.type,o))&&e.lu&&(e.res=DependencyProperty.GetDependencyProperty(e.lu.constructor,o)),null==e.res?!1:e.res.IsAttached||e.lu instanceof e.type||null!=(e.res=DependencyProperty.GetDependencyProperty(e.lu.constructor,o))?e.res.IsAttached&&e.explicitType&&!e.parenOpen?!1:!0:!1}var lookupNamespaces,PropertyPath=function(){function e(e,t){this._Propd=null,this._Path=e,this._ExpandedPath=t}return e.CreateFromParameter=function(t){var n=new e;return t instanceof DependencyProperty&&(n._Propd=t),n._Path=null,t instanceof String&&(n._Path=t),n},e.prototype.TryResolveDependencyProperty=function(t,n){if(this._Propd)return this._Propd;var r=t.Value,o=e.ResolvePropertyPath(t,this,n);return r===t.Value&&(this._Propd=o),o},Object.defineProperty(e.prototype,"Path",{get:function(){return this._Path},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ExpandedPath",{get:function(){return this._ExpandedPath},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParsePath",{get:function(){return this._Propd?"(0)":this._ExpandedPath?this._ExpandedPath:this._Path},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HasDependencyProperty",{get:function(){return null!=this._Propd},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DependencyProperty",{get:function(){return this._Propd},enumerable:!0,configurable:!0}),e.ResolvePropertyPath=function(e,t,n){var r=t.Path,o=t.ExpandedPath;null!=o&&(r=o);for(var i,a={index:0,i:0,end:r.length,path:r,parenOpen:!1,tickOpen:!1,prop:r,res:null,cloned:!1,expressionFound:!1,lu:e.Value,collection:null,promotedValues:n,explicitType:!1,type:null};a.index<a.end;){i=!0;var s=a.path.charAt(a.index);if(a.index++,"("===s?a.parenOpen=!0:")"===s?a.parenOpen=!1:"'"===s?t.ExpandedPath?a.tickOpen=!a.tickOpen:console.warn("The ' character is not legal in property paths."):i="."===s?handlePeriod(a):"["===s?handleLeftBracket(a):handleDefault(a),!i)return e.Value=null,null}return e.Value=a.lu,a.res},e.prototype.Clone=function(){return new e(this._Path,this._ExpandedPath)},e}();Data.PropertyPath=PropertyPath,Fayde.CoreLibrary.add(PropertyPath),nullstone.registerTypeConverter(PropertyPath,function(e){return e?e instanceof PropertyPath?e:new PropertyPath(e.toString()):new PropertyPath})}(Data=Fayde.Data||(Fayde.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){function t(e,t,n){if(!t)return-1;n||(n=0);for(var r=n;r<e.length;r++)for(var o=e.charAt(r),i=0;i<t.length;i++)if(o===t[i])return r;return-1}!function(e){e[e.None=0]="None",e[e.AttachedProperty=1]="AttachedProperty",e[e.Indexed=2]="Indexed",e[e.Property=3]="Property"}(e.PropertyNodeType||(e.PropertyNodeType={}));var n=e.PropertyNodeType,r=function(){function e(e){this.Path=e}return e.prototype.Step=function(e){var r=n.None,o=this.Path;if(0===o.length)return e.typeName=null,e.propertyName=null,e.index=null,r;var i=0;if("("===o.charAt(0)){if(r=n.AttachedProperty,i=o.indexOf(")"),-1===i)throw new ArgumentException("Invalid property path. Attached property is missing the closing bracket");var a,s,u,l;o.indexOf("'");if(a=o.indexOf("'"),a>0){if(a++,s=o.indexOf("'",a+1),0>s)throw new Exception("Invalid property path, Unclosed type name '"+o+"'.");if(u=o.indexOf(".",s),0>u)throw new Exception("Invalid properth path, No property indexer found '"+o+"'.");u++}else{if(a=1,s=o.indexOf(".",a),0>s)throw new Exception("Invalid property path, No property indexer found on '"+o+"'.");u=s+1}l=i,e.typeName=o.slice(a,s),e.propertyName=o.slice(u,l),e.index=null,o.length>i+1&&"."===o.charAt(i+1)&&i++,o=o.substr(i+1)}else"["===o.charAt(0)?(r=n.Indexed,i=o.indexOf("]"),e.typeName=null,e.propertyName=null,e.index=parseInt(o.substr(1,i-1)),o=o.substr(i+1),"."===o.charAt(0)&&(o=o.substr(1))):(r=n.Property,i=t(o,[".","["]),-1===i?(e.propertyName=o,o=""):(e.propertyName=o.substr(0,i),o="."===o.charAt(i)?o.substr(i+1):o.substr(i)),e.typeName=null,e.index=null);return this.Path=o,r},e}();e.PropertyPathParser=r}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n=function(){function e(e,n,r,s){n=n!==!1,r=r===!0,this.IsDataContextBound=s===!0,this.Path=e,this.IsDataContextBound=s;var u=null;if(e&&"."!==e)for(var l,c={typeName:void 0,propertyName:void 0,index:void 0},p=new t.PropertyPathParser(e);(l=p.Step(c))!==t.PropertyNodeType.None;){var d=!1,h=u=new i(n,d);switch(l){case t.PropertyNodeType.AttachedProperty:case t.PropertyNodeType.Property:h.Next=new o(c.typeName,c.propertyName);break;case t.PropertyNodeType.Indexed:h.Next=new a(c.index)}this.FinalNode?this.FinalNode.Next=h:this.Node=h,this.FinalNode=h.Next}else u=new i(n,r),this.Node=u,this.FinalNode=u;u.BindToView=u.BindToView||r,this.FinalNode.Listen(this)}return Object.defineProperty(e.prototype,"IsPathBroken",{get:function(){var e=this.Path;if(this.IsDataContextBound&&(!e||e.length<1))return!1;for(var t=this.Node;t;){if(t.IsBroken)return!0;t=t.Next}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FinalPropertyName",{get:function(){var e=this.FinalNode;if(e instanceof o)return e.PropertyInfo?e.PropertyInfo.name:"";for(var t="",n=this.Node;n;n=n.Next)n instanceof o&&(t=n.PropertyInfo?n.PropertyInfo.name:"");return t},enumerable:!0,configurable:!0}),e.prototype.GetValue=function(e){this.Update(e);var t=this.FinalNode.Value;return t},e.prototype.Update=function(e){this.Source=e,this.Node.SetSource(e)},e.prototype.Listen=function(e){this._Listener=e},e.prototype.Unlisten=function(e){this._Listener===e&&(this._Listener=null)},e.prototype.IsBrokenChanged=function(e){this.ValueInternal=e.Value;var t=this._Listener;t&&t.IsBrokenChanged()},e.prototype.ValueChanged=function(e){this.ValueInternal=e.Value;var t=this._Listener;t&&t.ValueChanged()},e.prototype.GetContext=function(){for(var e=null,t=this.Node,n=this.FinalNode;t&&t!==n;)e=t,t=t.Next;return e?e.Value:void 0},e}();t.PropertyPathWalker=n;var r=function(){function t(){}return Object.defineProperty(t.prototype,"IsBroken",{get:function(){return this._IsBroken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Source",{get:function(){return this._Source},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Value",{get:function(){return this._Value},enumerable:!0,configurable:!0}),t.prototype.Listen=function(e){this._NodeListener=e},t.prototype.Unlisten=function(e){this._NodeListener===e&&(this._NodeListener=null)},t.prototype.OnSourceChanged=function(e,t){},t.prototype.OnSourcePropertyChanged=function(e,t){},t.prototype.UpdateValue=function(){throw new Exception("No override for abstract method: PropertyPathNode.UpdateValue")},t.prototype.SetValue=function(e){throw new Exception("No override for abstract method: PropertyPathNode.SetValue")},t.prototype.GetSource=function(){return this._Source},t.prototype.SetSource=function(t){if(null==t||t!==this._Source){var n=this._Source,r=e.INotifyPropertyChanged_.as(n);r&&r.PropertyChanged.off(this.OnSourcePropertyChanged,this),this._Source=t,r=e.INotifyPropertyChanged_.as(this._Source),r&&r.PropertyChanged.on(this.OnSourcePropertyChanged,this),this.OnSourceChanged(n,this._Source),this.UpdateValue(),this.Next&&this.Next.SetSource(this._Value)}},t.prototype.UpdateValueAndIsBroken=function(e,t){var n=this._IsBroken!==t,r=!nullstone.equals(this.Value,e);if(this._IsBroken=t,this._Value=e,r){var o=this._NodeListener;o&&o.ValueChanged(this)}else if(n){var o=this._NodeListener;o&&o.IsBrokenChanged(this)}},t.prototype._CheckIsBroken=function(){return!this.Source||!this.PropertyInfo&&!this.DependencyProperty},t}(),o=function(t){function n(e,n){t.call(this),this._STypeName=e,this._PropertyName=n}return __extends(n,t),n.prototype.SetValue=function(e){this.DependencyProperty?this.Source.SetValue(this.DependencyProperty,e):this.PropertyInfo&&this.PropertyInfo.setValue(this.Source,e)},n.prototype.UpdateValue=function(){if(this.DependencyProperty)this.ValueType=this.DependencyProperty.GetTargetType(),this.UpdateValueAndIsBroken(this.Source.GetValue(this.DependencyProperty),this._CheckIsBroken());else if(this.PropertyInfo){this.ValueType=null;try{this.UpdateValueAndIsBroken(this.PropertyInfo.getValue(this.Source),this._CheckIsBroken())}catch(e){this.UpdateValueAndIsBroken(null,this._CheckIsBroken())}}else this.ValueType=null,this.UpdateValueAndIsBroken(null,this._CheckIsBroken())},n.prototype.OnSourceChanged=function(n,r){t.prototype.OnSourceChanged.call(this,n,r);var o,i;n instanceof e.DependencyObject&&(o=n),r instanceof e.DependencyObject&&(i=r);var a=this._DPListener;if(a&&(a.Detach(),this._DPListener=a=null),this.DependencyProperty=null,this.PropertyInfo=null,this.Source){var s=this.Source.constructor,u=this._STypeName;if(u){u.indexOf(":")>-1&&console.warn("[Not supported] Cannot resolve type name outside of default namespace.",u);var l={type:void 0,isPrimitive:!1};e.CoreLibrary.resolveType(null,u,l)&&(s=l.type)}if(i){var c=DependencyProperty.GetDependencyProperty(s,this._PropertyName,!0);c&&(this.DependencyProperty=c,this._DPListener=a=c.Store.ListenToChanged(i,c,this.OnPropertyChanged,this))}this.DependencyProperty&&this.DependencyProperty.IsAttached||(this.PropertyInfo=nullstone.PropertyInfo.find(this.Source,this._PropertyName))}},n.prototype.OnPropertyChanged=function(e,t){try{this.UpdateValue(),this.Next&&this.Next.SetSource(this.Value)}catch(n){}},n.prototype.OnSourcePropertyChanged=function(e,t){if(t.PropertyName===this._PropertyName&&this.PropertyInfo){this.UpdateValue();var n=this.Next;n&&n.SetSource(this.Value)}},n}(r),i=function(e){function n(t,n){e.call(this),this.BindsDirectlyToSource=t===!0,this.BindToView=n===!0}return __extends(n,e),n.prototype.OnSourceChanged=function(t,n){e.prototype.OnSourceChanged.call(this,t,n),this.DisconnectViewHandlers(),this.ConnectViewHandlers(n,n)},n.prototype.ViewChanged=function(e,t){this.DisconnectViewHandlers(!0),this.ConnectViewHandlers(null,t.NewValue),this.ViewCurrentChanged(this,null)},n.prototype.ViewCurrentChanged=function(e,t){this.UpdateValue(),this.Next&&this.Next.SetSource(this.Value)},n.prototype.SetValue=function(){throw new NotSupportedException("SetValue")},n.prototype.UpdateValue=function(){var e=this.Source;if(!this.BindsDirectlyToSource){var n;e instanceof t.CollectionViewSource?e=n=e.View:n=t.ICollectionView_.as(e),n&&!this.BindToView&&(e=n.CurrentItem)}this.ValueType=null==e?null:e.constructor,this.UpdateValueAndIsBroken(e,this._CheckIsBroken())},n.prototype._CheckIsBroken=function(){return null==this.Source},n.prototype.ConnectViewHandlers=function(e,n){e instanceof t.CollectionViewSource&&(this._ViewPropertyListener=t.CollectionViewSource.ViewProperty.Store.ListenToChanged(e,t.CollectionViewSource.ViewProperty,this.ViewChanged,this),n=e.View),this._View=t.ICollectionView_.as(n),this._View&&this._View.CurrentChanged.on(this.ViewCurrentChanged,this)},n.prototype.DisconnectViewHandlers=function(e){e||(e=!1),this._ViewPropertyListener&&!e&&(this._ViewPropertyListener.Detach(),this._ViewPropertyListener=null),this._View&&this._View.CurrentChanged.off(this.ViewCurrentChanged,this)},n}(r),a=function(t){function n(e){t.call(this),this._IsBroken=!1;var n=parseInt(e,10);isNaN(n)||(e=n),Object.defineProperty(this,"Index",{value:e,writable:!1})}return __extends(n,t),n.prototype.UpdateValue=function(){if(null==this.PropertyInfo)return this._IsBroken=!0,this.ValueType=null,void this.UpdateValueAndIsBroken(null,this._IsBroken);try{var e=this.PropertyInfo.getValue(this.Source,this.Index);this._IsBroken=!1,this.ValueType=this.PropertyInfo.propertyType,this.UpdateValueAndIsBroken(e,this._IsBroken)}catch(t){this._IsBroken=!0,this.ValueType=null,this.UpdateValueAndIsBroken(null,this._IsBroken)}},n.prototype.SetValue=function(e){this.PropertyInfo&&this.PropertyInfo.setValue(this.Source,this.Index,e)},n.prototype._CheckIsBroken=function(){return this._IsBroken||t.prototype._CheckIsBroken.call(this)},n.prototype.OnSourcePropertyChanged=function(e,t){this.UpdateValue(),null!=this.Next&&this.Next.SetSource(this.Value)},n.prototype.OnSourceChanged=function(n,r){t.prototype.OnSourceChanged.call(this,n,r);var o=e.Collections.INotifyCollectionChanged_.as(n);o&&o.CollectionChanged.off(this.CollectionChanged,this),o=e.Collections.INotifyCollectionChanged_.as(r),o&&o.CollectionChanged.on(this.CollectionChanged,this),this._GetIndexer()},n.prototype._GetIndexer=function(){this.PropertyInfo=null,null!=this._Source&&(this.PropertyInfo=nullstone.IndexedPropertyInfo.find(this._Source))},n.prototype.CollectionChanged=function(e,t){this.UpdateValue(),this.Next&&this.Next.SetSource(this.Value)},n}(r)}(t=e.Data||(e.Data={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){function r(e,t,n){var r=e.length-1,o=t.length-1;for(n.Index1=-1,n.Index2=-1;r>=0&&o>=0;){if(e[r]!==t[o])return;n.Index1=r--,n.Index2=o--}}var o=function(){function n(e){var n=this;this.InputList=[],this._IsEmitting=!1,this._PendingCapture=null,this._PendingReleaseCapture=!1,this._Captured=null,this._CapturedInputList=null,Object.defineProperty(this,"Device",{value:this.CreateTouchDevice(),writable:!1}),this._FinishReleaseCaptureFunc=function(){return e.HandleTouches(t.TouchInputType.NoOp,[n],!1,!0)}}return n.prototype.Capture=function(e){var t=e.XamlNode;return this._Captured===t||this._PendingCapture===t?!0:this._IsEmitting?(this._PendingCapture=t,!0):!1},n.prototype.ReleaseCapture=function(e){var t=e.XamlNode;(this._Captured===t||this._PendingCapture===t)&&(this._IsEmitting?this._PendingReleaseCapture=!0:this._PerformReleaseCapture())},n.prototype._PerformCapture=function(e){this._Captured=e;for(var t=[];null!=e;)t.push(e),e=e.VisualParentNode;this._CapturedInputList=t,this._PendingCapture=null},n.prototype._PerformReleaseCapture=function(){var e=this._Captured;this._Captured=null,this._PendingReleaseCapture=!1,e._EmitLostTouchCapture(new t.TouchEventArgs(this.Device)),this._FinishReleaseCaptureFunc()},n.prototype.Emit=function(e,n,o,i){if(!this._IsEmitting){this._IsEmitting=!0;var a=!1,s={Index1:-1,Index2:-1};r(this.InputList,n,s),o!==!1&&this._EmitList(t.TouchInputType.TouchLeave,this.InputList,s.Index1),i!==!1&&this._EmitList(t.TouchInputType.TouchEnter,n,s.Index2);var a=!1;return e!==t.TouchInputType.NoOp&&(a=this._EmitList(e,this._Captured?this._CapturedInputList:n)),this.InputList=n,this._PendingCapture&&this._PerformCapture(this._PendingCapture),this._PendingReleaseCapture&&this._PerformReleaseCapture(),this._IsEmitting=!1,a}},n.prototype._EmitList=function(n,r,o){var i=!1;if(0===o)return i;o&&-1!==o||(o=r.length);var a=new t.TouchEventArgs(this.Device),s=r[0];s&&a instanceof e.RoutedEventArgs&&(a.Source=s.XObject);for(var u=0;o>u;u++)s=r[u],n===t.TouchInputType.TouchLeave&&(a.Source=s.XObject),s._EmitTouchEvent(n,a)&&(i=!0),n===t.TouchInputType.TouchLeave&&(a=new t.TouchEventArgs(this.Device));return i},n.prototype.GetTouchPoint=function(t){if(!t)return this.CreateTouchPoint(this.Position.Clone());if(!(t instanceof e.UIElement))throw new ArgumentException("Specified relative object must be a UIElement.");var n=this.Position.Clone();return minerva.core.Updater.transformPoint(t.XamlNode.LayoutUpdater,n),this.CreateTouchPoint(n)},n.prototype.CreateTouchPoint=function(e){return new t.TouchPoint(e,0)},n.prototype.CreateTouchDevice=function(){var e=this,t={Identifier:null,Captured:null,Capture:function(t){return e.Capture(t)},ReleaseCapture:function(t){return e.ReleaseCapture(t)},GetTouchPoint:function(t){return e.GetTouchPoint(t)}};return Object.defineProperty(t,"Identifier",{get:function(){return e.Identifier}}),Object.defineProperty(t,"Captured",{get:function(){return e._Captured?e._Captured.XObject:null}}),t},n}();n.ActiveTouchBase=o}(n=t.TouchInternal||(t.TouchInternal={}))}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){this.CanvasOffset=null,this.ActiveTouches=[]}return Object.defineProperty(e.prototype,"CoordinateOffset",{get:function(){return{left:window.pageXOffset+this.CanvasOffset.left,top:window.pageYOffset+this.CanvasOffset.top}},enumerable:!0,configurable:!0}),e.prototype.Register=function(e,t){this.Input=e,this.CanvasOffset=this._CalcOffset(t)},e.prototype._CalcOffset=function(e){var t=0,n=0,r=e;if(r.offsetParent)do t+=r.offsetLeft,n+=r.offsetTop;while(r=r.offsetParent);return{left:t,top:n}},e.prototype.HandleTouches=function(e,t,n,r){for(var o,i=!1;o=t.shift();){var a=this.Input.HitTestPoint(o.Position);a&&(i=i||o.Emit(e,a,n,r))}return i},e}();e.TouchInteropBase=t}(t=e.TouchInternal||(e.TouchInternal={}))}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){function r(e,t){for(var n=t.length,r=0;n>r;r++){var o=e.indexOf(t[r]);o>-1&&e.splice(o,1)}}var o=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.Init=function(e,t){this.TouchObject=e,this.Identifier=e.identifier,this.Position=new Point(e.clientX+t.left,e.clientY+t.top)},n.prototype.CreateTouchPoint=function(e){var n=this.TouchObject;return new t.TouchPoint(e,n.force)},n}(n.ActiveTouchBase),i=function(n){function i(){n.apply(this,arguments)}return __extends(i,n),i.prototype.Register=function(e,t){var r=this;n.prototype.Register.call(this,e,t),t.addEventListener("touchstart",function(e){return r._HandleTouchStart(window.event?window.event:e)}),t.addEventListener("touchend",function(e){return r._HandleTouchEnd(window.event?window.event:e)}),t.addEventListener("touchmove",function(e){return r._HandleTouchMove(window.event?window.event:e)}),t.addEventListener("touchenter",function(e){return r._HandleTouchEnter(window.event?window.event:e)}),t.addEventListener("touchleave",function(e){return r._HandleTouchLeave(window.event?window.event:e)})},i.prototype._HandleTouchStart=function(n){n.preventDefault(),e.Engine.Inspection.Kill();var r=this.TouchArrayFromList(n.changedTouches);this.ActiveTouches=this.ActiveTouches.concat(r),this.Input.SetIsUserInitiatedEvent(!0),this.HandleTouches(t.TouchInputType.TouchDown,r),this.Input.SetIsUserInitiatedEvent(!1)},i.prototype._HandleTouchEnd=function(e){var n=this.TouchArrayFromList(e.changedTouches);this.Input.SetIsUserInitiatedEvent(!0),this.HandleTouches(t.TouchInputType.TouchUp,n),this.Input.SetIsUserInitiatedEvent(!1),r(this.ActiveTouches,n)},i.prototype._HandleTouchMove=function(e){var n=this.TouchArrayFromList(e.changedTouches);this.HandleTouches(t.TouchInputType.TouchMove,n)},i.prototype._HandleTouchEnter=function(e){var n=this.TouchArrayFromList(e.changedTouches);this.HandleTouches(t.TouchInputType.TouchEnter,n)},i.prototype._HandleTouchLeave=function(e){var n=this.TouchArrayFromList(e.changedTouches);this.HandleTouches(t.TouchInputType.TouchLeave,n)},i.prototype.TouchArrayFromList=function(e){for(var t,n,r=e.length,i=[],a=0;r>a;a++){var t=e.item(a);n=this.FindTouchInList(t.identifier)||new o(this),n.Init(t,this.CoordinateOffset),i.push(n)}return i},i.prototype.FindTouchInList=function(e){for(var t=this.ActiveTouches,n=t.length,r=0;n>r;r++)if(t[r].Identifier===e)return t[r];return null},i}(n.TouchInteropBase);n.NonPointerTouchInterop=i}(n=t.TouchInternal||(t.TouchInternal={}))}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.Init=function(e,t){this.TouchObject=e,this.Identifier=e.pointerId,this.Position=new Point(e.clientX+t.left,e.clientY+t.top)},n.prototype.CreateTouchPoint=function(e){var n=this.TouchObject;return new t.TouchPoint(e,n.pressure)},n}(n.ActiveTouchBase),o=function(n){function o(){n.apply(this,arguments)}return __extends(o,n),o.prototype.Register=function(e,t){var r=this;n.prototype.Register.call(this,e,t),t.style.msTouchAction="none",t.style.touchAction="none",t.addEventListener("selectstart",function(e){e.preventDefault()}),navigator.msPointerEnabled?(t.addEventListener("MSPointerDown",function(e){return r._HandlePointerDown(window.event?window.event:e)}),t.addEventListener("MSPointerUp",function(e){return r._HandlePointerUp(window.event?window.event:e)}),t.addEventListener("MSPointerMove",function(e){return r._HandlePointerMove(window.event?window.event:e)}),t.addEventListener("MSPointerEnter",function(e){return r._HandlePointerEnter(window.event?window.event:e)}),t.addEventListener("MSPointerLeave",function(e){return r._HandlePointerLeave(window.event?window.event:e)})):(t.addEventListener("pointerdown",function(e){return r._HandlePointerDown(window.event?window.event:e)}),t.addEventListener("pointerup",function(e){return r._HandlePointerUp(window.event?window.event:e)}),t.addEventListener("pointermove",function(e){return r._HandlePointerMove(window.event?window.event:e)}),t.addEventListener("pointerenter",function(e){return r._HandlePointerEnter(window.event?window.event:e)}),t.addEventListener("pointerleave",function(e){return r._HandlePointerLeave(window.event?window.event:e)}))},o.prototype._HandlePointerDown=function(n){if("touch"===n.pointerType){n.preventDefault(),e.Engine.Inspection.Kill();var r=this.GetActiveTouch(n);this.Input.SetIsUserInitiatedEvent(!0),this.HandleTouches(t.TouchInputType.TouchDown,[r]),this.Input.SetIsUserInitiatedEvent(!1)}},o.prototype._HandlePointerUp=function(e){if("touch"===e.pointerType){var n=this.GetActiveTouch(e);this.Input.SetIsUserInitiatedEvent(!0),this.HandleTouches(t.TouchInputType.TouchUp,[n]),this.Input.SetIsUserInitiatedEvent(!1);var r=this.ActiveTouches.indexOf(n);r>-1&&this.ActiveTouches.splice(r,1)}},o.prototype._HandlePointerMove=function(e){if("touch"===e.pointerType){var n=this.GetActiveTouch(e);this.HandleTouches(t.TouchInputType.TouchMove,[n])}},o.prototype._HandlePointerEnter=function(e){if("touch"===e.pointerType){var n=this.GetActiveTouch(e);this.HandleTouches(t.TouchInputType.TouchEnter,[n])}},o.prototype._HandlePointerLeave=function(e){if("touch"===e.pointerType){var n=this.GetActiveTouch(e);this.HandleTouches(t.TouchInputType.TouchLeave,[n])}},o.prototype.GetActiveTouch=function(e){var t=this.FindTouchInList(e.pointerId),n=t||new r(this);return t||this.ActiveTouches.push(n),n.Init(e,this.CoordinateOffset),n},o.prototype.FindTouchInList=function(e){for(var t=this.ActiveTouches,n=t.length,r=0;n>r;r++)if(t[r].Identifier===e)return t[r];return null},o}(n.TouchInteropBase);n.PointerTouchInterop=o}(n=t.TouchInternal||(t.TouchInternal={}))}(t=e.Input||(e.Input={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){function n(t,n,r){return{obj:null,xo:null,dobj:null,rd:null,coll:null,arr:null,type:null,set:function(o){this.obj=o,this.type=o?o.constructor:null,this.rd=o instanceof e.ResourceDictionary?o:null,this.rd&&(this.rd.App=t),this.dobj=o instanceof e.DependencyObject?o:null;var i=this.xo=o instanceof e.XamlObject?o:null;i&&(i.XamlNode.DocNameScope=n,i.TemplateOwner=r,i.App=t),o instanceof e.Application&&(t=o),this.coll=nullstone.ICollection_.as(o),this.arr="array"==typeof o?o:null},setName:function(e){if(this.xo){var t=this.xo.XamlNode;n.RegisterName(e,t),t.Name=e}},getApp:function(){return t}}}t.createActiveObject=n}(n=t.Internal||(t.Internal={}))}(t=e.Markup||(e.Markup={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){function t(e){var t=[];return{start:function(){var n={};e.init(n),t.push(n)},end:function(){t.pop(),e.init(t[t.length-1])}}}e.createObjectActor=t}(t=e.Internal||(e.Internal={}))}(t=e.Markup||(e.Markup={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){function r(n,r,o){function i(e,t){var r=e||n.type;v.visited=v.visited||[];var o=v.visited[r];if(o){if(o.indexOf(t)>-1)throw new XamlParseException("Cannot set ["+r.name+"]["+t+"] more than once.")}else o=v.visited[r]=[];o.push(t)}function a(){i(n.type,v.propd.Name)}function s(e,t){if(v.coll||v.arr||v.propd||v.prop||v.eprop)return!0;if(n.dobj){var r=e||n.type;if(v.propd=DependencyProperty.GetDependencyProperty(r,t,!0),!v.propd){var o=n.dobj[t];return o instanceof nullstone.Event?v.eprop=t:v.prop=t,!0}if(v.propd.IsImmutable){var i=n.dobj.GetValue(v.propd);v.coll=nullstone.ICollection_.as(i),v.arr="array"==typeof i?i:null}else{var a=v.propd.GetTargetType();nullstone.ICollection_.is(a.prototype)?n.dobj.SetValue(v.propd,v.coll=new a):a===Array&&n.dobj.SetValue(v.propd,v.arr=[])}return!0}if(n.rd&&"MergedDictionaries"===t)return v.coll=n.rd.MergedDictionaries,!0;if(n.obj){if(e&&n.type!==e)throw new XamlParseException("Cannot set Attached Property on object that is not a DependencyObject.");return v.prop=t,!0}return!1}function u(){var r=v.content=v.content||{};if(r.coll||r.arr||r.rd||r.propd)return!0;var o=r.propd=t.Content.Get(n.type);if(!o){if(r.coll=nullstone.ICollection_.as(n.obj),r.arr="array"==typeof n.obj?n.obj:null,r.rd=n.rd,r.app=n.obj instanceof e.Application?n.obj:null,r.coll||r.arr||r.rd||r.app)return!0;throw new XamlParseException("Cannot set content for object of type '"+n.type.name+"'.")}if(!o.IsImmutable)return!0;var i=n.dobj.GetValue(o);return i?(r.coll=nullstone.ICollection_.as(i),r.arr="array"==typeof i?i:null,!0):!1}function l(e,t){if(n.rd){if(t=t||h(e),!t)throw new XamlParseException("Items in a ResourceDictionary must have a x:Key.");n.rd.Set(t,e)}else if(n.coll)n.coll.Add(e);else if(n.arr)n.arr.push(e);else if(n.dobj)if(v.content.coll)v.content.coll.Add(e);else if(v.content.arr)v.content.arr.push(e);else if(v.content.rd){if(t=t||h(e),!t)throw new XamlParseException("Items in a ResourceDictionary must have a x:Key.");v.content.rd.Set(e,t)}else if(v.content.app)v.content.app.$$SetRootVisual(e);else{if(v.content.count>0)throw new XamlParseException("Cannot set content more than once.");n.dobj.SetValue(v.content.propd,e)}v.content.count++}function c(e,t){v.coll?v.coll.Add(e):v.arr?v.arr.push(e):v.propd?n.dobj.SetValue(v.propd,f(v.propd,e)):v.prop?n.obj[v.prop]=e:v.eprop&&m(v.eprop,e)}function p(e,t,r){if(n.dobj){var o=e||n.type,i=DependencyProperty.GetDependencyProperty(o,t,!0);if(!i){var a=n.dobj[t];return a instanceof nullstone.Event?m(t,r):n.dobj[t]=r,!0}return i.IsImmutable?d(f(i,r),n.dobj.GetValue(i)):(n.dobj.SetValue(i,f(i,r)),!0)}if(n.obj){var a=n.obj[t];return a instanceof nullstone.Event?m(t,r):n.obj[t]=r,!0}return!1}function d(e,t){var n,r=nullstone.ICollection_.as(e);if(r)n=nullstone.IEnumerable_.toArray(r),r.Clear();else{if("array"!=typeof e)return!1;n=e.slice(0),e.length=0}var o=nullstone.IEnumerator_.fromArray(n),i=nullstone.ICollection_.as(t),a="array"==typeof t?t:null;if(i)for(;o.moveNext();)i.Add(o.current);else{if(!a)return!1;for(;o.moveNext();)a.push(o.current)}return!0}function h(t){if(t instanceof e.XamlObject){var n=t.XamlNode.Name;if(n)return n}return y(t)}function y(t){if(t instanceof e.DataTemplate){var n=t.DataType;if(!n)throw new XamlParseException("A DataTemplate in a ResourceDictionary must have x:Key or DataType.");return n}if(t instanceof e.Style){var r=t.TargetType;if(!r)throw new XamlParseException("A Style in a ResourceDictionary must have x:Key or TargetType.");return r}}function f(t,n){var i=t.GetTargetType(),a=n;if("string"==typeof a){if(i===e.IType_)return r(a);if(t===e.Setter.PropertyProperty)return o(a)}else if(a instanceof e.Expression)return a;return nullstone.convertAnyToType(a,i)}function m(t,r){if(!(r instanceof e.EventBindingExpression))throw new XamlParseException("Cannot subscribe to event '"+t+"' without {EventBinding}.");r.Init(t),r.OnAttached(n.dobj)}var v={visited:void 0,coll:void 0,arr:void 0,propd:void 0,prop:void 0,eprop:void 0,incontent:void 0,content:{count:0,coll:void 0,arr:void 0,rd:void 0,propd:void 0,app:void 0}};return{init:function(e){v=e},start:function(e,t){i(e,t),s(e,t)},startContent:function(){u()&&(0===v.content.count&&a(),v.incontent=!0)},end:function(){v.incontent=!1,v.coll=v.arr=v.propd=v.prop=v.eprop=void 0},addObject:function(e,t){v.incontent?(l(e,t),v.content.count++):c(e,t)},setContentText:function(e){if(n.dobj){var r=t.TextContent.Get(n.type);if(r)return i(n.type,r.Name),void n.dobj.SetValue(r,e);var o=t.Content.Get(n.type);o&&(i(n.type,o.Name),n.dobj.SetValue(o,f(o,e)))}},setObject:function(e,t,n){i(e,t),p(e,t,n)},isNewResources:function(){return v.coll instanceof e.ResourceDictionaryCollection?!0:!n.rd}}}n.createPropertyActor=r}(n=t.Internal||(t.Internal={}))}(t=e.Markup||(e.Markup={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){function n(t,n){var r=[];return{start:function(){t.rd&&r.push(t.rd)},end:function(){t.rd&&r.pop()},get:function(){var o=n?n.concat(r):r.slice(0);if(t.dobj instanceof e.FrameworkElement){var i=t.dobj.ReadLocalValue(e.FrameworkElement.ResourcesProperty);i!==DependencyProperty.UnsetValue&&o.push(i)}return o}}}t.createResourcesActor=n}(n=t.Internal||(t.Internal={}))}(t=e.Markup||(e.Markup={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){!function(e){e[e.EaseOut=0]="EaseOut",e[e.EaseIn=1]="EaseIn",e[e.EaseInOut=2]="EaseInOut"}(t.EasingMode||(t.EasingMode={}));var n=t.EasingMode;e.CoreLibrary.addEnum(n,"EasingMode"),function(e){e[e.HoldEnd=0]="HoldEnd",e[e.Stop=1]="Stop"}(t.FillBehavior||(t.FillBehavior={}));var r=t.FillBehavior;e.CoreLibrary.addEnum(r,"FillBehavior")}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(){function e(){this._Duration=null,this._Count=null,this.IsForever=!1}return e.FromRepeatDuration=function(t){var n=new e;return n._Duration=t,n},e.FromIterationCount=function(t){var n=new e;return n._Count=t,n},Object.defineProperty(e.prototype,"HasCount",{get:function(){return null!=this._Count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Count",{get:function(){return this._Count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HasDuration",{get:function(){return null!=this._Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this._Duration},enumerable:!0,configurable:!0}),e.prototype.Clone=function(){var t=new e;return t._Duration=this._Duration,
t._Count=this._Count,t.IsForever=this.IsForever,t},e.Forever=function(){var t=new e;return t.IsForever=!0,t}(),e}();t.RepeatBehavior=n,e.CoreLibrary.add(n),nullstone.registerTypeConverter(n,function(e){if(!e||"forever"===e.toLowerCase())return n.Forever;if("x"===e[e.length-1]){var t=parseInt(e.substr(0,e.length-1));return n.FromIterationCount(t)}var r=new Duration(nullstone.convertAnyToType(e,TimeSpan));return n.FromRepeatDuration(r)})}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(n){function r(){n.apply(this,arguments),this.Completed=new nullstone.Event,this._IsPaused=!1,this._BeginPauseTime=0,this._TicksPaused=0,this._IsFirstUpdate=!0,this._HasBegun=!1,this._BeginTicks=void 0,this._InitialStep=void 0,this._HasCompleted=!1,this.ManualTarget=void 0}return __extends(r,n),Object.defineProperty(r.prototype,"HasManualTarget",{get:function(){return void 0!==this.ManualTarget},enumerable:!0,configurable:!0}),r.prototype.Reset=function(){this._TicksPaused=0,this._IsFirstUpdate=!0,this._BeginTicks=void 0,this._HasBegun=!1,this._HasCompleted=!1},r.prototype.Pause=function(){this._IsPaused||(this._BeginPauseTime=(new Date).getTime(),this._IsPaused=!0)},r.prototype.Resume=function(){if(this._IsPaused){this._IsPaused=!1;var e=(new Date).getTime();this._TicksPaused=e-this._BeginPauseTime}},r.prototype.Stop=function(){this.Reset()},r.prototype.OnCompleted=function(){this._HasCompleted=!0;var e=this.FillBehavior;switch(e){case t.FillBehavior.HoldEnd:this.HoldEnd();break;case t.FillBehavior.Stop:this.Stop()}this.Completed.raise(this,null)},r.prototype.Update=function(e){var t=this.CreateClockData(e);!t||this._IsPaused||this._HasCompleted||(this.UpdateInternal(t),t.Completed&&this.OnCompleted())},r.prototype.UpdateInternal=function(e){},r.prototype.HoldEnd=function(){},r.prototype.CreateClockData=function(e){if(this._IsFirstUpdate&&(this._InitialStep=e,this._HasBegun=!1,this._IsFirstUpdate=!1),!this._HasBegun){if(!this.IsAfterBeginTime(e))return null;this._BeginTicks=e,this._HasBegun=!0}var t=e-this._BeginTicks-this._TicksPaused,n=t,o=0,i=!1,a=this.GetNaturalDuration();if(a.IsAutomatic)o=1,i=!0;else if(a.HasTimeSpan){var s=a.TimeSpan.Ticks;0===s?o=1:this.AutoReverse===!0?(s/=2,o=1-Math.abs(t%(s+s)-s)/s):o=t/s-Math.floor(t/s);var u=this.RepeatBehavior||r.DEFAULT_REPEAT_BEHAVIOR;u.IsForever||(u.HasCount?(0===s||Math.floor(t/s)>=u.Count)&&(o=1,i=!0):u.HasDuration&&t>=u.Duration.TimeSpan.Ticks&&(o=1,i=!0)),0!==s&&(n=o*s)}return{CurrentTime:new TimeSpan(n),Progress:o,Completed:i}},r.prototype.IsAfterBeginTime=function(e){var t=this.BeginTime;if(null==t)return!0;var n=t.Ticks;if(0>=n)return!0;var r=e-this._InitialStep;return n>r?!1:!0},r.prototype.GetNaturalDuration=function(){var e=this.Duration;return!e||e.IsAutomatic?this.GetNaturalDurationCore():e},r.prototype.GetNaturalDurationCore=function(){return Duration.Automatic},r.prototype.GenerateFrom=function(){return void 0},r.prototype.GenerateTo=function(e){return void 0},r.DEFAULT_REPEAT_BEHAVIOR=t.RepeatBehavior.FromIterationCount(1),r.AutoReverseProperty=DependencyProperty.Register("AutoReverse",function(){return Boolean},r,!1),r.BeginTimeProperty=DependencyProperty.Register("BeginTime",function(){return TimeSpan},r),r.DurationProperty=DependencyProperty.Register("Duration",function(){return Duration},r),r.RepeatBehaviorProperty=DependencyProperty.Register("RepeatBehavior",function(){return t.RepeatBehavior},r),r.SpeedRatioProperty=DependencyProperty.Register("SpeedRatio",function(){return Number},r,1),r.FillBehaviorProperty=DependencyProperty.Register("FillBehavior",function(){return new e.Enum(t.FillBehavior)},r,t.FillBehavior.HoldEnd),r}(e.DependencyObject);t.Timeline=n,e.CoreLibrary.add(n);var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.XamlObjectCollection);t.TimelineCollection=r,e.CoreLibrary.add(r)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){function n(e,t,n,r){var o="ANIMATION:"+e+":"+t._ID+"["+t.constructor.name+"]";return o+=";"+(void 0===n?"(undefined)":null===n?"(null)":n.toString()),o+="->"+(void 0===r?"(undefined)":null===r?"(null)":r.toString())}var r=function(e){function r(){e.call(this),this._IsHolding=!1}return __extends(r,e),r.prototype.Resolve=function(e,t){return!0},r.prototype.HoldEnd=function(){this._IsHolding=!0},r.prototype.Stop=function(){var e=this._AnimStorage;e&&(t.AnimationStore.Detach(e)||e.IsDisabled||t.AnimationStore.ApplyStop(e))},r.prototype.UpdateInternal=function(e){if(!this._IsHolding){var r=this._AnimStorage;if(r&&!r.IsDisabled){var o=r.CurrentValue;r.CurrentValue=this.GetCurrentValue(r.BaseValue,void 0!==r.StopValue?r.StopValue:r.BaseValue,e),t.Log&&console.log(n("AnimationBase.UpdateInternal",this,o,r.CurrentValue)),o!==r.CurrentValue&&void 0!==r.CurrentValue&&t.AnimationStore.ApplyCurrent(r)}}},r.prototype.GetNaturalDurationCore=function(){return Duration.Automatic},r.prototype.GetCurrentValue=function(e,t,n){return void 0},r.prototype._Hookup=function(e,n){this._IsHolding=!1,this.Reset();var r=t.Storyboard.ResolveTarget(this);r.Target||console.warn("Could not resolve storyboard target.",t.Storyboard.GetTargetName(this));var o={Value:r.Target},i=r.Property.TryResolveDependencyProperty(o,e);if(r.Target=o.Value,!i){n.Number=BError.XamlParse;var a=t.Storyboard.GetTargetName(this);return n.Message="Could not resolve property for storyboard. ("+a+")->["+r.Property.Path.toString()+"]",!1}return this.Resolve(r.Target,i)?(this._AnimStorage=t.AnimationStore.Create(r.Target,i),this._AnimStorage.Animation=this,t.AnimationStore.Attach(this._AnimStorage),!0):(n.Number=BError.InvalidOperation,n.Message="Storyboard value could not be converted to the correct type",!1)},r}(t.Timeline);t.AnimationBase=r,e.CoreLibrary.add(r)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){function n(e,n,r){var o=n.Animation,i=t.Storyboard.GetTargetName(n.Animation);o.HasManualTarget&&(i=o.ManualTarget.Name);var a=t.Storyboard.GetTargetProperty(o),s="ANIMATION:"+e+":"+n.ID+"["+i+"]("+a.Path+")->";return s+=void 0===r?"(undefined)":null===r?"(null)":r.toString()}function r(){return i++}var o=function(){function o(){}return o.Create=function(t,n){var o=t.GetValue(n);if(void 0===o){var i=n.GetTargetType();o=i===Number?0:i===String?"":new i}return{ID:r(),Animation:void 0,PropStorage:e.Providers.GetStorage(t,n),IsDisabled:!1,BaseValue:o,CurrentValue:void 0,StopValue:void 0}},o.Attach=function(e){var t=e.PropStorage,n=t.Animations;n||(t.Animations=n=[]);var r=n[n.length-1];n.push(e),r?(e.StopValue=r.StopValue,r.IsDisabled=!0):e.StopValue=t.Local},o.Detach=function(e){var t=e.PropStorage,n=t.Animations;if(!n)return!1;var r=n.length;if(1>r)return!1;var i=n.lastIndexOf(e);if(i===r-1){if(n.pop(),r>1){var a=n[r-2];if(a.IsDisabled)return a.IsDisabled=!1,o.ApplyCurrent(a),!0}}else n.splice(i,1),n[i].StopValue=e.StopValue;return!1},o.ApplyCurrent=function(e){var r=e.CurrentValue;if(void 0!==r){t.LogApply&&console.log(n("ApplyCurrent",e,r));var o=e.PropStorage;o.Property.Store.SetLocalValue(o,e.CurrentValue)}},o.ApplyStop=function(e){var r=e.StopValue;t.LogApply&&console.log(n("ApplyStop",e,r));var o=e.PropStorage;o.Property.Store.SetLocalValue(o,r)},o}();t.AnimationStore=o;var i=0}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function n(){e.call(this);var t=n.KeyFramesProperty.Initialize(this);t.AttachTo(this)}return __extends(n,e),n.prototype.Resolve=function(e,n){for(var r=this.KeyFrames,o=t.KeyFrameCollection.ResolveKeyFrames(this,r),i=o.length,a=0;i>a;a++)if(!o[a].KeyTime.IsValid)return!1;return!0},n.prototype.GetCurrentValue=function(e,n,r){var o=this.KeyFrames,i={Value:null},a=o.GetKeyFrameForTime(r.CurrentTime,i),s=i.Value;if(!a)return null;var u,l,c=a._ResolvedKeyTime;s?(u=s instanceof t.ObjectKeyFrame?s.ConvertedValue:s.Value,l=s._ResolvedKeyTime):(u=e,l=new TimeSpan);var p;if(r.CurrentTime.CompareTo(c)>=0)p=1;else{var d=c.Ticks-l.Ticks;p=0>=d?1:(r.CurrentTime.Ticks-l.Ticks)/d}return a.InterpolateValue(u,p)},n.prototype.GetNaturalDurationCore=function(){var e,n=this.KeyFrames,r=t.KeyFrameCollection.ResolveKeyFrames(this,n),o=r.length;return e=o>0?r[o-1]._ResolvedKeyTime:new TimeSpan,new Duration(e)},n.prototype.AddKeyFrame=function(e){this.KeyFrames.Add(e)},n.prototype.RemoveKeyFrame=function(e){this.KeyFrames.Remove(e)},n.KeyFramesProperty=DependencyProperty.RegisterImmutable("KeyFrames",function(){return t.KeyFrameCollection},n),n}(t.AnimationBase);t.AnimationUsingKeyFrames=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.KeyFramesProperty)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.Fire=function(){var e=this.Storyboard;e&&e.Begin()},n.StoryboardProperty=DependencyProperty.RegisterCore("Storyboard",function(){return t.Storyboard},n),n}(e.TriggerAction);t.BeginStoryboard=n,e.CoreLibrary.add(n),e.Markup.Content(n,n.StoryboardProperty)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function n(){e.call(this),this._FromCached=null,this._ToCached=null,this._ByCached=null,this._EasingCached=void 0}return __extends(n,e),n.prototype.GetCurrentValue=function(e,t,n){var r=new Color;this._FromCached?r=this._FromCached:e instanceof Color&&(r=e);var o=r;this._ToCached?o=this._ToCached:this._ByCached?o=r.Add(this._ByCached):t instanceof Color&&(o=t);var i=this._EasingCached;return i&&(n.Progress=i.Ease(n.Progress)),Color.LERP(r,o,n.Progress)},n.prototype._FromChanged=function(e){this._FromCached=e.NewValue},n.prototype._ToChanged=function(e){this._ToCached=e.NewValue},n.prototype._ByChanged=function(e){this._ByCached=e.NewValue},n.prototype._EasingChanged=function(e){this._EasingCached=e.NewValue},n.prototype.GenerateFrom=function(){return new n},n.prototype.GenerateTo=function(e){var t=null!=this.From?this.From:this.To;if(null==t)return null;var r=new n;return r.To=t,r},n.ByProperty=DependencyProperty.Register("By",function(){return Color},n,null,function(e,t){return e._ByChanged(t)}),n.EasingFunctionProperty=DependencyProperty.Register("EasingFunction",function(){return t.EasingFunctionBase},n,void 0,function(e,t){return e._EasingChanged(t)}),n.FromProperty=DependencyProperty.Register("From",function(){return Color},n,null,function(e,t){return e._FromChanged(t)}),n.ToProperty=DependencyProperty.Register("To",function(){return Color},n,null,function(e,t){return e._ToChanged(t)}),n}(t.AnimationBase);t.ColorAnimation=n,e.CoreLibrary.add(n)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.GenerateFrom=function(){return new t.ColorAnimation},n.prototype.GenerateTo=function(e){var n=this.KeyFrames;if(0===n.Count)return null;var r=n.GetValueAt(e?0:n.Count-1).Value;if(null==r)return null;var o=new t.ColorAnimation;return o.To=r,o},n}(t.AnimationUsingKeyFrames);t.ColorAnimationUsingKeyFrames=n,e.CoreLibrary.add(n)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function t(){e.apply(this,arguments),this._ResolvedKeyTime=null,this._Resolved=!1}return __extends(t,e),t.prototype.CoerceKeyTime=function(e,t,n,r,o){return n?r.Value=n:r.Value=this.KeyTime,!0},t.prototype.InterpolateValue=function(e,t){return void 0},t.prototype.CompareToTimeSpan=function(e){return this._ResolvedKeyTime.CompareTo(e)},t.prototype.Listen=function(e){this._Listener=e},t.prototype.Unlisten=function(e){this._Listener===e&&(this._Listener=null)},t.prototype.InvalidateKeyFrame=function(){var e=this._Listener;e&&e.KeyFrameChanged(this)},t.Comparer=function(e,t){var n=e._ResolvedKeyTime,r=t._ResolvedKeyTime;return n.CompareTo(r)},t.ResolveKeyFrames=function(e,t){var n,r,o,i=!1,a=new TimeSpan,s=t.length;for(o=0;s>o;o++)r=t[o],r._ResolvedKeyTime=new TimeSpan,r._Resolved=!1;var u;for(o=0;s>o;o++)if(r=t[o],u=r.KeyTime,u.HasTimeSpan){i=!0;var l=u.TimeSpan;l.CompareTo(a)>0&&(a=l),r._ResolvedKeyTime=l,r._Resolved=!0}var c=e.Duration;for(n=c&&c.HasTimeSpan?c.TimeSpan:i?a:new TimeSpan(TimeSpan._TicksPerSecond),o=0;s>o;o++)r=t[o],u=r.KeyTime,u.HasPercent&&(r._ResolvedKeyTime=n.Multiply(u.Percent),r._Resolved=!0);return s>0&&(r=t[s-1],u=r.KeyTime,(u.IsPaced||u.IsUniform)&&(r._ResolvedKeyTime=n,r._Resolved=!0)),s>0&&(r=t[s-1],u=r.KeyTime,!r._Resolved&&u.IsPaced&&(r._ResolvedKeyTime=new TimeSpan,r._Resolved=!0)),t},t.KeyTimeProperty=DependencyProperty.Register("KeyTime",function(){return KeyTime},t,void 0,function(e,t){return e.InvalidateKeyFrame()}),t}(e.DependencyObject);t.KeyFrame=n,e.CoreLibrary.add(n);var r=function(e){function t(){e.apply(this,arguments),this._Resolved=!1,this._SortedList=[]}return __extends(t,e),t.prototype.GetKeyFrameForTime=function(e,t){var n,r=null,o=null,i=this._SortedList;if(0==i.length)return t.Value=null,null;var a,s;for(n=0;n<i.length&&(a=i[n],!(a.CompareToTimeSpan(e)>=0||n+1>=i.length));n++);for(;n>=0;n--)if(a=i[n],s=DependencyProperty.GetDependencyProperty(a.constructor,"Value"),void 0!==a.GetValue(s)){r=a;break}for(n--;n>=0;n--)if(a=i[n],s=DependencyProperty.GetDependencyProperty(a.constructor,"Value"),void 0!==a.GetValue(s)){o=a;break}return t.Value=o,r},t.prototype.Clear=function(){return this._Resolved=!1,this._SortedList=[],e.prototype.Clear.call(this)},t.prototype.AddingToCollection=function(t,n){return e.prototype.AddingToCollection.call(this,t,n)?(this._Resolved=!1,t.Listen(this),!0):!1},t.prototype.RemovedFromCollection=function(t,n){e.prototype.RemovedFromCollection.call(this,t,n),this._Resolved=!1,t.Unlisten(this)},t.prototype.KeyFrameChanged=function(e){this._Resolved=!1},t.ResolveKeyFrames=function(e,t){return t._Resolved?t._SortedList:(t._SortedList=n.ResolveKeyFrames(e,t._ht).slice(0),t._SortedList.sort(n.Comparer),t._Resolved=!0,t._SortedList)},t}(e.XamlObjectCollection);t.KeyFrameCollection=r,e.CoreLibrary.add(r)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.ValueProperty=DependencyProperty.Register("Value",function(){return Color},t),t}(t.KeyFrame);t.ColorKeyFrame=n,e.CoreLibrary.add(n);var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.InterpolateValue=function(e,t){return t>=1?this.Value:e},t}(n);t.DiscreteColorKeyFrame=r,e.CoreLibrary.add(r);var o=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.InterpolateValue=function(e,t){if(t>=1)return this.Value;var n=e,r=this.Value,o=this.EasingFunction;return o&&(t=o.Ease(t)),Color.LERP(n,r,t)},n.EasingFunctionProperty=DependencyProperty.Register("EasingFunction",function(){return t.EasingFunctionBase},n),n}(n);t.EasingColorKeyFrame=o,e.CoreLibrary.add(o);var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.InterpolateValue=function(e,t){return Color.LERP(e,this.Value,t)},t}(n);t.LinearColorKeyFrame=i,e.CoreLibrary.add(i);var a=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.InterpolateValue=function(e,t){if(t>=1)return this.Value;var n=e,r=this.Value,o=t,i=this.KeySpline;return i&&(o=i.GetSplineProgress(t)),Color.LERP(n,r,o)},n.KeySplineProperty=DependencyProperty.Register("KeySpline",function(){return t.KeySpline},n),n}(n);t.SplineColorKeyFrame=a,e.CoreLibrary.add(a)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.QuadraticArrayYForX=function(t,n,r){for(var o=0;r>o;o++)if(n<t[o].c2.x)return e.QuadraticYForX(n,t[o]);return 0},e.QuadraticYForX=function(e,t){var n=t.c2.x-t.c0.x;return 0>=n?0:(e=(e-t.c0.x)/n,(1-e)*(1-e)*t.c0.y+2*e*(1-e)*t.c1.y+e*e*t.c2.y)},e.SubdivideCubicAtLevel=function(t,n,r){e.RecursiveSubdivide(t,n,1,0,r)},e.RecursiveSubdivide=function(t,n,r,o,i){var a={b1:null,b2:null};e.SubdivideCubic(a,i);var s=a.b1,u=a.b2;return r===n?(t[o]=s,t[o+1]=u,o+2):(o=e.RecursiveSubdivide(t,n,r+1,o,s),o=e.RecursiveSubdivide(t,n,r+1,o,u))},e.SubdivideCubic=function(t,n){var r={x:0,y:0},o={x:0,y:0},i={x:0,y:0},a={x:0,y:0},s={x:0,y:0},u={x:0,y:0};e.HalfLerpPoint(r,n.c0,n.c1),e.HalfLerpPoint(a,n.c1,n.c2),e.HalfLerpPoint(u,n.c2,n.c3),e.HalfLerpPoint(o,r,a),e.HalfLerpPoint(s,a,u),e.HalfLerpPoint(i,o,s),t.b1={c0:n.c0,c1:r,c2:o,c3:i},t.b2={c0:i,c1:s,c2:u,c3:n.c3}},e.HalfLerpPoint=function(e,t,n){e.x=t.x+.5*(n.x-t.x),e.y=t.y+.5*(n.y-t.y)},e.ConvertCubicsToQuadratics=function(t,n){for(var r=[],o=0;n>o;o++)r.push(e.QuadraticFromCubic(t[o]));return r},e.QuadraticFromCubic=function(e){return{c0:{x:e.c0.x,y:e.c0.y},c1:{x:(e.c1.x+e.c2.x)/2,y:(e.c1.y+e.c2.y)/2},c2:{x:e.c3.x,y:e.c3.y}}},e}();e.Curves=t}(t=e.Animation||(e.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function n(){e.call(this),this._FromCached=null,this._ToCached=null,this._ByCached=null,this._EasingCached=void 0}return __extends(n,e),n.prototype.GetCurrentValue=function(e,t,n){var r=0;null!=this._FromCached?r=this._FromCached:null!=e&&"number"==typeof e&&(r=e);var o=r;null!=this._ToCached?o=this._ToCached:null!=this._ByCached?o=r+this._ByCached:null!=t&&"number"==typeof t&&(o=t);var i=this._EasingCached;return null!=i&&(n.Progress=i.Ease(n.Progress)),r+(o-r)*n.Progress},n.prototype._FromChanged=function(e){this._FromCached=e.NewValue},n.prototype._ToChanged=function(e){this._ToCached=e.NewValue},n.prototype._ByChanged=function(e){this._ByCached=e.NewValue},n.prototype._EasingChanged=function(e){this._EasingCached=e.NewValue},n.prototype.GenerateFrom=function(){return new n},n.prototype.GenerateTo=function(e){var t=null!=this.From?this.From:this.To;if(null==t)return null;var r=new n;return r.To=t,r},n.ByProperty=DependencyProperty.Register("By",function(){return Number},n,null,function(e,t){return e._ByChanged(t)}),n.EasingFunctionProperty=DependencyProperty.Register("EasingFunction",function(){return t.EasingFunctionBase},n,void 0,function(e,t){return e._EasingChanged(t)}),n.FromProperty=DependencyProperty.Register("From",function(){return Number},n,null,function(e,t){return e._FromChanged(t)}),n.ToProperty=DependencyProperty.Register("To",function(){return Number},n,null,function(e,t){return e._ToChanged(t)}),n}(t.AnimationBase);t.DoubleAnimation=n,e.CoreLibrary.add(n)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.GenerateFrom=function(){return new t.DoubleAnimation},n.prototype.GenerateTo=function(e){var n=this.KeyFrames;if(0===n.Count)return null;var r=n.GetValueAt(e?0:n.Count-1).Value;if(null==r)return null;var o=new t.DoubleAnimation;return o.To=r,o},n}(t.AnimationUsingKeyFrames);t.DoubleAnimationUsingKeyFrames=n,e.CoreLibrary.add(n)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.ValueProperty=DependencyProperty.Register("Value",function(){return Number},t),t}(t.KeyFrame);t.DoubleKeyFrame=n,e.CoreLibrary.add(n);var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.InterpolateValue=function(e,t){return t>=1?this.Value:e},t}(n);t.DiscreteDoubleKeyFrame=r,e.CoreLibrary.add(r);var o=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.InterpolateValue=function(e,t){if(t>=1)return this.Value;var n=e,r=this.Value,o=this.EasingFunction;return o&&(t=o.Ease(t)),isNaN(n)&&(n=0),isNaN(r)&&(r=0),n+(r-n)*t},n.EasingFunctionProperty=DependencyProperty.Register("EasingFunction",function(){return t.EasingFunctionBase},n),n}(n);t.EasingDoubleKeyFrame=o,e.CoreLibrary.add(o);var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.InterpolateValue=function(e,t){var n=e,r=this.Value;return isNaN(n)&&(n=0),isNaN(r)&&(r=0),n+(r-n)*t},t}(n);t.LinearDoubleKeyFrame=i,e.CoreLibrary.add(i);var a=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.InterpolateValue=function(e,t){if(t>=1)return this.Value;var n=e,r=this.Value,o=t,i=this.KeySpline;return i&&(o=i.GetSplineProgress(t)),isNaN(n)&&(n=0),isNaN(r)&&(r=0),n+(r-n)*o},n.KeySplineProperty=DependencyProperty.Register("KeySpline",function(){return t.KeySpline},n),n}(n);t.SplineDoubleKeyFrame=a,e.CoreLibrary.add(a)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.Ease=function(e){var n=this.EasingMode;switch(n){case t.EasingMode.EaseIn:return this.EaseInCore(e);case t.EasingMode.EaseOut:return this.EaseInCore(1-e);case t.EasingMode.EaseInOut:return.5>=e?.5*this.EaseInCore(2*e):1-this.EaseInCore(2*(1-e)*.5);default:return 0}},r.prototype.EaseInCore=function(e){return e},r.EasingModeProperty=DependencyProperty.Register("EasingMode",function(){return new e.Enum(t.EasingMode)},r),r}(e.DependencyObject);t.EasingFunctionBase=n}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){var t=this.Amplitude;return e*e*e-e*t*Math.sin(e*Math.PI)},t.AmplitudeProperty=DependencyProperty.Register("Amplitude",function(){return Number},t),t}(t.EasingFunctionBase);t.BackEase=n,e.CoreLibrary.add(n);var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){e=1-e;for(var t=this.Bounces,n=this.Bounciness,r=-1,o=2,i=0;t>=i;i++)r+=o*Math.pow(1+n/2,-i);for(var a=-1,s=0,u=r*r,l=100,c=0;l>0;)s=a+o*Math.pow(1+n/2,-c++),l=u*(e-a/r)*(e-s/r),a=s;return-l},t.BouncesProperty=DependencyProperty.Register("Bounces",function(){return Number},t,3),t.BouncinessProperty=DependencyProperty.Register("Bounciness",function(){return Number},t,2),t}(t.EasingFunctionBase);t.BounceEase=r,e.CoreLibrary.add(r);var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){return 1-Math.sqrt(1-e*e)},t}(t.EasingFunctionBase);t.CircleEase=o,e.CoreLibrary.add(o);var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){return e*e*e},t}(t.EasingFunctionBase);t.CubicEase=i,e.CoreLibrary.add(i);var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){var t=1/(this.Oscillations+.25),n=t/4;return e-=1,e*-Math.pow(2,this.Springiness*e)*Math.sin((e-n)*Math.PI*2/t)},t.OscillationsProperty=DependencyProperty.Register("Oscillations",function(){return Number},t),t.SpringinessProperty=DependencyProperty.Register("Springiness",function(){return Number},t),t}(t.EasingFunctionBase);t.ElasticEase=a,e.CoreLibrary.add(a);var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){var t=this.Exponent;return(Math.exp(t*e)-1)/(Math.exp(t)-1)},t.ExponentProperty=DependencyProperty.Register("Exponent",function(){return Number},t),t}(t.EasingFunctionBase);t.ExponentialEase=s,e.CoreLibrary.add(s);var u=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){return Math.pow(e,this.Power)},t.PowerProperty=DependencyProperty.Register("Power",function(){return Number},t),t}(t.EasingFunctionBase);t.PowerEase=u,e.CoreLibrary.add(u);var l=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){return e*e},t}(t.EasingFunctionBase);t.QuadraticEase=l,e.CoreLibrary.add(l);var c=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){return e*e*e*e},t}(t.EasingFunctionBase);t.QuarticEase=c,e.CoreLibrary.add(c);var p=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){return e*e*e*e*e},t}(t.EasingFunctionBase);t.QuinticEase=p,e.CoreLibrary.add(p);var d=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.EaseInCore=function(e){return 1-Math.sin(1-e)*(Math.PI/2)},t}(t.EasingFunctionBase);t.SineEase=d,e.CoreLibrary.add(d)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function n(){e.apply(this,arguments),this._QuadraticsArray=null}return __extends(n,e),n.prototype.GetSplineProgress=function(e){return e>=1?1:0>=e?0:(this._QuadraticsArray||this._RegenerateQuadratics(),t.Curves.QuadraticArrayYForX(this._QuadraticsArray,e,n.TOTAL_COUNT))},n.prototype.InvalidateControlPoints=function(){this._QuadraticsArray=null},n.prototype._RegenerateQuadratics=function(){var e=this.ControlPoint1||new Point(0,0),r=this.ControlPoint2||new Point(1,1),o={c0:{x:0,y:0},c1:{x:e.x,y:e.y},c2:{x:r.x,y:r.y},c3:{x:1,y:1}},i=[];t.Curves.SubdivideCubicAtLevel(i,n.PRECISION_LEVEL,o),this._QuadraticsArray=t.Curves.ConvertCubicsToQuadratics(i,n.TOTAL_COUNT)},n.PRECISION_LEVEL=4,n.TOTAL_COUNT=Math.pow(2,n.PRECISION_LEVEL),n.ControlPoint1Property=DependencyProperty.RegisterCore("ControlPoint1",function(){return Point},n,void 0,function(e,t){return e.InvalidateControlPoints()}),n.ControlPoint2Property=DependencyProperty.RegisterCore("ControlPoint2",function(){return Point},n,void 0,function(e,t){return e.InvalidateControlPoints()}),n}(e.DependencyObject);t.KeySpline=n,e.CoreLibrary.add(n)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){function n(e,t){try{return nullstone.convertAnyToType(t,e.GetTargetType())}catch(n){return console.warn("Error resolving ObjectAnimation Value."),o}}var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.Resolve=function(t,r){for(var i=this.KeyFrames.getEnumerator();i.moveNext();){var a=i.current,s=a.Value;if(null==s)a.ConvertedValue=void 0;else{var u=n(r,s);if(u===o)return!1;a.ConvertedValue=u}}return e.prototype.Resolve.call(this,t,r)},t}(t.AnimationUsingKeyFrames);t.ObjectAnimationUsingKeyFrames=r,e.CoreLibrary.add(r);var o={}}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function t(){e.apply(this,arguments),this.ConvertedValue=void 0}return __extends(t,e),t.ValueProperty=DependencyProperty.Register("Value",function(){return Object},t),t}(t.KeyFrame);t.ObjectKeyFrame=n,e.CoreLibrary.add(n);var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.InterpolateValue=function(e,t){return t>=1?this.ConvertedValue:e},t}(n);t.DiscreteObjectKeyFrame=r,e.CoreLibrary.add(r)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function n(){e.call(this),this._FromCached=null,this._ToCached=null,this._ByCached=null,this._EasingCached=void 0}return __extends(n,e),n.prototype.GetCurrentValue=function(e,t,n){var r=new Point;null!=this._FromCached?r=this._FromCached:e instanceof Point&&(r=e);var o=r;null!=this._ToCached?o=this._ToCached:null!=this._ByCached?o=new Point(r.x+this._ByCached.x,r.y+this._ByCached.y):t instanceof Point&&(o=t);var i=this._EasingCached;return null!=i&&(n.Progress=i.Ease(n.Progress)),Point.LERP(r,o,n.Progress)},n.prototype._FromChanged=function(e){this._FromCached=e.NewValue},n.prototype._ToChanged=function(e){this._ToCached=e.NewValue},n.prototype._ByChanged=function(e){this._ByCached=e.NewValue},n.prototype._EasingChanged=function(e){this._EasingCached=e.NewValue},n.prototype.GenerateFrom=function(){return new n},n.prototype.GenerateTo=function(e){var t=null!=this.From?this.From:this.To;if(null==t)return null;var r=new n;return r.To=t,r},n.ByProperty=DependencyProperty.Register("By",function(){return Point},n,null,function(e,t){return e._ByChanged(t)}),n.EasingFunctionProperty=DependencyProperty.Register("EasingFunction",function(){return t.EasingFunctionBase},n,void 0,function(e,t){return e._EasingChanged(t)}),n.FromProperty=DependencyProperty.Register("From",function(){return Point},n,null,function(e,t){return e._FromChanged(t)}),n.ToProperty=DependencyProperty.Register("To",function(){return Point},n,null,function(e,t){return e._ToChanged(t)}),n}(t.AnimationBase);t.PointAnimation=n,e.CoreLibrary.add(n)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.GenerateFrom=function(){return new t.PointAnimation},n.prototype.GenerateTo=function(e){var n=this.KeyFrames;if(0===n.Count)return null;var r=n.GetValueAt(e?0:n.Count-1).Value;if(null==r)return null;var o=new t.PointAnimation;return o.To=r,o},n}(t.AnimationUsingKeyFrames);t.PointAnimationUsingKeyFrames=n,e.CoreLibrary.add(n)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.ValueProperty=DependencyProperty.Register("Value",function(){return Point},t),t}(t.KeyFrame);t.PointKeyFrame=n,e.CoreLibrary.add(n);var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.InterpolateValue=function(e,t){return t>=1?this.Value:e},t}(n);t.DiscretePointKeyFrame=r,e.CoreLibrary.add(r);var o=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.InterpolateValue=function(e,t){if(t>=1)return this.Value;var n=e,r=this.Value,o=this.EasingFunction;return o&&(t=o.Ease(t)),Point.LERP(n,r,t)},n.EasingFunctionProperty=DependencyProperty.Register("EasingFunction",function(){return t.EasingFunctionBase},n),n}(n);t.EasingPointKeyFrame=o,e.CoreLibrary.add(o);var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.InterpolateValue=function(e,t){return Point.LERP(e,this.Value,t)},t}(n);t.LinearPointKeyFrame=i,e.CoreLibrary.add(i);var a=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.InterpolateValue=function(e,t){if(t>=1)return this.Value;var n=e,r=this.Value,o=t,i=this.KeySpline;return i&&(o=i.GetSplineProgress(t)),isNaN(n.x)&&(n.x=0),isNaN(n.y)&&(n.y=0),isNaN(r.x)&&(r.x=0),isNaN(r.y)&&(r.y=0),Point.LERP(n,r,o)},n.KeySplineProperty=DependencyProperty.Register("KeySpline",function(){return t.KeySpline},n),n}(n);t.SplinePointKeyFrame=a,e.CoreLibrary.add(a)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){function n(e,t,n,o){for(var i,a=[],s="",u=t.Children.getEnumerator();u.moveNext();){i=u.current,s="",s+="(",s+=i.constructor.name,s+=":",s+=r.GetTargetName(i),s+=":";var l=r.GetTargetProperty(i);
s+=l?l.Path:"",s+=")",a.push(s)}var c="ANIMATION:"+e+":"+t._ID;return o&&(c+="("+(100*o.Progress).toFixed(0)+"%)"),n&&(c+="->["+a.join(",")+"]"),c}var r=function(r){function o(){r.call(this);var e=o.ChildrenProperty.Initialize(this);e.AttachTo(this)}return __extends(o,r),o.GetTargetName=function(e){return e.GetValue(o.TargetNameProperty)},o.SetTargetName=function(e,t){return e.SetValue(o.TargetNameProperty,t)},o.GetTargetProperty=function(e){return e.GetValue(o.TargetPropertyProperty)},o.SetTargetProperty=function(e,t){return e.SetValue(o.TargetPropertyProperty,t)},o.ResolveTarget=function(e){var t={Target:void 0,Property:void 0};if(e.HasManualTarget)t.Target=e.ManualTarget;else{var n=o.GetTargetName(e);n&&(t.Target=e.FindName(n,!0))}return t.Property=o.GetTargetProperty(e),t},o.SetTarget=function(e,t){e.ManualTarget=t},o.prototype.Begin=function(){t.Log&&console.log(n("Storyboard.Begin",this,!0)),this.Reset();for(var r=new BError,o=[],i=this.Children.getEnumerator();i.moveNext();){var a=i.current;a._Hookup(o,r)||r.ThrowException()}e.Application.Current.RegisterStoryboard(this)},o.prototype.Pause=function(){r.prototype.Pause.call(this);for(var e=this.Children.getEnumerator();e.moveNext();)e.current.Pause()},o.prototype.Resume=function(){r.prototype.Resume.call(this);for(var e=this.Children.getEnumerator();e.moveNext();)e.current.Resume()},o.prototype.Stop=function(){t.Log&&console.log(n("Storyboard.Stop",this,!1)),r.prototype.Stop.call(this),e.Application.Current.UnregisterStoryboard(this);for(var o=this.Children.getEnumerator();o.moveNext();)o.current.Stop()},o.prototype.UpdateInternal=function(e){t.Log&&console.log(n("Storyboard.UpdateInternal",this,!1,e));for(var r=this.Children.getEnumerator();r.moveNext();)r.current.Update(e.CurrentTime.Ticks)},o.prototype.GetNaturalDurationCore=function(){for(var e=0,n=this.Children.getEnumerator();n.moveNext();){var r=n.current,o=r.GetNaturalDuration();if(!o.IsAutomatic){if(o.IsForever)return Duration.Forever;var i=o.TimeSpan.Ticks,a=r.RepeatBehavior||t.Timeline.DEFAULT_REPEAT_BEHAVIOR;if(a.IsForever)return Duration.Forever;a.HasCount&&(i*=a.Count),r.AutoReverse&&(i*=2),a.HasDuration&&(i=a.Duration.TimeSpan.Ticks),0!==i&&(i/=r.SpeedRatio);var s=r.BeginTime;s&&(i+=s.Ticks),(0===e||i>=e)&&(e=i)}}return e?new Duration(new TimeSpan(e)):Duration.Automatic},o.TargetNameProperty=DependencyProperty.RegisterAttached("TargetName",function(){return String},o),o.TargetPropertyProperty=DependencyProperty.RegisterAttached("TargetProperty",function(){return e.Data.PropertyPath},o),o.ChildrenProperty=DependencyProperty.RegisterImmutable("Children",function(){return t.TimelineCollection},o),o}(t.Timeline);t.Storyboard=r,e.CoreLibrary.add(r),e.Markup.Content(r,r.ChildrenProperty)}(n=t.Animation||(t.Animation={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.PreRender=function(e){},n.prototype.PostRender=function(e){},n.prototype.GetPadding=function(e){return!1},n.EffectMappingProperty=DependencyProperty.Register("EffectMapping",function(){return t.GeneralTransform},n),n}(e.DependencyObject);n.Effect=r,e.CoreLibrary.add(r);var o;!function(t){e.DPReaction(r.EffectMappingProperty,function(t,n,r){return e.Incite(t)})}(o||(o={}))}(n=t.Effects||(t.Effects={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.RadiusProperty=DependencyProperty.Register("Radius",function(){return Number},n,void 0,e.Incite),n}(t.Effect);t.BlurEffect=n,e.CoreLibrary.add(n)}(n=t.Effects||(t.Effects={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.GetPadding=function(e){var t=Math.min(this.BlurRadius,n.MAX_BLUR_RADIUS),r=Math.min(Math.max(0,this.ShadowDepth),n.MAX_SHADOW_DEPTH),o=this.Direction*Math.PI/180,i=Math.ceil(t),a=Math.cos(o)*r,s=Math.sin(o)*r,u=-a+i,l=s+i,c=a+i,p=-s+i,d=1>u?1:Math.ceil(u),h=1>l?1:Math.ceil(l),y=1>c?1:Math.ceil(c),f=1>p?1:Math.ceil(p),m=e.left!==d||e.top!==h||e.right!==y||e.bottom!==f;return e.left=d,e.top=h,e.right=y,e.bottom=f,m},n.prototype.PreRender=function(e){var t=this.Color,r=t.A*this.Opacity,o=Math.min(this.BlurRadius,n.MAX_BLUR_RADIUS),i=Math.min(Math.max(0,this.ShadowDepth),n.MAX_SHADOW_DEPTH),a=this.Direction*Math.PI/180,s=Math.cos(a)*i,u=-Math.sin(a)*i,l=e.raw;l.shadowColor="rgba("+t.R+","+t.G+","+t.B+","+r+")",l.shadowBlur=o,l.shadowOffsetX=s,l.shadowOffsetY=u},n.MAX_BLUR_RADIUS=20,n.MAX_SHADOW_DEPTH=300,n.BlurRadiusProperty=DependencyProperty.Register("BlurRadius",function(){return Number},n,5,e.Incite),n.ColorProperty=DependencyProperty.Register("Color",function(){return Color},n,Color.KnownColors.Black,e.Incite),n.DirectionProperty=DependencyProperty.Register("Direction",function(){return Number},n,315,e.Incite),n.OpacityProperty=DependencyProperty.Register("Opacity",function(){return Number},n,1,e.Incite),n.ShadowDepthProperty=DependencyProperty.Register("ShadowDepth",function(){return Number},n,5,e.Incite),n}(t.Effect);t.DropShadowEffect=n,e.CoreLibrary.add(n)}(n=t.Effects||(t.Effects={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),Object.defineProperty(t.prototype,"pixelWidth",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelHeight",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.lock=function(){},t.prototype.unlock=function(){},Object.defineProperty(t.prototype,"image",{get:function(){return void 0},enumerable:!0,configurable:!0}),t}(e.DependencyObject);t.ImageSource=n,e.CoreLibrary.add(n)}(n=t.Imaging||(t.Imaging={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){function n(e,t,n){return"number"!=typeof n?!1:n>0}var r=function(t){function r(){t.apply(this,arguments),this._Listener=null}return __extends(r,t),Object.defineProperty(r.prototype,"pixelWidth",{get:function(){return this.GetValue(r.PixelWidthProperty)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pixelHeight",{get:function(){return this.GetValue(r.PixelHeightProperty)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"image",{get:function(){return this._Image},enumerable:!0,configurable:!0}),r.prototype.ResetImage=function(){var e=this;this._Image=new Image,this._Image.onerror=function(t){return e._OnErrored(t)},this._Image.onload=function(t){return e._OnLoad(t)},this.PixelWidth=0,this.PixelHeight=0;var t=this._Listener;t&&t.ImageChanged(this)},r.prototype.UriSourceChanged=function(t,n){this._Image&&n||this.ResetImage(),this._Image.src=e.TypeManager.resolveResource(n);var r=this._Listener;r&&r.ImageChanged(this)},r.prototype.Listen=function(e){this._Listener=e},r.prototype.Unlisten=function(e){this._Listener===e&&(this._Listener=null)},r.prototype._OnErrored=function(e){console.info("Failed to load: "+this._Image.src.toString());var t=this._Listener;t&&t.OnImageErrored(this,e)},r.prototype._OnLoad=function(e){this.PixelWidth=this._Image.naturalWidth,this.PixelHeight=this._Image.naturalHeight;var t=this._Listener;t&&(t.OnImageLoaded(this,e),t.ImageChanged(this))},r.PixelWidthProperty=DependencyProperty.RegisterFull("PixelWidth",function(){return Number},r,0,void 0,void 0,void 0,n),r.PixelHeightProperty=DependencyProperty.RegisterFull("PixelHeight",function(){return Number},r,0,void 0,void 0,void 0,n),r}(t.ImageSource);t.BitmapSource=r,e.CoreLibrary.add(r)}(n=t.Imaging||(t.Imaging={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(n){function r(e){n.call(this),this.ImageFailed=new nullstone.Event,this.ImageOpened=new nullstone.Event,this._BackingBuffer=null,e&&(this.UriSource=e)}return __extends(r,n),r.prototype._UriSourceChanged=function(t){var n=t.NewValue;e.Uri.isNullOrEmpty(n)?this.ResetImage():this.UriSourceChanged(t.OldValue,n)},r.prototype._OnErrored=function(e){n.prototype._OnErrored.call(this,e),this.ImageFailed.raise(this,null)},r.prototype._OnLoad=function(e){n.prototype._OnLoad.call(this,e),this.ImageOpened.raise(this,null)},r.prototype.SetSource=function(e){this._BackingBuffer=e,this.UriSource=t.encodeImage(e)},r.UriSourceProperty=DependencyProperty.RegisterFull("UriSource",function(){return e.Uri},r,void 0,function(e,t){return e._UriSourceChanged(t)},void 0,!0),r}(t.BitmapSource);t.BitmapImage=n,e.CoreLibrary.add(n),nullstone.registerTypeConverter(t.ImageSource,function(r){if(!r)return null;if(r instanceof t.ImageSource)return r;if(r instanceof ArrayBuffer){var o=new n;return o.SetSource(r),o}var o=new n;return o.UriSource=nullstone.convertAnyToType(r,e.Uri),o})}(n=t.Imaging||(t.Imaging={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(r){function o(){r.apply(this,arguments),this.ImageFailed=new nullstone.Event,this.ImageOpened=new nullstone.Event}return __extends(o,r),o._SourceCoercer=function(n,r,o){return"string"==typeof o?new t.Imaging.BitmapImage(new e.Uri(o)):o instanceof e.Uri?new t.Imaging.BitmapImage(o):o},o.prototype.setupBrush=function(e,t){var n=this.ImageSource;n&&n.image&&r.prototype.setupBrush.call(this,e,t)},o.prototype.GetTileExtents=function(){var e=this.ImageSource;return new minerva.Rect(0,0,e.pixelWidth,e.pixelHeight)},o.prototype.DrawTile=function(e,t){var n=this.ImageSource;e.rect(0,0,n.pixelWidth,n.pixelHeight),e.fillStyle=e.createPattern(n.image,"no-repeat"),e.fill()},o.prototype._ImageSourceChanged=function(e){var t;(t=e.OldValue)&&t instanceof n.BitmapSource&&t.Unlisten(this);var r;(r=e.NewValue)&&r instanceof n.BitmapSource&&r.Listen(this),this.InvalidateBrush()},o.prototype.OnImageErrored=function(e,t){this.ImageFailed.raise(this,null)},o.prototype.OnImageLoaded=function(e,t){this.ImageOpened.raise(this,null)},o.prototype.ImageChanged=function(e){this.InvalidateBrush()},o.ImageSourceProperty=DependencyProperty.RegisterFull("ImageSource",function(){return n.ImageSource},o,void 0,function(e,t){return e._ImageSourceChanged(t)},o._SourceCoercer),o}(t.TileBrush);n.ImageBrush=r,e.CoreLibrary.add(r)}(n=t.Imaging||(t.Imaging={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){function n(t){var n=new Uint8Array(t),i=o(n),a=r(n);return new e.Uri("data:"+a+";base64,"+i)}function r(e){return i(e)?"image/jpeg":a(e)?"image/png":"image/jpeg"}function o(e){for(var t=[],n=0;n<e.byteLength;n++)t.push(String.fromCharCode(e[n]));return window.btoa(t.join(""))}function i(e){return 255===e[0]&&216===e[1]&&255===e[e.length-2]&&217===e[e.length-1]}function a(e){return 137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]&&13===e[4]&&10===e[5]&&26===e[6]&&10===e[7]}t.encodeImage=n}(n=t.Imaging||(t.Imaging={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){function t(t,n,r){var o={x:t.x,y:t.y},i={x:n.x,y:n.y},a={x:n.x-t.x,y:n.y-t.y};e.calcMetrics(a,o,i,r);var s=(i.x-o.x)/a.x,u=1/s,l=-u;return{x0:o.x,y0:o.y,x1:i.x,y1:i.y,step:function(){return l+=u,1>l},interpolate:function(e){return l+e/s}}}function n(t,n,r){var o={x:t.x,y:t.y},i={x:n.x,y:n.y},a={x:n.x-t.x,y:n.y-t.y};e.calcMetrics(a,o,i,r);var s=(i.x-o.x)/a.x,u=1/s,l=-u,c=Math.round((t.x-o.x)/a.x)%2===0;return{x0:o.x,y0:o.y,x1:i.x,y1:i.y,step:function(){return c=!c,l+=u,1>l},interpolate:function(e){var t=e/s;return c?l+(u-t):l+t}}}e.createRepeatInterpolator=t,e.createReflectInterpolator=n}(t=e.LinearGradient||(e.LinearGradient={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){function t(e,t,c,p){0===e.y?e.x<0?r(e,t,c,p):0!==e.x&&n(e,t,c,p):0===e.x?e.y<0?i(e,t,c,p):0!==e.y&&o(e,t,c,p):e.x<0&&e.y<0?a(e,t,c,p):e.x<0&&e.y>0?s(e,t,c,p):e.x>0&&e.y<0?u(e,t,c,p):e.x>0&&e.y>0&&l(e,t,c,p)}function n(e,t,n,r){for(var o=r.x+r.width;t.x>=r.x;)t.x-=e.x;for(;n.x<=o;)n.x+=e.x}function r(e,t,n,r){for(var o=r.x+r.width;t.x<=o;)t.x-=e.x;for(;n.x>=r.x;)n.x+=e.x}function o(e,t,n,r){for(var o=r.y+r.height;t.y>=r.y;)t.y-=e.y;for(;n.y<=o;)n.y+=e.y}function i(e,t,n,r){for(var o=r.y+r.height;t.y<=o;)t.y-=e.y;for(;n.y>=r.y;)n.y+=e.y}function a(e,t,n,r){for(var o=r.x+r.width,i=r.y+r.height;t.x<=o&&t.y<=i;)t.x-=e.x,t.y-=e.y;for(;n.x>=r.x&&n.y>=r.y;)n.x+=e.x,n.y+=e.y}function s(e,t,n,r){for(var o=r.x+r.width,i=r.y+r.height;t.x<=o&&t.y>=r.y;)t.x-=e.x,t.y-=e.y;for(;n.x>=r.x&&n.y<=i;)n.x+=e.x,n.y+=e.y}function u(e,t,n,r){for(var o=r.x+r.width,i=r.y+r.height;t.x>=r.x&&t.y<=i;)t.x-=e.x,t.y-=e.y;for(;n.x<=o&&n.y>=r.y;)n.x+=e.x,n.y+=e.y}function l(e,t,n,r){for(var o=r.x+r.width,i=r.y+r.height;t.x>=r.x&&t.y>=r.y;)t.x-=e.x,t.y-=e.y;for(;n.x<=o&&n.y<=i;)n.x+=e.x,n.y+=e.y}e.calcMetrics=t}(t=e.LinearGradient||(e.LinearGradient={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(e){function t(e,t){var r=!1,o=e.x1-e.x0,i=e.y1-e.y0,a=e.r1,s=!1,u={x0:e.x0,y0:e.y0,r0:0,x1:e.x1,y1:e.y1,r1:e.r1,step:function(){return r?(u.x0=u.x1,u.y0=u.y1,u.r0+=a,u.r1+=a,u.x1+=o,u.y1+=i,s?!1:(s=n(u.x1,u.y1,u.r1,t),!0)):(r=!0,!0)},createGradient:function(e){return e.createRadialGradient(u.x0,u.y0,u.r0,u.x1,u.y1,u.r1)}};return u}function n(e,t,n,o){var i=r(e,t,o.x,o.y),a=r(e,t,o.x+o.width,o.y),s=r(e,t,o.x+o.width,o.y+o.height),u=r(e,t,o.x,o.y+o.height);return Math.max(i,a,s,u)<n}function r(e,t,n,r){var o=n-e,i=r-t;return Math.sqrt(o*o+i*i)}e.createExtender=t}(t=e.RadialGradient||(e.RadialGradient={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.StoryboardProperty=DependencyProperty.Register("Storyboard",function(){return t.Animation.Storyboard},n),n}(e.DependencyObject);n.VisualState=r,e.CoreLibrary.add(r),e.Markup.Content(r,r.StoryboardProperty);var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.XamlObjectCollection);n.VisualStateCollection=o,e.CoreLibrary.add(o)}(n=t.VSM||(t.VSM={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(t){var n=function(){function e(e,t,n){Object.defineProperty(this,"OldState",{value:e,writable:!1}),Object.defineProperty(this,"NewState",{value:t,writable:!1}),Object.defineProperty(this,"Control",{value:n,writable:!1})}return e}();t.VisualStateChangedEventArgs=n;var r=function(r){function o(){r.call(this),this._CurrentStoryboards=[],this.CurrentStateChanging=new nullstone.Event,this.CurrentStateChanged=new nullstone.Event,this.CurrentState=null,o.StatesProperty.Initialize(this),o.TransitionsProperty.Initialize(this)}return __extends(o,r),Object.defineProperty(o.prototype,"CurrentStoryboards",{get:function(){return this._CurrentStoryboards.slice(0)},enumerable:!0,configurable:!0}),o.prototype.GetState=function(e){for(var t,n=this.States.getEnumerator();n.moveNext();)if(t=n.current,t.Name===e)return t;return null},o.prototype.StartNewThenStopOld=function(e,t){var n,r,o=e.Resources;for(n=0;n<t.length;n++)if(r=t[n],null!=r){o.Set(r._ID,r);try{r.Begin()}catch(i){for(var a=0;n>=a;a++)null!=t[a]&&o.Set(t[a]._ID,void 0);console.warn(i)}}this.StopCurrentStoryboards(e);var s=this._CurrentStoryboards;for(n=0;n<t.length;n++)null!=t[n]&&s.push(t[n])},o.prototype.StopCurrentStoryboards=function(e){for(var t,n=this._CurrentStoryboards,r=nullstone.IEnumerator_.fromArray(n);r.moveNext();)t=r.current,t&&(e.Resources.Set(t._ID,void 0),t.Stop());this._CurrentStoryboards=[]},o.prototype.Deactivate=function(){for(var e=nullstone.IEnumerator_.fromArray(this._CurrentStoryboards);e.moveNext();)e.current&&e.current.Pause()},o.prototype.Activate=function(){for(var e=nullstone.IEnumerator_.fromArray(this._CurrentStoryboards);e.moveNext();)e.current&&e.current.Resume()},o.prototype.RaiseCurrentStateChanging=function(e,t,r,o){this.CurrentStateChanging.raise(this,new n(t,r,o))},o.prototype.RaiseCurrentStateChanged=function(e,t,r,o){this.CurrentStateChanged.raise(this,new n(t,r,o))},o.StatesProperty=DependencyProperty.RegisterImmutable("States",function(){return t.VisualStateCollection},o),o.TransitionsProperty=DependencyProperty.RegisterImmutable("Transitions",function(){return e.XamlObjectCollection},o),o}(e.DependencyObject);t.VisualStateGroup=r,e.CoreLibrary.add(r),e.Markup.Content(r,r.StatesProperty);var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.XamlObjectCollection);t.VisualStateGroupCollection=o,e.CoreLibrary.add(o)}(n=t.VSM||(t.VSM={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){function r(e,n,r,s){var l=new t.Animation.Storyboard;null!=s?l.Duration=s.GeneratedDuration:l.Duration=new Duration(new TimeSpan);for(var c=a(n.CurrentStoryboards),p=a([null!=s?s.Storyboard:null]),d=a([r.Storyboard]),h=0,y=p.length;y>h;h++)u(p[h],c),u(p[h],d);for(var f,h=0,y=d.length;y>h;h++){f=d[h];var m=i(e,f.timeline,!0);null!=m&&(o(e,f.timeline,m),m.Duration=l.Duration,l.Children.Add(m)),u(f,c)}for(var h=0,y=c.length;y>h;h++){f=c[h];var v=f.timeline.GenerateFrom();if(null!=v){o(e,f.timeline,v),v.Duration=l.Duration;var g=t.Animation.Storyboard.GetTargetProperty(f.timeline);t.Animation.Storyboard.SetTargetProperty(v,g),l.Children.Add(v)}}return l}function o(e,t,n){if(null!=t.ManualTarget)c.SetTarget(n,t.ManualTarget);else{var r=c.GetTargetName(t);r&&c.SetTargetName(n,r)}}function i(t,n,r){var o=n.GenerateTo(r);if(!o)return null;var i=c.GetTargetName(n);if(c.SetTargetName(o,i),i){var a=t.FindName(i);a instanceof e.DependencyObject&&c.SetTarget(o,a)}return c.SetTargetProperty(o,c.GetTargetProperty(n)),o}function a(e){for(var t=[],n=0,r=e.length;r>n;n++)s(function(e){return t.push(e)},e[n],null,null);return t}function s(t,n,r,o){if(n){var i=c.ResolveTarget(n);if(i.Target&&(r=i.Target),i.Property&&(o=i.Property),n instanceof c)for(var a=0,u=n.Children,l=u.Count;l>a;a++)s(t,u.GetValueAt(a),r,o);else if(o&&r){var p={Value:r},d=e.Data.PropertyPath.ResolvePropertyPath(p,o,[]);d&&p.Value&&t({dobj:p.Value,propd:d,timeline:n})}}}function u(e,t){for(var n=0,r=t.length;r>n;n++){var o=t[n];if(o.dobj===e.dobj&&o.propd===e.propd)return t.splice(n,1)}}var l=function(t){function o(){t.apply(this,arguments)}return __extends(o,t),o.GetVisualStateGroups=function(e){return e.GetValue(o.VisualStateGroupsProperty)},o.SetVisualStateGroups=function(e,t){e.SetValue(o.VisualStateGroupsProperty,t)},o.GetCustomVisualStateManager=function(e){return e.GetValue(o.CustomVisualStateManagerProperty)},o.SetCustomVisualStateManager=function(e,t){e.SetValue(o.CustomVisualStateManagerProperty,t)},o.GoToState=function(e,t,n){if(!e)throw new ArgumentException("control");if(!t)throw new ArgumentException("stateName");var r=o._GetTemplateRoot(e);if(!r)return!1;var i=o.GetVisualStateGroups(r);if(!i)return!1;var a={group:null,state:null};if(!o._TryGetState(i,t,a))return!1;var s=o.GetCustomVisualStateManager(r);return s?s.GoToStateCore(e,r,t,a.group,a.state,n):null!=a.state?o.GoToStateInternal(e,r,a.group,a.state,n):!1},o.prototype.GoToStateCore=function(e,t,n,r,i,a){return o.GoToStateInternal(e,t,r,i,a)},o.GoToStateInternal=function(e,t,i,a,s){var u=i.CurrentState;if(u===a)return!0;n.Debug&&window.console&&console.log("VSM:GoToState:["+e._ID+"]"+(u?u.Name:"()")+"-->"+a.Name);var l,c=s?o._GetTransition(t,i,u,a):null;if(null==c||c.GeneratedDuration.IsZero&&(null==(l=c.Storyboard)||l.Duration.IsZero))null!=c&&null!=l?i.StartNewThenStopOld(t,[l,a.Storyboard]):i.StartNewThenStopOld(t,[a.Storyboard]),i.RaiseCurrentStateChanging(t,u,a,e),i.RaiseCurrentStateChanged(t,u,a,e);else{var p=r(t,i,a,c);c.DynamicStoryboardCompleted=!1;var d=function(n,r){(null==c.Storyboard||c.ExplicitStoryboardCompleted===!0)&&(i.StartNewThenStopOld(t,[a.Storyboard]),i.RaiseCurrentStateChanged(t,u,a,e)),c.DynamicStoryboardCompleted=!0},h={};if(p.Completed.on(d,h),null!=c.Storyboard&&c.ExplicitStoryboardCompleted===!0){var y=function(n,r){c.DynamicStoryboardCompleted===!0&&(i.StartNewThenStopOld(t,[a.Storyboard]),i.RaiseCurrentStateChanged(t,u,a,e)),c.Storyboard.Completed.off(y,h),c.ExplicitStoryboardCompleted=!0};c.ExplicitStoryboardCompleted=!1,c.Storyboard.Completed.on(y,h)}i.StartNewThenStopOld(t,[c.Storyboard,p]),i.RaiseCurrentStateChanging(t,u,a,e)}return i.CurrentState=a,!0},o.DestroyStoryboards=function(e,t){if(!t)return!1;var n=o.GetVisualStateGroups(t);if(!n)return!1;for(var r=n.getEnumerator();r.moveNext();)r.current.StopCurrentStoryboards(t)},o.Deactivate=function(e,t){if(!t)return!1;var n=o.GetVisualStateGroups(t);if(!n)return!1;for(var r=n.getEnumerator();r.moveNext();)r.current.Deactivate()},o.Activate=function(e,t){if(!t)return!1;var n=o.GetVisualStateGroups(t);if(!n)return!1;for(var r=n.getEnumerator();r.moveNext();)r.current.Activate()},o._GetTemplateRoot=function(t){if(t instanceof e.Controls.UserControl)return t.XamlNode.TemplateRoot;var n=t.XamlNode.GetVisualTreeEnumerator(),r=null;return n.moveNext()&&(r=n.current,r instanceof e.FENode||(r=null)),r?r.XObject:null},o.GetGroup=function(e,t){var n=o._GetTemplateRoot(e);if(!n)return null;var r=o.GetVisualStateGroups(n);if(!r)return null;for(var i=r.getEnumerator();i.moveNext();)if(i.current.Name===t)return i.current;return null},o._TryGetState=function(e,t,n){for(var r=e.getEnumerator();r.moveNext();)if(n.group=r.current,n.state=n.group.GetState(t),n.state)return!0;return n.group=null,n.state=null,!1},o._GetTransition=function(e,t,n,r){if(!e)throw new ArgumentException("element");if(!t)throw new ArgumentException("group");if(!r)throw new ArgumentException("to");for(var o,i=null,a=null,s=-1,u=t.Transitions.getEnumerator();u.moveNext();)if(o=u.current,a||!o.IsDefault){var l=-1,c=t.GetState(o.From),p=t.GetState(o.To);if(n===c)l+=1;else if(null!=c)continue;if(r===p)l+=2;else if(null!=p)continue;l>s&&(s=l,i=o)}else a=o;return null!=i?i:a},o.VisualStateGroupsProperty=DependencyProperty.RegisterAttachedCore("VisualStateGroups",function(){return n.VisualStateGroupCollection},o),o.CustomVisualStateManagerProperty=DependencyProperty.RegisterAttachedCore("CustomVisualStateManager",function(){return o},o),o}(e.DependencyObject);n.VisualStateManager=l,e.CoreLibrary.add(l);var c=t.Animation.Storyboard}(n=t.VSM||(t.VSM={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(t){var n;!function(n){var r=function(e){function n(){e.apply(this,arguments),this.From=null,this.To=null,this._GeneratedDuration=null,this.DynamicStoryboardCompleted=!0,this.ExplicitStoryboardCompleted=!0}return __extends(n,e),Object.defineProperty(n.prototype,"GeneratedDuration",{get:function(){return this._GeneratedDuration},set:function(e){this._GeneratedDuration=nullstone.convertAnyToType(e,Duration)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsDefault",{get:function(){return null==this.From&&null==this.To},enumerable:!0,configurable:!0}),n.StoryboardProperty=DependencyProperty.Register("Storyboard",function(){return t.Animation.Storyboard},n),n}(e.DependencyObject);n.VisualTransition=r,e.Markup.Content(r,r.StoryboardProperty),e.CoreLibrary.add(r)}(n=t.VSM||(t.VSM={}))}(t=e.Media||(e.Media={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(e,t,n,r,o){this.SelectionAnchor=e,this.SelectionCursor=t,this.Start=r,this.Text=n.substr(r,o)}return t.prototype.Undo=function(t){t.text=e.Buffer.insert(t.text,this.Start,this.Text)},t.prototype.Redo=function(t){return t.text=e.Buffer.cut(t.text,this.Start,this.Text.length),this.Start},t}();t.DeleteAction=n}(t=e.History||(e.History={}))}(t=e.Text||(e.Text={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(e,t,n,r,o){this.SelectionAnchor=e,this.SelectionCursor=t,this.Start=n,this.Text=r,this.IsGrowable=o!==!0}return t.prototype.Undo=function(t){t.text=e.Buffer.cut(t.text,this.Start,this.Text.length)},t.prototype.Redo=function(t){return t.text=e.Buffer.insert(t.text,this.Start,this.Text),this.Start+this.Text.length},t.prototype.Insert=function(e,t){return this.IsGrowable&&e===this.Start+this.Text.length?(this.Text+=t,!0):!1},t}();t.InsertAction=n}(t=e.History||(e.History={}))}(t=e.Text||(e.Text={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(e,t,n,r,o,i){this.SelectionAnchor=e,this.SelectionCursor=t,this.Start=r,this.Length=o,this.Deleted=n.substr(r,o),this.Inserted=i}return t.prototype.Undo=function(t){t.text=e.Buffer.cut(t.text,this.Start,this.Inserted.length),t.text=e.Buffer.insert(t.text,this.Start,this.Deleted)},t.prototype.Redo=function(t){return t.text=e.Buffer.cut(t.text,this.Start,this.Length),t.text=e.Buffer.insert(t.text,this.Start,this.Inserted),this.Start+this.Inserted.length},t}();t.ReplaceAction=n}(t=e.History||(e.History={}))}(t=e.Text||(e.Text={}))}(Fayde||(Fayde={}));var Fayde;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(e){this.$$undo=[],this.$$redo=[],this.$$maxUndoCount=e}return Object.defineProperty(n.prototype,"canUndo",{get:function(){return this.$$undo.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canRedo",{get:function(){return this.$$redo.length>0},enumerable:!0,configurable:!0}),n.prototype.undo=function(e){if(this.$$undo.length<1)return null;var t=this.$$undo.pop();return this.$$redo.push(t)>this.$$maxUndoCount&&this.$$redo.shift(),t.Undo(e),t},n.prototype.redo=function(e){if(!(this.$$redo.length<1)){var t=this.$$redo.pop();return this.$$undo.push(t)>this.$$maxUndoCount&&this.$$undo.shift(),t.Redo(e)}},n.prototype.enter=function(e,n,r,o){var i=this.$$undo[this.$$undo.length-1];return i instanceof t.InsertAction&&i.Insert(r,o)?void(this.$$redo.length>0&&(this.$$redo=[])):this.insert(e,n,r,o)},n.prototype.insert=function(e,n,r,o){this.$doAction(new t.InsertAction(e,n,r,o))},n.prototype.replace=function(e,n,r,o,i,a){this.$doAction(new t.ReplaceAction(e,n,r,o,i,a))},n.prototype["delete"]=function(t,n,r,o,i){this.$doAction(new e.History.DeleteAction(t,n,r,o,i))},n.prototype.$doAction=function(e){this.$$undo.push(e),this.$$undo.length>this.$$maxUndoCount&&this.$$undo.shift(),this.$$redo=[]},n}();t.Tracker=n}(t=e.History||(e.History={}))}(t=e.Text||(e.Text={}))}(Fayde||(Fayde={}));var Fayde;!function(e){function t(){for(var t=[],r=e.Application.Current,o=r.MainSurface.walkLayers();o.step();)t.push(n(o.current));return t}function n(e){var t=e.getAttachedValue("$node"),i=t.XObject,a=new Function("return function "+i.constructor.name+"() { }")(),s=new a;s.assets=e.assets,s.dirtyFlags=r(e.assets.dirtyFlags),s.uiFlags=o(e.assets.uiFlags),s.children=[],s.id=i._ID,s.node=t;for(var u=e.tree.walk();u.step();)s.children.push(n(u.current));return s}function r(e){var t=Object.keys(minerva.DirtyFlags).map(function(e){return parseInt(e)}).filter(function(e){return!isNaN(e)}).filter(i).sort(function(e,t){return e===t?0:t>e?-1:1}).reverse(),n=e;return t.filter(function(e){return 0===(n&e)?!1:(n&=~e,!0)}).map(function(e){return minerva.DirtyFlags[e]}).join("|")}function o(e){var t=Object.keys(minerva.UIFlags).map(function(e){return parseInt(e)}).filter(function(e){return!isNaN(e)}).filter(i).sort(function(e,t){return e===t?0:t>e?-1:1}).reverse(),n=e;return t.filter(function(e){return 0===(n&e)?!1:(n&=~e,!0)}).map(function(e){return minerva.UIFlags[e]}).join("|")}function i(e){var t=Math.log2(e);return Math.abs(Math.round(t)-t)<1e-6}function a(){for(var t=e.Application.Current,n="",r=t.MainSurface.walkLayers();r.step();)n+=s(r.current);return n}function s(e,t){void 0===t&&(t=0);for(var n=e.getAttachedValue("$node"),r=n.XObject,o="",i=0;t>i;i++)o+="	";o+=r.constructor.name,o+="["+r._ID+"]";var a=n.NameScope,u=a?a.IsRoot?"+":"-":"^";o+=" ["+u+n.Name+"]",o+="\n";for(var l=e.tree.walk();l.step();)o+=s(l.current,t+1);return o}function u(t){for(var n=e.Application.Current,i=n.MainSurface.walkLayers();i.step();)for(var a=i.current.walkDeep();a.step();){var s=a.current,u=s.getAttachedValue("$node"),l=u.XObject;if(l._ID===t)return{obj:l,node:u,updater:s,flags:r(s.assets.dirtyFlags),uiflags:o(s.assets.uiFlags)}}}function l(){for(var t=[],n=e.Application.Current,r=n.MainSurface.walkLayers();r.step();)for(var o=r.current.walkDeep();o.step();)t.push(o.current);return t}e.debugLayers=t,e.sexify=n,e.debugLayersRaw=a,e.getById=u,e.debugLayersFlatten=l}(Fayde||(Fayde={}));
//# sourceMappingURL=fayde.min.js.map